<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mrli&#39;s Blog</title>
  
  <subtitle>åˆ«è£…ä½œå¾ˆåŠªåŠ›ï¼Œç»“å±€ä¸ä¼šé™ªä½ æ¼”æˆã€‚</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://nymrli.top/"/>
  <updated>2022-06-03T02:18:07.863Z</updated>
  <id>https://nymrli.top/</id>
  
  <author>
    <name>Mrli</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>çˆ¬è™«â€”â€”è¯·æ±‚å‚æ•°é€†å‘</title>
    <link href="https://nymrli.top/2022/06/01/%E7%88%AC%E8%99%AB%E2%80%94%E2%80%94%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91/"/>
    <id>https://nymrli.top/2022/06/01/çˆ¬è™«â€”â€”è¯·æ±‚å‚æ•°é€†å‘/</id>
    <published>2022-06-01T15:13:46.000Z</published>
    <updated>2022-06-03T02:18:07.863Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç™»é™†å‚æ•°ç±»"><a class="markdownIt-Anchor" href="#ç™»é™†å‚æ•°ç±»"></a> ç™»é™†å‚æ•°ç±»</h1><h2 id="æ–°æµªåšå®¢ç™»é™†"><a class="markdownIt-Anchor" href="#æ–°æµªåšå®¢ç™»é™†"></a> <a href="http://blog.sina.com.cn/" target="_blank" rel="noopener">æ–°æµªåšå®¢ç™»é™†</a></h2><p>Inputè¾“å…¥:</p><ol><li>Usernameè´¦å·</li><li>passwordå¯†ç </li></ol><p>paramsè¯·æ±‚å‚æ•°ï¼š</p><ol><li><a href="https://login.sina.com.cn/sso/prelogin.php?entry=boke&amp;callback=sinaSSOController.preloginCallBack&amp;su=MTUyMzIxMzEy&amp;rsakt=mod&amp;checkpin=1&amp;client=ssologin.js(v1.4.19)&amp;_=1654090585990" target="_blank" rel="noopener">https://login.sina.com.cn/sso/prelogin.php?entry=boke&amp;callback=sinaSSOController.preloginCallBack&amp;su=MTUyMzIxMzEy&amp;rsakt=mod&amp;checkpin=1&amp;client=ssologin.js(v1.4.19)&amp;_=1654090585990</a><ul><li>entry: bokeâ€”â€”å›ºå®šå€¼</li><li>callback: sinaSSOController.preloginCallBackâ€”â€”å›ºå®šå€¼</li><li>su: MTUyMzIxMzEyâ€”â€”å˜ï¼šåŠ å¯†</li><li>rsakt: modâ€”â€”å›ºå®šå€¼</li><li>checkpin: 1â€”â€”å›ºå®šå€¼</li><li>client: ssologin.js(v1.4.19)â€”â€”å›ºå®šå€¼</li><li>_: 1654090585990â€”â€”å˜ï¼š13ä½æ—¶é—´æˆ³</li></ul></li><li><a href="https://login.sina.com.cn/sso/login.php?client=ssologin.js(v1.4.19)&amp;_=1654090586051" target="_blank" rel="noopener">https://login.sina.com.cn/sso/login.php?client=ssologin.js(v1.4.19)&amp;_=1654090586051</a><ul><li>client: ssologin.js(v1.4.19)â€”â€”å›ºå®šå€¼</li><li>_: 1654090586051â€”â€”13ä½æ—¶é—´æˆ³</li></ul></li></ol><h3 id="é’ˆå¯¹suå‚æ•°çš„è§£å¯†æµç¨‹"><a class="markdownIt-Anchor" href="#é’ˆå¯¹suå‚æ•°çš„è§£å¯†æµç¨‹"></a> é’ˆå¯¹<code>su</code>å‚æ•°çš„è§£å¯†æµç¨‹</h3><ol><li><p><code>Ctrl+Shift+F</code>å…¨å±€æœç´¢: <code>su =</code></p></li><li><p>æœç´¢ç»“æœä¸­å®šä½åˆ°å…·ä½“çš„æ–‡ä»¶ï¼š<code>ssologin.js</code></p></li><li><p>Jsonifyåé˜…è¯»ä»£ç ï¼Œå®šä½å…·ä½“è¡Œæ•°ï¼š971</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">request = objMerge(request, me.loginExtraFlag);</span><br><span class="line">request = objMerge(request, me.loginExtraQuery);</span><br><span class="line">request.su = sinaSSOEncoder.base64.encode(urlencode(username));</span><br><span class="line"><span class="keyword">if</span> (me.service) &#123;</span><br><span class="line">    request.service = me.service</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç»™971è¡Œ: <code>request.su = sinaSSOEncoder.base64.encode(urlencode(username));</code>åŠ ä¸Šæ–­ç‚¹</p></li><li><p>é‡æ–°è¾“å…¥è´¦å·å¯†ç åï¼Œæäº¤ç™»é™†è¯·æ±‚</p></li><li><p>æ•æ‰4ä¸­æ‰“çš„æ–­ç‚¹ï¼ŒæŸ¥çœ‹å‚æ•°è¿è¡Œæ—¶çš„å€¼</p></li><li><p>è§‚å¯Ÿ971è¡Œå…·ä½“çš„åŠ å¯†é€»è¾‘ï¼š</p></li><li><p>æ‰£å‡ºsinaSSOEncoderç±»çš„å®šä¹‰ï¼š</p></li></ol><h3 id="é™„jsä¸­callè°ƒç”¨"><a class="markdownIt-Anchor" href="#é™„jsä¸­callè°ƒç”¨"></a> é™„â€”â€”JSä¸­callè°ƒç”¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a =  a||&#123;&#125;;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.say =&#123;</span><br><span class="line">        what: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"what"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).call(a);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line"><span class="built_in">console</span>.log(a.say.what())</span><br></pre></td></tr></table></figure><h1 id="è¯·æ±‚å‚æ•°ç±»"><a class="markdownIt-Anchor" href="#è¯·æ±‚å‚æ•°ç±»"></a> è¯·æ±‚å‚æ•°ç±»</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ç™»é™†å‚æ•°ç±»&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç™»é™†å‚æ•°ç±»&quot;&gt;&lt;/a&gt; ç™»é™†å‚æ•°ç±»&lt;/h1&gt;
&lt;h2 id=&quot;æ–°æµªåšå®¢ç™»é™†&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ–°æµªåšå®¢ç™»é™†&quot;&gt;&lt;/a&gt; &lt;
      
    
    </summary>
    
    
      <category term="çˆ¬è™«" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
      <category term="JS" scheme="https://nymrli.top/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>æ¯å‘¨ä¸€ä¸ªå¼€æºé¡¹ç›®â€”â€”ddt-sharp-shooter</title>
    <link href="https://nymrli.top/2022/05/29/%E6%AF%8F%E5%91%A8%E4%B8%80%E4%B8%AA%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94ddt-sharp-shoote/"/>
    <id>https://nymrli.top/2022/05/29/æ¯å‘¨ä¸€ä¸ªå¼€æºé¡¹ç›®â€”â€”ddt-sharp-shoote/</id>
    <published>2022-05-29T10:04:15.000Z</published>
    <updated>2022-05-30T15:40:16.738Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ddt-sharp-shooter"><a class="markdownIt-Anchor" href="#ddt-sharp-shooter"></a> <a href="https://github.com/boring-plans/ddt-sharp-shooter" target="_blank" rel="noopener">ddt-sharp-shooter</a></h1><blockquote><p>è¿™æ˜¯ä¸€ä¸ªåŸºäº <a href="https://github.com/moses-palmer/pynput" target="_blank" rel="noopener">Pynput</a> çš„ DDT å·¥å…·ã€‚åŸºæœ¬åŸç†åœ¨äºï¼Œå¾—çŸ¥é£åŠ›ã€è§’åº¦ã€è·ç¦»çš„æƒ…å†µä¸‹ï¼Œå‚è€ƒåŠ›åº¦è¡¨å¾—å‡ºå‘å°„åŠ›åº¦ï¼Œè€Œåå‘å°„ã€‚<br>å…¶ä¸­ï¼Œé£åŠ›ã€è§’åº¦é€šè¿‡ <a href="https://github.com/sml2h3/ddddocr" target="_blank" rel="noopener">ddddocr</a>ï¼ˆAn awesome captcha recognition libraryï¼‰è¯†åˆ«ï¼Œå±è·é€šè¿‡æ ‡è®°å±è·æµ‹é‡æ¡†ã€æ•Œæˆ‘ä½ç½®æ¥æ¨ç®—ï¼ŒåŠ›åº¦é€šè¿‡æŒ‰å‹æ—¶é•¿æ¥ä½“ç°ï¼Œå…·ä½“è§<a href="https://github.com/boring-plans/ddt-sharp-shooter/tree/master" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p></blockquote><h2 id="ä½¿ç”¨åˆ°çš„åº“"><a class="markdownIt-Anchor" href="#ä½¿ç”¨åˆ°çš„åº“"></a> ä½¿ç”¨åˆ°çš„åº“:</h2><p><code>screeninfoã€pillowã€ddddocrã€pynputã€py2app</code></p><ul><li>pynput: æ§åˆ¶å’Œç›‘è§†è¾“å…¥è®¾å¤‡ï¼›ç±»ä¼¼çš„æœ‰PyHook3ï¼ˆç›‘è§†é”®é¼ ï¼‰ã€pywin32 ï¼ˆæ¨¡æ‹Ÿé”®é¼ ï¼‰</li><li>ddddocrï¼šè¯†åˆ«éªŒè¯ç ï¼Œè¿™è¾¹ç”¨æ¥è¯†åˆ«æ•°å­—</li><li>py2app: å°†Pythonç¨‹åºæ‰“åŒ…æˆMacOSåº”ç”¨ç¨‹åº</li><li>screeninfo: è·å¾—å±å¹•æ˜¾ç¤ºä¿¡æ¯ï¼š<code>monitors = screeninfo.get_monitors()</code>ã€<code>_screen_size = (monitors[0].width, monitors[0].height)</code></li><li>pillow: è¿›è¡Œå±å¹•æˆªå›¾</li></ul><h2 id="whats-new"><a class="markdownIt-Anchor" href="#whats-new"></a> Whatâ€™s New:</h2><h3 id="1è¿›ç¨‹é—´é€šä¿¡"><a class="markdownIt-Anchor" href="#1è¿›ç¨‹é—´é€šä¿¡"></a> 1.è¿›ç¨‹é—´é€šä¿¡</h3><blockquote><p>Tkinterç•Œé¢å¼€å¯mainloopè¿›ç¨‹ï¼Œå…¶ä¸­åˆå¼€è¾Ÿå‡ºä¸€ä¸ªå­çº¿ç¨‹æ¥ä¾¦å¬å…¶ä»–è¿›ç¨‹å‘é€çš„æ•°æ®æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡<code>tk.Text</code>æ§ä»¶æ¥å±•ç¤º</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="comment"># å£°æ˜å…¨å±€å¯¹è±¡åŠç±»å‹</span></span><br><span class="line">_tk: tkinter.Tk</span><br><span class="line">_text: tkinter.Text</span><br><span class="line">_terminate = <span class="keyword">False</span></span><br><span class="line">_queue: multiprocessing.Queue</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_text</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""å­çº¿ç¨‹ä¾¦å¬è¿›ç¨‹æ¶ˆæ¯"""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> _terminate:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _queue.empty():</span><br><span class="line">            text = _queue.get(<span class="keyword">False</span>)</span><br><span class="line">            append_text(text)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_text</span><span class="params">(text)</span>:</span></span><br><span class="line">    _text.config(state=<span class="string">'normal'</span>)</span><br><span class="line">    _text.insert(<span class="string">'end'</span>, <span class="string">f'\n<span class="subst">&#123;text&#125;</span>'</span>)</span><br><span class="line">    _text.see(<span class="string">'end'</span>)</span><br><span class="line">    _text.config(state=<span class="string">'disabled'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(gui_queue)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> _tk, _text, _queue, _screen_size</span><br><span class="line">    _queue = gui_queue</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    threading.Thread(target=update_text).start()</span><br><span class="line">    </span><br><span class="line">    _tk.mainloop()</span><br></pre></td></tr></table></figure><h3 id="2py2appåˆ›å»ºmacosåº”ç”¨"><a class="markdownIt-Anchor" href="#2py2appåˆ›å»ºmacosåº”ç”¨"></a> 2.py2appåˆ›å»ºMacOSåº”ç”¨</h3><p><code>py2app setup</code>ï¼Œåœ¨macosä¸‹åˆ›å»ºpythonåº”ç”¨ï¼Œ <code>python setup.py py2app</code></p><h3 id="3ddddocrè¯†åˆ«æ•°å­—å¹¶æ¸…æ™°"><a class="markdownIt-Anchor" href="#3ddddocrè¯†åˆ«æ•°å­—å¹¶æ¸…æ™°"></a> 3.ddddocrè¯†åˆ«æ•°å­—å¹¶æ¸…æ™°</h3><p>å¯¹çº¯æ•°å­—è¯†åˆ«ç»“æœè¿›è¡Œæ¸…æ´—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recognize_digits</span><span class="params">(image: bytes)</span>:</span></span><br><span class="line">    <span class="string">"""è¿›è¡Œæ•°å­—è¯†åˆ«"""</span></span><br><span class="line">    ocr = ddddocr.DdddOcr(show_ad=<span class="keyword">False</span>)</span><br><span class="line">    result = ocr.classification(image)</span><br><span class="line">    <span class="keyword">return</span> wash_digits(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wash_digits</span><span class="params">(digits: str)</span>:</span></span><br><span class="line">    <span class="string">"""ç”±äºä¸ä¼šå‡ºç°éæ•°å­—, æ‰€ä»¥å¯¹æ˜“è¯†åˆ«é”™è¯¯çš„å­—ç¬¦è¿›è¡Œæ›¿æ¢"""</span></span><br><span class="line">    washed = digits \</span><br><span class="line">        .replace(<span class="string">'g'</span>, <span class="string">'9'</span>).replace(<span class="string">'q'</span>, <span class="string">'9'</span>) \</span><br><span class="line">        .replace(<span class="string">'l'</span>, <span class="string">'1'</span>).replace(<span class="string">'i'</span>, <span class="string">'1'</span>) \</span><br><span class="line">        .replace(<span class="string">'z'</span>, <span class="string">'2'</span>) \</span><br><span class="line">        .replace(<span class="string">'o'</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r'\D'</span>, <span class="string">'0'</span>, washed)</span><br></pre></td></tr></table></figure><h3 id="4pynputå¤„ç†é”®é¼ äº‹ä»¶"><a class="markdownIt-Anchor" href="#4pynputå¤„ç†é”®é¼ äº‹ä»¶"></a> 4.pynputå¤„ç†é”®é¼ äº‹ä»¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># km.py</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Keyboard and mouse input/output,</span></span><br><span class="line"><span class="string">and ScreenGrabbing</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> pynput <span class="keyword">import</span> keyboard, mouse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_click</span><span class="params">(x, y, btn_type, down)</span>:</span></span><br><span class="line">    <span class="string">"""é¼ æ ‡ç‚¹å‡»å›è°ƒå‡½æ•°"""</span></span><br><span class="line">    <span class="keyword">if</span> btn_type == mouse.Button.left <span class="keyword">and</span> down:</span><br><span class="line">        _queue.put((int(x), int(y)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_press</span><span class="params">(event)</span>:</span></span><br><span class="line">    <span class="string">"""æŒ‰é”®å›è°ƒå‡½æ•°"""</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># å¤„ç†æ­£å¸¸çš„ASCIIå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">if</span> event.char == <span class="string">'q'</span>:</span><br><span class="line">            <span class="comment"># è®¾ç½®æ¯’è¯, å½“queue.get()è·å¾—Noneçš„æ—¶å€™, æ¶ˆè´¹ç«¯åº”è¯¥è¢«kill</span></span><br><span class="line">            _queue.put(<span class="keyword">None</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _queue.put(event.char)</span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        <span class="comment"># å¤„ç†ç‰¹æ®Šçš„æŒ‰é”®</span></span><br><span class="line">        <span class="keyword">if</span> event == keyboard.Key.esc:</span><br><span class="line">            _queue.put(<span class="string">'esc'</span>)</span><br><span class="line">        <span class="keyword">elif</span> event == keyboard.Key.enter:</span><br><span class="line">            _queue.put(<span class="string">'enter'</span>)</span><br><span class="line">        <span class="keyword">elif</span> event == keyboard.Key.space:</span><br><span class="line">            _queue.put(<span class="string">' '</span>)</span><br><span class="line">        <span class="keyword">elif</span> event == keyboard.Key.backspace:</span><br><span class="line">            _queue.put(<span class="string">'delete'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">space_press_and_release</span><span class="params">(duration)</span>:</span></span><br><span class="line">    <span class="string">"""Press the key 'space' down for a while, and then release"""</span></span><br><span class="line">    <span class="comment"># @param duration: æŒç»­æ—¶é—´</span></span><br><span class="line">    k = keyboard.Controller()</span><br><span class="line">    k.press(keyboard.Key.space)</span><br><span class="line">    time.sleep(duration)</span><br><span class="line">    k.release(keyboard.Key.space)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_press_and_release</span><span class="params">(key)</span>:</span></span><br><span class="line">    <span class="string">"""Press certain key several times down, and then release immediately"""</span></span><br><span class="line">    <span class="comment"># @param key: æŒ‰ä¸‹æŒ‰é”®</span></span><br><span class="line">    k = keyboard.Controller()</span><br><span class="line">    k.press(key)</span><br><span class="line">    k.release(key)</span><br><span class="line">    time.sleep(<span class="number">0.37</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(km_queue)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> _queue</span><br><span class="line">    _queue = km_queue</span><br><span class="line"><span class="comment"># æ³¨å†Œé”®ç›˜äº‹ä»¶ç›‘å¬ä¸å›è°ƒå‡½æ•°</span></span><br><span class="line">    keyboard_listener = keyboard.Listener(on_press=on_press)</span><br><span class="line">    keyboard_listener.start()</span><br><span class="line">    time.sleep(<span class="number">.5</span>)</span><br><span class="line">    <span class="comment"># æ³¨å†Œé¼ æ ‡äº‹ä»¶ç›‘å¬ä¸å›è°ƒå‡½æ•°</span></span><br><span class="line">    mouse_listener = mouse.Listener(on_click=on_click)</span><br><span class="line">    mouse_listener.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    run(<span class="keyword">None</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>on_presså‡½æ•°åªæ˜¯äº§ç”Ÿäº†queueçš„æ•°æ®ï¼Œæ•°æ®å…·ä½“æ˜¯åœ¨main.pyä¸­çš„<code>handle_inputs</code>ä¸­è¢«æ¶ˆè´¹çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">km_listen_queue</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        inputs = _km_queue.get()</span><br><span class="line">        <span class="keyword">if</span> inputs <span class="keyword">is</span> <span class="keyword">None</span>:  <span class="comment"># poison bill</span></span><br><span class="line">            <span class="comment"># æ¥æ”¶æ¯’è¯, æ¯’è¯çš„è®¾ç½®å¯è§ä¸Šæ–‡Listenerä¸­å›è°ƒå‡½æ•°æ˜¯ä½•æ—¶put Noneçš„</span></span><br><span class="line">            <span class="keyword">if</span> len(_wind_degree_points) &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">with</span> open(_W_D_POINTS_DUMP_NAME, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    pickle.dump(_wind_degree_points, f)</span><br><span class="line">            _gui_process.terminate()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># handle inputs</span></span><br><span class="line">            handle_inputs(inputs)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_inputs</span><span class="params">(inputs)</span>:</span></span><br><span class="line">    <span class="string">"""To handle inputs"""</span></span><br><span class="line">    <span class="keyword">global</span> _command_flag, _direct_force_typing, _wind_direction</span><br><span class="line">    inputs_type = type(inputs)</span><br><span class="line">    <span class="comment"># é”®ç›˜äº‹ä»¶on_press, è¿”å›str</span></span><br><span class="line">    <span class="keyword">if</span> inputs_type == str:</span><br><span class="line">        <span class="comment"># press ESC to cancel</span></span><br><span class="line">        <span class="keyword">if</span> inputs == <span class="string">'esc'</span>:</span><br><span class="line">            reset_inputs()</span><br><span class="line">        <span class="keyword">elif</span> inputs == <span class="string">'-'</span>:</span><br><span class="line">            _wind_direction = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">elif</span> inputs == <span class="string">'='</span>:</span><br><span class="line">            _wind_direction = <span class="number">1</span></span><br><span class="line">        <span class="comment"># press the key 't' twice to enable command mode</span></span><br><span class="line">        <span class="keyword">elif</span> inputs == <span class="string">'t'</span>:</span><br><span class="line">            _command_flag += <span class="number">1</span></span><br><span class="line">            <span class="comment"># æœ€å¤§tçš„æ¬¡æ•°ä¸º4, æ‰€ä»¥4ä¸ºä¸€ä¸ªå‘¨æœŸ</span></span><br><span class="line">            _command_flag %= <span class="number">4</span></span><br><span class="line">            <span class="keyword">if</span> _command_flag == <span class="number">2</span>:</span><br><span class="line">                _gui_queue.put(<span class="string">"æŒ‡ä»¤è¾“å…¥å¼€å¯ğŸ’¡"</span>)</span><br><span class="line">            <span class="keyword">elif</span> _command_flag == <span class="number">0</span>:</span><br><span class="line">                _gui_queue.put(<span class="string">"æŒ‡ä»¤è¾“å…¥å…³é—­ğŸ”’"</span>)</span><br><span class="line">        <span class="keyword">elif</span> _command_flag == <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># _command_flag == 2æ­¤æ—¶ä¸ºå‘½ä»¤æ¨¡å¼, è¾“å…¥enterå®Œæˆè®¾ç½®, reset_inputs</span></span><br><span class="line">            <span class="comment"># press enter to submit command and fire</span></span><br><span class="line">            <span class="keyword">if</span> inputs == <span class="string">'enter'</span>:</span><br><span class="line">                direct_force = analyse_direct_force()</span><br><span class="line">                <span class="keyword">if</span> direct_force &gt; <span class="number">0</span>:</span><br><span class="line">                    fire(force=direct_force)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    wind, degree, distance = analyse_wind(), analyse_degree(), analyse_distance()</span><br><span class="line">                    fire(wind, degree, distance)</span><br><span class="line">                reset_inputs()</span><br><span class="line">            <span class="comment"># edit command</span></span><br><span class="line">            <span class="keyword">elif</span> inputs == <span class="string">'delete'</span>:</span><br><span class="line">                _direct_force_typing = _direct_force_typing[:<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                _direct_force_typing += inputs</span><br><span class="line">        <span class="comment"># when not in command mode</span></span><br><span class="line">        <span class="comment"># any key except 't' will reset mode flag</span></span><br><span class="line">        <span class="comment"># which means only consecutive 't' input can enable command mode</span></span><br><span class="line">        <span class="keyword">elif</span> _command_flag == <span class="number">1</span>:</span><br><span class="line">            reset_inputs()</span><br><span class="line">    <span class="comment"># é¼ æ ‡äº‹ä»¶on_click, è¿”å›(x, y)</span></span><br><span class="line">    <span class="keyword">elif</span> inputs_type == tuple:</span><br><span class="line">        <span class="keyword">if</span> _command_flag == <span class="number">2</span>:</span><br><span class="line">            _distance_points.append(inputs)</span><br><span class="line">            _gui_queue.put(<span class="string">f'<span class="subst">&#123;len(_distance_points)&#125;</span> ä¸ªç‚¹å·²æ ‡è®°'</span>)</span><br><span class="line">        <span class="comment"># æŒ‰ä¸‰æ¬¡tä¹‹åå†ç‚¹å‡», è¿›å…¥è®¾ç½®â€œè§’åº¦ä¸­å¿ƒä½ç½®ã€é£åŠ›ä¸­å¿ƒä½ç½®â€</span></span><br><span class="line">        <span class="keyword">if</span> _command_flag == <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> len(_wind_degree_points) == <span class="number">2</span>:</span><br><span class="line">                <span class="comment"># å¦‚æœæ ‡è®°è¿‡äº†é£åŠ›å’Œè§’åº¦, åˆ™é‡æ–°æ ‡è®°</span></span><br><span class="line">                _wind_degree_points.clear()</span><br><span class="line">            _wind_degree_points.append(inputs)</span><br><span class="line">            <span class="keyword">if</span> len(_wind_degree_points) == <span class="number">1</span>:</span><br><span class="line">                _gui_queue.put(<span class="string">'è§’åº¦ä½ç½®å·²æ ‡è®°ğŸ“ï¸'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                _gui_queue.put(<span class="string">'é£åŠ›ä½ç½®å·²æ ‡è®°ğŸŒªï¸'</span>)</span><br></pre></td></tr></table></figure><h3 id="5å±å¹•æˆªå›¾"><a class="markdownIt-Anchor" href="#5å±å¹•æˆªå›¾"></a> 5.å±å¹•æˆªå›¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">grab_box</span><span class="params">(box: tuple)</span> -&gt; bytes:</span></span><br><span class="line">    <span class="comment"># å¼€å¯å†…å­˜IO</span></span><br><span class="line">    bytes_io = io.BytesIO()</span><br><span class="line">    <span class="comment"># æˆªå›¾</span></span><br><span class="line">    image = ImageGrab.grab().resize((_screen_size[<span class="number">0</span>], _screen_size[<span class="number">1</span>])).crop(box)</span><br><span class="line">    <span class="comment"># å†™å…¥å†…å­˜IO</span></span><br><span class="line">    image.save(bytes_io, format=<span class="string">'png'</span>)</span><br><span class="line">    <span class="comment"># è·å¾—byteså€¼</span></span><br><span class="line">    <span class="keyword">return</span> bytes_io.getvalue()</span><br></pre></td></tr></table></figure><h2 id="æ‰§è¡Œæµç¨‹"><a class="markdownIt-Anchor" href="#æ‰§è¡Œæµç¨‹"></a> æ‰§è¡Œæµç¨‹</h2><blockquote><p><code>mian.py</code>ä¸ºç¨‹åºå…¥å£</p></blockquote><ol start="0"><li><p>å®šä¹‰å…¨å±€å˜é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">_W_D_POINTS_DUMP_NAME = <span class="string">'wind_degree_points.list'</span></span><br><span class="line">_PRESS_DURATION_PER_FORCE = <span class="number">4.1</span> / <span class="number">100</span></span><br><span class="line">_screen_size: tuple</span><br><span class="line">_command_flag = <span class="number">0</span></span><br><span class="line">_direct_force_typing = <span class="string">''</span></span><br><span class="line">_wind_direction = <span class="number">-1</span></span><br><span class="line">_distance_unit = <span class="number">0</span>  <span class="comment"># ç”¨äºåƒç´ ä¸å±è·è½¬æ¢</span></span><br><span class="line">_distance_points = []  <span class="comment"># ç”¨äºè®¡ç®— _distance_unit ä»¥åŠ å±è·</span></span><br><span class="line">_wind_degree_points = []  <span class="comment"># ç”¨äºé…ç½®è§’åº¦ã€é£åŠ› å±å¹•æˆªå–ä½ç½®çš„ç‚¹</span></span><br><span class="line">_gui_process: multiprocessing.Process</span><br><span class="line"><span class="comment"># GUIæ˜¯å¦å¤–çš„è¿›ç¨‹, æ‰€ä»¥éœ€è¦ä½¿ç”¨è¿›ç¨‹é—´çš„é˜Ÿåˆ—</span></span><br><span class="line">_gui_queue = multiprocessing.Queue()</span><br><span class="line"><span class="comment"># ç›¸æ¯”ä¹‹ä¸‹, kmæ˜¯ä¸»è¿›ç¨‹ä¸­çš„, ä¸æ¶‰åŠè¿›ç¨‹é—´æ•°æ®é€šä¿¡, æ‰€ä»¥ç›´æ¥ä½¿ç”¨æ™®é€šQueueå°±è¡Œ</span></span><br><span class="line">_km_queue = Queue()</span><br></pre></td></tr></table></figure></li><li><p>è·å¾—å±å¹•ä¿¡æ¯ï¼š<code>_screen_size = (monitors[0].width, monitors[0].height)</code></p></li><li><p>å¼€å¯GUIè¿›ç¨‹: <code>_gui_process = multiprocessing.Process(target=gui_run, args=(_gui_queue,))</code></p></li><li><p>å¼€å¯pynputçš„é”®é¼ ä¾¦å¬Listenerçº¿ç¨‹</p></li><li><p>å¼€å¯é”®é¼ å¤„ç†çº¿ç¨‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">threading.Thread(target=km_listen_queue).start()</span><br><span class="line"><span class="comment"># km_listen_queueä¸­æ¥æ”¶poison bill(å³æŒ‰ä¸‹"q")æ—¶, å…³é—­è¿›ç¨‹</span></span><br><span class="line">threading.Thread(target=gui_check_alive).start()</span><br><span class="line"><span class="comment"># GUIæ£€æµ‹å¿ƒè·³çº¿ç¨‹, å½“GUIçš„çŠ¶æ€ä¸æ˜¯is_aliveæ—¶, å‘queueä¸­æŠ•é€’æ¯’è¯, å°†terminateè®¾ç½®ä¸ºFalse. ä»è€Œå…³é—­GUIè¿›ç¨‹ä¸­çš„update_textçº¿ç¨‹</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨é”®é¼ å¤„ç†çº¿ç¨‹ä¸­ï¼Œæ ¹æ®é”®é¼ è¾“å…¥å€¼ï¼Œè¿›è¡ŒåŠŸèƒ½ç”Ÿæ•ˆ</p></li></ol><h2 id="ä»£ç é£æ ¼ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#ä»£ç é£æ ¼ç‰¹ç‚¹"></a> ä»£ç é£æ ¼ç‰¹ç‚¹ï¼š</h2><p>æ¯ä¸ªæ¨¡å—ï¼ˆpyæ–‡ä»¶ï¼‰éƒ½æœ‰è‡ªå·±çš„å…¨å±€å˜é‡ï¼Œé€šè¿‡ä¸»ç¨‹åºè°ƒç”¨æ¨¡å—å‡½æ•°æ—¶è¿›è¡Œä¼ å¼•ç”¨ï¼Œè€Œå˜é‡å…¨åœ¨ä¸»ç¨‹åº<code>main.py</code>ä¸­å®šä¹‰ã€‚</p><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“ï¼š</h2><p>æ¶‰åŠäº†<strong>å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€å›¾åƒè¯†åˆ«ã€å±å¹•æˆªå›¾è¯†åˆ«ã€é”®é¼ æ£€æµ‹ã€æ‰“åŒ…åº”ç”¨</strong>ç­‰å†…å®¹ï¼Œå…¶ä¸­å¯¹äºâ‘ å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ä½¿ç”¨ã€â‘¡è¯†åˆ«ç»“æœåçš„é’ˆå¯¹çº¯æ•°å­—æ•°æ®è¿›è¡Œæ¸…æ´—ï¼›â‘¢æ¶ˆæ¯é˜Ÿåˆ—çš„ä½¿ç”¨ã€æ¯’è¯è®¾ç½®ï¼›éƒ½æ¯”è¾ƒè®©äººæœ‰æ”¶è·ã€‚</p><h1 id="è§†é¢‘æ€è·¯"><a class="markdownIt-Anchor" href="#è§†é¢‘æ€è·¯"></a> è§†é¢‘æ€è·¯</h1><ol><li>è®²è§£ç¨‹åºåŠŸèƒ½</li><li>ä»‹ç»ä½¿ç”¨åˆ°çš„åº“</li><li>è®²è§£ç¨‹åºæ–‡ä»¶ç»“æ„</li><li>è®²è§£æ¯ä¸ªæ–‡ä»¶å®ç°</li><li>ä»‹ç»ä¼˜ç‚¹å’Œæœ‰ä»·å€¼çš„</li><li>ä»‹ç»ç¼ºç‚¹<ol><li>Cå¼çš„å…¨å±€å˜é‡é£æ ¼</li></ol></li></ol><p><a href="https://www.bilibili.com/video/BV1iz411b7Fa/" target="_blank" rel="noopener">ã€PRæ•™ç¨‹ã€‘2åˆ†é’Ÿå­¦ä¼šåˆ¶ä½œè§†é¢‘å†…å®¹å¯¼èˆªæ¡</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ddt-sharp-shooter&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ddt-sharp-shooter&quot;&gt;&lt;/a&gt; &lt;a href=&quot;https://github.com/boring-plans/ddt-sharp-sh
      
    
    </summary>
    
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
      <category term="å¼€æºé¡¹ç›®" scheme="https://nymrli.top/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>çˆ¬è™«Appâ€”â€”å¤œç¥æ¨¡æ‹Ÿå™¨xposed+inspeckage</title>
    <link href="https://nymrli.top/2022/05/10/%E7%88%AC%E8%99%ABApp%E2%80%94%E2%80%94xposed-inspeckage/"/>
    <id>https://nymrli.top/2022/05/10/çˆ¬è™«Appâ€”â€”xposed-inspeckage/</id>
    <published>2022-05-10T06:34:49.000Z</published>
    <updated>2022-05-10T12:47:02.087Z</updated>
    
    <content type="html"><![CDATA[<p>å¤´ä¸€æ¬¡æ¥è§¦åˆ°Appå‚æ•°åŠ å¯†çš„ï¼Œå› æ­¤éœ€è¦å¯¹åŠ å¯†å‚æ•°è¿›è¡Œåç¼–è¯‘ï¼Œäº†è§£åˆ°æœ‰å·¥å…·inspeckageå¯ä»¥æ–¹ä¾¿çš„æ¥æ‰¾å¯»åŠ å¯†å‚æ•°ã€‚è€Œå…¶ä½¿ç”¨çš„æ¡ä»¶ä¸º</p><ul><li>æ‰‹æœºå·²ROOT</li><li>åœ¨Xposedæ¡†æ¶ä¸‹è¿è¡Œ</li></ul><p>äºæ˜¯å¼€å§‹åœ¨å¤œç¥æ¨¡æ‹Ÿå™¨ä¸Šæ£é¼“å®‰è£…xposedã€inspeckageã€‚</p><h2 id="å®‰è£…"><a class="markdownIt-Anchor" href="#å®‰è£…"></a> å®‰è£…</h2><h3 id="xposedæ¡†æ¶"><a class="markdownIt-Anchor" href="#xposedæ¡†æ¶"></a> xposedæ¡†æ¶</h3><p>åœ¨ä¸å°‘åœ°æ–¹éƒ½ä¸‹è½½äº†xposedæ¡†æ¶ï¼Œä½†éƒ½ä¸å¤ªä½¿ç”¨ï¼Œåæ¥äº†è§£åˆ°æ¨¡æ‹Ÿå™¨çš„xposedæ˜¯ä¸“ç”¨çš„ï¼Œæ ¹æ®å¤œç¥æ¨¡æ‹Ÿå™¨å®˜ç½‘ä»‹ç»çš„<a href="https://support.yeshen.com/zh-CN/qt/xp" target="_blank" rel="noopener">å¤œç¥æ¨¡æ‹Ÿå™¨å¦‚ä½•å®‰è£…xposedæ¡†æ¶</a>åï¼Œå†³å®šè¿˜æ˜¯åœ¨<strong>æ¨¡æ‹Ÿå™¨çš„åº”ç”¨å•†åº—</strong>è¿›è¡Œå®‰è£…xposedï¼Œä¸‹è½½å®‰è£…åçš„åç§°ä¸º&quot;xposed æ´¾å¤§æ˜Ÿ&quot;ã€‚</p><p>ä¸‹è½½å®‰è£…åç«‹é©¬æ‰“å¼€è¿˜æ˜¯ä¼šæ˜¾ç¤ºæ²¡å®‰è£…ï¼Œéœ€è¦ç‚¹å‡»&quot;å®‰è£…/æ›´æ–°&quot;ä¸‹çš„é€‰é¡¹è¿›è¡Œå®‰è£…æ‰è¡Œã€‚åœ¨å®‰è£…å®Œæˆåå†é€‰æ‹©<strong>é‡å¯æ¨¡æ‹Ÿå™¨</strong>ã€‚</p><h3 id="inspeckageæ¨¡å—"><a class="markdownIt-Anchor" href="#inspeckageæ¨¡å—"></a> inspeckageæ¨¡å—</h3><blockquote><p>Inspeckageæ˜¯ä¸€ä¸ªç”¨äºæä¾›Androidåº”ç”¨ç¨‹åºåŠ¨æ€åˆ†æçš„å·¥å…·ã€‚é€šè¿‡å¯¹Android APIçš„å‡½æ•°ä½¿ç”¨hookæŠ€æœ¯ï¼Œå¸®åŠ©ç”¨æˆ·äº†è§£åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶çš„è¡Œä¸ºâ€”â€”cryptoèœå•æ ä¸‹ä¼šhookæ•æ‰å¸¸è§çš„åŠ å¯†ï¼ŒHashèœå•æ ä¸‹ä¼šhookæ•æ‰å¸¸è§çš„hashã€‚</p></blockquote><p>åŸä»¥ä¸ºéœ€è¦é¢å¤–å»æœå¯»ä¸‹è½½ï¼Œåæ¥å‘ç°æ¨èçš„éƒ½æ˜¯å®‰è£…å¥½xposedè½¯ä»¶åï¼Œåœ¨å…¶èœå•æ çš„&quot;ä¸‹è½½&quot;ä¸­æœå¯»&quot;inspeckage&quot;æ¨¡å—ä½¿ç”¨ï¼ˆæœç´¢ç»“æœä¸ºInspeckage-Andriod package inspectorï¼‰åå®‰è£…ï¼Œå®‰è£…æˆåŠŸåˆ‡æ¢åˆ°èœå•æ çš„&quot;æ¨¡å—&quot;ä¸­ï¼Œå‹¾é€‰&quot;inspeckage&quot;å<strong>é‡å¯æ¨¡æ‹Ÿå™¨</strong>ã€‚</p><p>æ³¨ï¼šxposedçš„ä½œç”¨åªæ˜¯ä¸ºäº†ç»™inspeckageæä¾›è¿è¡Œç¯å¢ƒã€‚</p><h2 id="å¯åŠ¨inspeckage"><a class="markdownIt-Anchor" href="#å¯åŠ¨inspeckage"></a> å¯åŠ¨inspeckage</h2><blockquote><p>å‚è€ƒï¼šInspeckageæ’ä»¶çš„è¿ç”¨</p></blockquote><ol><li><p>æ‰“å¼€æ¨¡æ‹Ÿå™¨çš„inspeckageç¨‹åºï¼Œ<code>choose target</code>ï¼šé€‰æ‹©ç›®æ ‡appç¨‹åº</p><p><img src="/2022/05/10/çˆ¬è™«Appâ€”â€”xposed-inspeckage/E:%5Chexo%5Csource_posts%5C%E7%88%AC%E8%99%ABApp%E2%80%94%E2%80%94xposed-inspeckage%5C%E6%A8%A1%E6%8B%9F%E5%99%A8inspeckage.jpg" alt="æ¨¡æ‹Ÿå™¨inspeckage"></p></li><li><p>ç‚¹å‡»&quot;Lauch APP&quot;æ‰“å¼€è¦æ•è·ç¨‹åº</p></li><li><p>åœ¨å®¿ä¸»æœºcmdé‡Œé¢è¾“å…¥å‘½ä»¤<code>adb forward tcp:8008 tcp:8008</code>ï¼Œç„¶ååœ¨æµè§ˆå™¨é‡Œè¾“å…¥http://127.0.0.1:8008 å°±ä¼šçœ‹åˆ°Inspeckageçš„ç•Œé¢</p></li></ol><p><img src="/2022/05/10/çˆ¬è™«Appâ€”â€”xposed-inspeckage/E:%5Chexo%5Csource_posts%5C%E7%88%AC%E8%99%ABApp%E2%80%94%E2%80%94xposed-inspeckage%5Cinspeckage%E7%BD%91%E9%A1%B5.png" alt="inspeckageç½‘é¡µ"></p><p>æ³¨ï¼šå¾—æ‰‹åŠ¨ç‚¹å‡»ONæ‰èƒ½å®æ—¶æŠ“ä¿¡æ¯ã€‚</p><p>æ›´å¤šä»‹ç»è§ï¼š<a href="https://blog.csdn.net/tom__chen/article/details/78216732" target="_blank" rel="noopener">Inspeckageä½¿ç”¨ç¬”è®°ï¼ˆappå®‰å…¨æ£€æµ‹å·¥å…·ï¼‰</a></p><h2 id="ä½¿ç”¨inspeckage"><a class="markdownIt-Anchor" href="#ä½¿ç”¨inspeckage"></a> ä½¿ç”¨inspeckage</h2><p>èœå•é¡µè¯´æ˜</p><table><thead><tr><th style="text-align:center">æ¨¡å—å</th><th style="text-align:center">åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">Logcat</td><td style="text-align:center">æŸ¥çœ‹è¯¥appçš„logcatè¾“å‡º</td></tr><tr><td style="text-align:center">Tree View</td><td style="text-align:center">æµè§ˆappçš„æ•°æ®ç›®å½•å¹¶ç›´æ¥ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</td></tr><tr><td style="text-align:center">Package Information</td><td style="text-align:center">åº”ç”¨åŸºæœ¬ä¿¡æ¯ï¼ˆç»„ä»¶ä¿¡æ¯ã€æƒé™ä¿¡æ¯ã€å…±äº«åº“ä¿¡æ¯ï¼‰</td></tr><tr><td style="text-align:center">Shared Preferences</td><td style="text-align:center">LOGï¼šapp XMLæ–‡ä»¶è¯»å†™è®°å½•ï¼›Filesï¼šå…·ä½“XMLå†™å…¥å†…å®¹</td></tr><tr><td style="text-align:center">Serialization</td><td style="text-align:center">ååºåˆ—åŒ–è®°å½•</td></tr><tr><td style="text-align:center">Crypto</td><td style="text-align:center">å¸¸è§åŠ è§£å¯†è®°å½•ï¼ŒAESã€DESã€RSAï¼ˆKEYã€IVå€¼ï¼‰</td></tr><tr><td style="text-align:center">Hash</td><td style="text-align:center">å¸¸è§çš„å“ˆå¸Œç®—æ³•è®°å½•</td></tr><tr><td style="text-align:center">SQLite</td><td style="text-align:center">SQLiteæ•°æ®åº“æ“ä½œè®°å½•</td></tr><tr><td style="text-align:center">HTTP</td><td style="text-align:center">HTTPç½‘ç»œè¯·æ±‚è®°å½•</td></tr><tr><td style="text-align:center">File System</td><td style="text-align:center">æ–‡ä»¶è¯»å†™è®°å½•</td></tr><tr><td style="text-align:center">Misc.</td><td style="text-align:center">è°ƒç”¨Clipboard,URL.Parse()è®°å½•</td></tr><tr><td style="text-align:center">WebView</td><td style="text-align:center">è°ƒç”¨webviewå†…å®¹</td></tr><tr><td style="text-align:center">IPC</td><td style="text-align:center">è¿›ç¨‹ä¹‹é—´é€šä¿¡è®°å½•</td></tr><tr><td style="text-align:center">+Hooks</td><td style="text-align:center">è¿è¡Œè¿‡ç¨‹ä¸­ç”¨æˆ·è‡ªå®šä¹‰Hookè®°å½•</td></tr></tbody></table><p>æ³¨ï¼šinspeckageä¸»è¦æ˜¯ç”¨æ¥hookåŠ å¯†çš„ï¼Œå¯¹hashæ£€æµ‹çš„æ•ˆæœå¯èƒ½ä¸æ˜¯å¾ˆå¥½â€”â€”AXHC</p><p><strong>ä½¿ç”¨è¯´æ˜</strong>ï¼š</p><p>å¦‚æœæ˜¯è¦å‚çœ‹åŠ å¯†å‰çš„æ•°æ®ï¼ˆè§£å¯†æ•°æ®ï¼‰ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹Cryptoèœå•æ ä¸‹çš„å†…å®¹ï¼Œæœç´¢ä½ æ‰€éœ€è¦æ‰¾çš„åŠ å¯†å‚æ•°å°±å¯ä»¥å¾—åˆ°åŸæ–‡å’Œä½¿ç”¨çš„åŠ å¯†ã€Hashç±»å‹ï¼Œç›´æ¥ç§’æ€ï¼</p><p>æ¯”å¦‚:<code>Algorithm( MD5 ) [eexssdsd : zxcxzc]</code>ï¼Œè¯´æ˜ä½¿ç”¨çš„ç®—æ³•ä¸ºMD5ï¼Œ <code>[plaintext : encrypted]</code></p><p><strong>åŸç†åˆ†æ</strong>ï¼šé‚£ä¹ˆè¿™ä¸ªæ•ˆæœæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç›´æ¥å°†Javaæ ‡å‡†åº“ä¸­å¸¸è§çš„è¢«ç”¨äºç”ŸæˆåŠ å¯†å‚æ•°çš„æ–¹æ³•ç»™Hookäº†ï¼Œç›‘å¬å®ƒä»¬çš„è¾“å…¥å‚æ•°å’Œè¿”å›å€¼ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥å¾—åˆ°åŠ å¯†ã€Hashå‰çš„åŸæ–‡ã€å¯†é’¥ã€IVç­‰å†…å®¹äº†ï¼Œæ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿâ€”â€”ç›¸å¯¹äºåç¼–è¯‘appï¼Œè‡ªå·±å†çœ‹ä»£ç å®ç°ç®€å•ã€å¿«æ·å¤šäº†ã€‚</p><p><strong>å®æˆ˜</strong>ï¼š</p><ul><li>è§£æsignå‚æ•°çš„æ˜æ–‡ï¼š<a href="https://blog.csdn.net/qq_38832624/article/details/100897605" target="_blank" rel="noopener">https://blog.csdn.net/qq_38832624/article/details/100897605</a></li><li><a href="https://blog.csdn.net/fatesunlove/article/details/105146882" target="_blank" rel="noopener">inspeckageä½¿ç”¨å®æˆ˜ä¸¤ä¾‹</a></li><li><a href="https://blog.csdn.net/z434890/article/details/100528704" target="_blank" rel="noopener">appåç¼–è¯‘å®æˆ˜ä¸‰ï¼šå·¥å…·inspeckageçš„ä½¿ç”¨</a>â€”â€”è¯†è´§MD5å‚æ•°è§£æ</li><li>Jadxåç¼–è¯‘ï¼š<a href="https://cloud.tencent.com/developer/article/1447630?from=article.detail.1548593" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1447630?from=article.detail.1548593</a></li><li>è§†é¢‘æ•™ç¨‹ï¼š<ul><li><a href="https://space.bilibili.com/175052335" target="_blank" rel="noopener">APPé€†å‘è§£å¯† å®‰å“HOOK</a>â€”â€”æ°æ°å°è§†é¢‘ï¼Œå¤åˆåŠ å¯†: MD5(password, â€œsaltAâ€ + phoneNum + â€œsaltBâ€)</li><li><a href="https://www.bilibili.com/video/BV1Qa4y1J7bc?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noopener">å®‰å“é€†å‘ HOOK APPåŠ å¯†å­—æ®µsignè§£å¯†</a>â€”â€”ä¼—èµ¢æ—¶ç©º</li></ul></li></ul><h1 id="é™„å½•"><a class="markdownIt-Anchor" href="#é™„å½•"></a> é™„å½•</h1><h2 id="mudule-disabled"><a class="markdownIt-Anchor" href="#mudule-disabled"></a> Mudule disabled</h2><p><strong>Module disabled</strong>è¡¨æ˜<a href="http://lib.csdn.net/base/softwaretest" target="_blank" rel="noopener">æµ‹è¯•</a>ç¯å¢ƒä¸­æ²¡æœ‰å®‰è£…<em><strong>Xposedæ¡†æ¶*</strong>ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ²¡æœ‰Xposedçš„æƒ…å†µä¸‹è¿è¡Œ</em><em>Inspeckage</em>*ï¼Œä½†æ˜¯ç»å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½è¦ä¾èµ–Xposedæ¡†æ¶ï¼Œæ‰€ä»¥å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒä¸­å®‰è£…è¯¥æ¡†æ¶ã€‚</p><p>å¦‚æœå®‰è£…Xposedåï¼Œå¹¶ä¸”inspeckageå°±æ˜¯é€šè¿‡å¯¹åº”çš„Xposedè½¯ä»¶ä¸‹è½½çš„ï¼Œé‚£ä¹ˆæ£€æŸ¥&quot;æ¨¡å—&quot;ä¸­æ˜¯å¦å°†&quot;inspeckage&quot;å‹¾é€‰ï¼Œç„¶åé‡å¯ã€‚</p><h2 id="æ‰‹æœºç›®å½•"><a class="markdownIt-Anchor" href="#æ‰‹æœºç›®å½•"></a> æ‰‹æœºç›®å½•</h2><p>MTç®¡ç†å™¨èƒ½çœ‹åˆ°</p><ul><li><code>/data/data/</code> ä¸‹æ˜¯æ‰‹æœºç³»ç»Ÿæ–‡ä»¶å’Œä½ å®‰è£…è½¯ä»¶çš„æ•°æ®æ–‡ä»¶ï¼Œä¸å»ºè®®éšä¾¿åˆ é™¤ï¼Œæˆ–é€ æˆæ­»æœºæˆ–å¼€ä¸äº†æœºã€‚éœ€è¦root</li><li><code>/etc/data</code></li></ul><h2 id="åç¼–è¯‘"><a class="markdownIt-Anchor" href="#åç¼–è¯‘"></a> åç¼–è¯‘</h2><blockquote><p>å¦‚æœç¨‹åºè¢«åŠ å›º(åŠ å£³ï¼Œè…¾è®¯ä¹å›ºã€360åŠ å›º)ï¼Œåˆ™éœ€è¦å»å£³ååç¼–è¯‘ï¼Œæ¯”å¦‚è„±å£³å·¥å…·FDex2ï¼Œè„±å£³åå¾—åˆ°å¤šä¸ªdexæ–‡ä»¶ï¼Œå°†å…¶å‹ç¼©æˆå‹ç¼©åŒ…ï¼Œå†ä½¿ç”¨åç¼–è¯‘å¦‚jadxå¯¼å…¥åˆ†æã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å¤´ä¸€æ¬¡æ¥è§¦åˆ°Appå‚æ•°åŠ å¯†çš„ï¼Œå› æ­¤éœ€è¦å¯¹åŠ å¯†å‚æ•°è¿›è¡Œåç¼–è¯‘ï¼Œäº†è§£åˆ°æœ‰å·¥å…·inspeckageå¯ä»¥æ–¹ä¾¿çš„æ¥æ‰¾å¯»åŠ å¯†å‚æ•°ã€‚è€Œå…¶ä½¿ç”¨çš„æ¡ä»¶ä¸º&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹æœºå·²ROOT&lt;/li&gt;
&lt;li&gt;åœ¨Xposedæ¡†æ¶ä¸‹è¿è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯å¼€å§‹åœ¨å¤œç¥æ¨¡æ‹Ÿå™¨ä¸Šæ£
      
    
    </summary>
    
    
      <category term="çˆ¬è™«" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Pythonè½¬ä¹‰å®ç°å‰ç«¯åŠ å¯†ç®—æ³•-è®°å½•ç¬”è®°</title>
    <link href="https://nymrli.top/2022/04/29/%E4%BD%BF%E7%94%A8Python%E8%BD%AC%E4%B9%89%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95-%E8%AE%B0%E5%BD%95%E7%AC%94%E8%AE%B0/"/>
    <id>https://nymrli.top/2022/04/29/ä½¿ç”¨Pythonè½¬ä¹‰å®ç°å‰ç«¯åŠ å¯†ç®—æ³•-è®°å½•ç¬”è®°/</id>
    <published>2022-04-29T01:22:28.000Z</published>
    <updated>2022-04-29T04:36:04.026Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¯å¢ƒå®‰è£…"><a class="markdownIt-Anchor" href="#ç¯å¢ƒå®‰è£…"></a> ç¯å¢ƒå®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall crypto</span><br><span class="line">pip uninstall pycryptodome</span><br><span class="line">pip install pycryptodome</span><br></pre></td></tr></table></figure><p>å‰é¢ä¸¤ä¸ªå¸è½½å‘½ä»¤æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®‰è£…ç¯å¢ƒé—®é¢˜ï¼Œå…·ä½“è¯·çœ‹<a href="https://blog.csdn.net/chouzhou9701/article/details/106432497/" target="_blank" rel="noopener">æ–‡ç« </a></p><h1 id="pycryptodome"><a class="markdownIt-Anchor" href="#pycryptodome"></a> pycryptodome</h1><h2 id="aesåŠ å¯†"><a class="markdownIt-Anchor" href="#aesåŠ å¯†"></a> AESåŠ å¯†</h2><p><strong>åŠ å¯†æ¨¡å¼</strong></p><p>AES åŠ å¯†æœ€å¸¸ç”¨çš„æ¨¡å¼å°±æ˜¯ ECBæ¨¡å¼ å’Œ CBC æ¨¡å¼ï¼Œå½“ç„¶è¿˜æœ‰å¾ˆå¤šå…¶å®ƒæ¨¡å¼ï¼Œä»–ä»¬éƒ½å±äºAESåŠ å¯†ã€‚ECBæ¨¡å¼å’ŒCBC æ¨¡å¼ä¿©è€…åŒºåˆ«å°±æ˜¯ ECB ä¸éœ€è¦ ivåç§»é‡ï¼Œè€ŒCBCéœ€è¦ã€‚</p><p><strong>AESåŠ å¯†ä½¿ç”¨å‚æ•°</strong></p><p>ä»¥ä¸‹å‚æ•°éƒ½æ˜¯åœ¨pythonä¸­ä½¿ç”¨çš„ã€‚</p><p>å‚æ•°ä½œç”¨åŠæ•°æ®ç±»å‹<br>ç§˜é’¥åŠ å¯†çš„æ—¶å€™ç”¨ç§˜é’¥ï¼Œè§£å¯†çš„æ—¶å€™éœ€è¦åŒæ ·çš„ç§˜é’¥æ‰èƒ½è§£å‡ºæ¥; æ•°æ®ç±»å‹ä¸ºbytes<br>æ˜æ–‡éœ€è¦åŠ å¯†çš„å‚æ•°; æ•°æ®ç±»å‹ä¸ºbytes<br>æ¨¡å¼aes åŠ å¯†å¸¸ç”¨çš„æœ‰ ECB å’Œ CBC æ¨¡å¼ï¼ˆæˆ‘åªç”¨äº†è¿™ä¸¤ä¸ªæ¨¡å¼ï¼Œè¿˜æœ‰å…¶ä»–æ¨¡å¼ï¼‰;æ•°æ®ç±»å‹ä¸ºaesç±»å†…éƒ¨çš„æšä¸¾é‡<br>iv åç§»é‡è¿™ä¸ªå‚æ•°åœ¨ ECB æ¨¡å¼ä¸‹ä¸éœ€è¦ï¼Œåœ¨ CBC æ¨¡å¼ä¸‹éœ€è¦ï¼›æ•°æ®ç±»å‹ä¸ºbytes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ECBæ¨¡å¼åŠ å¯†è§£å¯†</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">password = <span class="string">b'1234567812345678'</span> <span class="comment">#ç§˜é’¥ï¼Œbå°±æ˜¯è¡¨ç¤ºä¸ºbytesç±»å‹</span></span><br><span class="line">text = <span class="string">b'abcdefghijklmnhi'</span> <span class="comment">#éœ€è¦åŠ å¯†çš„å†…å®¹ï¼Œbytesç±»å‹</span></span><br><span class="line">aes = AES.new(password,AES.MODE_ECB) <span class="comment">#åˆ›å»ºä¸€ä¸ªaeså¯¹è±¡</span></span><br><span class="line"><span class="comment"># AES.MODE_ECB è¡¨ç¤ºæ¨¡å¼æ˜¯ECBæ¨¡å¼</span></span><br><span class="line">en_text = aes.encrypt(text) <span class="comment">#åŠ å¯†æ˜æ–‡</span></span><br><span class="line">print(<span class="string">"å¯†æ–‡ï¼š"</span>,en_text) <span class="comment">#åŠ å¯†æ˜æ–‡ï¼Œbytesç±»å‹</span></span><br><span class="line"></span><br><span class="line">den_text = aes.decrypt(en_text) <span class="comment"># è§£å¯†å¯†æ–‡</span></span><br><span class="line">print(<span class="string">"æ˜æ–‡ï¼š"</span>,den_text)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯é’ˆå¯¹ECBæ¨¡å¼çš„åŠ å¯†è§£å¯†ï¼Œä»è¿™ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºå‚æ•°ä¸­æœ‰å‡ ä¸ªé™åˆ¶ã€‚</p><ol><li>ç§˜é’¥å¿…é¡»ä¸º16å­—èŠ‚æˆ–è€…16å­—èŠ‚çš„å€æ•°çš„å­—èŠ‚å‹æ•°æ®ã€‚</li><li>æ˜æ–‡å¿…é¡»ä¸º16å­—èŠ‚æˆ–è€…16å­—èŠ‚çš„å€æ•°çš„å­—èŠ‚å‹æ•°æ®ï¼Œå¦‚æœä¸å¤Ÿ16å­—èŠ‚éœ€è¦è¿›è¡Œè¡¥å…¨ï¼Œå…³äºè¡¥å…¨è§„åˆ™ï¼Œåé¢ä¼šåœ¨è¡¥å…¨æ¨¡å¼ä¸­å…·ä½“ä»‹ç»ã€‚</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CBC</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">password = <span class="string">b'1234567812345678'</span> <span class="comment">#ç§˜é’¥ï¼Œbå°±æ˜¯è¡¨ç¤ºä¸ºbytesç±»å‹</span></span><br><span class="line">iv = <span class="string">b'1234567812345678'</span> <span class="comment"># ivåç§»é‡ï¼Œbytesç±»å‹</span></span><br><span class="line">text = <span class="string">b'abcdefghijklmnhi'</span> <span class="comment">#éœ€è¦åŠ å¯†çš„å†…å®¹ï¼Œbytesç±»å‹</span></span><br><span class="line">aes = AES.new(password,AES.MODE_CBC,iv) <span class="comment">#åˆ›å»ºä¸€ä¸ªaeså¯¹è±¡</span></span><br><span class="line"><span class="comment"># AES.MODE_CBC è¡¨ç¤ºæ¨¡å¼æ˜¯CBCæ¨¡å¼</span></span><br><span class="line">en_text = aes.encrypt(text) </span><br><span class="line">print(<span class="string">"å¯†æ–‡ï¼š"</span>,en_text) <span class="comment">#åŠ å¯†æ˜æ–‡ï¼Œbytesç±»å‹</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(password,AES.MODE_CBC,iv) <span class="comment">#CBCæ¨¡å¼ä¸‹è§£å¯†éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ªaeså¯¹è±¡</span></span><br><span class="line">den_text = aes.decrypt(en_text)</span><br><span class="line">print(<span class="string">"æ˜æ–‡ï¼š"</span>,den_text)</span><br></pre></td></tr></table></figure><h1 id="hashlib"><a class="markdownIt-Anchor" href="#hashlib"></a> hashlib</h1><h2 id="md5"><a class="markdownIt-Anchor" href="#md5"></a> MD5</h2><blockquote><p>hashlibæ¨¡å—ä¸‹çš„&quot;åŠ å¯†&quot;</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">string=<span class="string">'ä»»æ€§çš„90åboy'</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(string.encode(<span class="string">'utf-8'</span>))<span class="comment">#è½¬ç ï¼Œupdateé‡Œçš„å¿…é¡»æ˜¯å­—èŠ‚å‹</span></span><br><span class="line"><span class="comment"># é»˜è®¤æ˜¯32ä½å°å†™</span></span><br><span class="line">res = md5.hexdigest() <span class="comment">#è¿”å›å­—ç¬¦å‹æ‘˜è¦ä¿¡æ¯print(md5.digest())#è¿”å›å­—èŠ‚å‹çš„æ‘˜è¦ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°16ä½å¤§å†™</span></span><br><span class="line"><span class="comment"># res=md5.hexdigest()[8:-8]</span></span><br><span class="line">print(<span class="string">"md5åŠ å¯†ç»“æœ:"</span>,res)</span><br></pre></td></tr></table></figure><h2 id="sha256"><a class="markdownIt-Anchor" href="#sha256"></a> Sha256</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">string=<span class="string">'ä»»æ€§çš„90åboy'</span></span><br><span class="line">sha256 = hashlib.sha256()</span><br><span class="line">sha256.update(string.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">res = sha256.hexdigest()</span><br><span class="line">print(<span class="string">"sha256åŠ å¯†ç»“æœ:"</span>,res)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç¯å¢ƒå®‰è£…&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç¯å¢ƒå®‰è£…&quot;&gt;&lt;/a&gt; ç¯å¢ƒå®‰è£…&lt;/h2&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s
      
    
    </summary>
    
    
      <category term="çˆ¬è™«" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>æ€»å¾—å­¦ç‚¹Elasticsearchå§</title>
    <link href="https://nymrli.top/2022/04/11/%E6%80%BB%E5%BE%97%E5%AD%A6%E7%82%B9Elasticsearch%E5%90%A7/"/>
    <id>https://nymrli.top/2022/04/11/æ€»å¾—å­¦ç‚¹Elasticsearchå§/</id>
    <published>2022-04-11T14:18:04.000Z</published>
    <updated>2022-04-12T14:29:28.958Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å€’æ’ç´¢å¼•"><a class="markdownIt-Anchor" href="#å€’æ’ç´¢å¼•"></a> å€’æ’ç´¢å¼•</h2><p>åå‘ç´¢å¼•ï¼ˆinverted indexï¼‰æ›´ç†Ÿæ‚‰çš„åå­—æ˜¯å€’æ’ç´¢å¼•ã€‚</p><p>ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•: å€’æ’ç´¢å¼•ä¹Ÿå«åå‘ç´¢å¼•ï¼Œé€šä¿—æ¥è®²æ­£å‘ç´¢å¼•æ˜¯é€šè¿‡keyæ‰¾valueï¼Œåå‘ç´¢å¼•åˆ™æ˜¯é€šè¿‡valueæ‰¾keyã€‚</p><p>ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ï¼šæˆ‘ä»¬ä¸€èˆ¬æ˜¯é€šè¿‡<strong>æ ‡é¢˜</strong>æ¥æ‰¾<strong>æ–‡ç« å†…å®¹</strong>ï¼Œå³é€šè¿‡ç›®å½•ï¼ˆæ­£å‘ç´¢å¼•ï¼‰ï¼›è€Œåå‘ç´¢å¼•çš„è¿ç”¨åœºæ™¯å°±æ˜¯é€šè¿‡<strong>å†…å®¹</strong>æ¥æ‰¾åˆ°æ˜¯<strong>å“ªä¸€ç¯‡æ–‡ç« </strong>ï¼ˆæ ‡é¢˜ï¼Œä½œè€…â€¦â€¦ï¼‰ï¼Œè€Œæ€ä¹ˆå»ºç«‹åå‘ç´¢å¼•å‘¢ï¼Ÿæ€ä¹ˆæ›´å¿«æ›´å¥½åœ°æ‰¾åˆ°ç»“æœå‘¢ï¼Ÿè¿™ä¸ªå°±æ˜¯<strong>æœç´¢å¼•æ“</strong>åšçš„äº‹äº†ã€</p><p>æ­£å‘ç´¢å¼•ï¼šä¾‹å¦‚ä¸€ä¸ªâ€œæ–‡æ¡£1â€ç»è¿‡åˆ†è¯ï¼Œæå–äº†20ä¸ªå…³é”®è¯ï¼Œæ¯ä¸ªå…³é”®è¯éƒ½ä¼šè®°å½•å®ƒåœ¨æ–‡æ¡£ä¸­çš„å‡ºç°æ¬¡æ•°å’Œå‡ºç°ä½ç½®ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡å¯¹&quot;æ–‡æ¡£1&quot;Documentè¿™ä¸ªç»“æ„è¿›è¡Œè§£æï¼Œä»è€Œå¾—åˆ°æ¯ä¸ªå…³é”®è¯çš„ä¿¡æ¯ã€‚</p><p>åå‘ç´¢å¼•ï¼šé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›é€šè¿‡å…³é”®è¯æ¥æ‰¾åˆ°å®ƒåœ¨å“ªå‡ ç¯‡â€œæ–‡æ¡£â€ä¸­å‡ºç°æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£ä¹ˆå…¶å®åœ¨éå†æ–‡ç« çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰æ–‡ç« å‡ºç°äº†keywordï¼Œåˆ™å¯¹Keywordçš„ç»“æ„ï¼ˆç®€å•ç‚¹å¯ä»¥æƒ³æˆæ˜¯ä¸€ä¸ªhashmapï¼‰æ·»åŠ ä¸Šè¿™ç¯‡æ–‡ç« çš„ä¿¡æ¯</p><p>å†ä¸¾ä¸ªç”Ÿæ´»ä¾‹å­ï¼š å½“ç”¨æˆ·åœ¨ä¸»é¡µä¸Šæœç´¢å…³é”®è¯â€œ<u>åä¸ºæ‰‹æœº</u>â€æ—¶ï¼Œå‡è®¾åªå­˜åœ¨æ­£å‘ç´¢å¼•ï¼ˆforward indexï¼‰ï¼Œé‚£ä¹ˆå°±éœ€è¦<strong>å®æ—¶æ‰«æå®Œç´¢å¼•åº“ä¸­çš„æ‰€æœ‰æ–‡æ¡£</strong>ï¼Œæ‰¾å‡ºæ‰€æœ‰åŒ…å«å…³é”®è¯â€œåä¸ºæ‰‹æœºâ€çš„æ–‡æ¡£ï¼Œå†æ ¹æ®æ‰“åˆ†æ¨¡å‹è¿›è¡Œæ‰“åˆ†ï¼Œæ’å‡ºåæ¬¡åå‘ˆç°ç»™ç”¨æˆ·ã€‚å› ä¸ºäº’è”ç½‘ä¸Šæ”¶å½•åœ¨æœç´¢å¼•æ“ä¸­çš„æ–‡æ¡£çš„æ•°ç›®æ˜¯ä¸ªå¤©æ–‡æ•°å­—ï¼Œè¿™æ ·çš„ç´¢å¼•ç»“æ„æ ¹æœ¬æ— æ³•æ»¡è¶³<strong>å®æ—¶</strong>è¿”å›æ’åç»“æœçš„è¦æ±‚ã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>æœç´¢å¼•æ“</strong>ä¼šå°†æ­£å‘ç´¢å¼•<strong>é‡æ–°æ„å»º</strong>ä¸ºå€’æ’ç´¢å¼•ï¼Œå³æŠŠ<strong>æ–‡ä»¶ID</strong>å¯¹åº”åˆ°<strong>å…³é”®è¯</strong>çš„æ˜ å°„è½¬æ¢ä¸º<strong>å…³é”®è¯åˆ°æ–‡ä»¶IDçš„æ˜ å°„</strong>ï¼Œæ¯ä¸ªå…³é”®è¯éƒ½å¯¹åº”ç€ä¸€ç³»åˆ—çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¸­éƒ½å‡ºç°è¿™ä¸ªå…³é”®è¯ã€‚ä»è€Œå¤§å¤§å‡å°‘äº†éå†çš„å¤§å°ï¼ŒåŠ å¿«äº†æ£€ç´¢çš„é€Ÿåº¦ã€‚</p><p><strong>æœ¬è´¨ä¸Šæ˜¯é€šè¿‡è®¾è®¡æ•°æ®ç»“æ„ï¼Œå¹¶èŠ±äº†é¢å¤–çš„ç©ºé—´å»æ¢æ£€ç´¢æ—¶çš„æ—¶é—´ã€‚</strong></p><p>è®ºæ–‡æŸ¥é‡å°±æ˜¯è¿™ç§çš„å…¸å‹åº”ç”¨ï¼š<a href="https://www.bilibili.com/video/BV1iK4y1M7XR?spm_id_from=444.41.0.0" target="_blank" rel="noopener">Bç«™è§†é¢‘â€”â€”è®ºæ–‡æŸ¥é‡æ˜¯å¦‚ä½•å®ç°çš„</a>â€”â€”å°†æ®µè½é€šè¿‡æ ‡ç‚¹ç¬¦å·åˆ†éš”æˆä¸€ä¸ªä¸ªå¥å­ï¼Œå†å°†å¥å­æ¯æ¯7ä¸ªåˆ†éš”æˆä¸€ä¸ªä¸ªsectionï¼Œæ¯”å¦‚é•¿åº¦ä¸º9çš„å¥å­åˆ™å¯ä»¥åˆ†æˆ3ä¸ªsectionï¼Œé¢„å¤„ç†åˆ›å»º<code>preDict={&quot;section1&quot;: [doc1, ], &quot;section2&quot;: [doc1, ], &quot;section&quot;3: [doc1, ]}</code>çš„å€’æ’ç´¢å¼•ï¼Œå½“è¿›è¡ŒæŸ¥é‡æ—¶ï¼Œä¹Ÿæ˜¯åˆ†éš”æˆå¥å­åæ¯æ¯7ä¸ªå­—è¿›è¡Œæ£€æŸ¥æ˜¯å¦åœ¨preDictä¸­ï¼Œå¦‚æœåœ¨åˆ™æ˜¯çŸ¥é“äº†åœ¨å“ªäº›æ–‡ç« ä¸­å‡ºç°ï¼ˆæœ€ç®€å•ç‰ˆï¼‰ã€‚è§†é¢‘ååˆæå‡ºäº†å¢åŠ LCSæœ€é•¿å…¬å…±å­ä¸²çš„å¢å¼ºï¼Œæœ‰æ•ˆåœ°æ£€éªŒå‡ºäº†æ·»åŠ â€œçš„â€å­—orè°ƒæ•´å­—ä½ç½®çš„å·é¸¡æ–¹æ³•â€”â€”å»ºç«‹4å­—å€’æ’ï¼Œå¦‚æœ4ä¸ªå­—å·²ç»å‡ºç°åœ¨äº†åˆ«çš„æ–‡ç« Aé‡Œï¼Œåˆ™æŠŠå½“å‰å¥å­S1ä¸æ–‡ç« Aä¸­çš„å¥å­S2è¿›è¡ŒLCSï¼Œå¦‚æœå…¬å…±å­ä¸²é•¿åº¦å¤§äº7åˆ™åˆ¤å®šä¸ºé‡å¤ã€‚</p><h2 id="æœç´¢å¼•æ“elasticsearch"><a class="markdownIt-Anchor" href="#æœç´¢å¼•æ“elasticsearch"></a> æœç´¢å¼•æ“â€”â€”Elasticsearch</h2><p>Elastic Stack å¦‚æœä½ æ²¡æœ‰å¬è¿‡ï¼Œé‚£ä¹ˆ ELK ä¸€å®šå¬è¿‡ã€‚ELK æ˜¯ä¸‰æ¬¾è½¯ä»¶çš„ç®€ç§°ï¼Œåˆ†åˆ«æ˜¯ <code>Elasticsearch</code>ã€<code>Logstash</code>ã€<code>Kibana</code> ç»„æˆã€‚é‚£ä»€ä¹ˆæ˜¯ Elasticsearchå‘¢ï¼Ÿâ€”â€”å…¨æ–‡æœç´¢æ˜¯å¾ˆå¤šç½‘ç«™å¸¸è§åŠŸèƒ½ï¼Œæ¯”å¦‚ GitHub ç«™å†…æœç´¢ã€JD å•†å“æœç´¢ã€B ç«™è§†é¢‘æœç´¢ã€‚<code>Elasticsearch</code> æ˜¯å½“ä»Šæœ€ç«çš„<strong>æœç´¢å¼•æ“</strong>ä¹‹ä¸€ï¼Œå®ƒçš„åº•å±‚åŸºäºå¦å¤–ä¸€ä¸ª <code>java</code> å¼€æºæœç´¢å¼•æ“ <code>Lucene</code>ï¼Œæ˜¯ä¸€æ¬¾å¼€æºåˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ç³»åˆ— <code>REST API</code> æ“ä½œæ¥å£ã€‚</p><h2 id="esçš„æ ¸å¿ƒæ¦‚å¿µ"><a class="markdownIt-Anchor" href="#esçš„æ ¸å¿ƒæ¦‚å¿µ"></a> ESçš„æ ¸å¿ƒæ¦‚å¿µ</h2><ol><li>ç´¢å¼•ï¼ˆIndexï¼‰ï¼šESå°†æ•°æ®å­˜å‚¨äºä¸€ä¸ªæˆ–å¤šä¸ªç´¢å¼•ä¸­ã€‚ç±»æ¯”ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é¢†åŸŸæ¥è¯´ï¼Œç´¢å¼•ç›¸å½“äºSQLä¸­çš„ä¸€ä¸ªæ•°æ®åº“ï¼Œæˆ–è€…ä¸€ä¸ªæ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼ˆschemaï¼‰ã€‚ç´¢å¼•ç”±å…¶åç§°ï¼ˆå¿…é¡»ä¸ºå…¨å°å†™å­—ç¬¦ï¼‰è¿›è¡Œæ ‡è¯†ã€‚ä¸€ä¸ªESé›†ç¾¤ä¸­å¯ä»¥æŒ‰éœ€åˆ›å»ºä»»æ„æ•°ç›®çš„ç´¢å¼•ã€‚</li><li>ç±»å‹ï¼ˆtypeï¼‰ï¼šç±»å‹æ˜¯ç´¢å¼•å†…éƒ¨çš„é€»è¾‘åˆ†åŒºï¼ˆcategory/partitionï¼‰ï¼Œä¸€ä¸ªç´¢å¼•å†…éƒ¨å¯å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ï¼ˆtypeï¼‰ã€‚ç±»æ¯”ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é¢†åŸŸæ¥è¯´ï¼Œç±»å‹ç›¸å½“äºâ€œè¡¨â€ã€‚</li><li>æ–‡æ¡£ï¼ˆDocumentï¼‰ï¼šæ–‡æ¡£æ˜¯ç´¢å¼•å’Œæœç´¢çš„åŸå­å•ä½ï¼Œå®ƒæ˜¯åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªåŸŸï¼ˆFildï¼‰çš„å®¹å™¨ï¼Œæ¯ä¸ªåŸŸæ‹¥æœ‰ä¸€ä¸ªåå­—åŠä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œæœ‰å¤šä¸ªå€¼çš„åŸŸé€šå¸¸ç§°ä¸ºâ€œå¤šå€¼åŸŸâ€ï¼Œæ–‡æ¡£åŸºäºJSONæ ¼å¼è¿›è¡Œè¡¨ç¤ºã€‚æ¯ä¸ªæ–‡æ¡£å¯ä»¥å­˜å‚¨ä¸åŒçš„åŸŸé›†ï¼Œä½†åŒä¸€ç±»å‹ä¸‹çš„æ–‡æ¡£è‡³åº”è¯¥æœ‰æŸç§ç¨‹åº¦ä¸Šçš„ç›¸ä¼¼ä¹‹å¤„ã€‚</li><li>é›†ç¾¤ï¼ˆClusterï¼‰ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªæ‹¥æœ‰ç›¸åŒclusterâ€¦nameé…ç½®çš„èŠ‚ç‚¹ç»„æˆï¼Œå®ƒä»¬å…±åŒæ‰¿æ‹…æ•°æ®å’Œè´Ÿè½½çš„å‹åŠ›ã€‚</li><li>èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼šä¸€ä¸ªè¿è¡Œä¸­çš„Elasticsearchå®ä¾‹ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹ã€‚<br>ESé›†ç¾¤ä¸­çš„èŠ‚ç‚¹æœ‰ä¸‰ç§ä¸åŒçš„ç±»å‹ï¼š<ul><li>ä¸»èŠ‚ç‚¹ï¼šè´Ÿè´£ç®¡ç†é›†ç¾¤èŒƒå›´å†…çš„æ‰€æœ‰å˜æ›´ï¼Œä¾‹å¦‚å¢åŠ ã€åˆ é™¤ç´¢å¼•ï¼Œæˆ–è€…å¢åŠ ã€åˆ é™¤èŠ‚ç‚¹ç­‰ã€‚ä¸»èŠ‚ç‚¹å¹¶ä¸éœ€è¦æ¶‰åŠåˆ°æ–‡æ¡£çº§åˆ«çš„å˜æ›´å’Œæœç´¢ç­‰æ“ä½œã€‚å¯ä»¥é€šè¿‡å±æ€§node.masteriè¿›è¡Œè®¾ç½®ã€‚</li><li>æ•°æ®èŠ‚ç‚¹ï¼šå­˜å‚¨æ•°æ®å’Œå…¶å¯¹åº”çš„å€’æ’ç´¢å¼•ã€‚é»˜è®¤æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯æ•°æ®èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬ä¸»èŠ‚ç‚¹ï¼‰ï¼Œå¯ä»¥é€šè¿‡ode.dataå±æ€§è¿›è¡Œè®¾ç½®ã€‚</li><li>åè°ƒèŠ‚ç‚¹ï¼šå¦‚æœnode.masterå’Œnode.dataå±æ€§å‡ä¸ºfalseï¼Œåˆ™æ­¤èŠ‚ç‚¹ç§°ä¸ºåè°ƒèŠ‚ç‚¹ï¼Œç”¨æ¥å“åº”å®¢æˆ·è¯·æ±‚ï¼Œå‡è¡¡æ¯ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½ã€‚</li></ul></li></ol><h2 id="pythonæ“ä½œelasticsearch"><a class="markdownIt-Anchor" href="#pythonæ“ä½œelasticsearch"></a> Pythonæ“ä½œElasticsearch</h2><p>å®‰è£…esåº“<code>pip install Elasticsearch</code></p><p>å‚è€ƒï¼š</p><ul><li><a href="https://www.bilibili.com/video/BV1CJ411L7uV?from=search&amp;seid=16833887069453710612&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener"><em>python</em>æ“ä½œ<em>ElasticSearch</em>-åˆ›å»ºã€æ’å…¥ã€æ£€ç´¢</a></li><li><a href="https://www.bilibili.com/video/BV1Nk4y1R7Hf?p=5&amp;spm_id_from=pageDriver" target="_blank" rel="noopener">ã€ç‹‚ç¥è¯´Javaã€‘ElasticSearchæœç´¢å®æˆ˜ä»¿äº¬ä¸œæœç´¢</a>â€”â€”Javaæ“ä½œES+ä»¿äº¬ä¸œæœç´¢+vueä¸thymeleftå•é¡µé¢å®ç°å‰ç«¯</li></ul><h1 id="é™„å½•"><a class="markdownIt-Anchor" href="#é™„å½•"></a> é™„å½•</h1><h2 id="docker-è¿è¡Œ-elasticsearch"><a class="markdownIt-Anchor" href="#docker-è¿è¡Œ-elasticsearch"></a> docker è¿è¡Œ Elasticsearch</h2><blockquote><p>æ ¹æ®å®˜ç½‘æ¨èï¼ŒESé…å¥— Kibana åªèƒ½å®‰è£… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.elastic.co%2Fguide%2Fen%2Fkibana%2F6.8%2Fdocker.html" target="_blank" rel="noopener">6.8.19</a>ï¼Œ æ‰€ä»¥å®‰è£…</p></blockquote><ol><li><p>æ‹‰å–é•œåƒ:<code>docker pull docker.io/elasticsearch:7.17.2</code>ï¼Œæ‹‰å–å…¶ä»–ç‰ˆæœ¬å¯è§<a href="#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E7%89%88%E6%9C%AC%EF%BC%9Adocker-search-tag">æŸ¥çœ‹é•œåƒç‰ˆæœ¬ï¼šdocker-search-tag</a></p></li><li><p>esé…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/apollo3d/cl/dockerdata/elasticsearch/config </span><br><span class="line">mkdir -p /home/apollo3d/cl/dockerdata/elasticsearch/data</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"http.host: 0.0.0.0"</span> &gt;&gt; /home/apollo3d/cl/dockerdata/elasticsearch/config/elasticsearch.yml</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨å®¹å™¨:<code>docker run --name es -p 9200:9200 -p 9300:9300 \ -e &quot;discovery.type=single-node&quot; \ -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; \ -v /home/apollo3d/dockerdata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml \ -v /home/apollo3d/dockerdata/elasticsearch/data:/usr/share/elasticsearch/data \ -v /home/apollo3d/dockerdata/elasticsearch/plugins:/usr/share/elasticsearch/plugins \ -d docker.io/elasticsearch:7.17.2</code>ï¼Œæ³¨ï¼š<code>&lt;image_id&gt;</code>å¯ä»¥é€šè¿‡<code>docker images</code>æŸ¥çœ‹åˆšåˆšpullä¸‹æ¥çš„é•œåƒï¼›éœ€è¦å»ESCä¸Šæ‰“å¼€é˜²ç«å¢™çš„æŒ‡å®šç«¯å£ï¼›</p></li><li><p>æµ‹è¯•ï¼šæµè§ˆå™¨è®¿é—® Elasticsearch åœ°å€ï¼š<code>ECS_IP:9200</code>ï¼Œ å¦‚æœè¿”å›JSONæ•°æ®åˆ™<strong>å¯åŠ¨æ­£ç¡®</strong></p></li><li><p>å®‰è£… ik åˆ†è¯å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥eså®¹å™¨</span></span><br><span class="line">$ docker <span class="built_in">exec</span> -it es bash</span><br><span class="line"><span class="comment"># ä¸‹è½½ikåˆ†è¯å™¨</span></span><br><span class="line">$ ./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.1.1/elasticsearch-analysis-ik-7.1.1.zip</span><br><span class="line"><span class="comment"># é€€å‡ºå®¹å™¨</span></span><br><span class="line">$ <span class="built_in">exit</span></span><br></pre></td></tr></table></figure></li><li><p>å®‰è£… ik åˆ†è¯å™¨åé‡å¯ Elasticsearchï¼š<code>docker restart es</code></p></li><li><p>postman æµ‹è¯• ik åˆ†è¯å™¨ï¼ˆæ³¨æ„ï¼šæŠŠ Content-Type è®¾ç½®ä¸º application/json ï¼‰</p></li></ol><h2 id="å¯åŠ¨-es-head-å¯è§†åŒ–ç•Œé¢"><a class="markdownIt-Anchor" href="#å¯åŠ¨-es-head-å¯è§†åŒ–ç•Œé¢"></a> å¯åŠ¨ es-head (å¯è§†åŒ–ç•Œé¢):</h2><blockquote><p>Elasticsearch 5.xåä¸æ”¯æŒæ’ä»¶ï¼Œheadä½œä¸ºå•ç‹¬æœåŠ¡ç‹¬ç«‹è¿è¡Œã€‚</p></blockquote><ol><li><p>æ‹‰å–é•œåƒï¼š<code>docker pull mobz/elasticsearch-head:5</code></p></li><li><p>å¯åŠ¨å®¹å™¨ï¼š<code>docker run -d -p 9100:9100 --name esh elasticsearch-head</code></p></li><li><p>è®¿é—® es-headï¼š<code>ECS_IP:9100</code></p><p>å½“ä½ è¾“å…¥ <a href="https://link.zhihu.com/?target=http%3A//192.168.232.128%3A9200/" target="_blank" rel="noopener">http://192.168.232.128:9200/</a> ç‚¹å‡»è¿æ¥æ—¶ï¼Œä¼šå‘ç°æ— æ³•è¿æ¥ã€‚æ˜¯å› ä¸ºå‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œéœ€è¦åœ¨æœåŠ¡ç«¯åš CORS çš„é…ç½®ã€‚æˆ‘ä»¬å†æ¬¡è¿›å…¥ Elasticsearch å®¹å™¨å†…éƒ¨ï¼Œä¿®æ”¹ <code>elasticsearch.yml</code> é…ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨</span></span><br><span class="line">$ docker <span class="built_in">exec</span> -it es /bin/bash</span><br><span class="line">[root@7f213e9fb6bb elasticsearch]<span class="comment"># vi config/elasticsearch.yml</span></span><br><span class="line"><span class="comment"># æ·»åŠ å¦‚ä¸‹ä¸¤æ¡é…ç½®ï¼Œæ³¨æ„å†’å·åé¢æœ‰ç©ºæ ¼ï¼Œä¿å­˜å¹¶é€€å‡ºã€‚</span></span><br><span class="line">http.cors.enabled: <span class="literal">true</span> </span><br><span class="line">http.cors.allow-origin: <span class="string">"*"</span></span><br></pre></td></tr></table></figure></li><li><p>æœ€åé€€å‡ºå®¹å™¨ï¼Œå¹¶é‡å¯ Elasticsearch: <code>docker restart esh</code></p></li><li><p>å†æ¬¡è®¿é—® es-headï¼Œå°±èƒ½çœ‹åˆ°å¯è§†åŒ–çš„ç•Œé¢äº†ã€‚</p></li></ol><h2 id="å¯åŠ¨-kibanaå¯è§†åŒ–ç•Œé¢"><a class="markdownIt-Anchor" href="#å¯åŠ¨-kibanaå¯è§†åŒ–ç•Œé¢"></a> â˜…å¯åŠ¨ kibanaï¼ˆå¯è§†åŒ–ç•Œé¢ï¼‰</h2><blockquote><p>Kibana æ˜¯ä¸º <a href="https://so.csdn.net/so/search?q=Elasticsearch&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">Elasticsearch</a>è®¾è®¡çš„å¼€æºåˆ†æå’Œå¯è§†åŒ–å¹³å°ã€‚å¯ä»¥ä½¿ç”¨ Kibana æ¥æœç´¢ï¼ŒæŸ¥çœ‹å­˜å‚¨åœ¨ Elasticsearch ç´¢å¼•ä¸­çš„æ•°æ®å¹¶ä¸ä¹‹äº¤äº’ã€‚ä½ å¯ä»¥å¾ˆå®¹æ˜“å®ç°é«˜çº§çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–ï¼Œå¹¶ä¸”ä»¥<u>å›¾è¡¨çš„å½¢å¼</u>å±•ç°å‡ºæ¥ã€‚</p><p>æ˜¯ELKæŠ€æœ¯æ ˆä¸­çš„Kï¼Œä¹Ÿæ˜¯ESæ¯”è¾ƒä¸»æµçš„å¯è§†åŒ–ç•Œé¢ï¼Œä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„</p><p>Elasticsearch 5.xåä¸æ”¯æŒæ’ä»¶ï¼Œè·ŸElasticsearch  headä¸€æ ·ï¼Œkibanaéœ€è¦ä½œä¸ºå•ç‹¬æœåŠ¡ç‹¬ç«‹è¿è¡Œã€‚</p></blockquote><ol><li><p>æ‹‰å–é•œåƒï¼š<code>docker pull docker.io/kibana:7.17.2</code></p></li><li><p>é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/dockerdata/elk7/kibana/config/</span><br><span class="line">vi ~/dockerdata/elk7/kibana/config/kibana.yml</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ** THIS IS AN AUTO-GENERATED FILE **</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Default Kibana configuration for docker target</span></span><br><span class="line"></span><br><span class="line">server.name: kibana</span><br><span class="line">server.host: <span class="string">"0"</span> <span class="comment"># å¯¹å¤–è®¿é—®kibanaçš„åœ°å€</span></span><br><span class="line">elasticsearch.hosts: [ <span class="string">"http://127.0.0.1:9200"</span> ]<span class="comment"># elasticsearchçš„åœ°å€</span></span><br><span class="line">xpack.monitoring.ui.container.elasticsearch.enabled: <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨å®¹å™¨: <code>docker run -d --name=kibana --restart=always -p 5601:5601 -v ~/dockerdata/elk7/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml kibana:7.17.2</code></p></li><li><p>æŸ¥çœ‹æ—¥å¿—: <code>docker logs -f kibana</code></p></li><li><p>ç­‰å¾…30ç§’ï¼Œå¦‚æœå‡ºç°ä»¥ä¸‹ä¿¡æ¯ï¼Œè¯´æ˜å¯åŠ¨æˆåŠŸäº†ï¼š<code>{&quot;type&quot;:&quot;log&quot;,&quot;@timestamp&quot;:&quot;2020-08-27T03:00:28Z&quot;,&quot;tags&quot;:[&quot;listening&quot;,&quot;info&quot;],&quot;pid&quot;:6,&quot;message&quot;:&quot;Server running at http://0:5601&quot;}</code></p></li><li><p>è®¿é—®é¡µé¢ï¼š<code>ECS_IP:5601</code>å°±å¯ä»¥çœ‹åˆ°Welcome to Kibanaå•¦~</p></li></ol><p>Kibana server is not ready yeté—®é¢˜ï¼š</p><ul><li><a href="https://blog.csdn.net/fbvukn/article/details/107289027?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=2" target="_blank" rel="noopener">kibanaè§£å†³Kibana server is not ready yeté—®é¢˜</a></li><li><a href="https://blog.csdn.net/whatday/article/details/107879989" target="_blank" rel="noopener">kibana æŠ¥é”™ server is not ready yet å¯èƒ½çš„åŸå› </a></li></ul><h2 id="docker-compose"><a class="markdownIt-Anchor" href="#docker-compose"></a> docker-compose:</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'3'</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">    elasticsearch:</span></span><br><span class="line"><span class="attr">        image:</span> <span class="string">docker.io/elasticsearch:7.17.2</span></span><br><span class="line"><span class="attr">        container_name:</span> <span class="string">es2</span></span><br><span class="line"><span class="attr">        environment:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">discovery.type=single-node</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="bullet">           -</span> <span class="string">"9200:9200"</span></span><br><span class="line"><span class="bullet">           -</span> <span class="string">"9300:9300"</span></span><br><span class="line"><span class="attr">    kinaba:</span></span><br><span class="line"><span class="attr">        image:</span> <span class="string">docker.io/kibana:7.17.2</span></span><br><span class="line"><span class="attr">        container_name:</span> <span class="string">kibana2</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">"5601:5601"</span></span><br><span class="line"><span class="attr">        volumes:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">/home/apollo3d/cl/dockerdata/elk7/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml</span></span><br><span class="line"><span class="attr">        depends_on:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">elasticsearch</span></span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹é•œåƒç‰ˆæœ¬docker-search-tag"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹é•œåƒç‰ˆæœ¬docker-search-tag"></a> æŸ¥çœ‹é•œåƒç‰ˆæœ¬ï¼šdocker-search-tag</h2><p><a href="http://xn--docker-show-repo-tag-2x06a431biq1j2e4clo2cqoe.sh" target="_blank" rel="noopener">ä½¿ç”¨è‡ªåˆ¶è„šæœ¬docker-show-repo-tag.sh</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Simple script that will display docker repository tags.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment">#   $ docker-show-repo-tags.sh ubuntu centos</span></span><br><span class="line"><span class="keyword">for</span> Repo <span class="keyword">in</span> $* ; <span class="keyword">do</span></span><br><span class="line">  curl -s -S <span class="string">"https://registry.hub.docker.com/v2/repositories/library/<span class="variable">$Repo</span>/tags/"</span> | \</span><br><span class="line">    sed -e <span class="string">'s/,/,\n/g'</span> -e <span class="string">'s/\[/\[\n/g'</span> | \</span><br><span class="line">    grep <span class="string">'"name"'</span> | \</span><br><span class="line">    awk -F\<span class="string">" '&#123;print <span class="variable">$4</span>;&#125;' | \</span></span><br><span class="line"><span class="string">    sort -fu | \</span></span><br><span class="line"><span class="string">    sed -e "</span>s/^/<span class="variable">$&#123;Repo&#125;</span>:/<span class="string">"</span></span><br><span class="line"><span class="string">done</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ç»ˆç«¯è¿è¡Œ<code>$ ./docker-show-repo-tags.sh elasticsearch</code>å³å¯è·å¾—ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">elasticsearch:8.0.1</span><br><span class="line">elasticsearch:8.1.0</span><br><span class="line">elasticsearch:8.1.1</span><br><span class="line">elasticsearch:8.1.2</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å€’æ’ç´¢å¼•&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å€’æ’ç´¢å¼•&quot;&gt;&lt;/a&gt; å€’æ’ç´¢å¼•&lt;/h2&gt;
&lt;p&gt;åå‘ç´¢å¼•ï¼ˆinverted indexï¼‰æ›´ç†Ÿæ‚‰çš„åå­—æ˜¯å€’æ’ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•: å€’æ’ç´¢å¼•ä¹Ÿå«åå‘ç´¢å¼•ï¼Œé€šä¿—æ¥è®²æ­£å‘
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç®—æ³•ä¸æ•°æ®ç»“æ„â€”â€”æ»‘åŠ¨çª—å£ã€å°ºå–æ³•</title>
    <link href="https://nymrli.top/2022/04/10/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/"/>
    <id>https://nymrli.top/2022/04/10/ç®—æ³•ä¸æ•°æ®ç»“æ„â€”â€”æ»‘åŠ¨çª—å£/</id>
    <published>2022-04-10T03:14:53.000Z</published>
    <updated>2022-04-11T08:35:58.656Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Sliding window algorithm is used to perform required operation on specific window size of given large buffer or array.æ»‘åŠ¨çª—å£ç®—æ³•æ˜¯åœ¨ç»™å®š<strong>ç‰¹å®šçª—å£å¤§å°</strong>çš„<u>æ•°ç»„æˆ–å­—ç¬¦ä¸²</u>ä¸Šæ‰§è¡Œè¦æ±‚çš„æ“ä½œã€‚</p><p>This technique shows how a nested for loop in few problems can be converted to single for loop and hence reducing the time complexity.è¯¥æŠ€æœ¯å¯ä»¥å°†ä¸€éƒ¨åˆ†é—®é¢˜ä¸­çš„åµŒå¥—å¾ªç¯è½¬å˜ä¸ºä¸€ä¸ªå•å¾ªç¯ï¼Œå› æ­¤å®ƒå¯ä»¥å‡å°‘æ—¶é—´å¤æ‚åº¦ã€‚</p></blockquote><h2 id="åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#åŸºæœ¬æ¦‚å¿µ"></a> åŸºæœ¬æ¦‚å¿µ</h2><p>æ»‘åŠ¨çª—å£æ˜¯ä¸€ç§åŸºäºåŒæŒ‡é’ˆçš„ä¸€ç§æ€æƒ³ï¼Œä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ä¹‹é—´å½¢æˆä¸€ä¸ªçª—å£ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ç§åŒæŒ‡é’ˆæ–¹æ³•çš„ç‰¹ä¾‹ã€‚</p><p>çª—å£çš„åšæ³•åˆ†ä¸ºå®šé•¿çª—å£å’Œä¸å®šé•¿çª—å£ï¼Œæœ‰äº›äººæŠŠæ¶‰åŠçª—å£ç§»åŠ¨çš„éƒ½ç»Ÿç§°ä¸º<strong>æ»‘åŠ¨çª—å£</strong>åšæ³•ã€‚è€Œåœ¨æ­¤ï¼Œæˆ‘ä»¬è¿›è¡Œè¿›ä¸€æ­¥çš„ç»†åˆ†ï¼š</p><ul><li>å®šé•¿æ»‘åŠ¨çª—å£</li><li>å˜é•¿æ»‘åŠ¨çª—å£â€”â€”å°ºå–æ³•</li></ul><p><strong>åº”ç”¨</strong>ï¼š</p><blockquote><p>åˆ©ç”¨çª—å£çš„ç‰¹æ€§ï¼Œå¯ä»¥ç”¨æ¥è§£å†³ä¸€äº›æŸ¥æ‰¾æ»¡è¶³ä¸€å®šæ¡ä»¶çš„<strong>è¿ç»­åŒºé—´çš„</strong>æ€§è´¨ï¼ˆé•¿åº¦ç­‰ï¼‰çš„é—®é¢˜ã€‚ç”±äºåŒºé—´è¿ç»­ï¼Œå› æ­¤å½“åŒºé—´å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡<u>æ—§æœ‰çš„è®¡ç®—ç»“æœ</u>è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œå¯¹æœç´¢ç©ºé—´è¿›è¡Œå‰ªæï¼Œè¿™æ ·ä¾¿å‡å°‘äº†é‡å¤è®¡ç®—ï¼Œé™ä½äº†æ—¶é—´å¤æ‚åº¦ã€‚</p></blockquote><p>Qï¼šé‚£ä¹ˆï¼Œå…·ä½“ä»€ä¹ˆæƒ…å†µå¯ä»¥ç”¨æ»‘åŠ¨çª—å£æ¥è§£å†³å®é™…é—®é¢˜å‘¢ï¼Ÿ</p><ol><li>ä¸€èˆ¬ç»™å‡ºçš„æ•°æ®ç»“æ„æ˜¯<u>æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²</u></li><li>æ±‚å–æŸä¸ªå­ä¸²æˆ–è€…<u>å­åºåˆ—</u><u>æœ€é•¿æœ€çŸ­ç­‰æœ€å€¼é—®é¢˜</u>æˆ–è€…æ±‚æŸä¸ªç›®æ ‡å€¼æ—¶</li><li>è¯¥é—®é¢˜<u>æœ¬èº«å¯ä»¥é€šè¿‡æš´åŠ›æ±‚è§£</u>â€”â€”â˜…æ»‘åŠ¨çª—å£è·ŸåŒæŒ‡é’ˆä¸€æ ·ï¼Œé’ˆå¯¹ä¸€äº›é—®é¢˜èƒ½é™ä½æ—¶é—´å¤æ‚åº¦ã€‚</li></ol><h2 id="æ ¸å¿ƒæ€è·¯"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒæ€è·¯"></a> <strong>æ ¸å¿ƒæ€è·¯</strong></h2><p><strong>çª—å£çš„å½¢æˆ</strong></p><p>åœ¨å…·ä½“ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬çŸ¥é“çª—å£å®é™…æ˜¯ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´å½¢æˆçš„åŒºåŸŸï¼Œé‚£å…³é”®å°±æ˜¯è¿™ä¸¤ä¸ªæŒ‡é’ˆæ˜¯å¦‚ä½•ç§»åŠ¨çš„ã€‚</p><p>ã€ŠæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ã€‹è¿™æœ¬ä¹¦ä¸­æŠŠæ»‘åŠ¨çª—å£å«åšã€Œè™«å–æ³•ã€ï¼Œè¿™ä¹Ÿéå¸¸ç”ŸåŠ¨å½¢è±¡ã€‚å› ä¸ºæ»‘åŠ¨çª—å£çš„ä¸¤ä¸ªæŒ‡é’ˆç§»åŠ¨çš„è¿‡ç¨‹å’Œè™«å­çˆ¬åŠ¨çš„è¿‡ç¨‹éå¸¸åƒï¼šå‰è„š(rightæŒ‡é’ˆ)ä¸åŠ¨ï¼ŒæŠŠåè„š(leftæŒ‡é’ˆ)ç§»åŠ¨è¿‡æ¥ï¼›åè„šä¸åŠ¨ï¼ŒæŠŠå‰è„šå‘å‰ç§»åŠ¨ã€‚</p><p>æ»‘åŠ¨çª—å£ä¸­ç”¨åˆ°äº†å·¦å³ä¸¤ä¸ªæŒ‡é’ˆï¼Œå®ƒä»¬ç§»åŠ¨çš„æ€è·¯æ˜¯ï¼š<strong>ä»¥å³æŒ‡é’ˆä½œä¸ºé©±åŠ¨ï¼Œæ‹–ç€å·¦æŒ‡é’ˆå‘å‰èµ°ã€‚<u>å³æŒ‡é’ˆæ¯æ¬¡åªç§»åŠ¨ä¸€æ­¥ï¼Œè€Œå·¦æŒ‡é’ˆåœ¨å†…éƒ¨ while å¾ªç¯ä¸­æ¯æ¬¡å¯èƒ½ç§»åŠ¨å¤šæ­¥</u>ã€‚å³æŒ‡é’ˆæ˜¯ä¸»åŠ¨å‰ç§»ï¼Œæ¢ç´¢æœªçŸ¥çš„æ–°åŒºåŸŸï¼›å·¦æŒ‡é’ˆæ˜¯è¢«è¿«ç§»åŠ¨ï¼Œè´Ÿè´£å¯»æ‰¾æ»¡è¶³é¢˜æ„çš„åŒºé—´</strong>ã€‚</p><p>ä¸ºäº†å¾—åˆ°ç¬¦åˆè¦æ±‚çš„æœ€é•¿å­æ•°ç»„çš„é•¿åº¦ï¼Œåº”éµå¾ªä»¥ä¸‹ä¸¤ç‚¹åŸåˆ™ï¼š</p><ul><li>å½“ start çš„å€¼å›ºå®šæ—¶ï¼Œend çš„å€¼åº”å°½å¯èƒ½å¤§ï¼›</li><li>å½“ end çš„å€¼å›ºå®šæ—¶, start çš„å€¼åº”å°½å¯èƒ½å°ã€‚</li></ul><p><strong>æ¨¡æ¿çš„æ‰§è¡Œæ€æƒ³æ˜¯ï¼š</strong></p><ol><li>å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ left å’Œ right åˆ†åˆ«æŒ‡å‘åŒºé—´çš„å¼€å¤´å’Œç»“å°¾ï¼Œæ³¨æ„æ˜¯<strong>é—­åŒºé—´</strong>ï¼›å®šä¹‰ sums ç”¨æ¥ç»Ÿè®¡è¯¥åŒºé—´å†…çš„å„ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°ï¼›</li><li>ç¬¬ä¸€é‡ while å¾ªç¯æ˜¯ä¸ºäº†åˆ¤æ–­ right æŒ‡é’ˆçš„ä½ç½®æ˜¯å¦è¶…å‡ºäº†æ•°ç»„è¾¹ç•Œï¼›å½“ right æ¯æ¬¡åˆ°äº†æ–°ä½ç½®ï¼Œéœ€è¦å¢åŠ  right æŒ‡é’ˆçš„æ±‚å’Œ/è®¡æ•° --&gt; sumï¼›</li><li>ç¬¬äºŒé‡ while å¾ªç¯æ˜¯è®© left æŒ‡é’ˆå‘å³ç§»åŠ¨åˆ° [left, right] åŒºé—´ç¬¦åˆé¢˜æ„çš„ä½ç½®ï¼›å½“ left æ¯æ¬¡ç§»åŠ¨åˆ°äº†æ–°ä½ç½®ï¼Œéœ€è¦å‡å°‘ left æŒ‡é’ˆçš„æ±‚å’Œ/è®¡æ•°ï¼›</li><li>åœ¨ç¬¬äºŒé‡ while å¾ªç¯ä¹‹åï¼ŒæˆåŠŸæ‰¾åˆ°äº†ä¸€ä¸ªç¬¦åˆé¢˜æ„çš„ [left, right] åŒºé—´ï¼Œä¾¿è·³å‡ºå¾ªç¯ï¼Œæ›´æ–°é¢˜ç›®è¦æ±‚æœ€å¤§çš„åŒºé—´é•¿åº¦ï¼Œå³ <code>res = max(res, right - left + 1)</code>ã€‚</li><li>right æŒ‡é’ˆæ¯æ¬¡å‘å³ç§»åŠ¨ä¸€æ­¥ï¼Œå¼€å§‹æ¢ç´¢æ–°çš„åŒºé—´ã€‚</li></ol><h2 id="ä»£ç æ¨¡æ¿"><a class="markdownIt-Anchor" href="#ä»£ç æ¨¡æ¿"></a> ä»£ç æ¨¡æ¿</h2><h3 id="å˜é•¿çª—å£æ¨¡æ¿"><a class="markdownIt-Anchor" href="#å˜é•¿çª—å£æ¨¡æ¿"></a> å˜é•¿çª—å£æ¨¡æ¿</h3><p>ä¼ªä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ»‘åŠ¨çª—å£æ¨¡æ¿</span></span><br><span class="line">left,right = <span class="number">0</span>, (<span class="number">0</span> <span class="keyword">or</span> <span class="number">1</span>)</span><br><span class="line">ans = target = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> right &lt; len(nums):</span><br><span class="line">   æ ¹æ® right æ›´æ–° target å€¼</span><br><span class="line">   <span class="keyword">while</span> çª—å£å†…æ•°æ®ä¸æ»¡è¶³è¦æ±‚</span><br><span class="line">      <span class="comment"># 1. æ›´æ–° target å€¼</span></span><br><span class="line">      <span class="comment"># 2. æ”¶ç¼©å·¦è¾¹ç•Œ ==&gt; ä½¿å¾—æ–°çª—å£æ»¡è¶³è¦æ±‚</span></span><br><span class="line">      <span class="comment"># or: æ›´æ–° ansï¼š çª—å£ç›¸å…³æœ€å°å€¼ï¼Œåˆ™åœ¨æ­¤æ›´æ–°</span></span><br><span class="line">    <span class="comment"># or: æ›´æ–° ansï¼š æ±‚çª—å£ç›¸å…³æœ€å¤§å€¼ï¼Œåˆ™åœ¨æ­¤æ›´æ–°</span></span><br><span class="line">    æ›´æ–°right(ç§»åŠ¨å³è¾¹ç•Œ)</span><br><span class="line">è¿”å› ans</span><br></pre></td></tr></table></figure><p>å…·è±¡åŒ–çš„Pythonä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findSubArray</span><span class="params">(nums)</span>:</span></span><br><span class="line">    N = len(nums) <span class="comment"># æ•°ç»„/å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    left, right = <span class="number">0</span>, <span class="number">0</span> <span class="comment"># åŒæŒ‡é’ˆï¼Œè¡¨ç¤ºå½“å‰éå†çš„åŒºé—´[left, right]ï¼Œé—­åŒºé—´</span></span><br><span class="line">    sums = <span class="number">0</span> <span class="comment"># ç”¨äºç»Ÿè®¡ å­æ•°ç»„/å­åŒºé—´ æ˜¯å¦æœ‰æ•ˆï¼Œæ ¹æ®é¢˜ç›®å¯èƒ½ä¼šæ”¹æˆæ±‚å’Œ/è®¡æ•°</span></span><br><span class="line">    res = <span class="number">0</span> <span class="comment"># ä¿å­˜æœ€å¤§çš„æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ å­æ•°ç»„/å­ä¸² é•¿åº¦</span></span><br><span class="line">    <span class="keyword">while</span> right &lt; N: <span class="comment"># å½“å³è¾¹çš„æŒ‡é’ˆæ²¡æœ‰æœç´¢åˆ° æ•°ç»„/å­—ç¬¦ä¸² çš„ç»“å°¾</span></span><br><span class="line">        sums += nums[right] <span class="comment"># å¢åŠ å½“å‰å³è¾¹æŒ‡é’ˆçš„æ•°å­—/å­—ç¬¦çš„æ±‚å’Œ/è®¡æ•°</span></span><br><span class="line">        <span class="keyword">while</span> åŒºé—´[left, right]ä¸ç¬¦åˆé¢˜æ„ï¼š<span class="comment"># æ­¤æ—¶éœ€è¦ä¸€ç›´ç§»åŠ¨å·¦æŒ‡é’ˆï¼Œç›´è‡³æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆé¢˜æ„çš„åŒºé—´</span></span><br><span class="line">            sums -= nums[left] <span class="comment"># ç§»åŠ¨å·¦æŒ‡é’ˆå‰éœ€è¦ä»counterä¸­å‡å°‘leftä½ç½®å­—ç¬¦çš„æ±‚å’Œ/è®¡æ•°</span></span><br><span class="line">            left += <span class="number">1</span> <span class="comment"># çœŸæ­£çš„ç§»åŠ¨å·¦æŒ‡é’ˆï¼Œæ³¨æ„é¡ºåºä¸èƒ½è·Ÿä¸Šé¢ä¸€è¡Œä»£ç å†™å</span></span><br><span class="line">        <span class="comment"># åˆ° while ç»“æŸæ—¶ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªç¬¦åˆé¢˜æ„è¦æ±‚çš„ å­æ•°ç»„/å­ä¸²</span></span><br><span class="line">        res = max(res, right - left + <span class="number">1</span>) <span class="comment"># éœ€è¦æ›´æ–°ç»“æœ</span></span><br><span class="line">        right += <span class="number">1</span> <span class="comment"># ç§»åŠ¨å³æŒ‡é’ˆï¼Œå»æ¢ç´¢æ–°çš„åŒºé—´</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ¨¡æ¿ï¼š</p><blockquote><p>(right++åœ¨å‰)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">string s, t;</span><br><span class="line">    <span class="comment">// åœ¨ s ä¸­å¯»æ‰¾ t çš„ã€Œæœ€å°è¦†ç›–å­ä¸²ã€</span></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    string res = s;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(right &lt; s.size()) &#123;</span><br><span class="line">        window.add(s[right]);</span><br><span class="line">        right++;</span><br><span class="line">        <span class="comment">// å¦‚æœç¬¦åˆè¦æ±‚ï¼Œè¯´æ˜çª—å£æ„é€ å®Œæˆï¼Œç§»åŠ¨ left ç¼©å°çª—å£</span></span><br><span class="line">        <span class="keyword">while</span> (window ç¬¦åˆè¦æ±‚) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè¿™ä¸ªçª—å£çš„å­ä¸²æ›´çŸ­ï¼Œåˆ™æ›´æ–° res</span></span><br><span class="line">            <span class="comment">// or: ansæ›´æ–°ä½ç½®</span></span><br><span class="line">            res = minLen(res, window);</span><br><span class="line">            window.remove(s[left]);</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// or: ansæ›´æ–°ä½ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><h3 id="å›ºå®šé•¿çª—å£æ¨¡æ¿"><a class="markdownIt-Anchor" href="#å›ºå®šé•¿çª—å£æ¨¡æ¿"></a> <a href="https://www.cnblogs.com/huansky/p/13488234.html" target="_blank" rel="noopener">å›ºå®šé•¿çª—å£æ¨¡æ¿ï¼š</a></h3><blockquote><p>rightæ›´æ–°åœ¨ç¬¬ä¸€å±‚whileæœ€åï¼Œä¸”whileä¸­æ²¡æœ‰<code>if (right &gt; k)</code>ç±»ä¼¼çš„ä»£ç </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxVowels</span><span class="params">(String s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        <span class="keyword">int</span> maxAns = Integer.MIN_VALUE;</span><br><span class="line">        <span class="keyword">int</span> target = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// åˆå§‹æ„é€ å®šé•¿çª—å£</span></span><br><span class="line">        <span class="keyword">while</span> (right &lt; k) &#123;</span><br><span class="line">            <span class="comment">// æ›´æ–°è¿™æ®µåˆå§‹åŒ–çª—å£ä¸­çš„ target å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// â˜…æ›´æ–° ans å€¼ maxAns = Math.max(maxAns, );</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®© right (æœ‰è¾¹ç•Œ)</span></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="comment">// æ›´æ–° target å€¼</span></span><br><span class="line">            <span class="comment">// æ›´æ–° ans å€¼ maxAns = Math.max(maxAns, );</span></span><br><span class="line">            right ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxAns;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">isVowel</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ch == <span class="string">'a'</span> || ch == <span class="string">'e'</span> || ch == <span class="string">'i'</span> || ch == <span class="string">'o'</span> || ch == <span class="string">'u'</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ¨¡æ¿ï¼š</p><blockquote><ul><li>(right++åœ¨å‰) --&gt; è¿™ä¸ªæ˜¯å¯ä»¥è°ƒæ•´çš„ï¼Œç›¸åº”åœ°ä¿®æ”¹<code>if</code></li><li>æœ‰<code>if right &gt; k</code>çš„åˆ¤æ–­ï¼Œå³çª—å£æ˜¯å¦å·²ç»æ„é€ å®Œæˆ</li></ul></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å›ºå®šçª—å£å¤§å°ä¸º k</span></span><br><span class="line">   <span class="built_in">string</span> s;</span><br><span class="line">   <span class="comment">// åœ¨ s ä¸­å¯»æ‰¾çª—å£å¤§å°ä¸º k æ—¶çš„æ‰€åŒ…å«æœ€å¤§å…ƒéŸ³å­—æ¯ä¸ªæ•°</span></span><br><span class="line">   <span class="keyword">int</span>  right = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">while</span>(right &lt; s.size()) &#123;</span><br><span class="line">       window.add(s[right]);</span><br><span class="line">       <span class="comment">// æ³¨ï¼šå¦‚æœæ”¾æœ€åï¼Œåˆ™ä¸‹é¢çš„ifæ”¹æˆ right &gt; k</span></span><br><span class="line">       right++;</span><br><span class="line">       <span class="comment">// å¦‚æœç¬¦åˆè¦æ±‚ï¼Œè¯´æ˜çª—å£æ„é€ å®Œæˆï¼Œ</span></span><br><span class="line">       <span class="keyword">if</span> (right&gt;=k) &#123;</span><br><span class="line">           <span class="comment">// è¿™æ˜¯å·²ç»æ˜¯ä¸€ä¸ªçª—å£äº†ï¼Œæ ¹æ®æ¡ä»¶åšä¸€äº›äº‹æƒ…</span></span><br><span class="line">          <span class="comment">// ... å¯ä»¥è®¡ç®—çª—å£æœ€å¤§å€¼ç­‰ </span></span><br><span class="line">           <span class="comment">// æœ€åä¸è¦å¿˜è®°æŠŠ right - k ä½ç½®å…ƒç´ ä»çª—å£é‡Œé¢ç§»é™¤</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ­¤æ—¶ä¸éœ€è¦ä¾èµ– left æŒ‡é’ˆäº†ã€‚å› ä¸ºçª—å£å›ºå®šæ‰€ä»¥å…¶å®å°±æ²¡å¿…è¦ä½¿ç”¨leftã€‚å¯ä»¥ç›´æ¥é€šè¿‡ right æŒ‡é’ˆæ¥æ§åˆ¶çª—å£ã€‚</p><p>ç”±äºçª—å£æ˜¯å›ºå®šçš„ï¼Œå› æ­¤å¯ä»¥è½»æ˜“è·å–åˆ° left çš„ä½ç½®ï¼Œæ­¤å¤„ left = right - kï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒå±‚whileä¸­å¯ä»¥é€šè¿‡<code>nums[right-k]</code>æ¥è·å¾—leftä½ç½®å¾—å€¼ï¼Œä»è€Œä»çª—å£ä¸­åˆ é™¤ã€‚</p><p>æ³¨ï¼š è™½ç„¶æä¾›äº†ä¸¤ç§æ¨¡æ¿ï¼Œä½†ä¸è¦è´ªå¤šï¼Œè·ŸäºŒåˆ†æ¨¡æ¿ä¸€æ ·ï¼Œåªè¦è®°ä½ä¸€ç§å°±è¡Œäº†ã€‚</p><h2 id="easy-point"><a class="markdownIt-Anchor" href="#easy-point"></a> easy point:</h2><ul><li>çª—å£çš„é•¿åº¦: <code>right - left + 1</code>ï¼Œ</li><li>å‡è®¾çª—å£é•¿åº¦ä¸ºkï¼Œåˆ™çª—å£å†…å®¹ä¸º<code>[right-k+1, right-k+2, ..., right]</code>ï¼Œè¦è¢«å‰”é™¤çš„<code>left</code>çš„ç´¢å¼•ä¸º<code>right-k</code>ï¼šå›ºå®šé•¿çª—å£çš„é¢˜ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡rightä½ç½®æ‰¾åˆ°leftä½ç½®ã€‚</li></ul><h2 id="ä¸€èµ·åšå‡ é¢˜"><a class="markdownIt-Anchor" href="#ä¸€èµ·åšå‡ é¢˜"></a> ä¸€èµ·åšå‡ é¢˜</h2><ul><li><a href="https://leetcode-cn.com/problems/maximum-number-of-vowels-in-a-substring-of-given-length/" target="_blank" rel="noopener">1456. å®šé•¿å­ä¸²ä¸­å…ƒéŸ³çš„æœ€å¤§æ•°ç›®</a>â€”â€”å›ºå®šé•¿çª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxVowels</span><span class="params">(String s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        <span class="keyword">int</span> maxAns = Integer.MIN_VALUE;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span>[] chars = &#123;<span class="string">'a'</span>, <span class="string">'e'</span>, <span class="string">'i'</span>, <span class="string">'u'</span>, <span class="string">'o'</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (right - left + <span class="number">1</span> &lt;= k) &#123;</span><br><span class="line">            <span class="keyword">if</span> (contains(chars, s.charAt(right))) &#123;</span><br><span class="line">                ans++;</span><br><span class="line">            &#125;</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">        maxAns = Math.max(maxAns, ans);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="keyword">if</span> (contains(chars, s.charAt(right))) &#123;</span><br><span class="line">                ans += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¢«æ’é™¤çš„æ˜¯å…ƒéŸ³</span></span><br><span class="line">            <span class="keyword">if</span> (contains(chars, s.charAt(right - k))) &#123;</span><br><span class="line">                ans -= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            maxAns = Math.max(maxAns, ans);</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> maxAns;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(<span class="keyword">char</span> chars[], <span class="keyword">char</span> ch)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (chars[i] == ch) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´å¥½çš„åšæ³•:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxVowels</span><span class="params">(String s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> right =<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (right &lt; s.length()) &#123;</span><br><span class="line">            sum += isYuan(s.charAt(right)) ;</span><br><span class="line">            right++;</span><br><span class="line">            <span class="keyword">if</span> (right &gt;=k) &#123;</span><br><span class="line">                max = Math.max(max, sum);</span><br><span class="line">                sum -= isYuan(s.charAt(right-k));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">isYuan</span><span class="params">(<span class="keyword">char</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s==<span class="string">'a'</span> || s==<span class="string">'e'</span> ||s==<span class="string">'i'</span> ||s==<span class="string">'o'</span> ||s==<span class="string">'u'</span> ? <span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/" target="_blank" rel="noopener"> #3 æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a> â€”â€”ç”¨setæ¥æ¨¡æ‹Ÿçª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> len;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        HashSet&lt;Character&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="comment">// æŠŠåˆ é™¤ä¹‹å‰s.charAt(right)ä½ç½®å†…æ‰€æœ‰çš„å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">while</span> (set.contains(s.charAt(right))) &#123;</span><br><span class="line">                set.remove(s.charAt(left++));</span><br><span class="line">            &#125;</span><br><span class="line">            set.add(s.charAt(right));</span><br><span class="line">            ans = Math.max(ans, right - left + <span class="number">1</span>);</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/minimum-size-subarray-sum/" target="_blank" rel="noopener"> #209 é•¿åº¦æœ€å°çš„å­æ•°ç»„</a> â€”â€” å˜é•¿çª—å£æ¿å­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> minLen = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">int</span> len = nums.length;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ( right &lt; len) &#123;</span><br><span class="line">            sum += nums[right];</span><br><span class="line">            <span class="keyword">while</span> (sum &gt;= target) &#123;</span><br><span class="line">                <span class="comment">// ç”±äºéœ€è¦æ±‚æœ€å°, å› æ­¤è¿™è¾¹åœ¨leftæ”¶ç¼©è¿‡ç¨‹ä¸­æ›´æ–°minVal</span></span><br><span class="line">                minLen = Math.min(minLen, right - left +<span class="number">1</span>);</span><br><span class="line">                sum -= nums[left];</span><br><span class="line">                left ++;</span><br><span class="line">            &#125;</span><br><span class="line">            right ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="number">0</span> : minLen;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/max-consecutive-ones-iii/" target="_blank" rel="noopener"> #1004 æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III</a> â€”â€” å˜é•¿çª—å£æ¿å­ç•¥æœ‰å˜å½¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">longestOnes</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> left= <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = nums.length;</span><br><span class="line">        <span class="keyword">int</span> zeroTimes = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="keyword">int</span> now = nums[right];</span><br><span class="line">            <span class="comment">// æŠŠå½“å‰ä¿®æ”¹æˆ1</span></span><br><span class="line">            <span class="keyword">if</span> (now == <span class="number">0</span>) &#123;</span><br><span class="line">                zeroTimes ++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœæ¬ äº†kï¼Œåˆ™éœ€è¦ä»å·¦è¾¹è¿›è¡ŒæŒªåŠ¨è¡¥å¿ï¼›ä¿è¯ä¸‹ä¸€æ¬¡æ·»åŠ nums[right]æ—¶ kä¸€å®šéè´Ÿ</span></span><br><span class="line">            <span class="keyword">while</span>( zeroTimes &gt; k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[left] == <span class="number">0</span>) &#123;</span><br><span class="line">                    zeroTimes--;</span><br><span class="line">                &#125;</span><br><span class="line">                left ++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è·å¾—æœ€å¤§é•¿åº¦</span></span><br><span class="line">            ans = Math.max(ans, right - left + <span class="number">1</span>);</span><br><span class="line">            right ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/maximum-average-subarray-i/" target="_blank" rel="noopener"> #643 å­æ•°ç»„æœ€å¤§å¹³å‡æ•° I</a>â€”â€”å›ºå®šé•¿çª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMaxAverage</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (i &lt; k) &#123;</span><br><span class="line">          sum += nums[i++];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">double</span> maxV = -<span class="number">10000</span>;</span><br><span class="line">      maxV = Math.max(maxV, (<span class="keyword">double</span>) sum / k);</span><br><span class="line">      <span class="keyword">for</span> (; i &lt; nums.length; i++) &#123;</span><br><span class="line">          sum = sum - nums[i - k] + nums[i];</span><br><span class="line">          maxV = Math.max(maxV, (<span class="keyword">double</span>) sum / k);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> maxV;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/contains-duplicate-ii/" target="_blank" rel="noopener"> #219 å­˜åœ¨é‡å¤å…ƒç´  II</a>â€”â€”ä½¿ç”¨setä½œä¸ºçª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        HashSet&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span> right = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–æ„é€ çª—å£</span></span><br><span class="line">        <span class="keyword">while</span> (set.size() &lt; k) &#123;</span><br><span class="line">            set.add(nums[right++]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(right &lt; nums.length)</span><br><span class="line">            <span class="keyword">if</span> (set.contains(nums[right])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            set.remove(nums[right-k]);</span><br><span class="line">            set.add(nums[right]);</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/find-all-anagrams-in-a-string/" target="_blank" rel="noopener">438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯</a>â€”â€”å›ºå®šé•¿çª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findAnagrams</span><span class="params">(String s, String p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        <span class="keyword">int</span> right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> plen = p.length();</span><br><span class="line">        ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="comment">// ä¿è¯pæ¯”sçŸ­</span></span><br><span class="line">        <span class="keyword">if</span> (plen &gt; len) &#123;</span><br><span class="line">            <span class="keyword">return</span> list;</span><br><span class="line">        &#125;</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">int</span>[] mp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span>[] targetmp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span> mpSize = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// è®°å½•pä¸­å„ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; plen; i++) &#123;</span><br><span class="line">            targetmp[ p.charAt(i) - <span class="string">'a'</span>] ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = s.charAt(right);</span><br><span class="line">            mp[c-<span class="string">'a'</span>]++; mpSize++;</span><br><span class="line">            <span class="comment">// whileå’Œifæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºmpå¤§å°æ˜¯é€šè¿‡rightä¸€æ¬¡æ¬¡å¢å¤§çš„</span></span><br><span class="line">            <span class="keyword">if</span> (mpSize &gt; plen) &#123;</span><br><span class="line">                <span class="comment">// ç¼©å°å·¦è¾¹ç•Œ</span></span><br><span class="line">                <span class="keyword">char</span> removeChar = s.charAt(right - plen);</span><br><span class="line">                mpSize--;</span><br><span class="line">                mp[removeChar-<span class="string">'a'</span>]--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (right(mp, targetmp)) &#123;</span><br><span class="line">                list.add(right - plen + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            right ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">right</span><span class="params">(<span class="keyword">int</span>[] chars1, <span class="keyword">int</span>[] chars2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars1.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (chars1[i] != chars2[i]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/get-equal-substrings-within-budget/" target="_blank" rel="noopener">1208. å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰</a>â€”â€”å˜é•¿çª—å£æ¿å­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">equalSubstring</span><span class="params">(String s, String t, <span class="keyword">int</span> maxCost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// ç°åœ¨å·²ç»èŠ±è´¹çš„cost</span></span><br><span class="line">        <span class="keyword">int</span> cost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            cost += Math.abs(s.charAt(right) - t.charAt(right));</span><br><span class="line">            <span class="comment">// æ­¤æ—¶costä¸æ»¡è¶³æ¡ä»¶</span></span><br><span class="line">            <span class="keyword">while</span> (cost &gt; maxCost) &#123;</span><br><span class="line">                <span class="comment">// é€šè¿‡ç§»åŠ¨left, å°†costè¡¥å¿å›æ¥</span></span><br><span class="line">                cost -= Math.abs(s.charAt(left) - t.charAt(left));</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ±‚æœ€å¤§é•¿åº¦ï¼Œåˆ™æ›´æ–°åœ¨ç¬¬ä¸€å±‚whileé‡Œé¢</span></span><br><span class="line">            ans = Math.max(ans, right - left + <span class="number">1</span>);</span><br><span class="line">            right ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/sliding-window-maximum/" target="_blank" rel="noopener">239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼(å›°éš¾)</a></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">int</span>[] maxSlidingWindow(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.length;</span><br><span class="line">        <span class="keyword">int</span>[] ans = <span class="keyword">new</span> <span class="keyword">int</span>[len - k + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">        LinkedList&lt;Integer&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            <span class="keyword">int</span> now = nums[right];</span><br><span class="line">            <span class="comment">// ä¿æŒlisté€’å‡</span></span><br><span class="line">            <span class="keyword">while</span> (!list.isEmpty() &amp;&amp; list.peekLast() &lt; now) &#123;</span><br><span class="line">                list.pollLast();</span><br><span class="line">            &#125;</span><br><span class="line">            list.addLast(now);</span><br><span class="line">            right++;</span><br><span class="line">            <span class="keyword">if</span> (right &gt;= k) &#123;</span><br><span class="line">                ans[idx++] = list.peekFirst();</span><br><span class="line">                <span class="comment">// ä¸‹ä¸€æ¬¡çš„æ—¶å€™å°†ä¸ä¼šå†åœ¨çª—å£é‡Œé¢ï¼Œ æ‰€ä»¥åˆ¤æ–­æ˜¯å¦å‡ºå±€</span></span><br><span class="line">                <span class="keyword">if</span> (list.peekFirst() == nums[right - k]) &#123;</span><br><span class="line">                    list.removeFirst();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://leetcode-cn.com/problems/permutation-in-string/" target="_blank" rel="noopener">567. å­—ç¬¦ä¸²çš„æ’åˆ—</a>â€”â€”å›ºå®šé•¿åº¦çª—å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€å¼€å§‹éƒ½æ²¡çœ‹å‡ºæ¥æ€ä¹ˆéœ€è¦ç”¨åˆ°çª—å£ï¼Œ åæ¥å‘ç°s1çš„æ’åˆ—å¿…é¡»æ˜¯s2çš„å­ä¸², æ‰€ä»¥å­—ç¬¦æ˜¯ç›¸åŒçš„, å­ä¸²é•¿åº¦ä¹Ÿæ˜¯å›ºå®šã€‚ æ‰€ä»¥æ˜¯é“å®šé•¿çª—å£é¢˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] arr1 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span>[] arr2 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s1.length(); i++) &#123;</span><br><span class="line">            arr1[s1.charAt(i) - <span class="string">'a'</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> k = s1.length(), right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = s2.length();</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; len) &#123;</span><br><span class="line">            arr2[s2.charAt(right) - <span class="string">'a'</span>]++;</span><br><span class="line">            cnt ++;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (cnt &gt; k) &#123;</span><br><span class="line">                arr2[ s2.charAt(right - k) - <span class="string">'a'</span>]--;</span><br><span class="line">                cnt--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (contains(arr1, arr2)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(<span class="keyword">int</span>[] arr1, <span class="keyword">int</span>[] arr2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr1.length; i++) &#123;</span><br><span class="line">            <span class="comment">// ä¸€æ—¦arr2ä¸ç¬¦åˆ</span></span><br><span class="line">            <span class="keyword">if</span> (arr1[i] &gt; arr2[i]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡ç« "><a class="markdownIt-Anchor" href="#å‚è€ƒæ–‡ç« "></a> å‚è€ƒæ–‡ç« ï¼š</h2><ul><li><a href="https://leetcode-cn.com/problems/max-consecutive-ones-iii/solution/fen-xiang-hua-dong-chuang-kou-mo-ban-mia-f76z/" target="_blank" rel="noopener">åˆ†äº«æ»‘åŠ¨çª—å£æ¨¡æ¿ï¼Œç§’æ€æ»‘åŠ¨çª—å£é—®é¢˜</a>â€”â€”å½¢è±¡çš„ç†è§£ï¼šè™«å–æ³•</li><li><a href="https://www.cnblogs.com/huansky/p/13488234.html" target="_blank" rel="noopener">æ»‘åŠ¨çª—å£ç®—æ³•åŸºæœ¬åŸç†ä¸å®è·µ</a>â€”â€”ä¾‹é¢˜+æ¨¡æ¿</li><li><a href="https://blog.csdn.net/Dby_freedom/article/details/89066140" target="_blank" rel="noopener">ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼ˆä¸€ï¼‰ï¼šæ»‘åŠ¨çª—å£æ³•æ€»ç»“</a>â€”â€”æ¦‚å¿µ+ä¾‹é¢˜</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Sliding window algorithm is used to perform required operation on specific window size of given large buffer or array.æ»‘åŠ¨çª—å£ç®—æ³•
      
    
    </summary>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://nymrli.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>[ç¿»è¯‘]è®¾è®¡Pastebin.com(or Bit.ly)ç³»ç»Ÿ</title>
    <link href="https://nymrli.top/2022/04/05/%E7%BF%BB%E8%AF%91-%E8%AE%BE%E8%AE%A1Pastebin-com-or-Bit-ly-%E7%B3%BB%E7%BB%9F/"/>
    <id>https://nymrli.top/2022/04/05/ç¿»è¯‘-è®¾è®¡Pastebin-com-or-Bit-ly-ç³»ç»Ÿ/</id>
    <published>2022-04-05T09:34:50.000Z</published>
    <updated>2022-04-05T11:30:43.887Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è®¾è®¡pastebincom"><a class="markdownIt-Anchor" href="#è®¾è®¡pastebincom"></a> <a href="http://xn--Pastebin-xx5xji.com" target="_blank" rel="noopener">è®¾è®¡Pastebin.com</a> (or <a href="http://Bit.ly" target="_blank" rel="noopener">Bit.ly</a>)ç³»ç»Ÿ</h1><p>æ³¨ï¼šæœ¬æ–‡æ¡£ç›´æ¥é“¾æ¥åˆ°ç³»ç»Ÿè®¾è®¡ä¸»é¢˜ä¸­çš„ç›¸å…³é¢†åŸŸï¼Œä»¥é¿å…é‡å¤ã€‚è¯·å‚è€ƒé“¾æ¥å†…å®¹æ¥äº†è§£æ€»ä½“çš„è®¨è®ºè¦ç‚¹ã€åˆ©å¼Šæƒè¡¡ä»¥åŠæ›¿ä»£æ–¹æ¡ˆã€‚</p><p>**è®¾è®¡<a href="https://www.baidu.com/s?wd=bit.ly&amp;rsv_spt=1&amp;rsv_iqid=0x97c01cce002338c1&amp;issp=1&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=2&amp;ie=utf-8&amp;rqlang=cn&amp;tn=baiduhome_pg&amp;rsv_enter=0&amp;rsv_dl=tb&amp;oq=bit.ly&amp;rsv_btype=t&amp;rsv_t=e8762eu5%2B6DVVq%2BNlFhLqorUp3QSNtSJ5UjqS%2FLmbVRjAw3gHUzdZ5VW%2F%2BJORNxD3z1%2F&amp;rsv_sug3=7&amp;rsv_sug1=7&amp;rsv_sug7=100&amp;rsv_pq=ce550397001e64ee&amp;prefixsug=bit.ly&amp;rsp=1&amp;rsv_sug4=5598" target="_blank" rel="noopener">Bit.ly</a>**æ˜¯ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜ã€‚åªæ˜¯Pastebinè¿˜å…·æœ‰ä¸€ä¸ªé¢å¤–çš„åŠŸèƒ½ï¼Œå³å­˜å‚¨ç²˜è´´çš„å†…å®¹ï¼Œè€Œä¸æ˜¯åŸå§‹çš„æœªç¼©çŸ­è¿‡çš„urlã€‚</p><h2 id="ç¬¬ä¸€æ­¥åˆ—å‡ºç”¨ä¾‹å’Œçº¦æŸçš„å¤§çº²"><a class="markdownIt-Anchor" href="#ç¬¬ä¸€æ­¥åˆ—å‡ºç”¨ä¾‹å’Œçº¦æŸçš„å¤§çº²"></a> ç¬¬ä¸€æ­¥ï¼šåˆ—å‡ºç”¨ä¾‹å’Œçº¦æŸçš„å¤§çº²</h2><blockquote><p>ç¡®å®šåº”ç”¨åœºæ™¯ï¼šæ”¶é›†éœ€æ±‚å’ŒèŒƒå›´é—®é¢˜ï¼›æé—®æ¥å¼„æ¸…é˜æ˜ç”¨ä¾‹å’Œçº¦æŸï¼Œè®¨è®ºæ¥ä½œå‡ºå‡è®¾ã€‚</p></blockquote><p>åœ¨æ²¡æœ‰é¢è¯•å®˜æ¥é˜æ˜æ¸…è¿™äº›é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€äº›ç”¨ä¾‹å’Œçº¦æŸã€‚</p><h3 id="ç”¨ä¾‹"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹"></a> ç”¨ä¾‹</h3><h4 id="æˆ‘ä»¬å°†ç¡®å®šé—®é¢˜çš„èŒƒå›´åªå¤„ç†ä»¥ä¸‹ä½¿ç”¨æƒ…å†µ"><a class="markdownIt-Anchor" href="#æˆ‘ä»¬å°†ç¡®å®šé—®é¢˜çš„èŒƒå›´åªå¤„ç†ä»¥ä¸‹ä½¿ç”¨æƒ…å†µ"></a> æˆ‘ä»¬å°†ç¡®å®šé—®é¢˜çš„èŒƒå›´ï¼Œåªå¤„ç†ä»¥ä¸‹ä½¿ç”¨æƒ…å†µ</h4><ul><li><strong>ç”¨æˆ·</strong>ï¼šè¾“å…¥ä¸€æ®µæ–‡æœ¬åï¼Œè·å¾—ä¸€ä¸ªéšæœºç”Ÿæˆçš„é“¾æ¥<ul><li>è¿‡æœŸ<ul><li>é»˜è®¤è®¾ç½®æ˜¯ä¸ä¼šè¿‡æœŸçš„</li><li>å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ—¶é—´è¿‡æœŸ</li></ul></li></ul></li><li><strong>ç”¨æˆ·</strong>ï¼šè¾“å…¥ä¸€ä¸ªpasteçš„urlé“¾æ¥ï¼Œä¾¿å¯ä»¥çœ‹åˆ°å†…å®¹</li><li><strong>ç”¨æˆ·</strong>ï¼šæ˜¯åŒ¿åçš„</li><li><strong>æœåŠ¡</strong>ï¼šå¯ä»¥è¿½è¸ªå¾—åˆ°é¡µé¢åˆ†æç»“æœ<ul><li>æ¯æœˆçš„è®¿é—®æ•°æ®</li></ul></li><li><strong>æœåŠ¡</strong>ï¼šåˆ é™¤è¿‡æœŸçš„pastenå†…å®¹</li><li><strong>æœåŠ¡</strong>ï¼šå…·æœ‰é«˜å¯ç”¨æ€§</li></ul><h4 id="èŒƒå›´ä¹‹å¤–"><a class="markdownIt-Anchor" href="#èŒƒå›´ä¹‹å¤–"></a> èŒƒå›´ä¹‹å¤–</h4><ul><li><strong>ç”¨æˆ·</strong>ï¼šæ³¨å†Œä¸€ä¸ªå¸æˆ·<ul><li><strong>ç”¨æˆ·</strong>ï¼šè®¤è¯é‚®ç®±</li></ul></li><li><strong>ç”¨æˆ·</strong>ï¼šç™»å½•æ³¨å†Œè´¦æˆ·<ul><li><strong>ç”¨æˆ·</strong>ï¼šç¼–è¾‘æ–‡æ¡£</li></ul></li><li><strong>ç”¨æˆ·</strong>ï¼šå¯ä»¥è®¾ç½®å¯è§æ€§</li><li><strong>ç”¨æˆ·</strong>ï¼šå¯ä»¥è®¾ç½®çŸ­é“¾æ¥</li></ul><h3 id="çº¦æŸå’Œå‡è®¾"><a class="markdownIt-Anchor" href="#çº¦æŸå’Œå‡è®¾"></a> çº¦æŸå’Œå‡è®¾</h3><h4 id="æƒ…å†µå‡è®¾"><a class="markdownIt-Anchor" href="#æƒ…å†µå‡è®¾"></a> æƒ…å†µå‡è®¾</h4><ul><li>æµé‡ä¸æ˜¯å‡åŒ€åˆ†å¸ƒçš„</li><li>äº§ç”Ÿä¸€ä¸ªçŸ­é“¾æ¥åº”è¯¥æ˜¯å¿«é€Ÿçš„</li><li>ç²˜è´´pasteå†…å®¹åªèƒ½æ˜¯æ–‡æœ¬</li><li>é¡µé¢æµè§ˆåˆ†æä¸éœ€è¦æ˜¯å®æ—¶çš„</li><li>1000ä¸‡ç”¨æˆ·</li><li>æ¯æœˆ1000ä¸‡æ¬¡çš„ç²˜è´´pasteå†™å…¥é‡</li><li>æ¯æœˆ1äº¿æ¬¡çš„ç²˜è´´pasteé˜…è¯»</li><li>10:1çš„è¯»ä¸å†™æ¯”ä¾‹</li></ul><h3 id="è®¡ç®—ç”¨é‡"><a class="markdownIt-Anchor" href="#è®¡ç®—ç”¨é‡"></a> è®¡ç®—ç”¨é‡</h3><p><strong>å‘ä½ çš„é¢è¯•å®˜è¯´æ˜ä½ æ˜¯å¦åº”è¯¥å¯¹ç”¨é‡è¿›è¡Œç²—ç•¥ä¼°è®¡ã€‚</strong></p><ul><li>æ¯æ¬¡ç²˜è´´pasteçš„å¤§å°<ul><li>æ¯æ¬¡ç²˜è´´çš„å†…å®¹ä¸º1KB</li><li><code>shortlink</code>- 7 bytes</li><li><code>expiration_length_in_minutes</code> - 4 bytes</li><li><code>created_at</code> - 5 bytes</li><li><code>paste_path</code> - 255 bytes</li><li><code>total</code> = ~1.27 KB</li></ul></li><li>æ¯æœˆ12.7GBçš„æ–°ç²˜è´´å†…å®¹<ul><li>æ¯ä¸ª1.27 KB çš„ç²˜è´´paste * æ¯æœˆ1000ä¸‡ä¸ªpaste</li><li>3å¹´å†…çº¦æœ‰450GBçš„æ–°ç²˜è´´å†…å®¹</li><li>3å¹´å†…æœ‰3.6äº¿ä¸ªçŸ­é“¾æ¥</li><li>å‡è®¾å¤§å¤šæ•°æ˜¯æ–°çš„ç²˜è´´å†…å®¹ï¼Œè€Œä¸æ˜¯å¯¹ç°æœ‰å†…å®¹çš„æ›´æ–°</li></ul></li><li>å¹³å‡æ¯ç§’é’Ÿå†™4æ¬¡ç²˜è´´å†…å®¹</li><li>å¹³å‡æ¯ç§’40æ¬¡è¯»å–è¯·æ±‚</li></ul><p>æ–¹ä¾¿çš„è½¬æ¢æŒ‡å—ï¼š</p><ul><li>æ¯æœˆ250ä¸‡ç§’</li><li>æ¯ç§’1ä¸ªè¯·æ±‚=æ¯æœˆ250ä¸‡ä¸ªè¯·æ±‚</li><li>æ¯ç§’40ä¸ªè¯·æ±‚=æ¯æœˆ1äº¿ä¸ªè¯·æ±‚</li><li>æ¯ç§’400ä¸ªè¯·æ±‚=æ¯æœˆ10äº¿ä¸ªè¯·æ±‚</li></ul><h2 id="ç¬¬äºŒæ­¥-åˆ›å»ºä¸€ä¸ªé«˜æ°´å¹³çš„è®¾è®¡"><a class="markdownIt-Anchor" href="#ç¬¬äºŒæ­¥-åˆ›å»ºä¸€ä¸ªé«˜æ°´å¹³çš„è®¾è®¡"></a> ç¬¬äºŒæ­¥: åˆ›å»ºä¸€ä¸ªé«˜æ°´å¹³çš„è®¾è®¡</h2><blockquote><p>å‹¾å‹’å‡ºä¸€ä¸ªåŒ…å«æ‰€æœ‰é‡è¦ç»„æˆéƒ¨åˆ†çš„é«˜å±‚æ¬¡è®¾è®¡ã€‚</p></blockquote><p><img src="http://i.imgur.com/BKsBnmG.png" alt="Imgur"></p><h2 id="ç¬¬ä¸‰æ­¥è®¾è®¡æ ¸å¿ƒç»„ä»¶"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰æ­¥è®¾è®¡æ ¸å¿ƒç»„ä»¶"></a> ç¬¬ä¸‰æ­¥ï¼šè®¾è®¡æ ¸å¿ƒç»„ä»¶</h2><p><strong>ç”¨ä¾‹: ç”¨æˆ·è¾“å…¥ä¸€æ®µæ–‡æœ¬åï¼Œè·å¾—ä¸€ä¸ªéšæœºç”Ÿæˆçš„é“¾æ¥</strong></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<a href="https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms" target="_blank" rel="noopener">å…³ç³»æ•°æ®åº“</a>ä½œä¸ºä¸€ä¸ªå¤§çš„å“ˆå¸Œè¡¨ï¼Œå°†ç”Ÿæˆçš„urlæ˜ å°„åˆ°æ–‡ä»¶æœåŠ¡å™¨å’ŒåŒ…å«ç²˜è´´pasteæ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>æˆ‘ä»¬ä¸é‡‡ç”¨ç®¡ç†æ–‡ä»¶æœåŠ¡å™¨çš„æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå¯ç®¡ç†çš„<strong>å¯¹è±¡å­˜å‚¨</strong>ï¼Œå¦‚Amazon S3æˆ–<a href="https://github.com/donnemartin/system-design-primer#document-store" target="_blank" rel="noopener">NoSQLæ–‡æ¡£å­˜å‚¨</a>ã€‚</p><p>ä½œä¸ºä¸€ä¸ªå¤§å‹å“ˆå¸Œè¡¨çš„å…³ç³»æ•°æ®åº“çš„æ›¿ä»£å“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="https://github.com/donnemartin/system-design-primer#key-value-store" target="_blank" rel="noopener">NoSQLé”®å€¼å­˜å‚¨</a>ã€‚æˆ‘ä»¬åº”è¯¥è®¨è®º<a href="https://github.com/donnemartin/system-design-primer#sql-or-nosql" target="_blank" rel="noopener">é€‰æ‹©SQLæˆ–NoSQLä¹‹é—´çš„åˆ©å¼Šæƒè¡¡</a>ã€‚ä¸‹é¢çš„è®¨è®ºä½¿ç”¨äº†å…³ç³»å‹æ•°æ®åº“çš„æ–¹æ³•ã€‚</p><ul><li><strong>å®¢æˆ·ç«¯</strong>å‘ä½œä¸ºåå‘ä»£ç†çš„<strong>webæœåŠ¡å™¨</strong>å‘é€ä¸€ä¸ªåˆ›å»ºç²˜è´´pasteè¯·æ±‚</li><li><strong>webæœåŠ¡å™¨</strong>å°†è¯¥è¯·æ±‚è½¬å‘ç»™ <strong>Write API æœåŠ¡å™¨</strong></li><li><strong>Write API æœåŠ¡å™¨</strong>åšä»¥ä¸‹å·¥ä½œã€‚<ul><li>ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„url<ul><li>é€šè¿‡æŸ¥çœ‹<strong>SQLæ•°æ®åº“</strong>æ˜¯å¦æœ‰é‡å¤çš„ç½‘å€ï¼Œæ¥æ£€æŸ¥è¯¥ç½‘å€æ˜¯å¦æ˜¯å”¯ä¸€çš„ã€‚</li><li>å¦‚æœurlä¸æ˜¯å”¯ä¸€çš„ï¼Œå®ƒå°†ç”Ÿæˆå¦ä¸€ä¸ªç½‘å€</li><li>å¦‚æœæˆ‘ä»¬æ”¯æŒè‡ªå®šä¹‰urlï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„urlï¼ˆä¹Ÿæ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„ï¼‰ã€‚</li></ul></li><li>ä¿å­˜åˆ°<strong>SQLæ•°æ®åº“</strong>ä¸­çš„<code>ç²˜è´´paste</code>è¡¨</li><li>å°†ç²˜è´´çš„æ•°æ®ä¿å­˜åˆ°<strong>å¯¹è±¡å­˜å‚¨</strong>ä¸­</li><li>è¿”å›url</li></ul></li></ul><p><strong>ä¸ä½ çš„é¢è¯•å®˜æ˜ç¡®è¯´æ˜ä½ è¦å†™å¤šå°‘ä»£ç </strong></p><p><code>pastes</code>è¡¨çš„ç»“æ„å¯ä»¥è®¾è®¡æˆä¸‹é¢çš„æ ·å­ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shortlink char(7) NOT NULL</span><br><span class="line">expiration_length_in_minutes int NOT NULL</span><br><span class="line">created_at datetime NOT NULL</span><br><span class="line">paste_path varchar(255) NOT NULL</span><br><span class="line">PRIMARY KEY(shortlink)</span><br></pre></td></tr></table></figure><p>å°†ä¸»é”®è®¾ç½®ä¸ºåŸºäº<code>shortlink</code>åˆ—çš„<a href="https://github.com/donnemartin/system-design-primer#use-good-indices" target="_blank" rel="noopener">ç´¢å¼•</a>ï¼Œæ•°æ®åº“ä¼šä½¿ç”¨è¿™ä¸ªç´¢å¼•æ¥å¼ºåˆ¶æ‰§è¡Œå”¯ä¸€æ€§ã€‚æˆ‘ä»¬å°†åœ¨<code>creative_at</code>ä¸Šåˆ›å»ºä¸€ä¸ªé¢å¤–çš„ç´¢å¼•ï¼Œä»¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼ˆç”¨æ—¥å¿—æ—¶é—´ä»£æ›¿æ‰«ææ•´ä¸ªè¡¨ï¼‰ï¼Œå¹¶å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ä»å†…å­˜ä¸­è¿ç»­è¯»å–1MBçš„æ•°æ®éœ€è¦250å¾®ç§’ï¼Œè€Œä»SSDä¸­è¯»å–éœ€è¦4å€ï¼Œä»ç£ç›˜ä¸­è¯»å–éœ€è¦80å€çš„æ—¶é—´ã€‚<sup><a href="https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know" target="_blank" rel="noopener">1</a></sup></p><p>ä¸ºäº†ç”Ÿæˆå”¯ä¸€çš„urlï¼Œæˆ‘ä»¬å¯ä»¥:</p><ul><li>å¯¹ç”¨æˆ·çš„<code>ip_address</code> + æ—¶é—´æˆ³è¿›è¡Œ<a href="https://en.wikipedia.org/wiki/MD5" target="_blank" rel="noopener"><strong>MD5</strong></a> å“ˆå¸Œ<ul><li>MD5æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„æ•£åˆ—å‡½æ•°ï¼Œäº§ç”Ÿä¸€ä¸ª128ä½çš„å“ˆå¸Œå€¼</li><li>MD5æ˜¯å‡åŒ€åˆ†å¸ƒçš„</li><li>å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å–éšæœºç”Ÿæˆçš„æ•°æ®çš„MD5å“ˆå¸Œå€¼</li></ul></li><li>ä½¿ç”¨<a href="https://www.kerstner.at/2012/07/shortening-strings-using-base-62-encoding/" target="_blank" rel="noopener"><strong>Base62</strong></a>å¯¹MD5å“ˆå¸Œç»“æœå€¼è¿›è¡Œç¼–ç <ul><li>Base 62 ç¼–ç å­—ç¬¦ä¸º<code>[a-zA-Z0-9]</code>ï¼Œä¸éœ€è¦è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œè¿™å¯¹Urlsæ¥è¯´å¾ˆæœ‰æ•ˆã€‚</li><li>åŸå§‹è¾“å…¥åªæœ‰ä¸€ä¸ªå“ˆå¸Œç»“æœï¼Œè€Œä¸”Base 62æ˜¯ç¡®å®šæ€§çš„ï¼ˆä¸æ¶‰åŠéšæœºæ€§ï¼‰ã€‚</li><li>Base 64 æ˜¯å¦ä¸€ç§æµè¡Œçš„ç¼–ç ï¼Œä½†ç”±äºæœ‰é¢å¤–çš„<code>+</code>å’Œ<code>/</code>å­—ç¬¦ï¼Œæ‰€ä»¥å¯¹urlsæœ‰é—®é¢˜ã€‚</li><li>ä¸‹é¢çš„<a href="http://stackoverflow.com/questions/742013/how-to-code-a-url-shortener" target="_blank" rel="noopener">Base 62ä¼ªä»£ç </a>åœ¨O(k)æ—¶é—´å†…è¿è¡Œï¼Œå…¶ä¸­k=7ã€‚</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base_encode</span><span class="params">(num, base=<span class="number">62</span>)</span>:</span></span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">0</span></span><br><span class="line">      remainder = modulo(num, base)</span><br><span class="line">      digits.push(remainder)</span><br><span class="line">      num = divide(num, base)</span><br><span class="line">    digits = digits.reverse</span><br></pre></td></tr></table></figure><ul><li>å–è¾“å‡ºçš„å‰7ä¸ªå­—ç¬¦ï¼Œç»“æœæ˜¯62^7ä¸ªå¯èƒ½çš„å€¼ï¼Œåº”è¯¥è¶³ä»¥å¤„ç†æˆ‘ä»¬3å¹´å†…3.6äº¿ä¸ªçŸ­é“¾æ¥çš„çº¦æŸã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url = base_encode(md5(ip_address+timestamp))[:URL_LENGTH]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå…¬å…±<a href="https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest" target="_blank" rel="noopener"><strong>REST API</strong></a>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X POST --data <span class="string">'&#123; "expiration_length_in_minutes": "60", \</span></span><br><span class="line"><span class="string">    "paste_contents": "Hello World!" &#125;'</span> https://pastebin.com/api/v1/paste</span><br></pre></td></tr></table></figure><p>Response:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"shortlink"</span>: <span class="string">"foobar"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºå†…éƒ¨é€šä¿¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc" target="_blank" rel="noopener">è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</a>ã€‚</p><h3 id="ç”¨ä¾‹ç”¨æˆ·è¾“å…¥ä¸€ä¸ªpaste-urlå¹¶æŸ¥çœ‹å…¶å†…å®¹"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹ç”¨æˆ·è¾“å…¥ä¸€ä¸ªpaste-urlå¹¶æŸ¥çœ‹å…¶å†…å®¹"></a> ç”¨ä¾‹ï¼šç”¨æˆ·è¾“å…¥ä¸€ä¸ªpaste urlå¹¶æŸ¥çœ‹å…¶å†…å®¹</h3><ul><li><strong>å®¢æˆ·ç«¯</strong>å‘<strong>webæœåŠ¡å™¨</strong>å‘é€ä¸€ä¸ªè·å–ç²˜è´´pasteçš„è¯·æ±‚</li><li><strong>WebæœåŠ¡å™¨</strong>å°†è¯¥è¯·æ±‚è½¬å‘ç»™ <strong>Read API æœåŠ¡å™¨</strong></li><li><strong>Read APIæœåŠ¡å™¨</strong>åšä»¥ä¸‹å·¥ä½œã€‚<ul><li>æ£€æŸ¥<strong>SQLæ•°æ®åº“</strong>ä¸­ç”Ÿæˆçš„url<ul><li>å¦‚æœurlåœ¨<strong>SQLæ•°æ®åº“</strong>ä¸­ï¼Œåˆ™ä»<strong>å¯¹è±¡å­˜å‚¨</strong>ä¸­è·å–ç²˜è´´å†…å®¹</li><li>å¦åˆ™ï¼Œç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯</li></ul></li></ul></li></ul><p>REST API:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://pastebin.com/api/v1/paste?shortlink=foobar</span><br></pre></td></tr></table></figure><p>Response:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"paste_contents"</span>: <span class="string">"Hello World"</span></span><br><span class="line">    <span class="string">"created_at"</span>: <span class="string">"YYYY-MM-DD HH:MM:SS"</span></span><br><span class="line">    <span class="string">"expiration_length_in_minutes"</span>: <span class="string">"60"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç”¨ä¾‹ç½‘é¡µè·Ÿè¸ªåˆ†ææœåŠ¡"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹ç½‘é¡µè·Ÿè¸ªåˆ†ææœåŠ¡"></a> ç”¨ä¾‹ï¼šç½‘é¡µè·Ÿè¸ªåˆ†ææœåŠ¡</h3><p>ç”±äºå®æ—¶åˆ†æä¸æ˜¯ä¸€ä¸ªè¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å¯¹<strong>WebæœåŠ¡å™¨</strong>çš„æ—¥å¿—è¿›è¡Œ <strong>MapReduce</strong> ä»¥ç”Ÿæˆç‚¹å‡»æ•°ã€‚</p><p><strong>ä¸ä½ çš„é¢è¯•å®˜æ˜ç¡®è¯´æ˜ä½ è¦å†™å¤šå°‘ä»£ç </strong>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HitCounts</span><span class="params">(MRJob)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract_url</span><span class="params">(self, line)</span>:</span></span><br><span class="line">        <span class="string">"""Extract the generated url from the log line."""</span></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract_year_month</span><span class="params">(self, line)</span>:</span></span><br><span class="line">        <span class="string">"""Return the year and month portions of the timestamp."""</span></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mapper</span><span class="params">(self, _, line)</span>:</span></span><br><span class="line">        <span class="string">"""Parse each log line, extract and transform relevant lines.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Emit key value pairs of the form:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (2016-01, url0), 1</span></span><br><span class="line"><span class="string">        (2016-01, url0), 1</span></span><br><span class="line"><span class="string">        (2016-01, url1), 1</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        url = self.extract_url(line)</span><br><span class="line">        period = self.extract_year_month(line)</span><br><span class="line">        <span class="keyword">yield</span> (period, url), <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reducer</span><span class="params">(self, key, values)</span>:</span></span><br><span class="line">        <span class="string">"""Sum values for each key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (2016-01, url0), 2</span></span><br><span class="line"><span class="string">        (2016-01, url1), 1</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">yield</span> key, sum(values)</span><br></pre></td></tr></table></figure><h3 id="ç”¨ä¾‹åˆ é™¤è¿‡æœŸpasteçš„æœåŠ¡"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹åˆ é™¤è¿‡æœŸpasteçš„æœåŠ¡"></a> ç”¨ä¾‹ï¼šåˆ é™¤è¿‡æœŸpasteçš„æœåŠ¡</h3><p>è¦åˆ é™¤è¿‡æœŸçš„ç²˜è´´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰«æ<strong>SQLæ•°æ®åº“</strong>ä¸­æ‰€æœ‰è¿‡æœŸæ—¶é—´æˆ³å¤§äºå½“å‰æ—¶é—´æˆ³çš„æ¡ç›®ã€‚ç„¶åï¼Œæ‰€æœ‰è¿‡æœŸçš„æ¡ç›®å°†è¢«ä»è¡¨ä¸­åˆ é™¤ï¼ˆæˆ–æ ‡è®°ä¸ºè¿‡æœŸï¼‰ã€‚</p><h2 id="ç¬¬å››æ­¥æ‰©å±•è®¾è®¡"><a class="markdownIt-Anchor" href="#ç¬¬å››æ­¥æ‰©å±•è®¾è®¡"></a> ç¬¬å››æ­¥ï¼šæ‰©å±•è®¾è®¡</h2><blockquote><p>é‰´äºçº¦æŸæ¡ä»¶ï¼Œè¯†åˆ«å¹¶è§£å†³ç“¶é¢ˆé—®é¢˜ã€‚</p></blockquote><p><img src="http://i.imgur.com/4edXG0T.png" alt="Imgur"></p><p><strong>é‡è¦ï¼šä¸è¦ç®€å•åœ°ä»æœ€åˆçš„è®¾è®¡ç›´æ¥è·³åˆ°æœ€ç»ˆçš„è®¾è®¡ä¸­å»!</strong></p><p>è¯´æ˜ä½ ä¼šè¿­ä»£åœ°åšè¿™ä»¶äº‹ã€‚1) <strong>åŸºå‡†æµ‹è¯•/è´Ÿè½½æµ‹è¯•</strong>ï¼›2) <strong>å‰–æ</strong>ç“¶é¢ˆï¼›3) è§£å†³ç“¶é¢ˆé—®é¢˜ï¼ŒåŒæ—¶è¯„ä¼°æ›¿ä»£æ–¹æ¡ˆå’Œåˆ©å¼Šæƒè¡¡ï¼›4) é‡å¤ã€‚å‚çœ‹<a href="../scaling_aws/README.md">è®¾è®¡ä¸€ä¸ªå¯ä»¥åœ¨AWSä¸Šæ‰©å±•åˆ°æ•°ç™¾ä¸‡ç”¨æˆ·çš„ç³»ç»Ÿ</a>ï¼Œä½œä¸ºä¸€ä¸ªå¦‚ä½•å¯¹åˆå§‹è®¾è®¡è¿›è¡Œè¿­ä»£æ‰©å±•çš„æ ·ä¾‹ã€‚</p><p>è®¨è®ºåˆå§‹è®¾è®¡å¯èƒ½é‡åˆ°çš„ç“¶é¢ˆä»¥åŠå¦‚ä½•è§£å†³æ¯ä¸ªç“¶é¢ˆæ˜¯å¾ˆé‡è¦çš„ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡æ·»åŠ ä¸€ä¸ªå¸¦æœ‰å¤šä¸ª<strong>WebæœåŠ¡å™¨</strong>çš„<strong>è´Ÿè½½å¹³è¡¡å™¨</strong>ã€<strong>CDN</strong>ã€<strong>ä¸»ä»å¤åˆ¶</strong>ï¼Œå¯ä»¥è§£å†³å“ªäº›é—®é¢˜ï¼Ÿå„è‡ªçš„æ›¿ä»£æ–¹æ¡ˆå’Œ<strong>åˆ©å¼Šæƒè¡¡</strong>æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æˆ‘ä»¬å°†ä»‹ç»ä¸€äº›ç»„ä»¶æ¥å®Œæˆè®¾è®¡å¹¶è§£å†³å¯æ‰©å±•æ€§é—®é¢˜ã€‚å†…éƒ¨è´Ÿè½½å‡è¡¡å™¨æ²¡æœ‰æ˜¾ç¤ºï¼Œä»¥å‡å°‘æ··ä¹±ã€‚</p><p><em>ä¸ºäº†é¿å…é‡å¤è®¨è®º</em>ï¼Œè¯·å‚è€ƒä¸‹é¢çš„<a href="https://github.com/donnemartin/system-design-primer#index-of-system-design-topics" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ä¸»é¢˜</a>æ¥äº†è§£ä¸»è¦çš„è®ºæ–‡è¦ç‚¹ã€åˆ©å¼Šæƒè¡¡å’Œæ›¿ä»£æ–¹æ¡ˆã€‚</p><ul><li><a href="https://github.com/donnemartin/system-design-primer#domain-name-system" target="_blank" rel="noopener">DNS</a></li><li><a href="https://github.com/donnemartin/system-design-primer#content-delivery-network" target="_blank" rel="noopener">CDN</a></li><li><a href="https://github.com/donnemartin/system-design-primer#load-balancer" target="_blank" rel="noopener">Load balancer</a></li><li><a href="https://github.com/donnemartin/system-design-primer#horizontal-scaling" target="_blank" rel="noopener">Horizontal scaling</a></li><li><a href="https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server" target="_blank" rel="noopener">Web server (reverse proxy)</a></li><li><a href="https://github.com/donnemartin/system-design-primer#application-layer" target="_blank" rel="noopener">API server (application layer)</a></li><li><a href="https://github.com/donnemartin/system-design-primer#cache" target="_blank" rel="noopener">Cache</a></li><li><a href="https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms" target="_blank" rel="noopener">Relational database management system (RDBMS)</a></li><li><a href="https://github.com/donnemartin/system-design-primer#fail-over" target="_blank" rel="noopener">SQL write master-slave failover</a></li><li><a href="https://github.com/donnemartin/system-design-primer#master-slave-replication" target="_blank" rel="noopener">Master-slave replication</a></li><li><a href="https://github.com/donnemartin/system-design-primer#consistency-patterns" target="_blank" rel="noopener">Consistency patterns</a></li><li><a href="https://github.com/donnemartin/system-design-primer#availability-patterns" target="_blank" rel="noopener">Availability patterns</a></li></ul><p><strong>æ•°æ®åº“åˆ†æ</strong>å¯ä»¥ä½¿ç”¨æ•°æ®ä»“åº“è§£å†³æ–¹æ¡ˆï¼Œå¦‚äºšé©¬é€Š Redshift æˆ–è°·æ­Œ BigQueryã€‚</p><p>åƒäºšé©¬é€ŠS3è¿™æ ·çš„<strong>å¯¹è±¡å­˜å‚¨</strong>å¯ä»¥ä»å®¹åœ°å¤„ç†æ¯æœˆ12.7 GB çš„æ–°å†…å®¹çš„çº¦æŸã€‚</p><p>ä¸ºäº†è§£å†³æ¯ç§’40æ¬¡çš„å¹³å‡è¯»å–è¯·æ±‚ï¼ˆé«˜å³°æ—¶æ›´é«˜ï¼‰ï¼Œçƒ­é—¨å†…å®¹çš„æµé‡åº”è¯¥ç”±<strong>å†…å­˜ç¼“å­˜</strong>è€Œä¸æ˜¯æ•°æ®åº“æ¥å¤„ç†ã€‚<strong>å†…å­˜ç¼“å­˜</strong>å¯¹äºå¤„ç†åˆ†å¸ƒä¸å‡çš„æµé‡å’Œæµé‡é«˜å³°ä¹Ÿå¾ˆæœ‰ç”¨ã€‚<strong>SQL Read å¤šå‰¯æœ¬</strong>åº”è¯¥èƒ½å¤Ÿå¤„ç†ç¼“å­˜çš„ç¼ºå¤±ï¼Œåªè¦å‰¯æœ¬æ²¡æœ‰è¢«å‰¯æœ¬å†™å…¥æ‰€æ‹–ç´¯ã€‚</p><p>å¯¹äºå•ä¸ª<strong>SQL Write ä¸»ä»</strong>æ¥è¯´ï¼Œæ¯ç§’<em>å¹³å‡</em>4æ¬¡ç²˜è´´å†™ï¼ˆé«˜å³°æ—¶æ›´å¤šï¼‰åº”è¯¥æ˜¯å¯ä»¥åšåˆ°çš„ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬å°±éœ€è¦é‡‡ç”¨é¢å¤–çš„SQLæ‰©å±•æ¨¡å¼ã€‚</p><ul><li><a href="https://github.com/donnemartin/system-design-primer#federation" target="_blank" rel="noopener">Federation</a></li><li><a href="https://github.com/donnemartin/system-design-primer#sharding" target="_blank" rel="noopener">Sharding</a></li><li><a href="https://github.com/donnemartin/system-design-primer#denormalization" target="_blank" rel="noopener">Denormalization</a></li><li><a href="https://github.com/donnemartin/system-design-primer#sql-tuning" target="_blank" rel="noopener">SQL Tuning</a></li></ul><p>æˆ‘ä»¬è¿˜åº”è¯¥è€ƒè™‘å°†ä¸€äº›æ•°æ®è½¬ç§»åˆ°<strong>NoSQLæ•°æ®åº“</strong>ã€‚</p><h2 id="é¢å¤–çš„è®¨è®ºè¦ç‚¹"><a class="markdownIt-Anchor" href="#é¢å¤–çš„è®¨è®ºè¦ç‚¹"></a> é¢å¤–çš„è®¨è®ºè¦ç‚¹</h2><blockquote><p>æ ¹æ®é—®é¢˜çš„èŒƒå›´å’Œå‰©ä½™æ—¶é—´ï¼Œå¯ä»¥æ·±å…¥ç ”ç©¶å…¶ä»–çš„è¯é¢˜ã€‚</p></blockquote><h4 id="nosql"><a class="markdownIt-Anchor" href="#nosql"></a> NoSQL</h4><ul><li><a href="https://github.com/donnemartin/system-design-primer#key-value-store" target="_blank" rel="noopener">Key-value store</a></li><li><a href="https://github.com/donnemartin/system-design-primer#document-store" target="_blank" rel="noopener">Document store</a></li><li><a href="https://github.com/donnemartin/system-design-primer#wide-column-store" target="_blank" rel="noopener">Wide column store</a></li><li><a href="https://github.com/donnemartin/system-design-primer#graph-database" target="_blank" rel="noopener">Graph database</a></li><li><a href="https://github.com/donnemartin/system-design-primer#sql-or-nosql" target="_blank" rel="noopener">SQL vs NoSQL</a></li></ul><h3 id="ç¼“å­˜"><a class="markdownIt-Anchor" href="#ç¼“å­˜"></a> ç¼“å­˜</h3><ul><li>ç¼“å­˜åˆ°å“ªé‡Œï¼Ÿ<ul><li><a href="https://github.com/donnemartin/system-design-primer#client-caching" target="_blank" rel="noopener">Client caching</a></li><li><a href="https://github.com/donnemartin/system-design-primer#cdn-caching" target="_blank" rel="noopener">CDN caching</a></li><li><a href="https://github.com/donnemartin/system-design-primer#web-server-caching" target="_blank" rel="noopener">Web server caching</a></li><li><a href="https://github.com/donnemartin/system-design-primer#database-caching" target="_blank" rel="noopener">Database caching</a></li><li><a href="https://github.com/donnemartin/system-design-primer#application-caching" target="_blank" rel="noopener">Application caching</a></li></ul></li><li>ç¼“å­˜ä»€ä¹ˆï¼Ÿ<ul><li><a href="https://github.com/donnemartin/system-design-primer#caching-at-the-database-query-level" target="_blank" rel="noopener">Caching at the database query level</a></li><li><a href="https://github.com/donnemartin/system-design-primer#caching-at-the-object-level" target="_blank" rel="noopener">Caching at the object level</a></li></ul></li><li>ä½•æ—¶æ›´æ–°ç¼“å­˜ï¼Ÿ<ul><li><a href="https://github.com/donnemartin/system-design-primer#cache-aside" target="_blank" rel="noopener">Cache-aside</a></li><li><a href="https://github.com/donnemartin/system-design-primer#write-through" target="_blank" rel="noopener">Write-through</a></li><li><a href="https://github.com/donnemartin/system-design-primer#write-behind-write-back" target="_blank" rel="noopener">Write-behind (write-back)</a></li><li><a href="https://github.com/donnemartin/system-design-primer#refresh-ahead" target="_blank" rel="noopener">Refresh ahead</a></li></ul></li></ul><h3 id="å¼‚æ­¥æ€§å’Œå¾®æœåŠ¡"><a class="markdownIt-Anchor" href="#å¼‚æ­¥æ€§å’Œå¾®æœåŠ¡"></a> å¼‚æ­¥æ€§å’Œå¾®æœåŠ¡</h3><ul><li><a href="https://github.com/donnemartin/system-design-primer#message-queues" target="_blank" rel="noopener">Message queues</a></li><li><a href="https://github.com/donnemartin/system-design-primer#task-queues" target="_blank" rel="noopener">Task queues</a></li><li><a href="https://github.com/donnemartin/system-design-primer#back-pressure" target="_blank" rel="noopener">Back pressure</a></li><li><a href="https://github.com/donnemartin/system-design-primer#microservices" target="_blank" rel="noopener">Microservices</a></li></ul><h3 id="é€šä¿¡"><a class="markdownIt-Anchor" href="#é€šä¿¡"></a> é€šä¿¡</h3><ul><li>å¯¹åˆ©å¼Šæƒè¡¡è¿›è¡Œè®¨è®ºï¼š<ul><li>ä¸å®¢æˆ·çš„å¤–éƒ¨é€šä¿¡ - <a href="https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest" target="_blank" rel="noopener">HTTP APIs following REST</a><ul><li>å†…éƒ¨é€šä¿¡ - <a href="https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc" target="_blank" rel="noopener">RPC</a></li></ul></li></ul></li><li><a href="https://github.com/donnemartin/system-design-primer#service-discovery" target="_blank" rel="noopener">æœåŠ¡å‘ç°</a></li></ul><h3 id="å®‰å…¨"><a class="markdownIt-Anchor" href="#å®‰å…¨"></a> å®‰å…¨</h3><p>è§ <a href="https://github.com/donnemartin/system-design-primer#security" target="_blank" rel="noopener">security section</a>.</p><h3 id="å»¶è¿Ÿæ•°"><a class="markdownIt-Anchor" href="#å»¶è¿Ÿæ•°"></a> å»¶è¿Ÿæ•°</h3><p>è§ <a href="https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know" target="_blank" rel="noopener">æ¯ä¸ªç¨‹åºå‘˜åº”è¯¥çŸ¥é“çš„å»¶è¿Ÿæ•°å­—</a>ã€‚</p><h3 id="æŒç»­æ¨è¿›"><a class="markdownIt-Anchor" href="#æŒç»­æ¨è¿›"></a> æŒç»­æ¨è¿›</h3><ul><li>ç»§ç»­å¯¹ä½ çš„ç³»ç»Ÿè¿›è¡ŒåŸºå‡†æµ‹è¯•å’Œç›‘æµ‹ï¼Œä»¥è§£å†³å‡ºç°çš„ç“¶é¢ˆé—®é¢˜</li><li>æ‰©å±•æ˜¯ä¸€ä¸ªåå¤çš„è¿‡ç¨‹</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;è®¾è®¡pastebincom&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#è®¾è®¡pastebincom&quot;&gt;&lt;/a&gt; &lt;a href=&quot;http://xn--Pastebin-xx5xji.com&quot; target=&quot;_blank&quot; rel=
      
    
    </summary>
    
    
      <category term="ç¿»è¯‘" scheme="https://nymrli.top/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="ç³»ç»Ÿè®¾è®¡" scheme="https://nymrli.top/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>ç†äº†ä¸€å¤©å½»åº•å¼„æ‡‚å…ƒç±»â€”â€”åˆ†äº«ç»™ä½ ä¸€èµ·å¼„æ‡‚</title>
    <link href="https://nymrli.top/2022/04/05/%E7%90%86%E4%BA%86%E4%B8%80%E5%A4%A9%E5%BD%BB%E5%BA%95%E5%BC%84%E6%87%82%E5%85%83%E7%B1%BB%E2%80%94%E2%80%94%E5%88%86%E4%BA%AB%E7%BB%99%E4%BD%A0%E4%B8%80%E8%B5%B7%E5%BC%84%E6%87%82/"/>
    <id>https://nymrli.top/2022/04/05/ç†äº†ä¸€å¤©å½»åº•å¼„æ‡‚å…ƒç±»â€”â€”åˆ†äº«ç»™ä½ ä¸€èµ·å¼„æ‡‚/</id>
    <published>2022-04-05T05:26:39.000Z</published>
    <updated>2022-04-05T05:42:12.847Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ä¸€ä¸ªåœ¨çœ‹å¼€æºä»£ç æ—¶é…åˆ°äº†å•ä¾‹å…ƒç±»å†™æ³•åçš„ä¸€ä¸ªåŸç†è´´ï¼Œå¯ä»¥å¸®ä½ å½»åº•å¼„æ¸…å…ƒç±»ã€ä»¥åŠ<code>__new__</code>å’Œ<code>__call__</code>ï¼Œç›¸ä¿¡æˆ‘ï¼Œçœ‹å®Œä½ ç»å¯¹ä¼šæœ‰æ”¶è·ã€‚</p><p>é¦–å…ˆï¼Œå…³äºå…ƒç±»çš„ç»“è®ºè¯´åœ¨å‰å¤´ï¼Œå…ˆæœ‰ä¸ªå°è±¡â€”â€”<strong>å°æ€»ç»“</strong>ï¼š</p><ul><li>ç°åœ¨æˆ‘ä»¬èƒ½çŸ¥é“ä¸ºä»€ä¹ˆå…ƒç±»å¿…é¡»ç»§æ‰¿typeäº†ï¼šå› ä¸ºæˆ‘ä»¬å®ä¾‹åŒ–å¯¹è±¡<code>Foo(xxx)</code>æ—¶è°ƒç”¨äº†<code>type.__call__</code>,è€Œ<code>type.__call__</code>åˆä¼šè°ƒç”¨<code>type.__new__</code>å› æ­¤å¦‚æœtypeå­ç±»é‡å†™å®ç°äº†<code>__new__</code>ï¼ˆè¿”å›çš„ç±»å®ä¾‹å¯¹è±¡çš„ç±»å‹ä½œæ§åˆ¶ï¼‰ã€<code>__call__</code>ï¼ˆå¯¹å®ä¾‹åŒ–çš„æµç¨‹åšæ§åˆ¶ï¼‰ï¼Œåˆ™å¯ä»¥å¯¹<strong>ç±»å¯¹è±¡çš„ç±»å‹å’Œç±»å±æ€§</strong>èµ·åˆ°è‡ªå®šä¹‰çš„åŠŸèƒ½ï¼Œè€Œé‡å†™å°±å¿…é¡»ç»§æ‰¿type=&gt;éœ€è¦å…ƒç±»å¿…é¡»ç»§æ‰¿type</li><li>æ‰€ä»¥æŒ‰ç…§ä¸Šè¿°çš„é€»è¾‘ï¼Œå¦‚æœå®šä¹‰äº†ä¸€ä¸ªå…ƒç±»è®©è‡ªå®šä¹‰ç±»ç”¨çš„è¯<code>class Foo(metaclass=MyMetaClass)</code>ï¼Œåœ¨å…¶å®ä¾‹åŒ–è¿‡ç¨‹ä¸­<code>Foo()</code>ä¼šç›´æ¥è°ƒç”¨é‡å†™åçš„<code>MyMetaClass.__call__</code>ï¼Œè€Œåªè¦è®°ä½åœ¨<code>MyMetaClass.__call__</code>ä¸­ä½¿ç”¨åˆ°<code>return super(Singleton, cls).__call__(*args, **kwargs)</code>å°±å¯ä»¥æŠŠ<code>type.__call__</code>ç”Ÿæˆçš„å®ä¾‹è¿”å›å•¦ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ<u>ç¼–å†™å…ƒç±»ï¼Œä¸€èˆ¬éƒ½æ˜¯ç»§æ‰¿äº†typeï¼Œç„¶åæ ¹æ®æƒ³æ§åˆ¶å®ä¾‹åŒ–æµç¨‹å°±é‡å†™<code>__call__</code>æ–¹æ³•ï¼Œæƒ³æ·»åŠ å±æ€§å°±é‡å†™<code>__new__</code>æ–¹æ³•å°±è¡Œäº†ã€‚</u></li><li><strong>â˜…å…ƒç±»äº§ç”Ÿå½±å“çš„æ—¶é—´ç‚¹æ˜¯åœ¨å®ä¾‹åŒ–çš„æ—¶å€™</strong></li></ul></blockquote><p>çœ‹å¼€æºä»£ç æ—¶ï¼Œçœ‹åˆ°äº†ä¸‹é¢ä¸€æ®µä»£ç ï¼Œäºæ˜¯å¯¹withMetaclassäº§ç”Ÿäº†å¥½å¥‡ï¼Œç»è¿‡äº†è§£å‘ç°å…¶ä½œç”¨æ˜¯sixå¯¹python2å’Œpython3ä½¿ç”¨å…ƒç±»å…¼å®¹çš„å†™æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python2å’Œ3å…¼å®¹ä½¿ç”¨å…ƒç±»å†™æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œä¸Šè¿°ä»£ç åœ¨Python3ä¸­ç›¸å½“äº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3å…ƒç±»ä½¿ç”¨å†™æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(metaclass=Singleton)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼ŒwithMetaclassåˆ°åº•æ˜¯æ€ä¹ˆå®ç°å…¼å®¹çš„å‘¢ï¼Ÿä¸‹é¢æ˜¯å…¶å®ç°ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withMetaclass</span><span class="params">(meta, *bases)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MetaClass</span><span class="params">(meta)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, this_bases, d)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> meta(name, bases, d)</span><br><span class="line">    <span class="keyword">return</span> type.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å…¶ä¸­å‡ºç°äº†ä¸å°‘æˆ‘ä»¬å¾ˆå°‘çœ‹åˆ°çš„ä½¿ç”¨æ–¹æ³•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä»”ç»†çš„å­¦ä¹ ä¸Šè¿°å†™æ³•ä¸ºä»€ä¹ˆå¯ä»¥æˆåŠŸã€‚</p><p>å…ƒç±»ä½¿ç”¨å¯ä»¥å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/49158035" target="_blank" rel="noopener">Python3 å…ƒç±»ï¼ˆmetaclassï¼‰</a></p><h3 id="é¢„ç½®çŸ¥è¯†typeå’Œobject"><a class="markdownIt-Anchor" href="#é¢„ç½®çŸ¥è¯†typeå’Œobject"></a> é¢„ç½®çŸ¥è¯†ï¼štypeå’Œobject</h3><blockquote><p>object å’Œ typeçš„å…³ç³»å¾ˆåƒé¸¡å’Œè›‹çš„å…³ç³»ï¼Œå…ˆæœ‰objectè¿˜æ˜¯å…ˆæœ‰typeæ²¡æ³•è¯´ï¼Œobejctå’Œtypeæ˜¯å…±ç”Ÿçš„å…³ç³»ï¼Œå¿…é¡»åŒæ—¶å‡ºç°çš„ã€‚</p><p>è®°ä½ä¸€ç‚¹ï¼š<strong>åœ¨Pythoné‡Œé¢ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡çš„æ¦‚å¿µ</strong>ï¼Œå³åŒ…æ‹¬ç±»ï¼ˆç±»æ˜¯typeçš„å®ä¾‹å¯¹è±¡ï¼‰</p></blockquote><p>æœ€é‡è¦çš„ä¸¤ç‚¹</p><ul><li>objectç±»æ˜¯æ‰€æœ‰ç±»çš„è¶…ç±»ï¼ˆä¹Ÿæ˜¯typeç±»çš„çˆ¶ç±»ï¼‰</li><li>typeæ˜¯æ‰€æœ‰ç±»çš„ç±»ï¼ˆç±»å‹ï¼Œæ‰€æœ‰ç±»éƒ½æ˜¯typeçš„å®ä¾‹å¯¹è±¡ï¼Œobject<u>ç±»å‹</u>ä¹Ÿæ˜¯typeçš„å®ä¾‹å¯¹è±¡ï¼›type åˆ›å»ºçš„å¯¹è±¡æ‹¥æœ‰åˆ›å»ºå¯¹è±¡çš„èƒ½åŠ›(ä¹Ÿå°±æ˜¯ç±»)ï¼‰â€“&gt;æ˜¯æ‰€æœ‰ç±»çš„å…ƒç±»</li></ul><p>æ­¤å¤–ï¼š</p><ul><li>typeæ˜¯æ‰€æœ‰<strong>å…ƒç±»</strong>çš„çˆ¶äº²ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>ç»§æ‰¿typeæ¥åˆ›å»ºå…ƒç±»</strong>ï¼ˆé€šè¿‡é‡å†™<code>type.__new__</code>å’Œ<code>type.__call__</code>æ¥æ‹¦æˆªè‡ªå®šä¹‰ç±»çš„åˆ›å»ºè¿‡ç¨‹ï¼‰ã€‚</li><li>objectæ˜¯æ‰€æœ‰ç±»çš„çˆ¶äº²ã€‚</li><li>å®ä¾‹æ˜¯å¯¹è±¡å…³ç³»é“¾çš„æœ«ç«¯ï¼Œä¸èƒ½å†è¢«å­ç±»åŒ–å’Œå®ä¾‹åŒ–ã€‚</li></ul><p>äº†è§£åˆ°è¿™äº›å…³é”®çš„ç‚¹åï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä»£ç ä¸­å‡ºç°çš„ä¸€äº›å†…å®¹ï¼š</p><h3 id="__new__"><a class="markdownIt-Anchor" href="#__new__"></a> <code>__new__</code></h3><blockquote><p><code>__new__()</code> æ˜¯ä¸€ç§è´Ÿè´£<strong>åˆ›å»ºç±»å®ä¾‹</strong>çš„<strong>é™æ€æ–¹æ³•</strong>ï¼Œå®ƒæ— éœ€ä½¿ç”¨ staticmethod è£…é¥°å™¨ä¿®é¥°ï¼Œä¸”è¯¥æ–¹æ³•ä¼šä¼˜å…ˆ <code>__init__()</code> åˆå§‹åŒ–æ–¹æ³•è¢«è°ƒç”¨ã€‚</p></blockquote><p><code>__new__()</code>é€šå¸¸ä¼šè¿”å›è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šè¿”å›å…¶ä»–ç±»çš„å®ä¾‹ï¼Œå…¶<code>super().__new__(cls)</code>ä¸­ä¼šè°ƒç”¨<code>object.__init__</code>æ¥<code>Create and return a new object.</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å†™å­ç±»çš„<code>__new__</code>å¯ä»¥æ·»åŠ ä¸€äº›é€»è¾‘æ¥æ§åˆ¶å®ä¾‹çš„äº§ç”Ÿï¼Œç„¶åå†é€šè¿‡<code>super().__new__(cls)</code>æ¥ç”Ÿæˆä¸€ä¸ªinstanceå¹¶è¿”å›ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demoClass</span>:</span></span><br><span class="line">    instances_created = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># __new__(): &lt;class '__main__.demoClass'&gt; ('abc',) &#123;&#125;</span></span><br><span class="line">        print(<span class="string">"__new__():"</span>, cls, args, kwargs)</span><br><span class="line">        <span class="comment"># 1. é€šè¿‡çˆ¶ç±»__new__ç”Ÿæˆä¸€ä¸ªå®ä¾‹: è°ƒç”¨çˆ¶ç±»object.__new__ç”Ÿæˆå®ä¾‹(Create and return a new object.) </span></span><br><span class="line">        instance = super().__new__(cls)</span><br><span class="line">        <span class="comment"># 2. è‡ªå·±é‡å†™è¦å®ç°çš„é€»è¾‘</span></span><br><span class="line">        instance.number = cls.instances_created</span><br><span class="line">        cls.instances_created += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 3. å°†çˆ¶ç±»ç”Ÿæˆçš„å®ä¾‹è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, attribute)</span>:</span></span><br><span class="line">        <span class="comment"># __init__(): &lt;__main__.demoClass object at 0x00000185A6466EB0&gt; abc</span></span><br><span class="line">        print(<span class="string">"__init__():"</span>, self, attribute)</span><br><span class="line">        self.attribute = attribute</span><br><span class="line"></span><br><span class="line">test1 = demoClass(<span class="string">"abc"</span>)</span><br><span class="line">test2 = demoClass(<span class="string">"xyz"</span>)</span><br><span class="line">print(test1.number, test1.instances_created)</span><br><span class="line">print(test2.number, test2.instances_created)</span><br></pre></td></tr></table></figure><p>Q:ä»€ä¹ˆæƒ…å†µä¸‹é‡å†™ç±»çš„<code>__new__()</code>å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œåœ¨<code>__init__()</code>ä¸å¤Ÿç”¨çš„æ—¶å€™ã€‚</p><p><code>__new__()</code>é€šå¸¸ä¼šè¿”å›è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šè¿”å›å…¶ä»–ç±»çš„å®ä¾‹ï¼Œå¦‚æœå‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼Œåˆ™ä¼šè·³è¿‡å¯¹ <code>__init__()</code>æ–¹æ³•çš„è°ƒç”¨ã€‚è€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚éœ€è¦ä¿®æ”¹<strong>ä¸å¯å˜ç±»å®ä¾‹</strong>ï¼ˆ<a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> çš„æŸäº›å†…ç½®ç±»å‹ï¼‰çš„åˆ›å»ºè¡Œä¸ºï¼‰ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ä¼šäº‹åŠåŠŸå€ã€‚æ¯”å¦‚ï¼š<a href="http://c.biancheng.net/view/5484.html%EF%BC%8C%E5%AF%B9" target="_blank" rel="noopener">http://c.biancheng.net/view/5484.htmlï¼Œå¯¹</a> Python ä¸å¯å˜çš„å†…ç½®ç±»å‹ï¼ˆå¦‚ intã€strã€float ç­‰ï¼‰è¿›è¡Œäº†å­ç±»åŒ–ï¼Œè¿™æ˜¯å› ä¸ºä¸€æ—¦åˆ›å»ºäº†è¿™æ ·ä¸å¯å˜çš„å¯¹è±¡å®ä¾‹ï¼Œå°±æ— æ³•åœ¨<code>__init__()</code>æ–¹æ³•ä¸­å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>æ³¨ï¼šç”±äº <code>__new__()</code> ä¸é™äºè¿”å›åŒä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è¢«æ»¥ç”¨ï¼Œä¸è´Ÿè´£ä»»åœ°ä½¿ç”¨è¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¯¹ä»£ç æœ‰å®³ï¼Œæ‰€ä»¥è¦è°¨æ…ä½¿ç”¨ã€‚</p><h3 id="metaclasså…ƒç±»"><a class="markdownIt-Anchor" href="#metaclasså…ƒç±»"></a> <a href="http://c.biancheng.net/view/2293.html" target="_blank" rel="noopener">MetaClasså…ƒç±»</a></h3><blockquote><p>æ‰¿æ¥ä¸Šæ–‡<code>__new__</code>ï¼ŒPythonä¸­å¤§é‡ä½¿ç”¨<code>__new__()</code>æ–¹æ³•ä¸”åˆç†çš„åœ°æ–¹ï¼Œå°±æ˜¯ MetaClass å…ƒç±»ã€‚</p><p>MetaClasså…ƒç±»ï¼Œå¹¶ä¸æ˜¯æŸä¸€ä¸ªç±»çš„åå­—ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œæ˜¯ä¸€ç§Pythonçš„æ€æƒ³ã€‚å½“ç„¶å…¶æœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œä½†å’Œæ™®é€šç±»çš„ç”¨æ³•ä¸åŒï¼Œå®ƒå¯ä»¥å¯¹<strong>ç±»å†…éƒ¨çš„å®šä¹‰</strong>ï¼ˆåŒ…æ‹¬ç±»å±æ€§å’Œç±»æ–¹æ³•ï¼‰è¿›è¡Œ<strong>åŠ¨æ€çš„ä¿®æ”¹</strong>ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œä½¿ç”¨å…ƒç±»çš„ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å®ç°åœ¨åˆ›å»ºç±»æ—¶ï¼Œèƒ½å¤ŸåŠ¨æ€åœ°æ”¹å˜ç±»ä¸­å®šä¹‰çš„å±æ€§æˆ–è€…æ–¹æ³•ã€‚å…¶å¯ä»¥å°†<strong>åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹æ‹¦æˆª</strong>ä¸‹æ¥ï¼Œä»è€Œå¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè‡ªå®šä¹‰ï¼ˆè¿™ä¸ªéœ€è¦<strong>ç±»ç»§æ‰¿type</strong>ï¼Œä¸å‰æ–‡ç»§æ‰¿objectçš„åšåŒºåˆ«ï¼‰ã€‚</p><p>æ˜ç¡®ä¸€ç‚¹ï¼šå…ƒç±»å¯ä»¥ç†è§£æˆæ˜¯è‡ªå®šä¹‰ç±»ç»§æ‰¿çš„çˆ¶ç±»ï¼ˆä»å…¼å®¹å†™æ³•ä¸­ä¹Ÿèƒ½çœ‹å‡ºï¼‰ï¼Œä½†å…ƒç±»çš„ç‰¹ç‚¹æ˜¯<strong>ä¸ä¼šå‡ºç°åœ¨è‡ªå®šä¹‰ç±»çš„ç»§æ‰¿å…³ç³»(<code>__mro__</code>)ä¹‹ä¸­</strong></p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ ¹æ®å®é™…åœºæ™¯çš„éœ€è¦ï¼Œæˆ‘ä»¬è¦ä¸ºå¤šä¸ªç±»æ·»åŠ ä¸€ä¸ª name å±æ€§å’Œä¸€ä¸ª say() æ–¹æ³•ã€‚æ˜¾ç„¶æœ‰å¤šç§æ–¹æ³•å¯ä»¥å®ç°ï¼Œä½†å…¶ä¸­ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨ MetaClass å…ƒç±»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªå…ƒç±»ï¼Œç»§æ‰¿typeã€‚å› ä¸ºåªæœ‰ç»§æ‰¿typeæ‰èƒ½é€šè¿‡é‡å†™__new__æ¥æ‹¦æˆªåˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line"><span class="comment"># â–²æ³¨æ„ï¼Œç»§æ‰¿typeå__new__èƒ½æ‹¿åˆ°çš„å‚æ•°ä¿¡æ¯è·Ÿä¸ç»§æ‰¿typeçš„æœ‰å¤©å£¤ä¹‹åˆ«ï¼ŒåŸå› ç»§ç»­çœ‹ä¸‹å»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FirstMetaClass</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="comment"># clsä»£è¡¨å…ƒç±»çš„ç±»: FirstMetaClass</span></span><br><span class="line">    <span class="comment"># nameä»£è¡¨è‡ªå®šä¹‰ç±»çš„ç±»å: CLanguage</span></span><br><span class="line">    <span class="comment"># basesä»£è¡¨è¢«åŠ¨æ€ä¿®æ”¹çš„ç±»çš„æ‰€æœ‰çˆ¶ç±»</span></span><br><span class="line">    <span class="comment"># atträ»£è¡¨è¢«åŠ¨æ€ä¿®æ”¹çš„ç±»çš„æ‰€æœ‰å±æ€§ã€æ–¹æ³•ç»„æˆçš„å­—å…¸</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, attrs)</span>:</span></span><br><span class="line">        <span class="comment"># åŠ¨æ€ä¸ºè¯¥ç±»æ·»åŠ ä¸€ä¸ªnameå±æ€§</span></span><br><span class="line">        attrs[<span class="string">'name'</span>] = <span class="string">"Cè¯­è¨€ä¸­æ–‡ç½‘"</span></span><br><span class="line">        attrs[<span class="string">'say'</span>] = <span class="keyword">lambda</span> self: print(<span class="string">"è°ƒç”¨ say() å®ä¾‹æ–¹æ³•"</span>)</span><br><span class="line">        <span class="keyword">return</span> super().__new__(cls,name,bases,attrs)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># å®šä¹‰ç±»æ—¶ï¼ŒæŒ‡å®šå…ƒç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CLanguage</span><span class="params">(object, metaclass=FirstMetaClass)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">clangs = CLanguage()</span><br><span class="line">print(clangs.name)</span><br><span class="line">clangs.say()</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆ›å»ºç±»æ—¶ï¼Œé€šè¿‡åœ¨æ ‡æ³¨çˆ¶ç±»çš„åŒæ—¶æŒ‡å®šå…ƒç±»ï¼ˆæ ¼å¼ä¸º<code>metaclass=å…ƒç±»å</code>ï¼‰ï¼Œåˆ™å½“ <a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> è§£é‡Šå™¨åœ¨åˆ›å»ºè¯¥ç±»å®ä¾‹æ—¶ï¼Œ<code>FirstMetaClass(type)</code>å…ƒç±»ä¸­çš„<code>__new__</code>æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œå…¶ä¸­baseså’Œattrsèƒ½æ‹¿åˆ°è‡ªå®šä¹‰ç±»çš„å‚æ•°ï¼Œä»è€Œå®ç°åŠ¨æ€ä¿®æ”¹ç±»å±æ€§æˆ–è€…ç±»æ–¹æ³•çš„ç›®çš„ã€‚</p><p><strong>å…ƒç±»å’Œçˆ¶ç±»çš„åŒºåˆ«ï¼š</strong></p><p>åœ¨å®šä¹‰å­ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šâ‘ æ˜¯ä¼ éœ€è¦ç»§æ‰¿çš„çˆ¶ç±»ï¼›â‘¡è‡ªå®šä¹‰çš„å…ƒç±»ã€‚</p><ul><li>çˆ¶ç±»æ˜¯å­ç±»çš„æ¨¡æ¿ï¼Œå­ç±»çš„åŠŸèƒ½æ˜¯è·Ÿçˆ¶ç±»ç´§è€¦åˆçš„ï¼Œå­ç±»å’Œçˆ¶ç±»ä¸€èˆ¬æ˜¯ä¸€ä¸€å¯¹åº”çš„</li><li>å…ƒç±»æ˜¯å­ç±»çš„ä¿®é¥°å™¨ï¼Œå¯ä»¥ä¸ºè¯¥å­ç±»å’Œå…¶ä»–å­ç±»éƒ½æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸åœ¨ç»§æ‰¿å…³ç³»ä¸­(<code>Class.__mro__</code>æŸ¥çœ‹)ï¼Œå­ç±»å’Œå…ƒç±»æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚å…ƒç±»å¹¶ä¸æ˜¯ç‰¹åœ°ä¸ºæŸä¸ªå­ç±»æœåŠ¡çš„</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMeta3</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, attrs)</span>:</span></span><br><span class="line">        print(cls)    <span class="comment"># å½“å‰ç±» </span></span><br><span class="line">        print(<span class="string">"name"</span>, name)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„ç±»å‹</span></span><br><span class="line">        print(<span class="string">"bases"</span>, bases)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„çˆ¶ç±»</span></span><br><span class="line">        print(<span class="string">"attrs"</span>, attrs)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„å±æ€§</span></span><br><span class="line">        <span class="keyword">return</span> type.__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pa3</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python3ä¸­å¯ä»¥ç›´æ¥é€šè¿‡metaclasså…³é”®å­—å‚æ•°æ¥æŒ‡å®šç±»çš„å…ƒç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Eg3</span><span class="params">(Pa3, metaclass=TestMeta3)</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self)</span>:</span></span><br><span class="line">        kkk = []</span><br><span class="line">        kkk.append(self.__skiless__)</span><br><span class="line">        <span class="keyword">return</span> kkk</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">acc2</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'a2'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è¾“å‡º</span></span><br><span class="line"><span class="string">&lt;class '__main__.TestMeta3'&gt;</span></span><br><span class="line"><span class="string">name Eg3</span></span><br><span class="line"><span class="string">bases (&lt;class '__main__.Pa3'&gt;,)</span></span><br><span class="line"><span class="string">attrs &#123;'__module__': '__main__', '__qualname__': 'Eg3', 'get': &lt;classmethod object at 0x00000263511C6FA0&gt;, 'acc2': &lt;function Eg3.acc2 at 0x00000263511C5310&gt;&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œå‘ç°ç«Ÿç„¶æœ‰è¾“å‡ºã€‚å› ä¸ºå®šä¹‰çš„æ—¶å€™ï¼Œpythonè§£é‡Šå™¨ä¼šåœ¨å½“å‰ç±»ä¸­æŸ¥æ‰¾metaclass[3]ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±<strong>ä½¿ç”¨è¯¥metaclassåˆ›å»ºEg3ç±»</strong>ã€‚æ‰€ä»¥æ‰“å°å‡ºæ¥çš„nameã€basesã€attrséƒ½å’ŒEg3æœ‰å…³ã€‚</p><p><strong>with_metaclass</strong></p><blockquote><p>ç”±äºpython2å’Œpython3ä¸­å…ƒç±»ä½¿ç”¨æ–¹æ³•çš„ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ç§å…¼å®¹çš„æ–¹å¼[1]ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withMetaclass</span><span class="params">(meta, *bases)</span>:</span></span><br><span class="line">    <span class="string">"""Create a base class with a metaclass."""</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MetaClass</span><span class="params">(meta)</span>:</span></span><br><span class="line"><span class="comment"># å¦‚æœåˆ é™¤__new__ï¼Œåˆ™ç±».__mro__ä¸­èƒ½çœ‹åˆ°metaç±»</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, this_bases, d)</span>:</span></span><br><span class="line">            <span class="comment"># å› ä¸ºmetaæ˜¯ç±»ï¼Œæ‰€ä»¥è¿™è¾¹æ˜¯åœ¨è°ƒç”¨metaçš„__call__()ã€‚â–²basesï¼Œdä¸ºConfigHandlerçš„çˆ¶ç±»å’Œå±æ€§</span></span><br><span class="line">            <span class="keyword">return</span> meta(name, bases, d)</span><br><span class="line"><span class="comment"># è¿”å›ä¸€ä¸ªæ–°ç±»å‹, type.__new__()è¦æ±‚ç¬¬ä¸€ä¸ªå¿…é¡»æ˜¯typeçš„å­ç±»</span></span><br><span class="line">    <span class="keyword">return</span> type.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)</span><br><span class="line"><span class="comment"># ä¸‹é¢ä¸¤å¥è¯ç­‰ä»·ï¼ŒwithMetaclassæ˜¯ä¸ºäº†å…¼å®¹python2å’Œpython3,2ä¸­æ²¡æœ‰metaclasså…³é”®å­—</span></span><br><span class="line"><span class="comment"># å…¶åœ¨åˆ›å»ºå®ä¾‹æ—¶ï¼Œ__new__æ–¹æ³•ä¼šè¢«MetaClassæ‹¦æˆª(å…¶å®å°±æ˜¯å­ç±»æ²¡å®šä¹‰__new__ï¼Œèµ°äº†çˆ¶ç±»çš„__new__)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span></span></span><br><span class="line"><span class="class"># <span class="title">python3</span>å†™æ³•</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">ConfigHandler</span><span class="params">(metaclass=Singleton)</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"># å› ä¸ºConfigHandlerç›¸å½“äºç»§æ‰¿äº† type.__new__è¿”å›çš„ç±»MetaClassï¼Œæ‰€ä»¥åœ¨c = ConfigHandler()å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šè§¦å‘Metaclassçš„__new__ç„¶åè°ƒç”¨meta.__call__ä»è€Œè¿”å›ä¸€ä¸ªå¯¹è±¡</span><br></pre></td></tr></table></figure><p><code>with_metaclass</code>è¿”å›çš„ä¸´æ—¶ç±»ä¸­ï¼Œæœ¬èº«æ— ä»»ä½•å±æ€§ï¼Œä½†åŒ…å«äº†å…ƒç±»å’ŒåŸºç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¹¶åœ¨<strong>ä¸‹ä¸€æ­¥å®šä¹‰ç±»æ—¶</strong>å°†æ‰€æœ‰ä¿¡æ¯è§£åŒ…å‡ºæ¥[1]ã€‚</p><p>è§ï¼š<a href="https://zhuanlan.zhihu.com/p/354828950" target="_blank" rel="noopener">â˜…Python å…ƒç±»åŠwith_metaclass</a></p><h3 id="type"><a class="markdownIt-Anchor" href="#type"></a> <a href="http://c.biancheng.net/view/2292.html" target="_blank" rel="noopener"><code>type</code>åŠ¨æ€åˆ›å»ºç±»</a></h3><ul><li>type() å‡½æ•°å±äº <a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> å†…ç½®å‡½æ•°ï¼Œé€šå¸¸ç”¨æ¥æŸ¥çœ‹æŸä¸ªå˜é‡çš„å…·ä½“ç±»å‹ã€‚<ul><li><code>type(obj)</code></li></ul></li><li>å…¶å®ï¼Œtype() å‡½æ•°è¿˜æœ‰ä¸€ä¸ªæ›´é«˜çº§çš„ç”¨æ³•ï¼Œå³<strong>åˆ›å»º</strong>ä¸€ä¸ªè‡ªå®šä¹‰<strong>ç±»å‹</strong>ï¼ˆä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªç±»ï¼‰ã€‚<ul><li><code>type(name, bases, dict)</code>ï¼šå…¶ä¸­ name è¡¨ç¤ºç±»çš„åç§°ï¼›bases è¡¨ç¤ºä¸€ä¸ªå…ƒç»„ï¼Œå…¶ä¸­å­˜å‚¨çš„æ˜¯è¯¥ç±»çš„çˆ¶ç±»ï¼›dict è¡¨ç¤ºä¸€ä¸ªå­—å…¸ï¼Œç”¨äºè¡¨ç¤ºç±»å†…å®šä¹‰çš„å±æ€§æˆ–è€…æ–¹æ³•ã€‚</li></ul></li></ul><p>å®é™…ä¸Š<code>type(name, bases, dict)</code>æ˜¯è°ƒç”¨äº†typeç±»çš„<code>type.__init__(cls, what, bases=None, dict=None)</code>æ–¹æ³•ï¼Œåˆ›å»ºäº†ä¸€ä¸ªtypeçš„å®ä¾‹ï¼ˆç±»ç±»å‹å°±æ˜¯ä¸€ä¸ªtypeå®ä¾‹ï¼‰ï¼Œç±»å‹æ˜¯<code>&lt;class 'type'&gt;</code></p><p><strong>&lt;class â€˜typeâ€™&gt;æ˜¯æ‰€æœ‰ç±»å‹çš„ç±»å‹ã€‚&lt;class â€˜objectâ€™&gt;ä¹Ÿæ˜¯æ‰€æœ‰å¯¹è±¡çš„è¶…ç±»ï¼ˆé™¤äº†å®ƒè‡ªå·±ï¼ŒåŒ…æ‹¬typeï¼‰</strong></p><p>â–². æ­¤å¤–typeè¿˜æœ‰<code>type.__new__(*args, **kwargs)</code>ï¼Œå…¶ä½œç”¨æ˜¯<code>Create and return a new object.</code>ï¼Œå¯ä»¥å†™æˆ<code>type.__new__(ClassTpye, name, base, dicts)</code>ï¼Œä½†ClassTypeå¿…é¡»æ˜¯typeçš„å­ç±»ã€‚ä¼šè¿”å›ä¸€ä¸ªè·ŸClassTypeæœ‰å…³ç³»çš„æ–°ç±»å‹</p><h3 id="é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»"><a class="markdownIt-Anchor" href="#é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»"></a> é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»</h3><blockquote><p>ç°åœ¨è®©æˆ‘ä»¬æ­£å¼çœ‹ï¼Œæˆ‘åœ¨å¼€æºä»£ç é‡Œçœ‹åˆ°çš„å†…å®¹ï¼š</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„è¿™è¾¹ç»§æ‰¿äº†type, æ‰€ä»¥ä¸‹é¢çš„__call__æ˜¯é‡å†™typeçš„__call__ï¼Œå³åˆ›å»ºå®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Singleton Metaclass</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    _inst = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> cls._inst:</span><br><span class="line">            cls._inst[cls] = super(Singleton, cls).__call__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._inst[cls]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withMetaclass</span><span class="params">(meta, *bases)</span>:</span></span><br><span class="line">    <span class="string">"""Create a base class with a metaclass."""</span></span><br><span class="line">    <span class="comment"># è¿™éœ€è¦ä¸€ç‚¹è§£é‡Šï¼šåŸºæœ¬æ€æƒ³æ˜¯ä¸ºä¸€ä¸ªçº§åˆ«çš„ç±»å®ä¾‹åŒ–åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå…ƒç±»ï¼Œç”¨å®é™…çš„å…ƒç±»æ›¿æ¢å®ƒè‡ªå·±ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># KeyPoint1. ç»§æ‰¿metaç±»</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MetaClass</span><span class="params">(meta)</span>:</span></span><br><span class="line">        <span class="comment"># å®é™…ä¸Šä¸‹é¢çš„__new__ä¸å½±å“</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, this_bases, d)</span>:</span></span><br><span class="line">            <span class="comment"># clsä¸ºwithMetaclass; nameä¸ºä½¿ç”¨è€…çš„ç±»å‹; this_basesä¸ºä½¿ç”¨è€…çš„çˆ¶ç±»ä»¬; dä¸ºä½¿ç”¨è€…çš„å±æ€§</span></span><br><span class="line">            <span class="keyword">return</span> meta(name, bases, d)</span><br><span class="line">    <span class="comment"># KeyPoint2. type.__new__åˆ›å»ºä¸€ä¸ªåç§°å«temporary_classï¼Œç±»å‹ä¸ºMetaClassçš„ç±»</span></span><br><span class="line">    <span class="comment"># â–²æ³¨æ„type.__new__ä¸­çš„ç±»ç±»å‹å¿…é¡»æ˜¯typeçš„å­ç±»</span></span><br><span class="line">    <span class="keyword">return</span> type.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"__init__"</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br><span class="line"><span class="comment"># res=withMetaclass(Singleton)çš„ç±»å‹ä¸º&lt;class 'util.six.withMetaclass.&lt;locals&gt;.MetaClass'&gt;</span></span><br><span class="line"><span class="comment"># å°†å…¶ä¼ ç»™ConfigHandlerä½œä¸ºçˆ¶ç±»ï¼Œåœ¨å®šä¹‰ ConfigHandler æ—¶ä¼šè§¦å‘MetaClass.__new__, äºæ˜¯è°ƒç”¨meta(name, bases, d)ï¼Œæ­¤å¤„çš„metaä¸ºSingletonï¼Œè€Œnameä¸ºConfigHandlerç±», basesä¸ºç©º, dä¸ºConfigHandlerçš„å±æ€§å’Œæ–¹æ³•ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(type(ConfigHandler)) ==&gt;  &lt;class 'util.singleton.Singleton'&gt;</span></span><br><span class="line"><span class="comment"># å› æ­¤ c = ConfigHandler() ==&gt; Singletonçš„__call__æ–¹æ³•ï¼Œ</span></span><br><span class="line">å½“c = ConfigHandler()æ—¶ä¼šå› ä¸ºtype.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)å»æ‰¾MetaClassçš„__call__è¿›è¡Œè°ƒç”¨ï¼ŒMetaClassæ²¡æœ‰__call__åˆ™æ‰¾åˆ°äº†å…¶çˆ¶ç±»meta(Singleton)çš„__call__</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ˜¯å…ƒç±»çš„å¯¹è±¡ï¼Œå³æˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªç±»æ—¶ï¼Œè°ƒç”¨å…¶å…ƒç±»çš„<code>__call__(cls, *args, **kwargs)</code>æ–¹æ³•è¿›è¡Œåˆ›å»ºå¯¹è±¡ã€‚</p><h2 id="__call__"><a class="markdownIt-Anchor" href="#__call__"></a> <code>__call__</code></h2><blockquote><p>ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„å®ä¾‹æ–¹æ³•ï¼Œå³<code>__call__()</code>ã€‚è¯¥æ–¹æ³•çš„åŠŸèƒ½æ˜¯åœ¨ç±»ä¸­<strong>é‡è½½äº†å¯¹è±¡çš„ () è¿ç®—ç¬¦</strong>ï¼Œä½¿å¾—ç±»å®ä¾‹å¯¹è±¡å¯ä»¥åƒè°ƒç”¨æ™®é€šå‡½æ•°é‚£æ ·ï¼Œä»¥â€œ<strong>å¯¹è±¡å()</strong>â€çš„å½¢å¼ä½¿ç”¨ã€‚</p></blockquote><p>å®é™…ä¸Šï¼Œå¦‚æœä¸é‡å†™<code>__call__</code>çš„è¯ï¼Œ<code>Class.__call__(*args, **kwargs)</code>è¿˜æ‰¿æ‹…ç€äº§ç”Ÿç±»å®ä¾‹çš„åŠŸèƒ½ï¼ˆä¼šè°ƒç”¨çˆ¶ç±»ï¼ˆå¯ä»¥é€šè¿‡<code>Class.__class__</code>æ¥æŸ¥çœ‹çˆ¶ç±»ï¼‰çš„<code>type.__call__</code>å…¶ä¼šè¿”å›ä¸€ä¸ªå®ä¾‹ï¼‰</p><p>æ¡ˆä¾‹ä¸€:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤ç»§æ‰¿çš„æ˜¯object, è€Œä¸æ˜¯type</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        print(<span class="string">"init"</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">"call"</span>)</span><br><span class="line"><span class="comment"># å½“æ²¡æœ‰é‡å†™__call__æ—¶ï¼Œæ— è®ºæ˜¯æ˜¾å¼çš„è°ƒç”¨__call__ï¼Œè¿˜æ˜¯é€šè¿‡()è¿ç®—ç¬¦è°ƒç”¨ï¼Œéƒ½ä¼šè°ƒç”¨type.__call__è¿”å›ä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">res = Meta.__call__(<span class="string">"asd"</span>)</span><br><span class="line">print(res, type(res))</span><br><span class="line">res = Meta(<span class="string">"asd"</span>)</span><br><span class="line">print(res, type(res))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000014FB5115EE0&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000014FB5115A90&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">ä¸Šè¿°ä¸¤ç§éƒ½èƒ½åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># å½“é‡å†™__call__ä»¥å, __call__()è¿”å›å®ä¾‹çš„æ•ˆæœå°±å¤±æ•ˆäº†==&gt;å› ä¸ºä¸Šè¿°ä»£ç æ²¡æœ‰return</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶ Meta()ä¸Meta.__call__()ä¸å†ç­‰ä»·</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">call</span></span><br><span class="line"><span class="string">None &lt;class 'NoneType'&gt;</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000016CC2745EE0&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>Q:æˆ‘ä»¬åœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™<code>f = Foo(1, y=2)</code>ï¼Œå¯ä»¥å‘ç°åœ¨<code>__init__()</code>ä¸­å¹¶æ²¡æœ‰è¿”å›å®ä¾‹ï¼Œä½†è°ƒç”¨<code>Foo(1, y=2)</code><strong>ç¡®å®</strong>è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”ï¼Œ<code>__init__</code>é¢„æœŸä¸€ä¸ª<code>self</code>å‚æ•°ï¼Œä½†æ˜¯å½“æˆ‘ä»¬è°ƒç”¨<code>Foo(1, y=2)</code>æ—¶è¿™é‡Œå¹¶æ²¡æœ‰è¿™ä¸ªå‚æ•°ã€‚é‚£ä¹ˆç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><p>A:æ„é€ é¡ºåºâ€”â€”<a href="https://www.jianshu.com/p/f63ad9d550f1" target="_blank" rel="noopener">ç†è§£pythonçš„ç±»å®ä¾‹åŒ–</a></p><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼ŒPythonä¸­çš„<strong>ç±»ä¹Ÿæ˜¯å¯¹è±¡</strong>ï¼ç±»ã€å‡½æ•°ã€æ–¹æ³•ä»¥åŠå®ä¾‹éƒ½æ˜¯å¯¹è±¡â€”â€”<strong>ç±»ç±»å‹æ˜¯typeçš„å¯¹è±¡</strong>ï¼Œå¹¶ä¸”æ— è®ºä½•æ—¶ä½ å°†ä¸€å¯¹æ‹¬å·æ”¾åœ¨å®ƒä»¬çš„åå­—åé¢æ—¶ï¼Œå°±ä¼šè°ƒç”¨<code>type.__call__()</code>æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºtypeæ˜¯ç±»å‹çš„çˆ¶ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Foo.__class__</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">type</span>'&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥<code>Foo</code>æ˜¯ç±»å‹<code>type</code>çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨typeç±»çš„<code>__call__(self, *args, **kwargs)</code>è¿”å›ä¸€ä¸ª<code>Foo</code>ç±»çš„å¯¹è±¡ã€‚è®©æˆ‘ä»¬çœ‹ä¸‹<code>type</code>ä¸­çš„<code>__call__</code>æ–¹æ³•æ˜¯ä»€ä¹ˆæ ·çš„ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å½“çš„å¤æ‚ï¼Œä½†æ˜¯æˆ‘ä»¬å°†å…¶Cä»£ç è½¬æˆPythonä»£ç ï¼Œå¹¶å°è¯•å°½é‡ç®€åŒ–å®ƒï¼Œç»“æœå¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">type</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="comment"># è¿™è¾¹çš„obj_typeè·Ÿclsä¸€æ ·</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(obj_type, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># é€šè¿‡__new__åˆ›å»ºä¸€ä¸ªç©ºçš„ç±»å®ä¾‹ï¼Œå¦‚æœobj_typeæ²¡æœ‰__new__åˆ™ä½¿ç”¨type.__new__</span></span><br><span class="line">        obj = obj_type.__new__(*args, **kwargs)</span><br><span class="line">        <span class="comment"># è¿›è¡Œç±»å‹æ£€æŸ¥</span></span><br><span class="line">        <span class="keyword">if</span> obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> issubclass(obj, obj_type):</span><br><span class="line">            <span class="comment"># å¯¹ç±»è¿›è¡Œ__init__åˆå§‹åŒ–</span></span><br><span class="line">            obj.__init__(*args, **kwargs)</span><br><span class="line">        <span class="comment"># è¿”å›ç±»å®ä¾‹</span></span><br><span class="line">        <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure><p>å¯è§<code>__new__</code>æ–¹æ³•ä¸ºå¯¹è±¡åˆ†é…äº†å†…å­˜ç©ºé—´ï¼Œæ„å»ºå®ƒä¸ºä¸€ä¸ªâ€œç©º&quot;å¯¹è±¡ç„¶å<code>__init__</code>æ–¹æ³•è¢«è°ƒç”¨æ¥åˆå§‹åŒ–å®ƒã€‚</p><p>é‚£æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå…·ä½“ç±»æ¥è®²è§£è¿™ä¸ªè¿‡ç¨‹ã€‚é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼š<strong>Fooç›¸å¯¹äºäº§ç”Ÿäº†ä¸€ä¸ªtypeå®ä¾‹åŒ–å¯¹è±¡</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y=<span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br></pre></td></tr></table></figure><p>è·å¾—å®ä¾‹åŒ–å¯¹è±¡**<code>Foo(*args, **kwargs)</code><strong>ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯<code>typeå¯¹è±¡()</code>å³</strong>è°ƒç”¨äº†typeä¸­()è¿ç®—ç¬¦çš„è§¦å‘çš„å‡½æ•°<code>type.__call__</code>ä»è€Œåˆ›å»ºä¸€ä¸ªFooçš„å®ä¾‹**</p><ul><li>è‡³äº<code>type.__call__</code>å‘ç”Ÿäº†ä»€ä¹ˆå°±æ˜¯ä¸Šé¢æŠ½è±¡ä»£ç ä¸­ä»‹ç»çš„é‚£èˆ¬ï¼Œè°ƒç”¨<code>type.__new__(Foo, *args, **kwargs)</code>ç„¶åè¿”å›ä¸€ä¸ªå¯¹è±¡å®ä¾‹objã€‚</li><li><code>obj</code>éšåé€šè¿‡è°ƒç”¨<code>obj.__init__(*args, **kwargs)</code>è¢«åˆå§‹åŒ–ã€‚</li><li><code>obj</code>è¢«<code>type.__call__</code>ä¸­è¿”å›ã€‚</li></ul><p>â–²æ³¨æ„ï¼š<code>Foo.__call__</code>é‡è½½çš„æ˜¯<code>fooå¯¹è±¡</code>çš„()è¿ç®—ç¬¦ï¼Œè€Œ<code>Foo()</code>å®ä¾‹åŒ–fooå¯¹è±¡ï¼Œåˆ™æ‰§è¡Œçš„æ˜¯<code>typeå¯¹è±¡</code>çš„()è¿ç®—ç¬¦ã€‚</p><p><strong>å°æ€»ç»“</strong>ï¼š</p><ul><li>ç°åœ¨æˆ‘ä»¬èƒ½çŸ¥é“ä¸ºä»€ä¹ˆå…ƒç±»å¿…é¡»ç»§æ‰¿typeäº†ï¼šå› ä¸ºæˆ‘ä»¬å®ä¾‹åŒ–å¯¹è±¡<code>Foo(xxx)</code>æ—¶è°ƒç”¨äº†<code>type.__call__</code>,è€Œ<code>type.__call__</code>åˆä¼šè°ƒç”¨<code>type.__new__</code>å› æ­¤å¦‚æœtypeå­ç±»é‡å†™å®ç°äº†<code>__new__</code>ï¼ˆè¿”å›çš„ç±»å®ä¾‹å¯¹è±¡çš„ç±»å‹ä½œæ§åˆ¶ï¼‰ã€<code>__call__</code>ï¼ˆå¯¹å®ä¾‹åŒ–çš„æµç¨‹åšæ§åˆ¶ï¼‰ï¼Œåˆ™å¯ä»¥å¯¹<strong>ç±»å¯¹è±¡çš„ç±»å‹å’Œç±»å±æ€§</strong>èµ·åˆ°è‡ªå®šä¹‰çš„åŠŸèƒ½ï¼Œè€Œé‡å†™å°±å¿…é¡»ç»§æ‰¿type=&gt;éœ€è¦å…ƒç±»å¿…é¡»ç»§æ‰¿type</li><li>æ‰€ä»¥æŒ‰ç…§ä¸Šè¿°çš„é€»è¾‘ï¼Œå¦‚æœå®šä¹‰äº†ä¸€ä¸ªå…ƒç±»è®©è‡ªå®šä¹‰ç±»ç”¨çš„è¯<code>class Foo(metaclass=MyMetaClass)</code>ï¼Œåœ¨å…¶å®ä¾‹åŒ–è¿‡ç¨‹ä¸­<code>Foo()</code>ä¼šç›´æ¥è°ƒç”¨é‡å†™åçš„<code>MyMetaClass.__call__</code>ï¼Œè€Œåªè¦è®°ä½åœ¨<code>MyMetaClass.__call__</code>ä¸­ä½¿ç”¨åˆ°<code>return super(Singleton, cls).__call__(*args, **kwargs)</code>å°±å¯ä»¥æŠŠ<code>type.__call__</code>ç”Ÿæˆçš„å®ä¾‹è¿”å›å•¦ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ<u>ç¼–å†™å…ƒç±»ï¼Œä¸€èˆ¬éƒ½æ˜¯ç»§æ‰¿äº†typeï¼Œç„¶åæ ¹æ®æƒ³æ§åˆ¶å®ä¾‹åŒ–æµç¨‹å°±é‡å†™<code>__call__</code>æ–¹æ³•ï¼Œæƒ³æ·»åŠ å±æ€§å°±é‡å†™<code>__new__</code>æ–¹æ³•å°±è¡Œäº†ã€‚</u></li><li><strong>â˜…å…ƒç±»äº§ç”Ÿå½±å“çš„æ—¶é—´ç‚¹æ˜¯åœ¨å®ä¾‹åŒ–çš„æ—¶å€™</strong></li></ul><p>æ³¨æ„ç‚¹ï¼šå…ƒç±»ç»§æ‰¿äº†typeï¼Œæ‰€ä»¥å®ä¾‹åŒ–å…ƒç±»æ˜¯åœ¨äº§ç”Ÿä¸€ä¸ªç±»ç±»å‹ï¼Œå°±è¦ä»¥typeåˆ›å»ºç±»ç±»å‹çš„å‚æ•°å»äº§ç”Ÿã€‚è€Œå…ƒç±»çš„ä½¿ç”¨ä¸€èˆ¬éƒ½æ˜¯è‡ªå®šä¹‰ç±»<code>class MyClass(metaclass=å…ƒç±»)</code>ï¼Œç„¶åå®ä¾‹åŒ–è‡ªå®šä¹‰ç±»<code>MyClass(xxx)</code></p><p><strong>æ€»ç»“</strong>ï¼šçœ‹å®Œä¸Šè¿°çŸ¥è¯†ç‚¹åï¼Œæˆ‘ä»¬èƒ½çŸ¥é“ä¸ºä»€ä¹ˆwithclassèƒ½èµ·åˆ°metaclassçš„ä½œç”¨(ç±»çš„<code>__mro__</code>ä¸­ä¸å‡ºç°æŒ‡å®šçš„å…ƒç±»)äº†ï¼š</p><ul><li>é¦–å…ˆåˆ†ææµç¨‹ï¼š<code>return type.__new__(Metaclass)</code>è¿”å›äº†ä¸€ä¸ªç±»å‹ä¾›è‡ªå®šä¹‰ç±»ç»§æ‰¿ï¼Œç”±äºMetaClassç»§æ‰¿çš„æ˜¯çœŸæ­£çš„å…ƒç±»(å…ƒç±»éƒ½ç»§æ‰¿type)ï¼Œæ‰€ä»¥åœ¨è‡ªå®šä¹‰ç±»å®ä¾‹åŒ–çš„æ—¶å€™ä¼šè¢«Metaclassçš„<code>__new__</code>æ–¹æ³•æ‹¦æˆªï¼Œåœ¨<code>MetaClass.__new__</code>é‡Œreturnäº†ä¸€ä¸ªè‡ªå®šä¹‰å®ä¾‹ï¼Œå¹¶æŠŠå¯¹è±¡åŠ å…¥åˆ°äº†Singletonå­—å…¸ä¸­äº†ã€‚</li><li>å…¶æ¬¡è®²è§£ä¸ºä»€ä¹ˆMetaClassä¸­æ²¡æœ‰MetaClassï¼šå› ä¸ºæ ¹æ®<a href="#"><code>__new__</code></a>çŸ¥è¯†ç‚¹ä¸­è®²åˆ°çš„ï¼Œ<code>__new__</code>æ§åˆ¶äº†å®ä¾‹äº§ç”Ÿï¼Œ<code>return type.__new__(Metaclass)</code>ä¸­åˆ›å»ºäº†<code>Metaclass</code>ï¼Œä½†å…¶åœ¨<code>__new__</code>ä¸­è¿”å›çš„å¹¶ä¸æ˜¯MetaClassï¼Œå› æ­¤<code>__mro__</code>ä¸­ä¸ä¼šå‡ºç°<code>Metaclass</code></li><li>æœ€åè¿˜è¦è®²è®²Singletonä¸­çš„æ‰§è¡Œé€»è¾‘ï¼š</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(type)</span>:</span></span><br><span class="line">    _inst = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> cls._inst:</span><br><span class="line">            <span class="comment"># super(Singleton, cls).__call__è°ƒç”¨çš„æ˜¯type.__call__(è‡ªå®šä¹‰ç±»ç±»åname, è‡ªå®šä¹‰ç±»çˆ¶ç±»bases, è‡ªå®šä¹‰ç±»å±æ€§attrs)</span></span><br><span class="line">            cls._inst[cls] = super(Singleton, cls).__call__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._inst[cls]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªåœ¨çœ‹å¼€æºä»£ç æ—¶é…åˆ°äº†å•ä¾‹å…ƒç±»å†™æ³•åçš„ä¸€ä¸ªåŸç†è´´ï¼Œå¯ä»¥å¸®ä½ å½»åº•å¼„æ¸…å…ƒç±»ã€ä»¥åŠ&lt;code&gt;__new__&lt;/code&gt;å’Œ&lt;code&gt;__call__&lt;/code&gt;ï¼Œç›¸ä¿¡æˆ‘ï¼Œçœ‹å®Œä½ ç»å¯¹ä¼šæœ‰æ”¶è·ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå…³äºå…ƒç±»çš„ç»“è®ºè¯´åœ¨å‰å¤´ï¼Œå…ˆæœ‰ä¸ª
      
    
    </summary>
    
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•</title>
    <link href="https://nymrli.top/2022/03/29/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/</id>
    <published>2022-03-29T09:54:46.000Z</published>
    <updated>2022-05-29T10:01:40.807Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çˆ¬è™«ç³»åˆ—"><a class="markdownIt-Anchor" href="#çˆ¬è™«ç³»åˆ—"></a> çˆ¬è™«ç³»åˆ—</h1><h2 id="æŠ¢è´­-ç§’æ€"><a class="markdownIt-Anchor" href="#æŠ¢è´­-ç§’æ€"></a> æŠ¢è´­ã€ç§’æ€</h2><h3 id="taobao_seckill"><a class="markdownIt-Anchor" href="#taobao_seckill"></a> <strong><a href="https://github.com/jerry3747/taobao_seckill" target="_blank" rel="noopener"> taobao_seckill</a></strong></h3><blockquote><p>æ·˜å®ç§’æ€ç‰©å“ï¼šåˆ†ä¸ºseleniumç‰ˆå’Œrequestç½‘ç»œè¯·æ±‚ç‰ˆï¼Œå¾®å°çš„åŒºåˆ«åœ¨äºï¼Œapiå…ˆè¯·æ±‚çš„æ˜¯è´­ç‰©è½¦çš„ç‰©å“ä¿¡æ¯ï¼Œseleniumåˆ™æ˜¯å‹¾é€‰é€‰æ‹©æ¡†ã€‚</p><p>æµç¨‹å¤§è‡´éƒ½ç›¸åŒï¼šâ‘ keep_waitç­‰å¾…ä¸´è¿‘æŠ¢è´­æ—¶é—´-----&gt;â‘¡å°†éœ€è¦çš„ä¿¡æ¯ç¼“å­˜ä½ï¼Œä¸å†åˆ·æ–°ï¼ˆæ¯”å¦‚è¦æŠ¢è´­çš„ç‰©å“ä¿¡æ¯ã€cookiesâ€¦ï¼‰-----&gt;â‘¢è¿›è¡Œç»“ç®—(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘£æäº¤è®¢å•(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘¤æ”¯ä»˜è®¢å•(/ç‚¹å‡»æŒ‰é’®)ï¼›</p></blockquote><ul><li><p><a href="https://www.cnblogs.com/amiza/p/10175543.html" target="_blank" rel="noopener">ä½¿ç”¨browsercookieæ¥ç®¡ç†æµè§ˆå™¨cookies</a>â€”â€”ä»æµè§ˆå™¨æå–ä¿å­˜çš„cookiesçš„å·¥å…·ã€‚å®ƒæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„çˆ¬è™«å·¥å…·ï¼Œé€šè¿‡åŠ è½½ä½ æµè§ˆå™¨çš„cookiesåˆ°ä¸€ä¸ªcookiejarå¯¹è±¡é‡Œé¢ï¼Œè®©ä½ è½»æ¾ä¸‹è½½éœ€è¦ç™»å½•çš„ç½‘é¡µå†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cj = browsercookie.chrome()<span class="comment"># browsercookie.load() åœ¨ä¸çŸ¥é“æˆ–è€…ä¸å…³å¿ƒæµè§ˆå™¨æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(url, cookies=cj)</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½œä¸ºå¼€å‘è€…çš„æˆ‘ä»¬éƒ½æ˜¯å°†cookiesæ‰‹åŠ¨å†™å…¥æˆ–è€…æ˜¯ä¼ å…¥ç¨‹åºçš„ï¼Œè€Œbrowsercookieç”¨é€”ï¼Œæˆ‘æƒ³å¯ä»¥æ˜¯å°†éœ€è¦ä¼ å…¥cookiesçš„ç¨‹åºæ‰“åŒ…ç»™ä¸ä¼šæå–Cookiesçš„ç”¨æˆ·ä½¿ç”¨ã€‚ï¼ˆç±»ä¼¼é€šè¿‡seleniumç™»é™†åï¼Œæ‹¿å–cookieså†å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¿™è¾¹æ˜¯è®©/å€ŸåŠ©ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨æ¥æ‹¿å–cookiesï¼‰</p></li><li><p>ä½¿ç”¨tkinteræ­å»ºç®€å•çš„GUIï¼šç‚¹å‡»â€œå¼€å§‹â€çš„æŒ‰é’®åä¼šå°†å¯†ç æ¡†å’ŒæŠ¢è´­è®¾ç½®æ—¶é—´æ¡†çš„å†…å®¹ä¼ å…¥ï¼Œä½œä¸ºå®ä¾‹åŒ–ChromeDriverSpiderçš„å‚æ•°ï¼Œå¹¶è¿è¡Œå®ä¾‹çš„sec_killæ–¹æ³•å¼€å§‹æ‰§è¡ŒæŠ¢è´­</p></li><li><p>é…ç½®chromeDriverå¯åŠ¨é…ç½®é¡¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_chrome_options</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""é…ç½®å¯åŠ¨é¡¹"""</span></span><br><span class="line">    chrome_options = webdriver.ChromeOptions()</span><br><span class="line">    chrome_options.accept_untrusted_certs = <span class="keyword">True</span></span><br><span class="line">    chrome_options.assume_untrusted_cert_issuer = <span class="keyword">True</span></span><br><span class="line">    arguments = [<span class="string">'--no-sandbox'</span>, <span class="string">'--disable-impl-side-painting'</span>, <span class="string">'--disable-setuid-sandbox'</span>, <span class="string">'--disable-seccomp-filter-sandbox'</span>,</span><br><span class="line">    <span class="string">'--disable-breakpad'</span>, <span class="string">'--disable-client-side-phishing-detection'</span>, <span class="string">'--disable-cast'</span>,</span><br><span class="line">    <span class="string">'--disable-cast-streaming-hw-encoding'</span>, <span class="string">'--disable-cloud-import'</span>, <span class="string">'--disable-popup-blocking'</span>,</span><br><span class="line">    <span class="string">'--ignore-certificate-errors'</span>, <span class="string">'--disable-session-crashed-bubble'</span>, <span class="string">'--disable-ipv6'</span>,</span><br><span class="line">    <span class="string">'--allow-http-screen-capture'</span>, <span class="string">'--start-maximized'</span>]</span><br><span class="line">    <span class="keyword">for</span> arg <span class="keyword">in</span> arguments:</span><br><span class="line">    chrome_options.add_argument(arg)</span><br><span class="line">    chrome_options.add_argument(<span class="string">f'--user-agent=<span class="subst">&#123;choice(get_useragent_data())&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> chrome_options</span><br></pre></td></tr></table></figure></li></ul><h3 id="taobao_api"><a class="markdownIt-Anchor" href="#taobao_api"></a> <strong><a href="https://github.com/gaoxt/taobao_api" target="_blank" rel="noopener">taobao_api</a></strong></h3><blockquote><p>seleniumå’Œapiç»“åˆï¼šç™»é™†é€»è¾‘ä½¿ç”¨äº†seleniumï¼Œåˆ·æ–°è´­ç‰©è½¦å’Œä¸‹å•è°ƒç”¨äº†æ‰‹æœºæ·˜å®taobao_apiï¼Œè‡ªåŠ¨ä»˜æ¬¾ä¹Ÿä½¿ç”¨äº†seleniumï¼Œèƒ½è‡ªåŠ¨æ¨¡æ‹Ÿè§¦æ‘¸è¾“å…¥å¯†ç ä»˜æ¬¾ï¼Œæ¥å£ç­¾åsignç”Ÿæˆæ–¹æ³•å‚è€ƒget_sign_valã€‚</p></blockquote><ul><li><p>åŒæ­¥é˜¿é‡Œäº‘æ—¶é—´æœåŠ¡å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸€æ¬¡æ€§è®¾ç½®</span></span><br><span class="line">sudo sntp -sS ntp.aliyun.com</span><br><span class="line"><span class="comment">#æ°¸ä¹…è®¾ç½®</span></span><br><span class="line">sudo systemsetup -setnetworktimeserver ntp.aliyun.com</span><br><span class="line">sudo systemsetup -setusingnetworktime on</span><br></pre></td></tr></table></figure></li><li><p>å±•ç¤ºQRCode</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment"># æ‰¾åˆ°äºŒç»´ç å›¾ç‰‡çš„é“¾æ¥</span></span><br><span class="line">   img = WebDriverWait(browser, <span class="number">2</span>, <span class="number">0.1</span>).until(</span><br><span class="line">       EC.presence_of_element_located((By.XPATH, <span class="string">"//div[@id='J_QRCodeImg']/img"</span>))).get_attribute(<span class="string">'src'</span>)</span><br><span class="line">   <span class="comment"># è·å¾—å›¾ç‰‡å­—èŠ‚æµå†…å®¹</span></span><br><span class="line">   img_content = requests.get(img, timeout=<span class="number">5</span>).content</span><br><span class="line">   <span class="comment"># ä¿å­˜åˆ°æœ¬åœ°å›¾ç‰‡ä¸­</span></span><br><span class="line">   file_name = <span class="string">'taobao_qrcode.png'</span></span><br><span class="line">   fp = open(file_name, <span class="string">'wb'</span>)</span><br><span class="line">   fp.write(img_content)</span><br><span class="line">   fp.close()</span><br><span class="line"><span class="comment"># å°†å…¶è§£ç æˆé“¾æ¥ï¼Œ pyzbarä¸ºäºŒç»´ç å’Œæ¡å½¢ç åº“ ==&gt; ä¸ªäººè§‰å¾—ä¿å­˜åå¯ä»¥ç›´æ¥è½¬æˆPILçš„Imageç„¶åimg.show()</span></span><br><span class="line">   <span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">   barcode_url = <span class="string">''</span></span><br><span class="line">   barcodes = decode(Image.open(file_name))</span><br><span class="line">   <span class="keyword">for</span> barcode <span class="keyword">in</span> barcodes:</span><br><span class="line">       <span class="comment"># è§£æè·å¾—äºŒç»´ç åçš„å†…å®¹ï¼›å¦‚æœæ˜¯æ¡å½¢ç ï¼Œåˆ™è¿”å›æ¡å½¢ç æ•°</span></span><br><span class="line">       barcode_url = barcode.data.decode(<span class="string">"utf-8"</span>)</span><br><span class="line"><span class="comment"># ç”ŸæˆäºŒç»´ç å¹¶é€šè¿‡æ§åˆ¶å°æ‰“å°</span></span><br><span class="line">   qr = qrcode.QRCode()</span><br><span class="line">   qr.add_data(barcode_url)</span><br><span class="line">   qr.print_ascii(invert=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<a href="http://zbar.sourceforge.net/" target="_blank" rel="noopener">ZBar</a>æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å¥—ä»¶ï¼Œç”¨äºä»å„ç§æ¥æºï¼ˆå¦‚è§†é¢‘æµã€å›¾åƒæ–‡ä»¶å’ŒåŸå§‹å¼ºåº¦ä¼ æ„Ÿå™¨ï¼‰è¯»å–æ¡å½¢ç ï¼›<code>pyzbar</code> æ˜¯é€šè¿‡ <code>Python2</code>å’Œ<code>3</code>æ¥å£ï¼Œä½¿ç”¨ <code>ZBar</code> åº“è¯»å–ä¸€ç»´æ¡å½¢ç å’ŒQRç  ã€‚=&gt;<a href="https://blog.csdn.net/qq_37924224/article/details/109582507" target="_blank" rel="noopener">è¯»å–æ¡å½¢ç </a>ã€<a href="https://blog.csdn.net/hxj0323/article/details/112969622" target="_blank" rel="noopener">è¯»å–äºŒç»´ç </a></p></li></ul><h3 id="jd_seckill"><a class="markdownIt-Anchor" href="#jd_seckill"></a> <strong><a href="https://github.com/andyzys/jd_seckill" target="_blank" rel="noopener">jd_seckill</a></strong></h3><blockquote><ol><li>é¢„çº¦å•†å“</li><li>ç§’æ€æŠ¢è´­å•†å“: â‘ <strong>è®¿é—®</strong>å•†å“çš„æŠ¢è´­<strong>é“¾æ¥</strong>ï¼ˆç”¨äºè®¾ç½®cookieç­‰â€”&gt;â‘¡è®¿é—®æŠ¢è´­è®¢å•<strong>ç»“ç®—é¡µé¢</strong>----&gt;â‘¢<strong>æäº¤æŠ¢</strong>è´­ï¼ˆç§’æ€ï¼‰<strong>è®¢å•</strong> [_get_seckill_order_dataç”Ÿæˆæäº¤æŠ¢è´­è®¢å•æ‰€éœ€çš„è¯·æ±‚ä½“å‚æ•°ã€è·å–ç§’æ€åˆå§‹åŒ–ä¿¡æ¯ï¼ˆåŒ…æ‹¬ï¼šåœ°å€ï¼Œå‘ç¥¨ï¼Œtokenï¼‰]</li></ol></blockquote><ul><li><p>ä»UAListä¸­é€šè¿‡<code>random.choice(USER_AGENTS)</code>éšæœºUA</p></li><li><p>ä½¿ç”¨å†…ç½®configparseræ¨¡å—è§£æconfig.ini</p><ul><li>RawConfigParseræ˜¯æœ€åŸºç¡€çš„INIæ–‡ä»¶è¯»å–ç±»ï¼›ConfigParserã€SafeConfigParser<a href="https://blog.csdn.net/miner_k/article/details/77857292" target="_blank" rel="noopener">æ”¯æŒå¯¹%(value)så˜é‡çš„è§£æ</a>ï¼ŒSafeConfigParserç±»å®ç°äº†ConfigParserç›¸åŒçš„æ¥å£ï¼Œæ–°å¢å¦‚ä¸‹æ–¹æ³•ï¼šsetå­˜åœ¨ä¿å­˜çš„æ–¹æ³•</li><li>sectionä¸‹çš„option(key)å¯ä»¥ä¸å¡«valueå€¼ï¼Œå³ä¸ºç©ºã€‚</li><li>from: <a href="https://blog.csdn.net/tianzhu123/article/details/6893755" target="_blank" rel="noopener">pythonä¸­RawConfigParserç±»ã€ConfigParserç±»ã€SafeConfigParserç±»ä¸­å‡½æ•°ä»‹ç»</a>ã€</li></ul></li><li><p>å¤šè¿›ç¨‹æ± ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ProcessPoolExecutor(work_count) <span class="keyword">as</span> pool:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(work_count):</span><br><span class="line">        pool.submit(self.seckill)</span><br></pre></td></tr></table></figure></li><li><p>ç§’æ€æ—¶é—´æ¯”è¾ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buy_time = datetime.strptime(global_config.getRaw(<span class="string">'config'</span>,<span class="string">'buy_time'</span>), <span class="string">"%Y-%m-%d %H:%M:%S.%f"</span></span><br><span class="line">now_time = datetime.now</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> now_time() &gt;= buy_time:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure></li><li><p><a href="https://github.com/woxiqingxian/jd_seckill/pull/2/commits/63a41a0609912d5643bc11f3419fe7dd8e84a00a" target="_blank" rel="noopener">è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´</a>ï¼š<code>https://api.m.jd.com/client.action?functionId=queryMaterialProducts&amp;client=wh5</code></p></li></ul><h3 id="jd-assistant"><a class="markdownIt-Anchor" href="#jd-assistant"></a> <strong><a href="https://github.com/tychxn/jd-assistant" target="_blank" rel="noopener">jd-assistantâ˜…</a></strong></h3><blockquote><p>æ˜¯<a href="#jd_seckill">jd_seckill</a>çš„ä¼˜åŒ–è¿›é˜¶ç‰ˆæœ¬</p><ul><li><p>æ™®é€šå•†å“è´­ä¹°ä¸»è¦æµç¨‹ï¼š<code>(1)æ¸…ç©ºè´­ç‰©è½¦</code> --&gt; <code>(2)æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</code> --&gt; <code>(3)æäº¤è®¢å•</code></p></li><li><p>é¢„çº¦æŠ¢è´­å•†å“ç‰¹ç‚¹ï¼š</p><ol><li>éœ€è¦æå‰ç‚¹å‡»é¢„çº¦</li><li>å¤§éƒ¨åˆ†æ­¤ç±»å•†å“åœ¨é¢„çº¦åè‡ªåŠ¨åŠ å…¥è´­ç‰©è½¦ï¼Œä½†æ˜¯æ— æ³•å‹¾é€‰âœ“ï¼Œä¹Ÿæ— æ³•ï¸è¿›å…¥åˆ°ç»“ç®—é¡µé¢</li><li>åˆ°äº†æŠ¢è´­çš„æ—¶é—´ç‚¹åå°†å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œæ­¤æ—¶æ‰èƒ½å‹¾é€‰å¹¶ä¸‹å•</li></ol></li><li><p>æ™®é€šå•†å“ï¼šèƒ½åŠ å…¥è´­ç‰©è½¦ğŸ›’ï¼Œç„¶åè¿›å…¥è´­ç‰©è½¦ç»“ç®—ä¸‹å•.</p></li><li><p>æŠ¢è´­å•†å“ï¼šéœ€ææå‰é¢„çº¦ï¼Œå¼€å§‹æŠ¢è´­æ—¶æœ‰â€œç«‹å³æŠ¢è´­â€æŒ‰é’®ğŸ”˜ï¼Œç‚¹å‡»æŒ‰é’®åå•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œç„¶åç»“ç®—ä¸‹å•.</p></li></ul><p>â­ï¸æŠ¢è´­å—å¤šç§å› ç´ å½±å“ï¼š<strong>ç½‘é€Ÿã€è´¦å·è´¨é‡ã€è¿æ°”</strong>ç­‰ç­‰ï¼Œä»…ä¾›å¨±ä¹ï¼Œè®¤çœŸå°±è¾“äº†.</p></blockquote><ul><li><p>deprecatedã€check_loginè£…é¥°å™¨ï¼šä¼ å…¥äº†selfå‚æ•°ï¼Œå¹¶é€šè¿‡selfå®ä¾‹è°ƒç”¨äº†ç±»çš„å…¶ä»–æˆå‘˜æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_login</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="string">"""ç”¨æˆ·ç™»é™†æ€æ ¡éªŒè£…é¥°å™¨ã€‚è‹¥ç”¨æˆ·æœªç™»é™†ï¼Œåˆ™è°ƒç”¨æ‰«ç ç™»é™†"""</span></span><br><span class="line"><span class="meta">    @functools.wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_func</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.is_login:</span><br><span class="line">            logger.info(<span class="string">"&#123;0&#125; éœ€ç™»é™†åè°ƒç”¨ï¼Œå¼€å§‹æ‰«ç ç™»é™†"</span>.format(func.__name__))</span><br><span class="line">            self.login_by_QRcode()</span><br><span class="line">        <span class="keyword">return</span> func(self, *args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> new_func</span><br></pre></td></tr></table></figure></li><li><p>å¯†ç åŠ å¯†â€”â€”<strong><a href="https://github.com/Legrandin/pycryptodome" target="_blank" rel="noopener">pycryptodome</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_pwd</span><span class="params">(password, public_key=RSA_PUBLIC_KEY)</span>:</span></span><br><span class="line">    rsa_key = RSA.importKey(public_key)</span><br><span class="line">    encryptor = Cipher_pkcs1_v1_5.new(rsa_key)</span><br><span class="line">    cipher = b64encode(encryptor.encrypt(password.encode(<span class="string">'utf-8'</span>)))</span><br><span class="line">    <span class="keyword">return</span> cipher.decode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure></li><li><p>æä¾›JSè„šæœ¬æ–‡ä»¶æ¥è·å–å•†å“çš„ä¿¡æ¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥ä¸‹ä»£ç åœ¨è®¢å•ç»“ç®—é¡µé¢çš„å¼€å‘è€…å·¥å…·Consoleä¸­æ‰§è¡Œï¼Œç”¨äºè·å–å¿…è¦çš„å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> eid = $(<span class="string">'#eid'</span>).val();</span><br><span class="line"><span class="keyword">var</span> fp = $(<span class="string">'#fp'</span>).val();</span><br><span class="line"><span class="keyword">var</span> trackId = getTakId();</span><br><span class="line"><span class="keyword">var</span> riskControl = $(<span class="string">'#riskControl'</span>).val();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`eid = <span class="subst">$&#123;eid&#125;</span>\nfp = <span class="subst">$&#123;fp&#125;</span>\ntrack_id = <span class="subst">$&#123;trackId&#125;</span>\nrisk_control = <span class="subst">$&#123;riskControl&#125;</span>`</span>);</span><br></pre></td></tr></table></figure></li><li><p>cookieséªŒè¯-é€šè¿‡è¯»å–æœ¬åœ°ä¿å­˜çš„cookiesæ—¶è¦å…ˆéªŒè¯ä¸‹cookiesæ˜¯å¦æœ‰æ•ˆï¼šrequestsåº“çš„ä½¿ç”¨æ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_validate_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""éªŒè¯cookiesæ˜¯å¦æœ‰æ•ˆï¼ˆæ˜¯å¦ç™»é™†ï¼‰</span></span><br><span class="line"><span class="string">    é€šè¿‡è®¿é—®ç”¨æˆ·è®¢å•åˆ—è¡¨é¡µè¿›è¡Œåˆ¤æ–­ï¼šè‹¥æœªç™»å½•ï¼Œå°†ä¼šé‡å®šå‘åˆ°ç™»é™†é¡µé¢ã€‚</span></span><br><span class="line"><span class="string">    :return: cookiesæ˜¯å¦æœ‰æ•ˆ True/False</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    url = <span class="string">'https://order.jd.com/center/list.action'</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">'rid'</span>: str(int(time.time() * <span class="number">1000</span>)),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = self.sess.get(url=url, params=payload, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == requests.codes.OK:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(e)</span><br><span class="line">    <span class="comment"># åˆ›å»ºæ–°çš„session</span></span><br><span class="line">    self.sess = requests.session()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure></li><li><p>äºŒç»´ç ç™»å½•ï¼šä¸‹è½½äºŒç»´ç <code>_get_QRcode</code>â€“&gt;è¯¢é—®è·å–äºŒç»´ç æ‰«æçŠ¶æ€<code>_get_QRcode_ticket</code>â€”&gt;éªŒè¯äºŒç»´ç ä¿¡æ¯(<code>_validate_QRcode_ticket</code>)â€“&gt;è®¾ç½®<code>is_login=Trueå’Œsave_cookies</code>ï¼ˆäºŒç»´ç æœ‰æ•ˆæœŸçº¦120sï¼Œæµè§ˆå™¨å¤§çº¦2så‘é€ä¸€ä¸ªè¯·æ±‚è¯¢é—®æ‰«æçŠ¶æ€ï¼‰â€”â€”çœ‹ä»£ç æ˜¯assistantå‚è€ƒäº†2018å¹´çš„**<a href="https://github.com/adyzng/jd-autobuy" target="_blank" rel="noopener">jd-autobuy</a>**</p></li><li><p>æ‰«æäºŒç»´ç ï¼šå†™å…¥å›¾ç‰‡å’Œæ‰“å¼€å›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_image</span><span class="params">(resp, image_file)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(image_file, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># ä»ç½‘ç»œè¯·æ±‚ä¸­ä¸‹è½½å†…å®¹</span></span><br><span class="line">        <span class="keyword">for</span> chunk <span class="keyword">in</span> resp.iter_content(chunk_size=<span class="number">1024</span>):</span><br><span class="line">            f.write(chunk)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_image</span><span class="params">(image_file)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> os.name == <span class="string">"nt"</span>:</span><br><span class="line">        os.system(<span class="string">'start '</span> + image_file)  <span class="comment"># for Windows</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> os.uname()[<span class="number">0</span>] == <span class="string">"Linux"</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"deepin"</span> <span class="keyword">in</span> os.uname()[<span class="number">2</span>]:</span><br><span class="line">                os.system(<span class="string">"deepin-image-viewer "</span> + image_file)  <span class="comment"># for deepin</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                os.system(<span class="string">"eog "</span> + image_file)  <span class="comment"># for Linux</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            os.system(<span class="string">"open "</span> + image_file)  <span class="comment"># for Mac</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šåˆ¤æ–­æ“ä½œç³»ç»Ÿè¿˜å¯ä»¥å€ŸåŠ©å†…ç½®çš„platformåº“<code>platform.system().lower()</code>å¾—åˆ°[linuxã€windowsã€mac]</p></li></ul><p>â–²cookieså’ŒäºŒç»´ç ç»“åˆä½¿ç”¨ï¼š</p><ol><li>å¦‚æœç™»é™†æˆåŠŸåˆ™å§cookiesæŒä¹…åŒ–</li><li>ä½¿ç”¨äºŒç»´ç ç™»é™†å‰ï¼Œå…ˆåŠ è½½éªŒè¯ä¹‹å‰æŒä¹…åŒ–çš„cookiesæ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæœ‰æ•ˆåˆ™æ— éœ€å†æ¬¡æ‰«ç ç™»é™†(åœ¨QRCode_loginçš„èµ·å§‹ä½ç½®åˆ¤æ–­validationä¸­ä¿®æ”¹çš„is_loginæ˜¯å¦ä¸ºTrue)</li></ol><h3 id="jd-seckill-maotai"><a class="markdownIt-Anchor" href="#jd-seckill-maotai"></a> <strong><a href="https://github.com/hello8817/jd-seckill-maotai" target="_blank" rel="noopener"> jd-seckill-maotai</a></strong></h3><blockquote><ul><li><h2 id="ä¸»è¦åŠŸèƒ½"><a class="markdownIt-Anchor" href="#ä¸»è¦åŠŸèƒ½"></a> ä¸»è¦åŠŸèƒ½</h2><ul><li>ç™»é™†äº¬ä¸œå•†åŸï¼ˆ<a href="http://www.jd.com" target="_blank" rel="noopener">www.jd.com</a>ï¼‰<ul><li>ç”¨äº¬ä¸œAPPæ‰«ç ç»™å‡ºçš„äºŒç»´ç </li></ul></li><li>é¢„çº¦èŒ…å°<ul><li>å®šæ—¶è‡ªåŠ¨é¢„çº¦</li></ul></li><li>ç§’æ€é¢„çº¦åç­‰å¾…æŠ¢è´­<ul><li>å®šæ—¶å¼€å§‹è‡ªåŠ¨æŠ¢è´­</li></ul></li></ul></li></ul><p><strong>ç‰¹åˆ«å£°æ˜ï¼š</strong></p><ul><li>æœ¬ä»“åº“å‘å¸ƒçš„<code>jd_seckill_maotai</code>é¡¹ç›®ä¸­æ¶‰åŠçš„ä»»ä½•è„šæœ¬ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚</li><li>æœ¬é¡¹ç›®å†…æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç¦æ­¢ä»»ä½•å…¬ä¼—å·ã€è‡ªåª’ä½“è¿›è¡Œä»»ä½•å½¢å¼çš„è½¬è½½ã€å‘å¸ƒã€‚</li><li><code>ChinaVolvocars</code> å¯¹ä»»ä½•è„šæœ¬é—®é¢˜æ¦‚ä¸è´Ÿè´£ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç”±ä»»ä½•è„šæœ¬é”™è¯¯å¯¼è‡´çš„ä»»ä½•æŸå¤±æˆ–æŸå®³.</li><li>è¯·å‹¿å°†<code>jd_seckill_maotai</code>é¡¹ç›®çš„ä»»ä½•å†…å®¹ç”¨äºå•†ä¸šæˆ–éæ³•ç›®çš„ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚</li><li>å¦‚æœä»»ä½•å•ä½æˆ–ä¸ªäººè®¤ä¸ºè¯¥é¡¹ç›®çš„è„šæœ¬å¯èƒ½æ¶‰å«Œä¾µçŠ¯å…¶æƒåˆ©ï¼Œåˆ™åº”åŠæ—¶é€šçŸ¥å¹¶æä¾›èº«ä»½è¯æ˜ï¼Œæ‰€æœ‰æƒè¯æ˜ï¼Œæˆ‘ä»¬å°†åœ¨æ”¶åˆ°è®¤è¯æ–‡ä»¶ååˆ é™¤ç›¸å…³è„šæœ¬ã€‚</li><li>æ‚¨å¿…é¡»åœ¨ä¸‹è½½åçš„24å°æ—¶å†…ä»è®¡ç®—æœºæˆ–æ‰‹æœºä¸­å®Œå…¨åˆ é™¤ä»¥ä¸Šå†…å®¹ã€‚</li><li>æœ¬é¡¹ç›®éµå¾ª<code>GPL-3.0 License</code>åè®®ï¼Œå¦‚æœæœ¬ç‰¹åˆ«å£°æ˜ä¸<code>GPL-3.0 License</code>åè®®æœ‰å†²çªä¹‹å¤„ï¼Œä»¥æœ¬ç‰¹åˆ«å£°æ˜ä¸ºå‡†ã€‚</li><li><em><strong>æ‚¨ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em><br><em><strong>æ‚¨åœ¨æœ¬å£°æ˜æœªå‘å‡ºä¹‹æ—¶ç‚¹ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ä¸”æ­¤æ—¶è¿˜åœ¨ä½¿ç”¨ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em></li></ul></blockquote><blockquote><p>æ ¹æ®12æœˆ14æ—¥ä»¥æ¥æŠ¢èŒ…å°çš„æ—¥å¿—åˆ†æï¼Œå¤§èƒ†æ¨æ–­å†æ¥å†å‰è¿”å›Jsonæ¶ˆæ¯ä¸­<code>resultCode</code>ä¸<strong>å°ç™½ä¿¡ç”¨</strong>çš„å…³ç³»ã€‚<br>è¿™é‡Œä¸»è¦åˆ†æå‡ºç°é¢‘ç‡æœ€é«˜çš„<code>90016</code>å’Œ<code>90008</code>ã€‚</p><table><thead><tr><th>æ¡ˆä¾‹</th><th>å°ç™½ä¿¡ç”¨</th><th>90016</th><th>90008</th><th>æŠ¢åˆ°è€—æ—¶</th></tr></thead><tbody><tr><td>å¼ ä¸‰</td><td>63.8</td><td>59.63%</td><td>40.37%</td><td>æš‚æœªæŠ¢åˆ°</td></tr><tr><td>æå››</td><td>92.9</td><td>72.05%</td><td>27.94%</td><td>4å¤©</td></tr><tr><td>ç‹äº”</td><td>99.6</td><td>75.70%</td><td>24.29%</td><td>æš‚æœªæŠ¢åˆ°</td></tr><tr><td>èµµå…­</td><td>103.4</td><td>91.02%</td><td>8.9%</td><td>2å¤©</td></tr></tbody></table><p>é£æ§æ”¾è¡Œåæ‰ä¼šè¿›è¡ŒæŠ¢è´­ï¼Œè¿™æ—¶å€™ç”¨çš„åº”è¯¥æ˜¯æ°´åº“è®¡æ•°æ¨¡å‹ï¼Œå‡è®¾æ— æ³•ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰æ•°æ®çš„æƒ…å†µä¸‹æ¥å°½é‡çš„åšåˆ°æŠ¢è´­æˆåŠŸç”¨æˆ·çš„å‡åŒ€åˆ†å¸ƒï¼Œè¿™æ ·å°±å’Œæ¦‚ç‡ç›¸å…³äº†ã€‚</p><p><strong>æŠ¢è´­ç»“æœç¡®è®¤</strong></p><p>æŠ¢è´­æ˜¯å¦æˆåŠŸé€šå¸¸åœ¨ç¨‹åºå¼€å§‹çš„ä¸€åˆ†é’Ÿå†…å¯è§åˆ†æ™“ï¼<br>æœç´¢æ—¥å¿—ï¼Œå‡ºç°â€œæŠ¢è´­æˆåŠŸï¼Œè®¢å•å·xxxxx&quot;ï¼Œä»£è¡¨æˆåŠŸæŠ¢åˆ°äº†ï¼ŒåŠ¡å¿…åŠå°æ—¶å†…æ”¯ä»˜è®¢å•ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼<br>è‹¥ä¸¤åˆ†é’Ÿè¿˜æœªæŠ¢è´­æˆåŠŸï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ²¡æŠ¢åˆ°ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼</p></blockquote><ul><li><p>åœ¨ç¨‹åºå¼€å§‹è¿è¡Œåï¼Œä¼šæ£€æµ‹æœ¬åœ°æ—¶é—´ä¸äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ï¼Œè¾“å‡ºçš„å·®å€¼ä¸ºã€æœ¬åœ°æ—¶é—´-äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ã€‘ï¼Œå³-50ä¸ºæœ¬åœ°æ—¶é—´æ¯”äº¬ä¸œæœåŠ¡å™¨æ—¶é—´æ…¢50msã€‚ æœ¬ä»£ç çš„æ‰§è¡Œçš„æŠ¢è´­æ—¶é—´ä»¥æœ¬åœ°ç”µè„‘/æœåŠ¡å™¨æ—¶é—´ä¸ºå‡†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, ...)</span>:</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®</span></span><br><span class="line">self.diff_time = self.local_time() - self.jd_time()</span><br><span class="line"><span class="comment"># ....</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="comment"># æœ¬åœ°æ—¶é—´å‡å»ä¸äº¬ä¸œçš„æ—¶é—´å·®(ms)ï¼Œèƒ½å¤Ÿå°†æ—¶é—´è¯¯å·®æå‡åˆ°0.1ç§’é™„è¿‘, å…·ä½“ç²¾åº¦ä¾èµ–è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´çš„ç½‘ç»œæ—¶é—´æŸè€—</span></span><br><span class="line">    <span class="keyword">if</span> self.local_time() - self.diff_time &gt;= self.buy_time_ms:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure><p>è¡¥å……ï¼šPythonçš„æ—¶é—´æˆ³é»˜è®¤éƒ½æ˜¯ç§’çº§åˆ«çš„ï¼Œå¦‚æœè¦msçº§åˆ«çš„ï¼Œåˆ™è¦ä¹˜ä»¥1000</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡timeï¼Œä»¥å…ƒç»„ï¼ˆstruct_timeï¼‰ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># è·å¾—10ä½ç§’çº§æ—¶é—´æˆ³</span></span><br><span class="line">seconds = time.time()</span><br><span class="line"><span class="comment"># è·å¾—13ä½æ¯«ç§’çº§æ—¶é—´æˆ³==&gt;javaé»˜è®¤13ä½</span></span><br><span class="line">millis = int(round(time.time() * <span class="number">1000</span>))</span><br><span class="line"><span class="comment"># åŒæ ·ï¼Œtimeä¸‹çš„mktimeä¹Ÿéœ€è¦*1000</span></span><br><span class="line">time.mktime(self.buy_time.timetuple()) * <span class="number">1000.0</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡datetimeï¼Œä»¥datetimeç±»å®ä¾‹å¯¹è±¡ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># è·å¾—å½“å‰æ—¶é—´</span></span><br><span class="line">now = datetime.now()</span><br><span class="line">timestamp = datetime.timestamp(now)</span><br><span class="line">print(<span class="string">"æ—¶é—´æˆ³ ="</span>, timestamp)</span><br><span class="line"><span class="comment"># ä¹Ÿæ˜¯10ä½sçº§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1648622589.624272</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="jd_mask"><a class="markdownIt-Anchor" href="#jd_mask"></a> <strong><a href="https://github.com/Lasx/jd_mask" target="_blank" rel="noopener">jd_mask</a></strong></h3><blockquote><p>æ­¤toolåªå•ç‹¬æ”¯æŒ<strong>é¢„çº¦-æŠ¢è´­-æˆåŠŸåç›´æ¥æäº¤è®¢å•</strong>çš„å•†å“ï¼Œå¦‚[å£ç½©]ï¼Œåªæä¾›å­¦ä¹ å‚è€ƒç”¨é€”.</p></blockquote><p>â“‚ï¸é˜…è¯»äº†å¤šä»½äº¬ä¸œæŠ¢è´­çš„ä»£ç åï¼Œå‘ç°åŸºæœ¬éƒ½æ˜¯ä»ä¸€ä¸ªæ¨¡æ¿é‡Œä¸æ–­ä¼˜åŒ–å‘å±•å‡ºæ¥çš„ï¼Œååº”äº†å¼€æºçš„æ„ä¹‰ï¼Œä¹Ÿååº”äº†äº¬ä¸œéƒ¨åˆ†ç»†èŠ‚çš„ä¿®æ”¹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¾—åˆ°ä¸€ä¸ªå‘Šç¤ºï¼šåœ¨å®ç°ç›¸åŒåŠŸèƒ½å‰ï¼Œä¸å¦¨å¤šçœ‹çœ‹ã€å€Ÿé‰´ä¸‹ä»¥å¾€å¯è¡Œçš„ä»£ç ã€‚</p><h3 id="automatic_ticket_purchase"><a class="markdownIt-Anchor" href="#automatic_ticket_purchase"></a> <strong><a href="https://github.com/MakiNaruto/Automatic_ticket_purchase" target="_blank" rel="noopener">Automatic_ticket_purchase</a></strong></h3><p>å¤§éº¦ç½‘æŠ¢è´­æµç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[å¼€å§‹] --&gt; B(ç™»é™†)</span><br><span class="line">    B --&gt; C&#123;æ˜¯å¦åˆ©ç”¨cookiesç™»é™†&#125;</span><br><span class="line">    C --&gt; |å¦| D[é¡µé¢ç™»é™†]</span><br><span class="line">    C --&gt; |æ˜¯| E[ç™»é™†éªŒè¯]</span><br><span class="line">    D --&gt; E</span><br><span class="line">    E --&gt; G&#123;æ˜¯å¦ç™»é™†æˆåŠŸ&#125;</span><br><span class="line">    G --&gt; |æ˜¯| F[è·å–è´­ç¥¨å¿…è¦ä¿¡æ¯]</span><br><span class="line">    G --&gt; |å¦|ED</span><br><span class="line">    F --&gt; L[æ£€æµ‹æŠ¢ç¥¨ç°åœ¨è´­ç¥¨çŠ¶æ€]</span><br><span class="line">    L --&gt; M&#123;ç›®æ ‡ç¥¨å¯è¿›è¡ŒæŠ¢è´­&#125;</span><br><span class="line">    M --&gt; |å³å°†å¼€æŠ¢|L</span><br><span class="line">    M --&gt; |ç¼ºè´§ç™»è®°|ED((ç»“æŸ))</span><br><span class="line">M --&gt; |ç«‹åˆ»è´­ä¹°|N&#123;æŠ¢è´­&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è·Ÿé™æ—¶ã€å®šæ—¶ç§’æ€ä¸åŒçš„æ˜¯ï¼Œå¤§éº¦ç½‘çš„æŠ¢è´­ä¿¡æ¯æ˜¯é ä¸æ–­åˆ·æ–°çš„ï¼Œéœ€è¦é€šè¿‡ä¸æ–­æ£€æµ‹é¡µé¢å†…å®¹ï¼Œåˆ¤æ–­ç›®å‰ç¥¨çš„å¯å¦è´­ä¹°æƒ…å†µã€‚å¦‚æœåˆ·æ–°ä¸ºå¯è´­ä¹°åˆ™è¿›è¡ŒæŠ¢è´­è´­ä¹°ã€‚</p></blockquote><ul><li><p>ç‚¹å‡»è´­ä¹°æ˜¯å¯¹æŒ‡å®šæ¥å£å‘é€è¯·æ±‚ï¼Œå¹¶æ›´æ–°cookies(cookieså«Œå°‘ä¸å«Œå¤š)ï¼šstep2_click_buy_now</p></li><li><p>æäº¤è®¢å•ï¼šstep3_submit_order</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">response = self.session.post(<span class="string">'https://buy.damai.cn/multi/trans/createOrder'</span>,</span><br><span class="line">                             headers=headers,</span><br><span class="line">                             params=params,</span><br><span class="line">                             data=submit_order_info,</span><br><span class="line">                             cookies=self.login_cookies)</span><br><span class="line">buy_status = json.loads(response.text)</span><br><span class="line"><span class="keyword">if</span> buy_status.get(<span class="string">'success'</span>) <span class="keyword">is</span> <span class="keyword">True</span> <span class="keyword">and</span> buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>):</span><br><span class="line">    print(<span class="string">'-'</span> * <span class="number">10</span>, <span class="string">'æŠ¢ç¥¨æˆåŠŸ, è¯·å‰å¾€ å¤§éº¦ç½‘-&gt;æˆ‘çš„å¤§éº¦-&gt;äº¤æ˜“ä¸­å¿ƒ-&gt;è®¢å•ç®¡ç† ç¡®è®¤è®¢å•'</span>, <span class="string">'-'</span> * <span class="number">10</span>)</span><br><span class="line">    print(<span class="string">'alipayOrderId: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>))</span><br><span class="line">    print(<span class="string">'æ”¯ä»˜å®æ”¯ä»˜é“¾æ¥: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayWapCashierUrl'</span>))</span><br></pre></td></tr></table></figure></li></ul><h3 id="nikerobot"><a class="markdownIt-Anchor" href="#nikerobot"></a> <strong><a href="https://github.com/cxiaoer/NikeRobot" target="_blank" rel="noopener"> NikeRobot</a></strong></h3><ul><li><p>pdbè°ƒè¯•æ–­ç‚¹ï¼š==&gt;å®é™…ä¸ŠPycharmçš„è°ƒè¯•æ›´åŠ å¥½ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">pdb.set_trace()</span><br></pre></td></tr></table></figure></li><li><p>å°†ç±»æˆå‘˜å±æ€§è½¬æˆå­—å…¸å½¢å¼: <code>NikeLoginParam().__dict__</code></p></li><li><p>è‡ªå·±ç®¡ç†çº¿ç¨‹ï¼šåˆ›å»ºç»§æ‰¿Threadçš„æ‰§è¡Œç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œåœ¨mainä¸­è¿›è¡Œåˆ›å»ºå¤šä¸ªå®ä¾‹MyThread().start()ï¼Œå¹¶joinä½ã€‚</p></li></ul><h3 id="hpv4g"><a class="markdownIt-Anchor" href="#hpv4g"></a> <strong><a href="https://github.com/xiangmingzhe0928/hpv4g" target="_blank" rel="noopener">hpv4g</a>â˜…</strong></h3><ul><li><p>æ˜¯å¦ä½¿ç”¨ä»£ç†ï¼š<code>init_ip_proxy_pool</code></p></li><li><p>å¤šçº¿ç¨‹å‚æ•°è®¾ç½®: python3.8ä¸­ThreadPoolExecutorçš„é»˜è®¤workerï¼š<code>max_workers = min(32, os.cpu_count() + 4)</code></p></li><li><p>çº¿ç¨‹æ± ï¼šThreadPoolExecutor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, FIRST_COMPLETED</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ThreadPoolExecutor(max_workers=max_workers) <span class="keyword">as</span> t:</span><br><span class="line">    fs = [t.submit(sec_kill_task, miao_miao, params[i % _params_len],</span><br><span class="line">                   <span class="keyword">None</span> <span class="keyword">if</span> <span class="keyword">not</span> _ip_proxys_len <span class="keyword">else</span> &#123;</span><br><span class="line">                       <span class="string">'http'</span>: <span class="keyword">None</span> <span class="keyword">if</span> (index := i % _ip_proxys_len) == <span class="number">0</span> <span class="keyword">else</span> ip_proxys[index]&#125;) <span class="keyword">for</span> i <span class="keyword">in</span></span><br><span class="line">          range(max_workers + <span class="number">5</span>)]</span><br><span class="line">    <span class="comment"># 120Såç»“æŸä»»åŠ¡, æœ‰ä¸€ä¸ªå®Œæˆåˆ™å®Œæˆ</span></span><br><span class="line">    wait(fs, <span class="number">120</span>, return_when=FIRST_COMPLETED)</span><br><span class="line">    <span class="keyword">global</span> KILL_FLAG</span><br><span class="line">    KILL_FLAG = <span class="keyword">True</span></span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;æœ¬è½®æœªæˆåŠŸç§’æ€åˆ°ç–«è‹—&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;'</span>)</span><br></pre></td></tr></table></figure></li><li><p>ç¼“å­˜é…ç½®â€”â€”éé»˜è®¤å‚æ•°çš„è£…é¥°å™¨ï¼šè€ƒè™‘æå‰ç¼“å­˜ç–«è‹—åˆ—è¡¨ ç§’æ€å¼€å§‹åè·³è¿‡æŸ¥è¯¢åˆ—è¡¨ç­‰æ“ä½œ ç›´æ¥è°ƒç”¨ç§’æ€æ¥å£</p></li><li><p>è·å–æœåŠ¡å™¨å½“å‰æ—¶é—´æˆ³</p></li><li><p>ç›´æ¥è®¾ç½®loggingä¸­çš„log</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># è®¾ç½®é…ç½®</span></span><br><span class="line">logging.basicConfig(handlers=[logging.FileHandler(filename=LOG_NAME,</span><br><span class="line">                                                  encoding=<span class="string">'utf-8'</span>, mode=<span class="string">'a+'</span>)],</span><br><span class="line">                    format=<span class="string">'%(asctime)s %(message)s'</span>,</span><br><span class="line">                    level=getattr(logging, args.log))</span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line">logging.info(<span class="string">"xxx"</span>)</span><br><span class="line">logging.debug(<span class="string">"yyy"</span>)</span><br></pre></td></tr></table></figure></li><li><p>argueparserä½¿ç”¨ï¼š</p><ul><li><p>actionå‚æ•°: <code>parser.add_argument('-reload_cache', action='store_true', help='åˆ·æ–°--region_codeç–«è‹—åˆ—è¡¨æœ¬åœ°ç¼“å­˜')</code>ï¼Œå‡ºç°reload_cacheå‚æ•°åˆ™ä¸ºtrueï¼Œæ‰€ä»¥é»˜è®¤ä¸ºfalse</p></li><li><p><code>parser.add_argument('--log', default='WARNING', choices=['DEBUG', 'INFO', 'WARNING', 'ERROR'],help='æ—¥å¿—çº§åˆ« é»˜è®¤WARNING')</code></p></li><li><p>add_argumentä¸­çš„typeå®é™…ä¸Šæ˜¯ä¸ªç±»å‹è½¬åŒ–å™¨ï¼Œå¦‚type=intï¼Œå¦‚æœæ— æ³•è½¬æˆintåˆ™æŠ¥é”™ï¼Œå› æ­¤å¯ä»¥å€Ÿæ­¤å‚æ•°å¯¹è¾“å…¥è¿›è¡Œçº¦æŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_valid_int_type</span><span class="params">(i)</span>:</span></span><br><span class="line">    valid_int = int(i)</span><br><span class="line">    <span class="keyword">if</span> valid_int &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> argparse.ArgumentTypeError(<span class="string">f'invalid int argument:<span class="subst">&#123;i&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> valid_int</span><br></pre></td></tr></table></figure></li></ul></li><li><p>requestsä½¿ç”¨ï¼š</p><ul><li><p><code>raise_for_status</code>çŠ¶æ€ç éæˆåŠŸæ—¶æŠ›å‡ºå¼‚å¸¸</p></li><li><p>è‡ªå®šä¹‰<code>_get(url, params=None, error_exit=True, **kwargs)</code>æ–¹æ³•ï¼Œæ·»åŠ å‚æ•°ï¼šerror_exit:è¿”å›4XX 5XXé”™è¯¯æ—¶ æ˜¯å¦é€€å‡º</p></li><li><p>cookiesé™¤äº†æ”¾åœ¨requests.get(cookies=xxxCookieDict)ï¼Œè¿˜å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²è®¾ç½®åœ¨header[â€œ<strong>cookie</strong>â€]ä¸­ï¼ˆæ— sï¼‰ï¼Œå¦‚<code>self._headers[&quot;cookie&quot;]=&quot;k1=v1;_xxhm_=%7B%2x%7D;k3=wxapptoken:v3&quot;</code>ï¼Œé€šè¿‡<code>;</code>æ¥åˆ†å‰²</p></li><li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># disable ssl warnings</span></span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="æŠ¢è´­å‹ä»£ç æ€»ç»“"><a class="markdownIt-Anchor" href="#æŠ¢è´­å‹ä»£ç æ€»ç»“"></a> æŠ¢è´­å‹ä»£ç æ€»ç»“ï¼š</h3><ul><li><p>å®ç°ä¸»è¦åˆ†ä¸ºselenium(è‡ªåŠ¨æµ‹è¯•å·¥å…·)æ¨¡æ‹Ÿç‚¹å‡»ï¼›apiæ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</p></li><li><p>ç™»é™†ä¹‹åä¼šå¯¹cookiesè¿›è¡ŒæŒä¹…åŒ–ï¼Œä½¿ç”¨pickleçš„å¥½å¤„æ˜¯æ— æ³•æ˜æ–‡çœ‹æ‡‚ã€å¤åˆ¶</p></li><li><p>å¯ä»¥é€šè¿‡æŒä¹…åŒ–çš„cookiesæ¥ç™»é™†ï¼Œä½†ä¼šæ£€æµ‹cookiesæ˜¯å¦ä»ç„¶æœ‰æ•ˆ</p></li><li><p>å®šæ—¶æŠ¢è´­ä¼šç­‰å¾…sleepåˆ°ä¸´è¿‘æ—¶é—´(while True+sleep(time)çš„æ–¹å¼ or sleepUntil+while try)ï¼Œç„¶åå†è¿›è¡Œå¤šæ¬¡æŠ¢è´­è¯·æ±‚ï¼ˆå¦‚æœæŠ¢è´­çš„2åˆ†é’Ÿå†…æ²¡æŠ¢åˆ°ï¼Œå¤§å¤šæ²¡å¸Œæœ›äº†ï¼Œåªå¥½ç­‰å¾…ä¸‹æ¬¡ï¼‰ï¼›å¦‚æœæ˜¯<a href="#Automatic_ticket_purchase">ç­‰å¾…é¡µé¢åˆ·æ–°çš„</a>ï¼Œåˆ™ä¸æ–­è¯·æ±‚é¡µé¢ï¼Œç­‰åˆ°ç»“æœæ”¹å˜ã€‚</p><ul><li>æ³¨æ„ï¼šç­‰å¾…é—´éš”ä¸è¦è¶…è¿‡æ—¶é—´é˜ˆå€¼ï¼Œå¦‚180så‰æ£€æŸ¥ï¼Œå¦‚æœä¸ç¬¦åˆä¸èƒ½è®©å…¶ç­‰å¾…190s</li></ul></li><li><p>æ¨é€å·¥å…·ï¼šæä¾›ä¸€ä¸ªè‡ªå·±å†™çš„</p><p>config.ini</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[pusher]</span></span><br><span class="line"><span class="attr">pusher_type</span> = pushplus</span><br><span class="line"><span class="attr">push_title</span> = é£é±¼ç§’æ€</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://sct.ftqq.com/</span></span><br><span class="line"><span class="section">[serverchan]</span></span><br><span class="line"><span class="attr">sec_key</span> = SCU35113Te369cebc21f6e483c03fffc400c4c5c05bdad63995c32</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://open.dingtalk.com/document/group/custom-robot-access</span></span><br><span class="line"><span class="section">[dingding]</span></span><br><span class="line"><span class="attr">access_token</span> =</span><br><span class="line"><span class="attr">secret</span> =</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://www.pushplus.plus/</span></span><br><span class="line"><span class="section">[pushplus]</span></span><br><span class="line"><span class="attr">pushplus_token</span> = fedcf6b08f6f4aaeb2948b7d7010eb93</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">'Mrli'</span></span><br><span class="line"></span><br><span class="line">CONFIG_INI_FILENAME = <span class="string">"push_config.ini"</span></span><br><span class="line">CONFIG_INI_PATH = Path(__file__).resolve().parent.with_name(<span class="string">"push_config.ini"</span>)</span><br><span class="line"></span><br><span class="line">REMIND_MSG = <span class="string">"""</span></span><br><span class="line"><span class="string">[pusher]</span></span><br><span class="line"><span class="string">pusher_type = pushplus</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[serverchan]</span></span><br><span class="line"><span class="string">sec_key =</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[dingding]</span></span><br><span class="line"><span class="string">access_token =</span></span><br><span class="line"><span class="string">secret =</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[pushplus]</span></span><br><span class="line"><span class="string">pushplus_token = </span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PusherException</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, message)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        super().__init__(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IPushUtil</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PushplusPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.pushplus_token = options.get(<span class="string">"pushplus_token"</span>)</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        d = &#123;</span><br><span class="line">            <span class="string">"token"</span>: self.pushplus_token,</span><br><span class="line">            <span class="string">"template"</span>: <span class="string">"markdown"</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"&#123;push_title&#125;-&#123;title&#125;"</span>.format(push_title=self.push_title, title=title),</span><br><span class="line">            <span class="string">"content"</span>: content</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(<span class="string">"http://www.pushplus.plus/send"</span>, data=d)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">200</span> &lt;= res.json().get(<span class="string">"code"</span>) &lt; <span class="number">300</span>):</span><br><span class="line">            print(res.json())</span><br><span class="line">        <span class="keyword">return</span> <span class="number">200</span> &lt;= res.json().get(<span class="string">"code"</span>) &lt; <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ServerChanPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.sec_key = options.get(<span class="string">"sec_key"</span>)</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'text'</span>: <span class="string">"&#123;push_title&#125;-&#123;title&#125;"</span>.format(push_title=self.push_title, title=title),</span><br><span class="line">            <span class="string">'desp'</span>: content</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=<span class="string">'https://sc.ftqq.com/&#123;&#125;.send'</span>.format(self.sec_key), data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (res.json().get(<span class="string">"errmsg"</span>) == <span class="string">"success"</span>):</span><br><span class="line">            print(res.json())</span><br><span class="line">        <span class="keyword">return</span> res.json().get(<span class="string">"errmsg"</span>) == <span class="string">"success"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DingDingPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    URL = <span class="string">"https://oapi.dingtalk.com/robot/send"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.access_token = options.get(<span class="string">"access_token"</span>)</span><br><span class="line">        self.secret = options.get(<span class="string">"secret"</span>)</span><br><span class="line">        self.target_url = self.get_url()</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_url</span><span class="params">(self)</span>:</span></span><br><span class="line">        timestamp = round(time.time() * <span class="number">1000</span>)</span><br><span class="line">        secret_enc = bytes(self.secret, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">        string_to_sign = <span class="string">"&#123;&#125;\n&#123;&#125;"</span>.format(timestamp, self.secret)</span><br><span class="line">        string_to_sign_enc = bytes(string_to_sign, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">        hmac_code = hmac.new(</span><br><span class="line">            secret_enc, string_to_sign_enc, digestmod=hashlib.sha256</span><br><span class="line">        ).digest()</span><br><span class="line">        sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class="line">        <span class="keyword">return</span> self.URL + <span class="string">"?access_token=&#123;access_token&#125;&amp;timestamp=&#123;timestamp&#125;&amp;sign=&#123;sign&#125;"</span>.format(</span><br><span class="line">            access_token=self.access_token, timestamp=timestamp, sign=sign)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        msg = self.gen_markdown_msg(title, content)</span><br><span class="line">        <span class="keyword">return</span> self.send(msg)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(self, message)</span>:</span></span><br><span class="line">        resp = requests.post(self.target_url, json=message)</span><br><span class="line">        <span class="keyword">return</span> resp.json()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_text_msg</span><span class="params">(content, at=None, at_all=False)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> at <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            at = []</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"msgtype"</span>: <span class="string">"text"</span>,</span><br><span class="line">            <span class="string">"text"</span>: &#123;<span class="string">"content"</span>: content&#125;,</span><br><span class="line">            <span class="string">"at"</span>: &#123;<span class="string">"atMobiles"</span>: at, <span class="string">"isAtAll"</span>: at_all&#125;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_markdown_msg</span><span class="params">(self, title, text, at=None, at_all=False)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">generateText</span><span class="params">()</span>:</span></span><br><span class="line">            res = <span class="string">""</span></span><br><span class="line">            <span class="comment"># æœ€é¡¶è¡Œæ˜¾ç¤ºæ ‡é¢˜</span></span><br><span class="line">            res += <span class="string">"# "</span> + <span class="string">"&#123;&#125;-"</span>.format(self.push_title) + title + <span class="string">"\n"</span></span><br><span class="line">            <span class="comment"># å†…å®¹</span></span><br><span class="line">            res += text</span><br><span class="line">            <span class="comment"># atå¯¹è±¡</span></span><br><span class="line">            res += reduce(<span class="keyword">lambda</span> x, y: x + <span class="string">"@"</span> + y, at, <span class="string">""</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"msgtype"</span>: <span class="string">"markdown"</span>,</span><br><span class="line">            <span class="string">"markdown"</span>: &#123;</span><br><span class="line">                <span class="string">"title"</span>: title,</span><br><span class="line">                <span class="string">"text"</span>: generateText()</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"at"</span>: &#123;<span class="string">"atMobiles"</span>: at, <span class="string">"isAtAll"</span>: at_all&#125;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pusher</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, logger=None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> logger:</span><br><span class="line">            self.cout = logger.info</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cout = <span class="keyword">print</span></span><br><span class="line">        self._pusher = self.init()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        å®ä¾‹åŒ–pusher</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">from</span> configparser <span class="keyword">import</span> RawConfigParser</span><br><span class="line">        cp = RawConfigParser()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(CONFIG_INI_PATH):</span><br><span class="line">            <span class="keyword">raise</span> PusherException(</span><br><span class="line">                <span class="string">"è¯·åˆ›å»º&#123;filename&#125;é…ç½®æ–‡ä»¶\npusheré…ç½®ä¿¡æ¯å¦‚ä¸‹:\n&#123;msg&#125;"</span>.format(filename=CONFIG_INI_FILENAME, msg=REMIND_MSG))</span><br><span class="line">        cp.read(CONFIG_INI_PATH, encoding=<span class="string">"utf8"</span>)</span><br><span class="line">        pusher_type = cp.get(<span class="string">"pusher"</span>, <span class="string">"pusher_type"</span>).lower()</span><br><span class="line">        push_title = cp.get(<span class="string">"pusher"</span>, <span class="string">"push_title"</span>)</span><br><span class="line">        <span class="comment"># æ˜¯å¦ä½¿ç”¨äº†pusher</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pusher_type:</span><br><span class="line">            self.cout(<span class="string">"åˆå§‹åŒ–Pusher: å½“å‰æœªé…ç½®Pusher, å¦‚æœéœ€è¦æ¨é€åŠŸèƒ½, åˆ™åœ¨&#123;filename&#125;"</span>.format(filename=CONFIG_INI_FILENAME))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">        generator_info = dict(cp.items(pusher_type))</span><br><span class="line">        <span class="comment"># æ£€æŸ¥pusheré…ç½®</span></span><br><span class="line">        <span class="keyword">if</span> pusher_type <span class="keyword">and</span> <span class="keyword">not</span> self._valid(generator_info):</span><br><span class="line">            <span class="keyword">raise</span> PusherException(<span class="string">"&#123;&#125;_pusheré…ç½®é”™è¯¯ï¼Œä¸èƒ½ä¸ºç©º~"</span>.format(pusher_type))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pusher_type == <span class="string">"serverchan"</span>:</span><br><span class="line">            <span class="keyword">return</span> ServerChanPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">elif</span> pusher_type == <span class="string">"dingding"</span>:</span><br><span class="line">            <span class="keyword">return</span> DingDingPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">elif</span> pusher_type == <span class="string">"pushplus"</span>:</span><br><span class="line">            <span class="keyword">return</span> PushplusPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> PusherException(<span class="string">"ä¸å¯çŸ¥pusherç±»å‹~"</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_valid</span><span class="params">(config_dict: dict)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        åˆ¤æ–­å­—å…¸å€¼æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="string">        :param dict:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> config_dict.values():</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> v:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self._pusher:</span><br><span class="line">            self.cout(<span class="string">"å½“å‰æœªé…ç½®pusher, æ¶ˆæ¯æ— æ³•å‘é€"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> self._pusher.push(content, title)</span><br></pre></td></tr></table></figure><h2 id="weibospider"><a class="markdownIt-Anchor" href="#weibospider"></a> <a href="https://github.com/dataabc/weiboSpider" target="_blank" rel="noopener">weiboSpider</a></h2><blockquote><p>å¯ä»¥è¿ç»­çˆ¬å–<strong>ä¸€ä¸ª</strong>æˆ–<strong>å¤šä¸ª</strong>æ–°æµªå¾®åšç”¨æˆ·ï¼ˆå¦‚<a href="https://weibo.cn/u/1223178222" target="_blank" rel="noopener">èƒ¡æ­Œ</a>ã€<a href="https://weibo.cn/u/1669879400" target="_blank" rel="noopener">è¿ªä¸½çƒ­å·´</a>ã€<a href="https://weibo.cn/u/1729370543" target="_blank" rel="noopener">éƒ­ç¢§å©·</a>ï¼‰çš„æ•°æ®ï¼Œå¹¶å°†ç»“æœä¿¡æ¯å†™å…¥<strong>æ–‡ä»¶</strong>æˆ–<strong>æ•°æ®åº“</strong>ã€‚</p></blockquote><ul><li>â‘ å…è®¸ç”¨æˆ·æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶ï¼›â‘¡å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œå¹¶å¯¹éæ³•é¡¹è¿›è¡Œæç¤º</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">config = _get_config()</span><br><span class="line">    config_util.validate_config(config)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_config</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""è·å–config.jsonæ•°æ®"""</span></span><br><span class="line">    src = os.path.split(</span><br><span class="line">        os.path.realpath(__file__))[<span class="number">0</span>] + os.sep + <span class="string">'config_sample.json'</span></span><br><span class="line">    config_path = os.getcwd() + os.sep + <span class="string">'config.json'</span></span><br><span class="line">    <span class="keyword">if</span> FLAGS.config_path:</span><br><span class="line">        config_path = FLAGS.config_path</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate_config</span><span class="params">(config)</span>:</span></span><br><span class="line">    <span class="string">"""éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># éªŒè¯filterã€pic_downloadã€video_download</span></span><br><span class="line">    argument_list = [<span class="string">'filter'</span>, <span class="string">'pic_download'</span>, <span class="string">'video_download'</span>]</span><br><span class="line">    <span class="keyword">for</span> argument <span class="keyword">in</span> argument_list:</span><br><span class="line">        <span class="keyword">if</span> config[argument] != <span class="number">0</span> <span class="keyword">and</span> config[argument] != <span class="number">1</span>:</span><br><span class="line">            logger.warning(<span class="string">u'%så€¼åº”ä¸º0æˆ–1,è¯·é‡æ–°è¾“å…¥'</span>, config[argument])</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éªŒè¯since_date</span></span><br><span class="line">    since_date = config[<span class="string">'since_date'</span>]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> _is_date(str(since_date))) <span class="keyword">and</span> (<span class="keyword">not</span> isinstance(since_date, int)):</span><br><span class="line">        logger.warning(<span class="string">u'since_dateå€¼åº”ä¸ºyyyy-mm-ddå½¢å¼æˆ–æ•´æ•°,è¯·é‡æ–°è¾“å…¥'</span>)</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure><h2 id="proxy_pool"><a class="markdownIt-Anchor" href="#proxy_pool"></a> <strong><a href="https://github.com/jhao104/proxy_pool" target="_blank" rel="noopener">proxy_pool</a>â˜…</strong></h2><blockquote><p>çˆ¬è™«ä»£ç†IPæ± é¡¹ç›®,ä¸»è¦åŠŸèƒ½ä¸ºå®šæ—¶é‡‡é›†ç½‘ä¸Šå‘å¸ƒçš„å…è´¹ä»£ç†éªŒè¯å…¥åº“ï¼Œå®šæ—¶éªŒè¯å…¥åº“çš„ä»£ç†ä¿è¯ä»£ç†çš„å¯ç”¨æ€§ï¼Œæä¾›APIå’ŒCLIä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥æ‰©å±•ä»£ç†æºä»¥å¢åŠ ä»£ç†æ± IPçš„è´¨é‡å’Œæ•°é‡ã€‚</p><p>æ¨¡å—ç»„æˆï¼šè·å–åŠŸèƒ½ã€å­˜å‚¨åŠŸèƒ½ã€æ ¡éªŒåŠŸèƒ½ã€æ¥å£ç®¡ç†</p><p>â­ï¸ç¨‹åºä¸»è¦æ˜¯å¯åŠ¨äº†<code>startServer</code>çš„APIæ¥å£æœåŠ¡ã€<code>startScheduler</code>å®šæ—¶æœåŠ¡</p><ul><li><code>startServer-&gt;runFlask</code>ï¼šæ˜¯å‘å¤–æä¾›äº†é€šè¿‡<strong>proxyHandler</strong>æ¥è·å¾—Redisä¸­çš„proxyæ•°æ®</li><li><code>startScheduler-&gt;sche.add_task(__runProxyFetch)ã€sche.add_task(__runProxyCheck)</code>ï¼Œ<ul><li><code>__runProxyFetch:proxy_fetcher.run()-&gt;proxy_queue-&gt;Checker(&quot;raw&quot;, proxy_queue)</code>è·å¾—å„ä¸ªä»£ç†ç½‘ç«™çš„ä»£ç†ä¿¡æ¯åï¼Œè¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸåˆ™å…¥åº“</li><li><code>__runProxyCheck:proxy in proxy_handler.getAll()-&gt;proxy_queue-&gt;Checker(&quot;use&quot;, proxy_queue)</code>ï¼šé€šè¿‡proxy_handleræ‹¿åˆ°åº“é‡Œæ‰€æœ‰ç°å­˜çš„æ•°æ®åï¼Œè¿›è¡Œæœ‰æ•ˆæ€§æ ¡éªŒï¼Œæ— æ•ˆçš„åˆ™åˆ é™¤ï¼Œæœ‰æ•ˆçš„åˆ™æ›´æ–°ä¿¡æ¯</li></ul></li></ul><p>ä½œä¸ºå­˜å‚¨åŠŸèƒ½çš„æ¥å£proxyHandlerï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªAPIæœåŠ¡ä¸å®šæ—¶æœåŠ¡çš„ä¸­ä»‹ã€‚ç¨‹åºä¹Ÿæ˜¯é€šè¿‡å­˜å‚¨åŠŸèƒ½ï¼Œå°†æ ¸å¿ƒçš„ä¸¤ä¸ªåŠŸèƒ½ï¼š<u>å®šæ—¶æŠ“å–çš„proxyæ•°æ®</u>ä¸<u>æä¾›proxyæ•°æ®ç»™ç”¨æˆ·ä½¿ç”¨</u>æˆåŠŸè”ç³»åœ¨äº†ä¸€èµ·</p></blockquote><ul><li><p>é€šè¿‡å…ƒç±»å®ç°å•ä¾‹æ¨¡å¼ï¼šConfigHandlerï¼Œå…¶å¯ä»¥åœ¨ä»»æ„æ¨¡å—ä¸­ä»¥c = ConfigHandler()çš„å½¢å¼è·å¾—ï¼Œè€Œä¸æ˜¯<code>ConfigHandler.getInstance()</code></p></li><li><p><code>@LazyProperty</code>æ‡’åŠ è½½å±æ€§çš„è£…é¥°å™¨ï¼š åªæœ‰ç”¨åˆ°æ—¶æ‰ä¼šåŠ è½½å¹¶å°†å€¼æ³¨å…¥åˆ°<code>__dict__</code>ã€åŠ è½½ä¸€æ¬¡åå€¼å°±ä¸å†å˜åŒ–ã€ï¼›è®²è§£å¯è§ï¼š<a href="https://www.jianshu.com/p/708dc26f9b92%E2%80%94%E2%80%94%E6%8F%8F%E8%BF%B0%E7%AC%A6or%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%AE%9E%E7%8E%B0" target="_blank" rel="noopener">https://www.jianshu.com/p/708dc26f9b92â€”â€”æè¿°ç¬¦orä¿®é¥°ç¬¦å®ç°</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LazyProperty</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># åœ¨è¢«æ³¨è§£ç±»æ–¹æ³•è¢«è§£é‡Šå™¨è¿è¡Œçš„æ—¶å€™å°±ä¼šåˆ›å»ºLazyPropertyå®ä¾‹å¹¶è¿”å›</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func)</span>:</span></span><br><span class="line">        self.func = func</span><br><span class="line">    <span class="string">"""é€šè¿‡pythonæè¿°ç¬¦æ¥å®ç°"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä¼šå°†ç»“æœå€¼é€šè¿‡setattræ–¹æ³•å­˜å…¥åˆ°instanceå¯¹è±¡å®ä¾‹çš„__dict__ä¸­</span></span><br><span class="line">            value = self.func(instance)</span><br><span class="line">            setattr(instance, self.func.__name__, value)</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    <span class="comment"># è¿”å›ä¸€ä¸ªLazyPropertyå®ä¾‹ </span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br><span class="line">c = ConfigHandler()</span><br><span class="line"><span class="comment"># ä¼šè§¦å‘ConfigHandler.__dict__["serverHost"], ç„¶åæ¥è€Œè§¦å‘LazyPropertyçš„__get__ï¼Œvalue = self.func(instance)ä¼šå¾—åˆ°çœŸæ­£serverHostå‡½æ•°çš„å€¼åå°†å…¶è®¾ç½®åœ¨ConfigHandler instanceå¯¹è±¡çš„__dict__ä¸­ï¼Œç”±äºå¯¹è±¡çš„__dict__["serverHost"]=valueä¼˜å…ˆçº§é«˜äºç±»çš„__dict__["serverHost"]=LazyProperty()å¯¹è±¡ï¼Œå› æ­¤ä¹‹åè°ƒç”¨å¾—åˆ°çš„æ˜¯valueç»“æœ</span></span><br><span class="line">print(c.serverHost)</span><br></pre></td></tr></table></figure><p><code>__get__</code>åªæœ‰è®¿é—®ç±»å±æ€§çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™è¾¹æ˜¯é€šè¿‡setattrå°†serverHostè®¾ç½®æˆäº†ConfigHandlerçš„ç±»å±æ€§</p></li><li><p>å°è£…äº†ä¸€ä¸ªè¯·æ±‚å·¥å…·ç±»<code>WebRequest</code>:</p><ul><li>å¢åŠ äº†å¼‚å¸¸å¤„ç†çš„åŠŸèƒ½</li><li>å¢åŠ äº†æ—¥å¿—åŠŸèƒ½</li><li>è¯·æ±‚å¤´ä¼šå¾—åˆ°éšæœºUA</li><li>è®¾ç½®é‡è¯•</li></ul></li><li><p>ä½¿ç”¨clickåˆ›å»ºå­å‘½ä»¤ï¼š</p><ol><li>å¾—åˆ°ä¸€ä¸ªclick_group</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CONTEXT_SETTINGS = dict(help_option_names=[<span class="string">'-h'</span>, <span class="string">'--help'</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">@click.group(context_settings=CONTEXT_SETTINGS)</span></span><br><span class="line"><span class="meta">@click.version_option(version=VERSION)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cli</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""ProxyPool cliå·¥å…·"""</span></span><br></pre></td></tr></table></figure><ol start="2"><li>æŒ‡å®šgroupä¸‹çš„å­å‘½ä»¤</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cli.command(name="server")</span></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥è®¾ç½®å‚æ•°: @click.option('--count', default=1, help='Number of greetings.') --&gt; def server(count)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">""" å¯åŠ¨apiæœåŠ¡ """</span></span><br><span class="line">    click.echo(BANNER)</span><br><span class="line">    startServer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    cli()</span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡bashè„šæœ¬åŒæ—¶å¼€å¯ä¸¤ä¸ªè¿›ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">python proxyPool.py server &amp;</span><br><span class="line">python proxyPool.py schedule</span><br></pre></td></tr></table></figure></li><li><p>DbClient DBå·¥å‚ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DbClient</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, db_conn)</span>:</span></span><br><span class="line">        self.parseDbConn(db_conn)</span><br><span class="line">        self.__initDbClient()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parseDbConn</span><span class="params">(cls, db_conn)</span>:</span></span><br><span class="line">        <span class="comment"># å¯ä»¥å…³æ³¨ä¸€ä¸‹urlparseçš„ä½¿ç”¨</span></span><br><span class="line">        db_conf = urlparse(db_conn)</span><br><span class="line">        cls.db_type = db_conf.scheme.upper().strip()</span><br><span class="line">        <span class="comment"># _NetlocResultMixinBaseå¯¹è±¡æ¥è·å–æƒ³è¦çš„å‚æ•°</span></span><br><span class="line">        cls.db_host = db_conf.hostname</span><br><span class="line">        cls.db_port = db_conf.port</span><br><span class="line">        cls.db_user = db_conf.username</span><br><span class="line">        cls.db_pwd = db_conf.password</span><br><span class="line">        cls.db_name = db_conf.path[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">return</span> cls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__initDbClient</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        init DB Client</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        __type = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"SSDB"</span> == self.db_type:</span><br><span class="line">            __type = <span class="string">"ssdbClient"</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">"REDIS"</span> == self.db_type:</span><br><span class="line">            __type = <span class="string">"redisClient"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">assert</span> __type, <span class="string">'type error, Not support DB type: &#123;&#125;'</span>.format(self.db_type)</span><br><span class="line">        self.client = getattr(__import__(__type), <span class="string">"%sClient"</span> % self.db_type.title())(host=self.db_host,</span><br><span class="line">port=self.db_port,</span><br><span class="line">username=self.db_user,</span><br><span class="line">password=self.db_pwd,</span><br><span class="line">db=self.db_name)</span><br></pre></td></tr></table></figure></li><li><p>pythonä¸­ä½¿ç”¨redis</p><blockquote><p>Redisä¸­ä»£ç†å­˜æ”¾çš„ç»“æ„ä¸ºhashï¼šhash  æ˜¯ä¸€ä¸ªé”®å€¼(key=&gt;value)å¯¹é›†åˆï¼›æ˜¯ä¸€ä¸ª string ç±»å‹çš„ fieldï¼ˆå­—æ®µï¼‰ å’Œ valueï¼ˆå€¼ï¼‰ çš„<strong>æ˜ å°„è¡¨</strong>ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚</p><p>æœ¬é¡¹ç›®ä¸­åº”ç”¨ï¼škeyä¸ºip:port, valueä¸ºä»£ç†å±æ€§çš„å­—å…¸;</p></blockquote><ul><li>pythonä¸åˆ›å»ºè¿æ¥</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install redis</span></span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> Redis, BlockingConnectionPool</span><br><span class="line">conn_dict = &#123;</span><br><span class="line">    <span class="string">"host"</span>: <span class="string">"49.235.118.244"</span>,</span><br><span class="line">    <span class="string">"port"</span>: <span class="number">6379</span>,</span><br><span class="line">    <span class="string">"db"</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">r = Redis(connection_pool=BlockingConnectionPool(decode_responses=<span class="keyword">True</span>,</span><br><span class="line">                                                 timeout=<span class="number">5</span>,</span><br><span class="line">                                                 socket_timeout=<span class="number">15</span>,</span><br><span class="line">                                                 **conn_dict)</span><br><span class="line">         )</span><br></pre></td></tr></table></figure><ul><li><a href="https://github.com/jhao104/proxy_pool/blob/master/db/redisClient.py" target="_blank" rel="noopener">â˜…hashä½¿ç”¨å°è£…</a></li></ul><blockquote><p>æ·»åŠ ï¼šsetã€zsetä¸ºaddã€listä¸ºpushã€stringå’Œhashä¸ºset</p></blockquote><p>å‚è€ƒ:<a href="https://blog.csdn.net/weixin_39576234/article/details/87603701" target="_blank" rel="noopener">RedisåŸºæœ¬æ¦‚å¿µåŠä½¿ç”¨</a>ã€<a href="https://www.runoob.com/redis/redis-sorted-sets.html%E3%80%81" target="_blank" rel="noopener">https://www.runoob.com/redis/redis-sorted-sets.htmlã€</a><a href="https://www.runoob.com/w3cnote/python-redis-intro.html" target="_blank" rel="noopener">â˜…Python redis ä½¿ç”¨ä»‹ç»</a></p><p><img src="/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/E:%5Chexo%5Csource_posts%5C%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95%5Credis.jpg" alt="redis"></p></li><li><p>ç»§æ‰¿é‡å†™logging.loggerï¼Œå¯é€‰å‚æ•°ä¸º<code>name, level=DEBUG, stream=True, file=True</code>ï¼Œè®©æ¯ä¸ªåŠŸèƒ½å‡½æ•°éƒ½èƒ½ç”Ÿæˆå•ç‹¬çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œäº†å¯é€‰æ§åˆ¶ã€‚</p><p>ç›¸æ¯”å•ä¾‹ï¼Œæ—¥å¿—ç²¾åº¦æ›´ç»†ï¼Œä½†ä¹Ÿä½¿ç”¨èµ·æ¥ä¹Ÿæ›´éº»çƒ¦ï¼Œéœ€è¦è€ƒè™‘ä»€ä¹ˆåœ°æ–¹éœ€è¦ã€‚</p></li><li><p>æä¾›&quot;æ‰©å±•ä»£ç†&quot;æ¥å£</p><ol><li><p>åœ¨<a href="https://github.com/jhao104/proxy_pool/blob/1a3666283806a22ef287fba1a8efab7b94e94bac/fetcher/proxyFetcher.py#L21" target="_blank" rel="noopener">ProxyFetcher</a>ç±»ä¸­æ·»åŠ è‡ªå®šä¹‰çš„è·å–ä»£ç†çš„é™æ€æ–¹æ³•ï¼Œ è¯¥æ–¹æ³•éœ€è¦ä»¥ç”Ÿæˆå™¨(yield)å½¢å¼è¿”å›<code>host:ip</code>æ ¼å¼çš„ä»£ç†</p></li><li><p>æ·»åŠ å¥½æ–¹æ³•åï¼Œä¿®æ”¹<a href="https://github.com/jhao104/proxy_pool/blob/1a3666283806a22ef287fba1a8efab7b94e94bac/setting.py#L47" target="_blank" rel="noopener">setting.py</a>æ–‡ä»¶ä¸­çš„<code>PROXY_FETCHER</code>é¡¹ä¸‹æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•çš„åå­—:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PROXY_FETCHER = [</span><br><span class="line">    <span class="string">"freeProxy01"</span>,    </span><br><span class="line">    <span class="string">"freeProxy02"</span>,</span><br><span class="line">    <span class="comment"># ....</span></span><br><span class="line">    <span class="string">"freeProxyCustom1"</span>  <span class="comment">#  # ç¡®ä¿åå­—å’Œä½ æ·»åŠ æ–¹æ³•åå­—ä¸€è‡´</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><code>schedule</code> è¿›ç¨‹ä¼šæ¯éš”ä¸€æ®µæ—¶é—´æŠ“å–ä¸€æ¬¡ä»£ç†ï¼Œä¸‹æ¬¡æŠ“å–æ—¶ä¼šè‡ªåŠ¨è¯†åˆ«è°ƒç”¨ä½ å®šä¹‰çš„æ–¹æ³•ã€‚</p></li></ol><p><a href="https://github.com/jhao104/proxy_pool/blob/master/helper/fetch.py" target="_blank" rel="noopener">å®ç°æ–¹å¼</a>ï¼š</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">self.log.info(<span class="string">"ProxyFetch : start"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»é…ç½®ä¸­æ‹¿æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">for</span> fetch_source <span class="keyword">in</span> self.conf.fetchers:</span><br><span class="line">    <span class="comment"># åˆ¤æ–­ProxyFetcherä¸­æ˜¯å¦æœ‰å®šä¹‰ã€æ˜¯å¦å¯è°ƒç”¨</span></span><br><span class="line">fetcher = getattr(ProxyFetcher, fetch_source, <span class="keyword">None</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> fetcher:</span><br><span class="line">self.log.error(<span class="string">"ProxyFetch - &#123;func&#125;: class method not exists!"</span>.format(func=fetch_source))</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> callable(fetcher):</span><br><span class="line">self.log.error(<span class="string">"ProxyFetch - &#123;func&#125;: must be class method"</span>.format(func=fetch_source))</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line">thread_list.append(_ThreadFetcher(fetch_source, proxy_dict))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> thread_list:</span><br><span class="line">    thread.setDaemon(<span class="keyword">True</span>)</span><br><span class="line">    thread.start()</span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> thread_list:</span><br><span class="line">    thread.join()</span><br><span class="line">self.log.info(<span class="string">"ProxyFetch - all complete!"</span>)</span><br></pre></td></tr></table></figure><ul><li><p>Cpython(é»˜è®¤å®‰è£…çš„éƒ½æ˜¯Cpython)ä¸­Dictå’Œlistã€tupleéƒ½æ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„</p><ul><li><p>ä»¥è£…é¥°å™¨çš„å½¢å¼å°†è¿‡æ»¤å™¨å°†å…¥åˆ°å®¹å™¨ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyValidator</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    pre_validator = []</span><br><span class="line">    http_validator = []</span><br><span class="line">    https_validator = []</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addPreValidator</span><span class="params">(cls, func)</span>:</span></span><br><span class="line">        cls.pre_validator.append(func)</span><br><span class="line">        <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®é™…ä¸Šæ‰§è¡Œäº† formatValidator=ProxyValidator.addPreValidator(formatValidator)</span></span><br><span class="line"><span class="comment"># ç”±äºaddPreValidatorè¿”å›äº†func, æ‰€ä»¥formatValidatorè¿˜æ˜¯åŸæ¥çš„addPreValidator, ä½†åœ¨ç±»å®šä¹‰çš„æ—¶å€™ProxyValidator.pre_validatoræ·»åŠ äº†formatValidatoræ–¹æ³•</span></span><br><span class="line"><span class="meta">@ProxyValidator.addPreValidator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">formatValidator</span><span class="params">(proxy)</span>:</span></span><br><span class="line">    <span class="string">"""æ£€æŸ¥ä»£ç†æ ¼å¼"""</span></span><br><span class="line">    verify_regex = <span class="string">r"\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;:\d&#123;1,5&#125;"</span></span><br><span class="line">    _proxy = findall(verify_regex, proxy)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">True</span> <span class="keyword">if</span> len(_proxy) == <span class="number">1</span> <span class="keyword">and</span> _proxy[<span class="number">0</span>] == proxy <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoValidator</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">""" æ ¡éªŒæ‰§è¡Œå™¨ """</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validator</span><span class="params">(cls, proxy)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æ ¡éªŒå…¥å£</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            proxy: Proxy Object</span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Proxy Object</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        http_r = cls.httpValidator(proxy)</span><br><span class="line">        https_r = <span class="keyword">False</span> <span class="keyword">if</span> <span class="keyword">not</span> http_r <span class="keyword">else</span> cls.httpsValidator(proxy)</span><br><span class="line"></span><br><span class="line">        proxy.check_count += <span class="number">1</span></span><br><span class="line">        proxy.last_time = datetime.now().strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">        proxy.last_status = <span class="keyword">True</span> <span class="keyword">if</span> http_r <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">if</span> http_r:</span><br><span class="line">            <span class="keyword">if</span> proxy.fail_count &gt; <span class="number">0</span>:</span><br><span class="line">                proxy.fail_count -= <span class="number">1</span></span><br><span class="line">            proxy.https = <span class="keyword">True</span> <span class="keyword">if</span> https_r <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            proxy.fail_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> proxy</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preValidator</span><span class="params">(cls, proxy)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> func <span class="keyword">in</span> ProxyValidator.pre_validator:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> func(proxy):</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><a href="http://www.network-science.de/ascii/" target="_blank" rel="noopener">starter-banner</a>ï¼šå¯åŠ¨æ¨ªå¹…</p><ul><li>reflection: Noã€adjustment: cewnterã€Stretch: Yesã€width: 80</li><li>è¿˜ä¸é”™çš„fontï¼š<ul><li>5lineobliqueâ€”â€”å¥½çœ‹</li><li>banner3â€”â€”æ¸…æ¥š</li><li>bellâ€”â€”æŠ½è±¡</li><li>bigâ€”â€”æ¸…æ™°</li><li>bigchiefâ€”â€”ç­‰é«˜çº¿ç‰ˆæœ¬ã€è‰ºæœ¯</li><li>blockâ€”â€”å—çŠ¶</li><li>bulbheadâ€”â€”å¯çˆ±</li><li>larry3dâ€”â€”ç«‹ä½“3d</li><li>ogreâ€”â€”æ¸…æ™°</li><li>puffyâ€”â€”æ¸…æ™°+ä¸€ç‚¹å¯çˆ±</li><li>slantâ€”â€”æ¸…æ™°+æ–œä½“</li></ul></li></ul></li><li><p>å®šæ—¶å™¨æ¡†æ¶apscheduleé…ç½®:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">scheduler = BlockingScheduler(logger=scheduler_log, timezone=timezone)</span><br><span class="line"></span><br><span class="line">scheduler.add_job(__runProxyCheck, <span class="string">'interval'</span>, minutes=<span class="number">2</span>, id=<span class="string">"proxy_check"</span>, name=<span class="string">"proxyæ£€æŸ¥"</span>)</span><br><span class="line"></span><br><span class="line">executors = &#123;</span><br><span class="line">    <span class="comment"># job_defaultsä¸­çš„max_instancesä¹Ÿå—é™äºmax_workers, æ‰€ä»¥è¦å¤§äºmax_instancesï¼›æ­¤å¤–max_workersä¹Ÿå†³å®šäº†åŒæ—¶èƒ½å¤„ç†å‡ ä¸ªåŒæ—¶å‘ç”Ÿçš„task</span></span><br><span class="line">    <span class="string">'default'</span>: &#123;<span class="string">'type'</span>: <span class="string">'threadpool'</span>, <span class="string">'max_workers'</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    <span class="string">'processpool'</span>: ProcessPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line">&#125;</span><br><span class="line">job_defaults = &#123;</span><br><span class="line">    <span class="comment"># åˆå¹¶å°†æ‰€æœ‰è¿™äº›é”™è¿‡çš„æ‰§è¡Œåˆå¹¶ä¸ºä¸€ä¸ª, é»˜è®¤ä¸ºTrueã€‚ å¦‚æœæ˜¯å®šæ—¶çš„å­˜å‚¨ä»»åŠ¡çš„è¯ï¼Œå‚æ•°è‚¯å®šä¸åŒï¼Œä¸èƒ½åˆå¹¶æ‰€ä»¥å¾—æ‰‹åŠ¨è®¾ç½®False</span></span><br><span class="line">    <span class="comment"># åƒæœ¬é¡¹ç›®æ¯éš”ä¸€æ®µæ—¶é—´æŠ“å–åˆ°çš„æ•°æ®ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥å½“ä½œä¸€æ¬¡é”™è¯¯ä»»åŠ¡åˆå¹¶</span></span><br><span class="line">    <span class="string">'coalesce'</span>: <span class="keyword">False</span>,</span><br><span class="line">    <span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä½œä¸šåªå…è®¸åŒæ—¶è¿è¡Œä¸€ä¸ªå®ä¾‹ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½œä¸šå³å°†è¿è¡Œï¼Œä½†å‰ä¸€æ¬¡è¿è¡Œå°šæœªå®Œæˆï¼Œåˆ™è®¤ä¸ºæœ€è¿‘ä¸€æ¬¡è¿è¡Œå¤±è´¥ã€‚é€šè¿‡åœ¨æ·»åŠ ä½œä¸šæ—¶ä½¿ç”¨å…³é”®å­—å‚æ•°ï¼Œå¯ä»¥è®¾ç½®è°ƒåº¦ç¨‹åºå…è®¸åŒæ—¶è¿è¡Œçš„ç‰¹å®šä½œä¸šçš„æœ€å¤§å®ä¾‹æ•°ã€‚é»˜è®¤ä¸º1</span></span><br><span class="line">    <span class="string">'max_instances'</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="comment"># æ¡†æ¶ä¼šæ£€æŸ¥æ¯ä¸ªé”™è¿‡çš„æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœå½“å‰è¿˜åœ¨misfire_grace_timeæ—¶é—´å†…ï¼Œåˆ™ä¼šé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼Œè®¾é«˜ç‚¹å°±å¯ä»¥é¿å…ä»»åŠ¡è¢«æ¼æ‰æ‰§è¡Œã€‚é»˜è®¤ä¸º1</span></span><br><span class="line">    <span class="comment"># "misfire_grace_time": 5  è¯¥é¡¹ç›®æœªä½¿ç”¨ï¼Œè€Œæ˜¯é‡‡ç”¨äº†å¤šä»»åŠ¡å®ä¾‹æ¥è§„é¿ä»»åŠ¡é”™è¿‡æ‰§è¡Œ==&gt;å³å®˜æ–¹ç»™å‡ºä¸¤ç§æ–¹æ¡ˆä¸­çš„å¦ä¸€ç§ã€‚ä»»åŠ¡é”™è¿‡ä¿¡æ¯ï¼šRun time of job "say (trigger: interval[0:00:02])" was missed by 0:00:03.010383</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduler.configure(executors=executors, job_defaults=job_defaults, timezone=timezone)</span><br><span class="line">scheduler.start()</span><br></pre></td></tr></table></figure><p>job_defaultså‚æ•°å«ä¹‰è§<a href="https://apscheduler.readthedocs.io/en/3.x/userguide.html?highlight=max_instances#modifying-jobs" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€<a href="https://blog.csdn.net/weixin_44301439/article/details/124062178" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44301439/article/details/124062178</a></p><p>æ³¨ï¼š ç»è¿‡æµ‹è¯•ï¼Œåœ¨add_taskä¸­çš„funcå¦‚æœèµ·äº†å¤šä¸ªçº¿ç¨‹ï¼Œå…¶æ‰§è¡Œä¸å—é™äºscheçš„é…ç½®</p></li><li><p>Pythonä¸­å¦‚æœåªæ˜¯ä½¿ç”¨å…¨å±€å˜é‡åˆ™ä¸éœ€è¦ç”¨globalå£°æ˜ï¼ˆå› ä¸ºå˜é‡æœå¯»ä¼šç”±å†…å¾€å¤–ï¼‰ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ä¿®æ”¹åˆ™éœ€è¦ç”¨globalå£°æ˜ï¼Œå¦åˆ™æ— æ³•æ‰¾åˆ°ç›¸åº”å˜é‡</p></li><li><p>ç”Ÿæˆå™¨ï¼šä½¿ç”¨äº†yieldå…³é”®å­—çš„å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨ï¼Œç”Ÿæˆå™¨æ˜¯ä¸€ç±»ç‰¹æ®Šçš„è¿­ä»£å™¨ã€‚</p><p>ä½œç”¨ï¼š</p><ul><li>å¤„ç†å¤§é‡æ•°æ®ï¼šç”Ÿæˆå™¨ä¸€æ¬¡è¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œä¸æ˜¯ä¸€æ¬¡è¿”å›æ‰€æœ‰ç»“æœã€‚æ¯”å¦‚<code>sum([i for i in range(10000000000000)])</code>ä¼šå¡æœºï¼›<code>sum(i for i in range(10000000000000))</code>åˆ™ä¸ä¼š</li><li><a href="https://blog.csdn.net/a200822146085/article/details/89388362" target="_blank" rel="noopener">ä»£ç æ›´åŠ ç®€æ´</a>ï¼šå¯ä»¥å‡å°‘å˜é‡ã€ç©ºé—´</li><li>è¿­ä»£å™¨æœ¬èº«çš„ä½œç”¨</li></ul><p>yieldå…³é”®å­—æœ‰ä¸¤ç‚¹ä½œç”¨ï¼š</p><p>ä¿å­˜å½“å‰è¿è¡ŒçŠ¶æ€ï¼ˆ<strong>æ–­ç‚¹</strong>ï¼‰ï¼Œç„¶åæš‚åœæ‰§è¡Œï¼Œå³å°†ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰æŒ‚èµ·ï¼›å¯ä»¥ä½¿ç”¨next()å‡½æ•°è®©ç”Ÿæˆå™¨ä»æ–­ç‚¹å¤„<strong>ç»§ç»­æ‰§è¡Œ</strong>ï¼Œå³å”¤é†’ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰<br>å°†yieldå…³é”®å­—åé¢è¡¨è¾¾å¼çš„å€¼ä½œä¸º<strong>è¿”å›å€¼è¿”å›</strong>ï¼Œæ­¤æ—¶å¯ä»¥ç†è§£ä¸ºèµ·åˆ°äº†returnçš„ä½œç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__runProxyFetch</span><span class="params">()</span>:</span>     </span><br><span class="line">    <span class="keyword">for</span> proxy <span class="keyword">in</span> proxy_fetcher.run():</span><br><span class="line">        proxy_queue.put(proxy)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fetcher</span><span class="params">(object)</span>:</span></span><br><span class="line">    name = <span class="string">"fetcher"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># ...</span></span><br><span class="line">        <span class="comment"># ç›¸æ¯”ä½¿ç”¨ç”Ÿæˆæ¨å¯¼å¼ return [p for p in proxy_dict.values() if DoValidator.preValidator(p.proxy)]ï¼Œ ä½¿ç”¨yieldç”Ÿæˆå™¨å¯ä»¥èŠ‚çœç©ºé—´</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> proxy_dict.values():</span><br><span class="line">                <span class="keyword">if</span> DoValidator.preValidator(_.proxy):</span><br><span class="line">                    <span class="keyword">yield</span> _</span><br></pre></td></tr></table></figure></li><li><p>åº”ç”¨éƒ¨ç½²ï¼š</p><p>â‘ å¯¹apkæ¢æºï¼›â‘¡è®¾ç½®æ—¶åŒº</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.6</span>-alpine</span><br><span class="line"><span class="comment"># ..</span></span><br><span class="line"><span class="comment"># apk repository</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> sed -i <span class="string">'s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g'</span> /etc/apk/repositories</span></span><br><span class="line"><span class="bash"><span class="comment"># timezone</span></span></span><br><span class="line"><span class="bash">RUN apk add -U tzdata &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; apk del tzdata</span></span><br><span class="line"><span class="bash"><span class="comment"># ...</span></span></span><br><span class="line"><span class="bash">ENTRYPOINT [ <span class="string">"sh"</span>, <span class="string">"start.sh"</span> ]</span></span><br></pre></td></tr></table></figure><p><code>docker-compose.yml</code>ï¼š é•œåƒè¿˜æ²¡ç¼–è¯‘å¥½çš„æƒ…å†µã€‚ï¼ˆå¦‚æœè‡ªå·±æ”¹äº†åŠŸèƒ½å¹¶å¯ç”¨çš„è¯ï¼Œéœ€è¦ç”¨è¿™ç§ï¼›æˆ–è€…è‡ªå·±å‘å¸ƒé•œåƒåç”¨åä¸€ç§ï¼‰</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  proxy_pool:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">proxy_pool</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5010:5010"</span></span><br><span class="line"><span class="attr">    links:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">proxy_redis</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="attr">      DB_CONN:</span> <span class="string">"redis://@proxy_redis:6379/0"</span></span><br><span class="line"><span class="attr">  proxy_redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">"redis"</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">proxy_redis</span></span><br></pre></td></tr></table></figure><p><code>docker-compose.yml</code>ï¼šåˆ«äººé•œåƒå·²ç»ç¼–è¯‘å¥½å¹¶ä¸Šä¼ </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">    expose:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="number">6379</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">jhao104/proxy_pool</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">DB_CONN=redis://redis:6379/0</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5010:5010"</span></span><br><span class="line"><span class="attr">    depends_on:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">redis</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="schedulerçš„é€»è¾‘"><a class="markdownIt-Anchor" href="#schedulerçš„é€»è¾‘"></a> schedulerçš„é€»è¾‘</h3><p><img src="/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/E:%5Chexo%5Csource_posts%5C%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95%5Cproxy_pool%E6%97%B6%E5%BA%8F%E5%9B%BE.png" alt="proxy_poolæ—¶åºå›¾"></p><h3 id="é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™"><a class="markdownIt-Anchor" href="#é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™"></a> é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™ï¼š</h3><ul><li>settings: é…ç½®æ–‡ä»¶</li><li>mainï¼šå¯åŠ¨æ–‡ä»¶</li><li>apiï¼šæä¾›è·å–proxyæ•°æ®æ¥å£</li><li>handler:<ul><li>loggerHandlerï¼šæ—¥å¿—ç±»</li><li>configHandlerï¼šå•ä¾‹çš„é…ç½®æ¥å£ç±»</li><li>ProxyHandler: Proxy CRUDæ“ä½œç±»</li></ul></li><li>fetcher: ä»£ç†æ•°æ®è·å–ç±»</li><li>db:<ul><li>dbClinetï¼š å­˜å‚¨åŠŸèƒ½æ¥å£ç±»</li><li>redisClientï¼šå­˜å‚¨åŠŸèƒ½å®ç°ç±»</li></ul></li><li>helper<ul><li>scheduler: å®šæ—¶ä»»åŠ¡çš„å®šä¹‰ä¸å¯åŠ¨ç±»</li><li>validator: proxyæœ‰æ•ˆæ€§æ ¡éªŒç±»</li><li>check: å…·ä½“æ‰§è¡Œæ ¡éªŒé€»è¾‘ç±»</li><li>proxy: è·å–çš„proxyæ•°æ®å°è£…ç±»</li></ul></li><li>utils:<ul><li>lazyPropertyï¼š æ‡’åŠ è½½æè¿°å™¨</li><li>singleton: å•ä¾‹ç®¡ç†å™¨ç±»</li><li>sixï¼š python2ä¸python3å…¼å®¹ç±»</li><li>webRequest: ç½‘ç»œè¯·æ±‚å°è£…ç±»</li></ul></li></ul><h2 id="æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ä¸‰æ»‘å—ç¼ºå£è¯†åˆ«"><a class="markdownIt-Anchor" href="#æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ä¸‰æ»‘å—ç¼ºå£è¯†åˆ«"></a> æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸‰ï¼‰ï¼šæ»‘å—ç¼ºå£è¯†åˆ«</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸¤å¼ å›¾ç‰‡ï¼š1. å¸¦ç¼ºå£çš„èƒŒæ™¯å›¾ï¼›2. ä¸ä¹‹å¯¹åº”çš„æ¥å£å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">imshow</span><span class="params">(img, winname=<span class="string">'test'</span>, delay=<span class="number">0</span>)</span>:</span></span><br><span class="line">    <span class="string">"""cv2å±•ç¤ºå›¾ç‰‡"""</span></span><br><span class="line">    cv2.imshow(winname, img)</span><br><span class="line">    cv2.waitKey(delay)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pil_to_cv2</span><span class="params">(img)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    pilè½¬cv2å›¾ç‰‡</span></span><br><span class="line"><span class="string">    :param img: pilå›¾åƒ, &lt;type 'PIL.JpegImagePlugin.JpegImageFile'&gt;</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    img = cv2.cvtColor(np.asarray(img), cv2.COLOR_RGB2BGR)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_cv2</span><span class="params">(img)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    äºŒè¿›åˆ¶å›¾ç‰‡è½¬cv2</span></span><br><span class="line"><span class="string">    :param img: äºŒè¿›åˆ¶å›¾ç‰‡æ•°æ®, &lt;type 'bytes'&gt;</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># å°†å›¾ç‰‡å­—èŠ‚ç bytes, è½¬æ¢æˆä¸€ç»´çš„numpyæ•°ç»„åˆ°ç¼“å­˜ä¸­</span></span><br><span class="line">    img_buffer_np = np.frombuffer(img, dtype=np.uint8)</span><br><span class="line">    <span class="comment"># ä»æŒ‡å®šçš„å†…å­˜ç¼“å­˜ä¸­è¯»å–ä¸€ç»´numpyæ•°æ®, å¹¶æŠŠæ•°æ®è½¬æ¢(è§£ç )æˆå›¾åƒçŸ©é˜µæ ¼å¼</span></span><br><span class="line">    img_np = cv2.imdecode(img_buffer_np, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> img_np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv2_open</span><span class="params">(img, flag=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ç»Ÿä¸€è¾“å‡ºå›¾ç‰‡æ ¼å¼ä¸ºcv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    :param img: &lt;type 'bytes'/'numpy.ndarray'/'str'/'Path'/'PIL.JpegImagePlugin.JpegImageFile'&gt;</span></span><br><span class="line"><span class="string">    :param flag: é¢œè‰²ç©ºé—´è½¬æ¢ç±»å‹, default: None</span></span><br><span class="line"><span class="string">        eg: cv2.COLOR_BGR2GRAYï¼ˆç°åº¦å›¾ï¼‰</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;numpy.ndarray&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(img, bytes):</span><br><span class="line">        img = bytes_to_cv2(img)</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, (str, Path)):</span><br><span class="line">        img = cv2.imread(str(img))</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, np.ndarray):</span><br><span class="line">        img = img</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, PIL.Image):</span><br><span class="line">        img = pil_to_cv2(img)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f'è¾“å…¥çš„å›¾ç‰‡ç±»å‹æ— æ³•è§£æ: <span class="subst">&#123;type(img)&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">        img = cv2.cvtColor(img, flag)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_distance</span><span class="params">(bg, tp, im_show=False, save_path=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :param bg: èƒŒæ™¯å›¾è·¯å¾„æˆ–Pathå¯¹è±¡æˆ–å›¾ç‰‡äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="string">        eg: 'assets/bg.jpg'</span></span><br><span class="line"><span class="string">            Path('assets/bg.jpg')</span></span><br><span class="line"><span class="string">    :param tp: ç¼ºå£å›¾è·¯å¾„æˆ–Pathå¯¹è±¡æˆ–å›¾ç‰‡äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="string">        eg: 'assets/tp.jpg'</span></span><br><span class="line"><span class="string">            Path('assets/tp.jpg')</span></span><br><span class="line"><span class="string">    :param im_show: æ˜¯å¦æ˜¾ç¤ºç»“æœ, &lt;type 'bool'&gt;; default: False</span></span><br><span class="line"><span class="string">    :param save_path: ä¿å­˜è·¯å¾„, &lt;type 'str'/'Path'&gt;; default: None</span></span><br><span class="line"><span class="string">    :return: ç¼ºå£ä½ç½®</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># è¯»å–å›¾ç‰‡</span></span><br><span class="line">    bg_gray = cv2_open(bg, flag=cv2.COLOR_BGR2GRAY)</span><br><span class="line">    tp_gray = cv2_open(tp, flag=cv2.COLOR_BGR2GRAY)</span><br><span class="line">    <span class="comment"># è¾¹ç¼˜æ£€æµ‹</span></span><br><span class="line">    tp_gray = cv2.Canny(tp_gray, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">    bg_gray = cv2.Canny(bg_gray, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">    <span class="comment"># ç›®æ ‡åŒ¹é…</span></span><br><span class="line">    result = cv2.matchTemplate(bg_gray, tp_gray, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">    <span class="comment"># è§£æåŒ¹é…ç»“æœ</span></span><br><span class="line">    min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(result)</span><br><span class="line"></span><br><span class="line">    distance = max_loc[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> save_path <span class="keyword">or</span> im_show:</span><br><span class="line">        <span class="comment"># éœ€è¦ç»˜åˆ¶çš„æ–¹æ¡†é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">        tp_height, tp_width = tp_gray.shape[:<span class="number">2</span>]</span><br><span class="line">        <span class="comment"># çŸ©å½¢å·¦ä¸Šè§’ç‚¹ä½ç½®</span></span><br><span class="line">        x, y = max_loc</span><br><span class="line">        <span class="comment"># çŸ©å½¢å³ä¸‹è§’ç‚¹ä½ç½®</span></span><br><span class="line">        _x, _y = x + tp_width, y + tp_height</span><br><span class="line">        <span class="comment"># ç»˜åˆ¶çŸ©å½¢</span></span><br><span class="line">        bg_img = cv2_open(bg)</span><br><span class="line">        cv2.rectangle(bg_img, (x, y), (_x, _y), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">2</span>)</span><br><span class="line">        <span class="comment"># ä¿å­˜ç¼ºå£è¯†åˆ«ç»“æœåˆ°èƒŒæ™¯å›¾</span></span><br><span class="line">        <span class="keyword">if</span> save_path:</span><br><span class="line">            save_path = Path(save_path).resolve()</span><br><span class="line">            save_path = save_path.parent / <span class="string">f"<span class="subst">&#123;save_path.stem&#125;</span>.<span class="subst">&#123;distance&#125;</span><span class="subst">&#123;save_path.suffix&#125;</span>"</span></span><br><span class="line">            save_path = save_path.__str__()</span><br><span class="line">            cv2.imwrite(save_path, bg_img)</span><br><span class="line">        <span class="comment"># æ˜¾ç¤ºç¼ºå£è¯†åˆ«ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> im_show:</span><br><span class="line">            imshow(bg_img)</span><br><span class="line">    <span class="keyword">return</span> distance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d = get_distance(</span><br><span class="line">        bg=<span class="string">'assets/bg.jpg'</span>,</span><br><span class="line">        tp=<span class="string">'assets/tp.png'</span>,</span><br><span class="line">        im_show=<span class="keyword">True</span>,</span><br><span class="line">        save_path=<span class="string">'assets/bg.jpg'</span></span><br><span class="line">    )</span><br><span class="line">    print(d)</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼ä»£ç ï¼š<strong><a href="https://github.com/lixi5338619/lxBook" target="_blank" rel="noopener">lxBook</a></strong></p><p>ç›¸å…³æ–‡ç« ï¼š</p><ol><li><a href="https://blog.csdn.net/qq_42857999/article/details/121586389" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸€ï¼‰ï¼šASTè¿˜åŸæ··æ·†JS</a></li><li><a href="https://blog.csdn.net/qq_42857999/article/details/121628908" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆäºŒï¼‰ï¼šç¼ºå£å›¾ç‰‡è¿˜åŸ</a></li><li><a href="https://blog.csdn.net/qq_42857999/article/details/121635961" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸‰ï¼‰ï¼šæ»‘å—ç¼ºå£è¯†åˆ«</a></li><li><a href="https://blog.csdn.net/qq_42857999/article/details/121659205" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆå››ï¼‰ï¼šæ»‘å—è½¨è¿¹æ„é€ </a></li><li><a href="https://blog.csdn.net/qq_42857999/article/details/121674134" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆäº”ï¼‰ï¼šè¯·æ±‚åˆ†æåŠåŠ å¯†å‚æ•°ç ´è§£</a></li></ol><h1 id="æœºå™¨å­¦ä¹ "><a class="markdownIt-Anchor" href="#æœºå™¨å­¦ä¹ "></a> æœºå™¨å­¦ä¹ </h1><h2 id="cardrecorder"><a class="markdownIt-Anchor" href="#cardrecorder"></a> <strong><a href="https://github.com/ZDZX-T/cardRecorder" target="_blank" rel="noopener">cardRecorder</a></strong></h2><blockquote><p>é€šè¿‡pyautoGUIå®ç°çš„æ–—åœ°ä¸»è®°ç‰Œå™¨ï¼Œæä¾›äº†tkinterçš„ç•Œé¢</p></blockquote><ul><li><p>ä½¿ç”¨pyAutoGuiæ‰¾åˆ°ç±»ä¼¼çš„å›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment"># è¿›è¡Œæˆªå›¾</span></span><br><span class="line">   img = pyautogui.screenshot(region=myPos)</span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰æ’ç±»å‹    </span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> myCardsNum.keys():</span><br><span class="line">       <span class="comment"># è¿›è¡Œå®šä½, æ‰¾åˆ°pics\\m1.pngåœ¨å½“å‰å›¾ç‰‡imgé‡Œçš„ä½ç½®</span></span><br><span class="line">       result = pyautogui.locateAll(needleImage=<span class="string">'pics\\m'</span> + i + <span class="string">'.png'</span>, haystackImage=img, confidence=myConfidence)</span><br><span class="line">       </span><br><span class="line">       myCardsNum[i] = cardsFilter(list(result), myFilter)</span><br></pre></td></tr></table></figure><p>pyautoGUIå›¾ç‰‡è¯†åˆ«åŠŸèƒ½ä»‹ç»ï¼š</p><blockquote><p>PyAutoGUIå¯ä»¥æˆªå–å±å¹•æˆªå›¾ï¼ˆæˆªå›¾ï¼‰ï¼Œå°†å…¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å±å¹•ä¸­æŸ¥æ‰¾å›¾åƒ(å®šä½)ã€‚</p></blockquote><ul><li>æˆªå›¾</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆªå…¨å±</span></span><br><span class="line">pg.screenshot()  <span class="comment"># åªä¼šä¿å­˜åˆ°å†…å­˜ï¼Œä¸ä¼šç¼“å­˜åˆ°æœ¬åœ°</span></span><br><span class="line">pg.screenshot(<span class="string">'data/screenshot.jpg'</span>)  <span class="comment"># æŒ‡å®šè·¯å¾„ï¼Œåˆ™ä¼šä¿å­˜åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="comment"># æŒ‰ç…§æŒ‡å®šåŒºåŸŸæˆªå±, region(xåæ ‡,yåæ ‡,å®½åº¦,é«˜åº¦)ï¼Œåæ ‡ä¸ºæŒ‡å®šæˆªå›¾çš„å·¦ä¸Šè§’åæ ‡</span></span><br><span class="line">pg.screenshot(imageFilename=<span class="string">'data/screenshot.jpeg'</span>, region=(<span class="number">300</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">500</span>))</span><br></pre></td></tr></table></figure><ul><li>å›¾ç‰‡å®šä½</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨å±å¹•ä¸­åŒ¹é…å›¾ç‰‡ï¼Œå¹¶è¿”å›ä½ç½®ç›¸å…³æ•°æ®ï¼ŒåŒ¹é…ä¸åˆ°åˆ™è¿”å› None</span></span><br><span class="line">locate_1 = pg.locateOnScreen(image=<span class="string">'data/test.png'</span>)</span><br><span class="line">print(locate_1)  <span class="comment"># Box(left=177, top=614, width=43, height=37)</span></span><br><span class="line">print(locate_1.left)  <span class="comment"># 177  å¯ä»¥é€šè¿‡ .left ç­‰å±æ€§è·å–ç›¸åº”çš„å€¼</span></span><br><span class="line">print(locate_1[<span class="number">0</span>])  <span class="comment"># 177  ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼</span></span><br><span class="line"><span class="comment"># â€œæ¨¡ç³Šâ€åŒ¹é…  --  å¯ä»¥ä½¿ç”¨å‚æ•° confidence æ¥æŒ‡å®šæ¨¡ç³Šç¨‹åº¦ï¼Œé»˜è®¤æ˜¯ 1ï¼ŒèŒƒå›´æ˜¯ 0 - 1ï¼ˆå½“ç„¶ï¼Œå¤ªä½å°±æ²¡æ„ä¹‰äº†ï¼‰, ä½¿ç”¨è¯¥å‚æ•°è¦æ±‚å·²ç»å®‰è£…å¥½ openCV</span></span><br><span class="line"><span class="comment"># è¿™é‡Œçš„è·¯å¾„å…³é”®å­—æ˜¯ imageï¼Œå’Œä¸Šé¢çš„ imageFilename ä¸åŒï¼Œæ‰€ä»¥å»ºè®®ä¸è¦å†™å…³é”®å­—ï¼Œç›´æ¥å†™è·¯å¾„å°±å¥½ï¼Œé˜²æ­¢å†™é”™</span></span><br><span class="line">locate_2 = pg.locateOnScreen(image=<span class="string">'data/test.png'</span>, confidence=<span class="number">0.9</span>)</span><br><span class="line"><span class="comment"># è¿”å›åŒ¹é…åˆ°çš„å›¾ç‰‡çš„ä¸­å¿ƒä½ç½®åæ ‡</span></span><br><span class="line">center_point_1 = pg.center(locate_1)</span><br><span class="line">print(center_point_1)  <span class="comment"># Point(x=198, y=632)</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå±å¹•æˆªå›¾åŠŸèƒ½éœ€è¦Pillowæ¨¡å—ã€ç½®ä¿¡åº¦éœ€è¦cv</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/math98/p/14399644.html" target="_blank" rel="noopener">PyAutoGui å›¾ç‰‡è¯†åˆ«+å®šä½+æˆªå›¾å‡½æ•°æ–‡æ¡£</a>ã€<a href="https://zhuanlan.zhihu.com/p/417147884" target="_blank" rel="noopener">pyautogui çš„æˆªå›¾åŠå›¾ç‰‡åŒ¹é…</a>ã€<a href="https://www.cnblogs.com/gexbooks/p/10790063.html" target="_blank" rel="noopener">pyautogui æ–‡æ¡£ï¼ˆäº”ï¼‰ï¼šæˆªå›¾åŠå®šä½åŠŸèƒ½</a></p></li><li><p>tkinterä½¿ç”¨:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å˜é‡ä½¿ç”¨</span></span><br><span class="line">num_8 = tkinter.StringVar()  <span class="comment"># 8</span></span><br><span class="line">num_8.set(strCards[<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">root = tkinter.Tk()</span><br><span class="line"><span class="comment"># æ˜¾ç¤º</span></span><br><span class="line">x_start = <span class="number">20</span></span><br><span class="line">y_start = <span class="number">5</span></span><br><span class="line">x_add = <span class="number">30</span></span><br><span class="line">x_dif = <span class="number">2</span></span><br><span class="line">y_dif = <span class="number">25</span></span><br><span class="line"><span class="comment"># æ ‡ç­¾</span></span><br><span class="line">tkinter.Label(root, text=<span class="string">'å¤§'</span>, font=(<span class="string">''</span>, <span class="number">14</span>), width=<span class="number">1</span>).place(x=x_start, y=y_start)</span><br><span class="line"><span class="comment"># è¾“å…¥æ¡†</span></span><br><span class="line">tkinter.Entry(root, textvariable=num_dw, font=(<span class="string">''</span>, <span class="number">14</span>), width=<span class="number">1</span>).place(x=x_start + x_dif, y=y_start + y_dif)</span><br><span class="line"><span class="comment"># è¿›è¡Œå¾ªç¯ç­‰å¾…äº‹ä»¶å‘ç”Ÿ</span></span><br><span class="line">root.main_loop()</span><br></pre></td></tr></table></figure><p>å¸ƒå±€</p><ul><li>pack()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…ä¹‹å‰ï¼Œè§„åˆ’æ­¤æ§ä»¶åœ¨åŒºå—å†…çš„ä½ç½®ã€‚</li><li>grid()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…ä¹‹å‰ï¼Œè§„åˆ’æ­¤æ§ä»¶ä¸ºä¸€ä¸ªç½‘æ ¼ç±»å‹çš„æ¶æ„ã€‚</li><li>place()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…çš„ç‰¹å®š(æŒ‡å®š)ä½ç½®ã€‚</li></ul></li></ul><h2 id="wiki_zh_word2vec"><a class="markdownIt-Anchor" href="#wiki_zh_word2vec"></a> <strong><a href="https://github.com/AimeeLee77/wiki_zh_word2vec" target="_blank" rel="noopener">wiki_zh_word2vec</a></strong></h2><blockquote><p>åˆ©ç”¨Pythonæ„å»ºWikiä¸­æ–‡è¯­æ–™è¯å‘é‡æ¨¡å‹è¯•éªŒâ€”â€”æ‰¾åˆ°ç»™å®šè¯ç›¸ä¼¼çš„è¯è¯­</p><p>ä»£ç æ¶‰åŠï¼šå¼€å‘ç¯å¢ƒå‡†å¤‡ã€æ•°æ®çš„è·å–ã€æ•°æ®çš„é¢„å¤„ç†ã€æ¨¡å‹æ„å»ºå’Œæ¨¡å‹æµ‹è¯•å››å¤§å†…å®¹ï¼Œå¯¹åº”çš„æ˜¯å®ç°æ¨¡å‹æ„å»ºçš„äº”ä¸ªæ­¥éª¤ã€‚</p></blockquote><ol><li><p>å¼€å‘ç¯å¢ƒå‡†å¤‡: Python + gensim (NLPç¥å™¨åº“) +jieba + <a href="https://bintray.com/package/files/byvoid/opencc/OpenCC" target="_blank" rel="noopener">OpenCC</a>(ä¸­æ–‡ç¹ä½“æ›¿æ¢æˆç®€ä½“)</p></li><li><p>æ•°æ®è·å–: åˆ°wikiå®˜ç½‘ä¸‹è½½<a href="https://dumps.wikimedia.org/zhwiki/latest/zhwiki-latest-pages-articles.xml.bz2" target="_blank" rel="noopener">ä¸­æ–‡è¯­æ–™</a>ã€å°†XMLçš„Wikiæ•°æ®è½¬æ¢ä¸ºtextæ ¼å¼ï¼Œä½¿ç”¨åˆ°äº†gensim.corporaä¸­çš„WikiCorpuså‡½æ•°</p></li><li><p>Wikiæ•°æ®é¢„å¤„ç†ï¼šâ‘ ä½¿ç”¨OpenCCè¿›è¡Œç¹ç®€è½¬æ¢ï¼›â‘¡jiebaåˆ†è¯</p></li><li><p>Word2Vecæ¨¡å‹è®­ç»ƒï¼šåˆ†å¥½è¯çš„æ–‡æ¡£å³å¯è¿›è¡Œword2vecè¯å‘é‡æ¨¡å‹çš„è®­ç»ƒäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®­ç»ƒskip-gramæ¨¡å‹</span></span><br><span class="line">model = Word2Vec(LineSentence(inp), size=<span class="number">400</span>, window=<span class="number">5</span>, min_count=<span class="number">5</span>,</span><br><span class="line">                 workers=multiprocessing.cpu_count())</span><br><span class="line">   </span><br><span class="line"><span class="comment"># ä¿å­˜æ¨¡å‹</span></span><br><span class="line">model.save(outp1)</span><br><span class="line">model.wv.save_word2vec_format(outp2, binary=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure><p>ä»£ç è¿è¡Œå®Œæˆåå¾—åˆ°å¦‚ä¸‹å››ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­wiki.zh.text.modelæ˜¯å»ºå¥½çš„æ¨¡å‹ï¼Œwiki.zh.text.vectoræ˜¯è¯å‘é‡ã€‚</p></li><li><p>æ¨¡å‹æµ‹è¯•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">model = gensim.models.Word2Vec.load(fdir + <span class="string">'wiki.zh.text.model'</span>)</span><br><span class="line">word = model.most_similar(<span class="string">u"è¶³çƒ"</span>)</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> word:</span><br><span class="line">    <span class="keyword">print</span> (t[<span class="number">0</span>],t[<span class="number">1</span>])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è¶³çƒè¿åŠ¨ 0.531202495098</span></span><br><span class="line"><span class="string">å›½é™…è¶³çƒ 0.510423064232</span></span><br><span class="line"><span class="string">è¶³çƒæ¯”èµ› 0.499910503626</span></span><br><span class="line"><span class="string">å›½å®¶è¶³çƒé˜Ÿ 0.488919615746</span></span><br><span class="line"><span class="string">æ’çƒ 0.488108128309</span></span><br><span class="line"><span class="string">ç”·ä½“å­ç¯®çƒ0.482638418674</span></span><br><span class="line"><span class="string">ä½“è‚² 0.47221454978</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></li></ol><p>é™„ï¼šä»€ä¹ˆæ˜¯è¯å‘é‡? â€”â€”è¯å‘é‡æŠ€æœ¯æ˜¯å°†è¯è½¬åŒ–æˆä¸ºç¨ å¯†å‘é‡ï¼Œå¹¶ä¸”å¯¹äºç›¸ä¼¼çš„è¯ï¼Œå…¶å¯¹åº”çš„è¯å‘é‡ä¹Ÿç›¸è¿‘ã€‚</p><p>åœ¨<a href="https://so.csdn.net/so/search?q=%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">è‡ªç„¶è¯­è¨€å¤„ç†</a>ä»»åŠ¡ä¸­ï¼Œé¦–å…ˆéœ€è¦è€ƒè™‘è¯å¦‚ä½•åœ¨è®¡ç®—æœºä¸­è¡¨ç¤ºã€‚é€šå¸¸ï¼Œæœ‰ä¸¤ç§è¡¨ç¤ºæ–¹å¼ï¼š</p><ul><li>one-hot representation(ç¦»æ•£è¡¨ç¤º)<ul><li>ä¼ ç»Ÿçš„åŸºäºè§„åˆ™æˆ–åŸºäºç»Ÿè®¡çš„è‡ªç„¶è¯­ä¹‰å¤„ç†æ–¹æ³•å°†å•è¯çœ‹ä½œä¸€ä¸ªåŸå­ç¬¦å·</li><li>æŠŠæ¯ä¸ªè¯è¡¨ç¤ºä¸ºä¸€ä¸ªé•¿å‘é‡ã€‚è¿™ä¸ªå‘é‡çš„ç»´åº¦æ˜¯è¯è¡¨å¤§å°ï¼Œå‘é‡ä¸­åªæœ‰ä¸€ä¸ªç»´åº¦çš„å€¼ä¸º1ï¼Œå…¶ä½™ç»´åº¦ä¸º0ï¼Œè¿™ä¸ªç»´åº¦å°±ä»£è¡¨äº†å½“å‰çš„è¯ã€‚</li><li>one-hot representationç›¸å½“äºç»™æ¯ä¸ªè¯åˆ†é…ä¸€ä¸ªidï¼Œè¿™å°±å¯¼è‡´è¿™ç§è¡¨ç¤ºæ–¹å¼ä¸èƒ½å±•ç¤ºè¯ä¸è¯ä¹‹é—´çš„å…³ç³»ã€‚å¦å¤–ï¼Œone-hot representationå°†ä¼šå¯¼è‡´ç‰¹å¾ç©ºé—´éå¸¸å¤§ï¼Œä½†ä¹Ÿå¸¦æ¥ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œå¾ˆå¤šåº”ç”¨ä»»åŠ¡çº¿æ€§å¯åˆ†ã€‚</li></ul></li><li>distribution representation(åˆ†å¸ƒå¼è¡¨ç¤º)<ul><li>word embeddingæŒ‡çš„æ˜¯å°†è¯è½¬åŒ–æˆä¸€ç§åˆ†å¸ƒå¼è¡¨ç¤ºï¼Œåˆç§°è¯å‘é‡ã€‚åˆ†å¸ƒå¼è¡¨ç¤ºå°†è¯è¡¨ç¤ºæˆä¸€ä¸ªå®šé•¿çš„è¿ç»­çš„ç¨ å¯†å‘é‡ã€‚</li><li>åˆ†å¸ƒå¼è¡¨ç¤ºä¼˜ç‚¹:<ol><li>è¯ä¹‹é—´å­˜åœ¨ç›¸ä¼¼å…³ç³»ï¼šæ˜¯è¯ä¹‹é—´å­˜åœ¨â€œè·ç¦»â€æ¦‚å¿µï¼Œè¿™å¯¹å¾ˆå¤šè‡ªç„¶è¯­è¨€å¤„ç†çš„ä»»åŠ¡éå¸¸æœ‰å¸®åŠ©ã€‚</li><li>åŒ…å«æ›´å¤šä¿¡æ¯ï¼šè¯å‘é‡èƒ½å¤ŸåŒ…å«æ›´å¤šä¿¡æ¯ï¼Œå¹¶ä¸”æ¯ä¸€ç»´éƒ½æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚åœ¨é‡‡ç”¨one-hotç‰¹å¾æ—¶ï¼Œå¯ä»¥å¯¹ç‰¹å¾å‘é‡è¿›è¡Œåˆ å‡ï¼Œè¯å‘é‡åˆ™ä¸èƒ½ã€‚</li></ol></li></ul></li></ul><h1 id="ç³»ç»Ÿè®¾è®¡"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿè®¾è®¡"></a> ç³»ç»Ÿè®¾è®¡</h1><h2 id="python-è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·"><a class="markdownIt-Anchor" href="#python-è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·"></a> <a href="https://pythondict.com/python-work/screen-translate-tools/" target="_blank" rel="noopener">Python è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·</a></h2><p>ç¨‹åºçš„åŠŸèƒ½ä¸»è¦ç”±3ä¸ªæ¨¡å—ç»„æˆ</p><ol><li><p>screenshotï¼šæˆªå›¾</p><blockquote><p>ä½¿ç”¨Pillowåº“</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…PILä¾èµ–: pip install pillow</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step1: ä»å‰ªåˆ‡æ¿è¯»å–å›¾ç‰‡</span></span><br><span class="line">img = ImageGrab.grabclipboard()</span><br><span class="line"><span class="comment"># ä¿å­˜åˆ°æœ¬åœ° or å†…å­˜ä¸­</span></span><br><span class="line">image_result = <span class="string">'./temp.png'</span></span><br><span class="line">img.save(image_result)</span><br></pre></td></tr></table></figure></li><li><p>recognitionï¼šå°†æˆªå›¾ä¸­çš„é—®é¢˜è¯†åˆ«æˆæ–‡å­—</p><blockquote><p>ä½¿ç”¨easyocræˆ–è€…pytesseract</p></blockquote><p>easyocrï¼š</p><ul><li>ç¼–ç¨‹ä½¿ç”¨</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå®‰è£…æ‰€éœ€è¦çš„æ¨¡å‹æ–‡ä»¶, ä¹Ÿå¯ä»¥è‡ªå·±ä¸‹è½½åæ”¾åˆ°å¯¹åº”è·¯å¾„ä¸‹</span></span><br><span class="line"><span class="comment"># Windowsï¼šC:\Users\ç”¨æˆ·å.EasyOCR\model</span></span><br><span class="line"><span class="comment"># Linuxï¼š~/ .EasyOCR / model</span></span><br><span class="line">reader = easyocr.Reader([<span class="string">'ch_sim'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨GPUï¼Œçœ‹æ˜¯å¦ä¼šæœ‰æç¤º CUDA not available</span></span><br><span class="line"><span class="comment"># reader = easyocr.Reader(['ch_sim'])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒåŒæ—¶å¤šä¸ªè¯­è¨€, è™½ç„¶å¯ä»¥ä¸€æ¬¡æ€§è¯†åˆ«è®¸å¤šç§è¯­è¨€ï¼Œ</span></span><br><span class="line"><span class="comment"># ä½†å¹¶éæ‰€æœ‰è¯­è¨€éƒ½å¯ä»¥ä¸€èµ·ç”¨ï¼Œé€šå¸¸æ˜¯å…¬å…±è¯­è¨€å’Œä¸€ä¸ªç‰¹æ®Šè¯­ç§å¯ä»¥ä¸€èµ·è¯†åˆ«ï¼Œç›¸äº’å…¼å®¹ï¼Œæ¯”å¦‚è‹±è¯­å’Œæ—¥è¯­ã€‚</span></span><br><span class="line"><span class="comment"># reader = easyocr.Reader(['ch_sim','en'])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯†åˆ«</span></span><br><span class="line">resp = requests.get(<span class="string">'https://images.zsxq.com/Fsl4plilMdpd_C8gXVJT1mKJDui9?e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:Pg0990rjMMQUAlf2bJlNL9lmLSU='</span>)</span><br><span class="line">result = reader.readtext(resp.content)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><ul><li>å‘½ä»¤è¡Œè¿è¡Œï¼š <code>easyocr -l ch_sim en -f test.png --detail=1 --gpu=True</code></li></ul><p>å›¾ç‰‡åŠ è½½å‡½æ•°<code>readtext</code>æ¥æ”¶ä¸‰ç§å‚æ•°</p><ul><li>æ–‡ä»¶è·¯å¾„</li><li>å›¾ç‰‡çš„<code>np_array</code></li><li>å­—èŠ‚æµå¯¹è±¡</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å‰ªåˆ‡æ¿ä¸­è·å¾—å›¾ç‰‡</span></span><br><span class="line">r = easyocr.Reader([<span class="string">"ch_sim"</span>])</span><br><span class="line"></span><br><span class="line">img = ImageGrab.grabclipboard()</span><br><span class="line">print(img, type(img))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°ä¸º: file path or numpy-array or a byte stream object</span></span><br><span class="line"><span class="comment"># 1: file path</span></span><br><span class="line">img_path = <span class="string">"ttt.png"</span></span><br><span class="line">img.save(img_path)</span><br><span class="line">reg_result = r.readtext(img_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2: numpy-array</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np_img = np.array(img)</span><br><span class="line">reg_result = r.readtext(np_img)</span><br><span class="line">print(reg_result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3: a byte stream object</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">resp = requests.get(<span class="string">'https://images.zsxq.com/Fsl4plilMdpd_C8gXVJT1mKJDui9?e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:Pg0990rjMMQUAlf2bJlNL9lmLSU='</span>)</span><br><span class="line">reg_result = r.readtext(resp.content)</span><br><span class="line">print(reg_result)</span><br></pre></td></tr></table></figure></li><li><p>Translationï¼šå°†æ–‡å­—ç¿»è¯‘</p><blockquote><p>å¯ä»¥ä½¿ç”¨ç½‘ä¸Šçš„æœ‰é“ç¿»è¯‘APIã€æˆ–è€…ç›´æ¥ä½¿ç”¨Googleæä¾›çš„ç¿»è¯‘åº“<code>googletrans</code></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Googleç¿»è¯‘</span></span><br><span class="line">translator = Translator(service_urls=[<span class="string">'translate.google.cn'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¿»è¯‘æˆä¸­æ–‡</span></span><br><span class="line">content_chinese = translator.translate(content_eng, src=<span class="string">'en'</span>, dest=<span class="string">'zh-cn'</span>).text</span><br></pre></td></tr></table></figure></li><li><p>GUIï¼šå°†ç¿»è¯‘åçš„ç»“æœå±•ç¤º</p><blockquote><p>ä½¿ç”¨ Python è‡ªå¸¦çš„ GUI tkinkerï¼Œå°†è¯†åˆ«åçš„ä¸­æ–‡æ˜¾ç¤ºå‡ºæ¥ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line">root = Tk()</span><br><span class="line">root.withdraw()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç¿»è¯‘åçš„ç»“æœï¼Œä»¥å¯¹è¯æ¡†çš„å½¢å¼</span></span><br><span class="line">tkinter.messagebox.showinfo(<span class="string">'ç¿»è¯‘ç»“æœ'</span>, content_chinese)</span><br></pre></td></tr></table></figure></li></ol><p>å®Œæ•´ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab, Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = easyocr.Reader(["ch_sim"])</span></span><br><span class="line">r = easyocr.Reader([<span class="string">"en"</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">screenShot</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""1. ä»å‰ªåˆ‡æ¿ä¸­è·å¾—å›¾ç‰‡"""</span></span><br><span class="line">    img = ImageGrab.grabclipboard()</span><br><span class="line">    print(img, type(img))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identify</span><span class="params">(img: Image)</span>:</span></span><br><span class="line">    <span class="string">"""2. è¯†åˆ«æ–‡å­—"""</span></span><br><span class="line">    <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">    np_img = np.array(img)</span><br><span class="line">    reg_result = r.readtext(np_img)</span><br><span class="line">    rs = sorted(reg_result, key=<span class="keyword">lambda</span> x: x[<span class="number">2</span>], reverse=<span class="keyword">True</span>)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translate</span><span class="params">(rs: str)</span>:</span></span><br><span class="line">    <span class="string">"""3. ç¿»è¯‘ï¼šgoogletrans åº“"""</span></span><br><span class="line">    <span class="keyword">from</span> googletrans <span class="keyword">import</span> Translator</span><br><span class="line">    <span class="comment"># Googleç¿»è¯‘</span></span><br><span class="line">    translator = Translator(service_urls=[<span class="string">'translate.google.cn'</span>])</span><br><span class="line">    <span class="comment"># ç¿»è¯‘æˆä¸­æ–‡</span></span><br><span class="line">    translated_str = translator.translate(rs, src=<span class="string">'en'</span>, dest=<span class="string">'zh-cn'</span>).text</span><br><span class="line">    <span class="keyword">return</span> translated_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showText</span><span class="params">(s: str)</span>:</span></span><br><span class="line">    <span class="string">"""4. tkå±•ç¤º"""</span></span><br><span class="line">    <span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line">    <span class="keyword">from</span> tkinter.messagebox <span class="keyword">import</span> showinfo  <span class="comment"># å¼¹çª—åº“</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰¾åˆ°ä¸»åº”ç”¨</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    <span class="comment"># éšè—ä¸»ç•Œé¢</span></span><br><span class="line">    root.withdraw()</span><br><span class="line">    print(s)</span><br><span class="line">    showinfo(<span class="string">"ç¿»è¯‘ç»“æœ"</span>, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    img = screenShot()</span><br><span class="line">    <span class="comment"># è¯†åˆ«å‡ºæ¥çš„æ–‡å­—</span></span><br><span class="line">    rs = identify(img)</span><br><span class="line">    translated_str = translate(rs)</span><br><span class="line">    showText(translated_str)</span><br></pre></td></tr></table></figure><h2 id="system-design-primer"><a class="markdownIt-Anchor" href="#system-design-primer"></a> <strong><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">system-design-primer</a></strong></h2><h2 id="go-package-plantuml"><a class="markdownIt-Anchor" href="#go-package-plantuml"></a> <strong><a href="https://github.com/qquunn/go-package-plantuml" target="_blank" rel="noopener"> go-package-plantuml</a></strong></h2><ul><li>goä¸­çš„argueparserï¼š<code>&quot;import github.com/jessevdk/go-flags&quot;</code>ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰flagã€pflagæ¥å¤„ç†è¾“å…¥å‚æ•°</li></ul><h2 id="id-maker"><a class="markdownIt-Anchor" href="#id-maker"></a> <a href="https://github.com/yongxinz/id-maker" target="_blank" rel="noopener">id-maker</a></h2><h2 id="health_checker"><a class="markdownIt-Anchor" href="#health_checker"></a> <a href="https://github.com/Freedomisgood/When_Coding_in_ZJU/blob/main/Health_Checkin/health_checkin_helper_cst.py" target="_blank" rel="noopener">health_checker</a></h2><blockquote><p>æµ™å¤§çš„ç™»é™†åŠ å¯†</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pythonè½¬ä¹‰å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_rsa_encrypt</span><span class="params">(self, password_str, e_str, M_str)</span>:</span></span><br><span class="line">    <span class="comment"># å°†strè½¬åŒ–ä¸ºasciiçš„å­—èŠ‚</span></span><br><span class="line">    password_bytes = bytes(password_str, <span class="string">'ascii'</span>)</span><br><span class="line">    <span class="comment"># å¤§ç«¯å¡«å……</span></span><br><span class="line">    password_int = int.from_bytes(password_bytes, <span class="string">'big'</span>)</span><br><span class="line">    <span class="comment"># å°†å…¶æŒ‰ç…§16è¿›åˆ¶çš„å½¢å¼è½¬æˆ10è¿›åˆ¶</span></span><br><span class="line">    e_int = int(e_str, <span class="number">16</span>)</span><br><span class="line">    M_int = int(M_str, <span class="number">16</span>)</span><br><span class="line">    <span class="comment"># password_int^e%M</span></span><br><span class="line">    result_int = pow(password_int, e_int, M_int)</span><br><span class="line">    <span class="comment"># 10è¿›åˆ¶è½¬æˆ16è¿›åˆ¶str, å¹¶ rjust() è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å³å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">    <span class="comment"># "hello".rjust(8, "0") ==&gt; 000hello</span></span><br><span class="line">    <span class="keyword">return</span> hex(result_int)[<span class="number">2</span>:].rjust(<span class="number">128</span>, <span class="string">'0'</span>)</span><br></pre></td></tr></table></figure><p>JsåŠ å¯†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">RSAUtils.encryptedString = <span class="function"><span class="keyword">function</span>(<span class="params">key, s</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> a = [];</span><br><span class="line">    <span class="comment">// sä¸ºåå‘çš„password, å¦‚321321aaa</span></span><br><span class="line"><span class="keyword">var</span> sl = s.length;</span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i &lt; sl) &#123;</span><br><span class="line">a[i] = s.charCodeAt(i);</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// è¡¥è¶³0</span></span><br><span class="line"><span class="keyword">while</span> (a.length % key.chunkSize != <span class="number">0</span>) &#123;</span><br><span class="line">a[i++] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a ==&gt; 321312aaa000000 çš„ asciiå­—ç¬¦æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> al = a.length;</span><br><span class="line"><span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> j, k, block;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; al; i += key.chunkSize) &#123;</span><br><span class="line">block = <span class="keyword">new</span> BigInt();</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (k = i; k &lt; i + key.chunkSize; ++j) &#123;</span><br><span class="line">block.digits[j] = a[k++];</span><br><span class="line">block.digits[j] += a[k++] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> crypt = key.barrett.powMod(block, key.e);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">var</span> text = key.radix == <span class="number">16</span> ? RSAUtils.biToHex(crypt) : RSAUtils.biToString(crypt, key.radix);</span><br><span class="line">result += text + <span class="string">" "</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result.substring(<span class="number">0</span>, result.length - <span class="number">1</span>); <span class="comment">// Remove last space.</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>new BigInt();</code>å¾—åˆ°çš„æ˜¯digits.len=130çš„intæ•°ç»„</li></ul><h2 id="cookiecutter-golang"><a class="markdownIt-Anchor" href="#cookiecutter-golang"></a> <strong><a href="https://github.com/lacion/cookiecutter-golang" target="_blank" rel="noopener">cookiecutter-golang</a></strong></h2><blockquote><p>å¿«é€Ÿç”ŸæˆGoé¡¹ç›®çš„cookiecutteræ¨¡æ¿</p></blockquote><ul><li><a href="https://github.com/lacion/cookiecutter-golang/blob/master/%7B%7Bcookiecutter.app_name%7D%7D/main.go" target="_blank" rel="noopener">cobarä½¿ç”¨</a>ä¸<a href="https://github.com/lacion/cookiecutter-golang/blob/master/%7B%7Bcookiecutter.app_name%7D%7D/cmd/root.go" target="_blank" rel="noopener">cobarå‘½ä»¤å®šä¹‰</a>ï¼Œç›¸å½“äºPythonä¸­çš„Clickæ¨¡å—</li></ul><h2 id="dddd_trainer"><a class="markdownIt-Anchor" href="#dddd_trainer"></a> <strong><a href="https://github.com/sml2h3/dddd_trainer" target="_blank" rel="noopener"> dddd_trainer</a></strong></h2><ul><li><p>Cliå‘½ä»¤ä½¿ç”¨fireåº“ï¼šfireæ˜¯pythonä¸­ç”¨äºç”Ÿæˆå‘½ä»¤è¡Œç•Œé¢(Command Line Interfaces, CLIs)çš„å·¥å…·ï¼Œä¸éœ€è¦åšä»»ä½•é¢å¤–çš„å·¥ä½œï¼Œåªéœ€è¦ä»ä¸»æ¨¡å—ä¸­è°ƒç”¨fire.Fire()ï¼Œå®ƒä¼šè‡ªåŠ¨å°†ä½ çš„ä»£ç è½¬åŒ–ä¸ºCLIï¼Œ<u>Fire()çš„å‚æ•°å¯ä»¥è¯´ä»»ä½•çš„pythonå¯¹è±¡</u></p><p>ç‰¹ç‚¹ï¼šæ‰€æœ‰çš„<strong>å­å‘½ä»¤</strong>éƒ½èƒ½ä»¥å‡½æ•°ã€ç±»ç­‰å½¢å¼ä¹¦å†™ï¼Œæµç¨‹å’Œå‚æ•°è·å–éƒ½æ¯”è¾ƒæ¸…æ™°ï¼›ä¼ å‚å¯ä»¥è‡ªåŠ¨è¢«è§£ææˆPythonç±»å‹ï¼šå­—ç¬¦ä¸²ã€å…ƒç»„ã€åˆ—è¡¨ã€å­—å…¸</p><p>â˜…ä½¿ç”¨æŒ‡å—ï¼š <a href="https://blog.csdn.net/qq_17550379/article/details/79943740" target="_blank" rel="noopener">https://blog.csdn.net/qq_17550379/article/details/79943740</a></p></li><li><p><a href="https://www.jianshu.com/p/476478c17b8e" target="_blank" rel="noopener">ONNXRuntime</a>ï¼š é€šå¸¸æˆ‘ä»¬åœ¨è®­ç»ƒæ¨¡å‹æ—¶å¯ä»¥ä½¿ç”¨å¾ˆå¤šä¸åŒçš„æ¡†æ¶ï¼Œæ¯”å¦‚æœ‰çš„åŒå­¦å–œæ¬¢ç”¨ <code>Pytorch</code>ï¼Œæœ‰çš„åŒå­¦å–œæ¬¢ä½¿ç”¨ <code>TensorFLow</code>ï¼Œä¹Ÿæœ‰çš„å–œæ¬¢ <code>MXNet</code>ï¼Œä»¥åŠæ·±åº¦å­¦ä¹ æœ€å¼€å§‹æµè¡Œçš„ <code>Caffe</code>ç­‰ç­‰ï¼Œè¿™æ ·ä¸åŒçš„è®­ç»ƒæ¡†æ¶å°±å¯¼è‡´äº†äº§ç”Ÿä¸åŒçš„æ¨¡å‹ç»“æœåŒ…ï¼Œåœ¨æ¨¡å‹è¿›è¡Œéƒ¨ç½²æ¨ç†æ—¶å°±éœ€è¦ä¸åŒçš„ä¾èµ–åº“ï¼Œè€Œä¸”åŒä¸€ä¸ªæ¡†æ¶æ¯”å¦‚<code>tensorflow</code> ä¸åŒçš„ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚è¾ƒå¤§ï¼Œ ä¸ºäº†è§£å†³è¿™ä¸ªæ··ä¹±é—®é¢˜ï¼Œ<a href="https://links.jianshu.com/go?to=https%3A%2F%2Flfaidata.foundation%2F" target="_blank" rel="noopener">LF AI</a> è¿™ä¸ªç»„ç»‡è”åˆ Facebook, MicroSoftç­‰å…¬å¸åˆ¶å®šäº†æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ ‡å‡†ï¼Œè¿™ä¸ªæ ‡å‡†å«åš<strong>ONNX, Open Neural Network Exchage</strong>ï¼Œ<em>æ‰€æœ‰å…¶ä»–æ¡†æ¶äº§ç”Ÿçš„æ¨¡å‹åŒ… (<code>.pth</code>, <code>.pb</code>) éƒ½å¯ä»¥è½¬æ¢æˆè¿™ä¸ªæ ‡å‡†æ ¼å¼ï¼Œè½¬æ¢æˆè¿™ä¸ªæ ‡å‡†æ ¼å¼åï¼Œå°±å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„ ONNX Runtimeç­‰å·¥å…·è¿›è¡Œç»Ÿä¸€éƒ¨ç½²ã€‚</em></p></li><li><p><a href="https://pythondict.com/life-intelligent/tools/loguru/" target="_blank" rel="noopener">Loguru â€” æœ€å¼ºå¤§çš„ Python æ—¥å¿—è®°å½•å™¨</a>ï¼š å¼ºå¤§çš„å…¨å±€æ—¥å¿—å¯¹è±¡ï¼Œå…·æœ‰å¼€ç®±å³ç”¨çš„ç‰¹æ€§ã€ç¾è§‚çš„è¾“å‡ºï¼Œæ”¯æŒ<code>f-string</code>ã€æ”¯æŒåœ¨ä¸»è¿›ç¨‹å’Œçº¿ç¨‹ä¸­æ•è·å¼‚å¸¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">logger.add(<span class="string">"file.log"</span>, rotation=<span class="string">"12:00"</span> , format=<span class="string">"&#123;time:YYYY-MM-DD at HH:mm:ss&#125; | &#123;level&#125; | &#123;message&#125;"</span>, level=<span class="string">"INFO"</span>)</span><br><span class="line">logger.info(<span class="string">"That's it, beautiful and simple logging!"</span>)</span><br></pre></td></tr></table></figure></li></ul><h2 id="njupt-api"><a class="markdownIt-Anchor" href="#njupt-api"></a> <strong><a href="https://github.com/gaoliang/NJUPT-API" target="_blank" rel="noopener">NJUPT-API</a></strong></h2><blockquote><p>å—äº¬é‚®ç”µå¤§å­¦ç½‘ç«™æ¥å£, Pythonæ¨¡å—</p></blockquote><ul><li><p><code>@login_required</code> è£…é¥°å™¨: ç”±äºæœ‰äº›æ“ä½œå¿…é¡»ç™»å½•åæ‰ä¼šæœ‰æ­£ç¡®ç»“æœï¼Œæ‰€ä»¥ç›¸å½“äºåœ¨æ‰§è¡Œå‰åšäº†ä¸€å±‚æ ¡éªŒï¼ˆè‡³äºæŠ›å‡ºå¼‚å¸¸orè½¬å‘ç™»å½•å°±çœ‹è£…é¥°å™¨ä¸­æ€ä¹ˆå†™äº†ï¼‰â€”&gt; ç”±äºæ˜¯å°è£…æˆäº†packageåº“ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€å±‚éœ€è¦è¿›è¡Œé™åˆ¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_required</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.verified:</span><br><span class="line">            self.login_by_sso()</span><br><span class="line">        <span class="keyword">return</span> func(self, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure></li><li><p>setuptoolsä½¿ç”¨</p><ul><li><a href="http://setup.py" target="_blank" rel="noopener">setup.py</a></li><li><a href="http://MANIFEST.in" target="_blank" rel="noopener">MANIFEST.in</a></li></ul></li><li><p>æ¨¡å—æš´éœ²ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># njupt/__init__.py</span></span><br><span class="line"><span class="keyword">from</span> njupt.card <span class="keyword">import</span> Card  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.zhengfang <span class="keyword">import</span> Zhengfang  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.library <span class="keyword">import</span> Library  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.runningman <span class="keyword">import</span> RunningMan  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.sso <span class="keyword">import</span> SSO  <span class="comment"># noqa</span></span><br><span class="line"><span class="comment"># è¡¨ç¤ºnjuptæ¨¡å—æä¾›ä»¥ä¸‹5ä¸ªæ¥å£</span></span><br><span class="line">__all__ = [<span class="string">'SSO'</span>, <span class="string">'Card'</span>, <span class="string">'Zhengfang'</span>, <span class="string">'Library'</span>, <span class="string">'RunningMan'</span>]</span><br></pre></td></tr></table></figure></li><li><p>éªŒè¯ç è¯†åˆ«</p><blockquote><p>å­—ç¬¦å‹éªŒè¯ç ï¼šæŠŠå›¾ç‰‡å»å™ªã€åˆ†å‰²ã€å½’ç±»ã€‚æ”¶é›†äº†è¶³å¤Ÿå¤šçš„æ ·æœ¬ï¼Œç„¶åå¯¹æ–°çš„å›¾ç‰‡ä¹Ÿåˆ†å‰²ã€‚å°†åˆ†éš”åçš„æ¯ä¸ªå­—ç¬¦ä¸æ ·æœ¬é›†åŒ¹é…ï¼Œé€‰æ¦‚ç‡æœ€å¤§çš„å­—ç¬¦ï¼Œå°†ç»„åˆ</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CardCaptcha</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ä¸€å¡é€šç³»ç»Ÿçš„éªŒè¯ç å·¥å…·ç±»</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, im)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param im: PIL.imageå¯¹è±¡</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.im = im.convert(<span class="string">'L'</span>)</span><br><span class="line">        self.image_pre_process()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">image_pre_process</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># äºŒå€¼åŒ–, å»é™¤æ‚è‰²ç‚¹</span></span><br><span class="line">        threshold = <span class="number">200</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(self.im.width):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(self.im.height):</span><br><span class="line">                pix = self.im.getpixel((x, y))</span><br><span class="line">                <span class="keyword">if</span> pix &gt; threshold:</span><br><span class="line">                    self.im.putpixel((x, y), BLACK)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.im.putpixel((x, y), WHITE)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_split_image</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># åˆ‡å‰²éªŒè¯ç ï¼Œè¿”å›åŒ…å«äº”ä¸ªå­—ç¬¦å›¾åƒçš„åˆ—è¡¨</span></span><br><span class="line">        y_min, y_max = <span class="number">0</span>, <span class="number">82</span></span><br><span class="line">        <span class="comment"># å­—ç¬¦ä½ç½®å¤§è‡´å›ºå®š([7,49], [49, 91], ...)</span></span><br><span class="line">        split_lines = [<span class="number">7</span>, <span class="number">49</span>, <span class="number">91</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">217</span>]</span><br><span class="line">        ims = [self.im.crop([u, y_min, v, y_max]) <span class="keyword">for</span> u, v <span class="keyword">in</span> zip(split_lines[:<span class="number">-1</span>], split_lines[<span class="number">1</span>:])]</span><br><span class="line">        <span class="keyword">return</span> ims</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">crack</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="comment"># è£…è½½è®­ç»ƒæ•°æ®é›†</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(current_dir, <span class="string">'image_data.json'</span>), <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            image_data = json.load(f)</span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> self.handle_split_image():</span><br><span class="line">            <span class="comment"># build_vectorå°†å›¾ç‰‡è½¬æˆä¸€ç»´å‘é‡: for pixel in image.getdata():</span></span><br><span class="line">            letter_vector = build_vector(letter)</span><br><span class="line">            guess = []</span><br><span class="line">            <span class="comment"># åœ¨æ¨¡å‹æ•°æ®ä¸­, æ‰¾ä¸€ä¸ªæ±‰æ˜è·ç¦»æœ€å°(æœ€åƒçš„ç»“æœ)</span></span><br><span class="line">            <span class="keyword">for</span> image <span class="keyword">in</span> image_data:</span><br><span class="line">                <span class="comment"># xä¸ºkey, å½“å‰åŒ¹é…çš„å­—ç¬¦; yä¸ºå‘é‡</span></span><br><span class="line">                <span class="keyword">for</span> x, y <span class="keyword">in</span> image.items():</span><br><span class="line">                    <span class="keyword">if</span> len(y) != <span class="number">0</span>:</span><br><span class="line">                        <span class="comment"># è®¡ç®—ä¸¤ä¸ªä¸€ç»´å‘é‡çš„æ±‰æ˜è·ï¼ˆå‘é‡åªåŒ…å«0ï¼Œ1æ—¶ï¼‰:(åªè¦å…ƒç´ å€¼ä¸ç­‰, è·ç¦»å°±+1)</span></span><br><span class="line">                        guess.append((distance_hanmming(y, letter_vector), x))</span><br><span class="line">            guess.sort()</span><br><span class="line">            <span class="comment"># æ‰¾å‡ºè·ç¦»æœ€å°çš„, å³æœ€åŒ¹é…çš„å­—ç¬¦</span></span><br><span class="line">            result.append(guess[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.crack()</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šPILä¸­image.convert()å‡½æ•°ä½¿ç”¨</p><ol><li>æ¨¡å¼â€œ1â€ï¼šä¸ºäºŒå€¼å›¾åƒï¼Œéé»‘å³ç™½ã€‚ä½†æ˜¯å®ƒæ¯ä¸ªåƒç´ ç”¨8ä¸ªbitè¡¨ç¤ºï¼Œ0è¡¨ç¤ºé»‘ï¼Œ255è¡¨ç¤ºç™½ã€‚</li><li>æ¨¡å¼â€œLâ€ï¼š ä¸ºç°è‰²å›¾åƒï¼Œå®ƒçš„æ¯ä¸ªåƒç´ ç”¨8ä¸ªbitè¡¨ç¤ºï¼Œ0è¡¨ç¤ºé»‘ï¼Œ255è¡¨ç¤ºç™½ï¼Œå…¶ä»–æ•°å­—è¡¨ç¤ºä¸åŒçš„ç°åº¦ã€‚åœ¨PILä¸­ï¼Œä»æ¨¡å¼â€œRGBâ€è½¬æ¢ä¸ºâ€œLâ€æ¨¡å¼æ˜¯æŒ‰ç…§ä¸‹é¢çš„å…¬å¼è½¬æ¢çš„ï¼š<code>L = R * 299/1000 + G * 587/1000+ B * 114/1000</code></li><li>æ¨¡å¼â€œPâ€ä¸º8ä½å½©è‰²å›¾åƒã€æ¨¡å¼â€œRGBAâ€(alphaé€æ˜åº¦)ä¸º32ä½å½©è‰²å›¾åƒã€æ¨¡å¼â€œCMYKâ€ä¸º32ä½å½©è‰²å›¾åƒ</li></ol></li><li><p>è‡ªåˆ¶æ‰“ç å·¥å…·</p><ol><li><code>captcha_getter.py</code></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®å›¾ç‰‡è‡ªå·±è¾“å…¥è¯†åˆ«ç»“æœ, å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥, å›¾ç‰‡åä¸ºæ­£ç¡®çš„æ‰“ç ç»“æœ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaGUI</span>:</span></span><br><span class="line">    BASE_URL = <span class="string">"http://yktapp.njupt.edu.cn:8070"</span></span><br><span class="line">    CAPTCHA_URL = BASE_URL + <span class="string">"/Login/GetValidateCode"</span></span><br><span class="line">    LOGIN_URL = BASE_URL + <span class="string">"/Login/LoginBySnoQuery"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.s = requests.session()</span><br><span class="line">        self.r = self.s.get(self.CAPTCHA_URL)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line">        self.root = tkinter.Tk()</span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel = tkinter.Label(self.root, image=self.tkimg)</span><br><span class="line">        self.imgLabel.pack()</span><br><span class="line">        self.message = tkinter.Entry(self.root)</span><br><span class="line">        self.message.pack()</span><br><span class="line">        self.root.bind(<span class="string">'&lt;Return&gt;'</span>, self.judge_and_save)</span><br><span class="line">        self.root.mainloop()</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">judge_and_save</span><span class="params">(self, event)</span>:</span></span><br><span class="line">        <span class="comment"># è¾“å‡ºè¾“å…¥æ¡†çš„å†…å®¹</span></span><br><span class="line">        captcha_value = self.message.get()</span><br><span class="line">        print(captcha_value)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"sno"</span>: self.account,</span><br><span class="line">            <span class="string">"pwd"</span>: base64.b64encode(self.pwd.encode(<span class="string">"utf8"</span>)),</span><br><span class="line">            <span class="string">"ValiCode"</span>: captcha_value,</span><br><span class="line">            <span class="string">"remember"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"uclass"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"zqcode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"json"</span>: <span class="keyword">True</span>,</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment"># åªæœ‰è¾“å…¥æ­£ç¡®çš„æ‰ä¿å­˜</span></span><br><span class="line">        r = self.s.post(self.LOGIN_URL, data=data)</span><br><span class="line">        <span class="keyword">if</span> r.json()[<span class="string">"IsSucceed"</span>]:</span><br><span class="line">            print(<span class="string">"æˆåŠŸï¼"</span>)</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">"captchas/&#123;&#125;.gif"</span>.format(captcha_value), <span class="string">'wb+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(self.r.content)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(r.json())</span><br><span class="line">            print(<span class="string">"éªŒè¯ç è¾“é”™äº†"</span>)</span><br><span class="line"><span class="comment"># åˆ·æ–°, è¿›è¡Œæ‰“ç ä¸‹ä¸€å¼ </span></span><br><span class="line">        self.r = self.s.get(self.CAPTCHA_URL)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line">        <span class="comment"># åˆ·æ–°å›¾ç‰‡æ¡†</span></span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel.config(image=self.tkimg)</span><br><span class="line">        <span class="comment"># â–². å°†è¾“å…¥æ¡†æ¸…ç©º</span></span><br><span class="line">        self.message.delete(<span class="number">0</span>, <span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li><code>captcha_gen.py</code></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spilt2chars</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ†å‰²å·²æœ‰çš„æ•°æ®ä¸ºå­—ç¬¦å¹¶ä¿å­˜</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        shutil.rmtree(<span class="string">'captcha_chars'</span>)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    os.mkdir(<span class="string">"captcha_chars"</span>)</span><br><span class="line">    values = <span class="string">"1234567890"</span></span><br><span class="line">    <span class="comment"># æ¯ä¸ªå­—ç¬¦åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> values:</span><br><span class="line">        os.mkdir(<span class="string">'captcha_chars/&#123;&#125;'</span>.format(value))</span><br><span class="line"></span><br><span class="line">    file_names = os.listdir(<span class="string">'captchas'</span>)</span><br><span class="line">    <span class="comment"># éå†æ‰€æœ‰å­—ç¬¦æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names: </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(<span class="string">'captchas/&#123;&#125;'</span>.format(file_name)) <span class="keyword">and</span> file_name != <span class="string">'.DS_Store'</span>:</span><br><span class="line">            <span class="comment"># è·å¾—æ‰“ç imgçš„å›¾ç‰‡åç§°(æ­£ç¡®ç»“æœ)</span></span><br><span class="line">            values = file_name[:<span class="number">4</span>]</span><br><span class="line">            im = Image.open(<span class="string">'captchas/&#123;&#125;'</span>.format(file_name))</span><br><span class="line">            captcha = CardCaptcha(im)</span><br><span class="line">            <span class="comment"># handle_split_imageä¸ºåˆ‡å‰²åçš„å››ä¸ªå­—ç¬¦å›¾ç‰‡, valuesä¸º3fgcçš„å€¼</span></span><br><span class="line">            <span class="keyword">for</span> im_part, value <span class="keyword">in</span> zip(captcha.handle_split_image(), values):</span><br><span class="line">                <span class="comment"># è¿›è¡Œmd5éšæœºå–åä¿å­˜</span></span><br><span class="line">                m = hashlib.md5()</span><br><span class="line">                m.update(<span class="string">"&#123;&#125;&#123;&#125;"</span>.format(time.time(), value).encode(<span class="string">'utf8'</span>))</span><br><span class="line">                <span class="comment"># captcha_chars/3/asdz.png</span></span><br><span class="line">                im_part.save(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;.png"</span>.format(value, m.hexdigest()))</span><br><span class="line">                </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_models</span><span class="params">()</span>:</span></span><br><span class="line">    iconset = list(<span class="string">'0123456789'</span>)</span><br><span class="line">    <span class="comment"># å°†å›¾åƒæ•°æ®è½¬ä¸ºå‘é‡æ•°æ®å¹¶ä¿å­˜</span></span><br><span class="line">    image_data = []</span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> iconset:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># éå†å­—ç¬¦3ä¸‹é¢æ‰€æœ‰çš„å›¾ç‰‡</span></span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> os.listdir(<span class="string">'captcha_chars/&#123;&#125;/'</span>.format(letter)):</span><br><span class="line">                <span class="keyword">if</span> img != <span class="string">"Thumbs.db"</span> <span class="keyword">and</span> img != <span class="string">".DS_Store"</span>:</span><br><span class="line">                    <span class="comment"># å¾—åˆ°å…¶å›¾ç‰‡å‘é‡</span></span><br><span class="line">                    temp = build_vector(Image.open(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;"</span>.format(letter, img)))</span><br><span class="line">                    <span class="comment"># models_listä¸­æ·»åŠ [&#123;1: [0,1,1...]&#125;]</span></span><br><span class="line">                    image_data.append(&#123;letter: temp&#125;)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            print(letter)</span><br><span class="line">image_data = [ &#123;<span class="number">1</span>: [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,...]&#125;, &#123;<span class="number">1</span>: [<span class="number">1</span>,<span class="number">0</span>,...]&#125;, ..., &#123;<span class="number">2</span>: [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,...]&#125;]</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'image_data.json'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(image_data, f)</span><br></pre></td></tr></table></figure><p>é™„ï¼šæ‰¾åˆ°æœ€åˆé€‚çš„æ—‹è½¬è§’åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotate_img</span><span class="params">(image)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ ¹æ®å›¾åƒåœ¨xè½´æ–¹å‘æŠ•å½±å¤§å°ç¡®å®šå­—ç¬¦çš„æ‘†æ”¾æ–¹å‘</span></span><br><span class="line"><span class="string">    -45~+45å¾ªç¯, å½“xè½´ä¸ŠæŠ•å½±å¾—åˆ°çš„ç™½è‰²åƒç´ æ•°é‡æœ€å°ï¼Œæ­¤æ—¶å°±æ˜¯æ­£ç¡®çš„è§’åº¦</span></span><br><span class="line"><span class="string">    :param image: PIL.Image object</span></span><br><span class="line"><span class="string">    :return: rotated Image object</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    min_count = <span class="number">1000</span></span><br><span class="line">    final_angle = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> angle <span class="keyword">in</span> range(<span class="number">-45</span>, <span class="number">45</span>):</span><br><span class="line">        x_count = <span class="number">0</span></span><br><span class="line">        ti = image.rotate(angle, expand=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(ti.width):</span><br><span class="line">            <span class="comment"># å½“å‰yåˆ—åªè¦æœ‰ä¸€ä¸ªåƒç´ ä¸ºwhite, é‚£ä¹ˆå°±+1ç»“æŸ, è¿›è¡Œä¸‹ä¸€åˆ—åˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(ti.height):</span><br><span class="line">                <span class="keyword">if</span> ti.getpixel((x, y)) == WHITE:</span><br><span class="line">                    x_count += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> x_count &lt; min_count:</span><br><span class="line">            min_count = x_count</span><br><span class="line">            final_angle = angle</span><br><span class="line">    image = image.rotate(final_angle, expand=<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">return</span> image</span><br></pre></td></tr></table></figure></li></ul><h2 id="rss-monitor"><a class="markdownIt-Anchor" href="#rss-monitor"></a> <strong><a href="https://github.com/Freedomisgood/Rss-Monitor" target="_blank" rel="noopener">Rss-Monitor</a></strong></h2><blockquote><p>ä¸€ä¸ªé€šç”¨çš„RSSè®¢é˜…é€šçŸ¥å™¨ï¼Œå’Œ**<a href="https://github.com/DIYgod/RSSHub" target="_blank" rel="noopener">RSSHub</a>**ä¸€èµ·é£Ÿç”¨æ•ˆæœæ›´å¥½å“¦ã€‚<br>RSS(Really Simple Syndication,ç®€æ˜“ä¿¡æ¯èšåˆ)æ˜¯ä¸€ç§æè¿°å’ŒåŒæ­¥ç½‘ç«™å†…å®¹çš„æ ¼å¼ä½ å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§å®šåˆ¶ä¸ªæ€§åŒ–æ¨é€ä¿¡æ¯çš„æœåŠ¡ã€‚å®ƒèƒ½å¤Ÿè§£å†³ä½ æ¼«æ— ç›®çš„çš„æµè§ˆç½‘é¡µçš„é—®é¢˜ã€‚</p></blockquote><ul><li><p>åŠ¨æ€å¯¼å…¥æ¨¡å—</p></li><li><p>è·å¾—Rssé“¾æ¥ä¿¡æ¯â€”â€”<a href="https://pypi.python.org/pypi/feedparser/" target="_blank" rel="noopener">feedparser</a>åº“</p><blockquote><p>feedparseræ˜¯ä¸€ä¸ªPythonçš„Feedè§£æåº“ï¼Œå¯ä»¥å¤„ç†RSS ï¼ŒCDFï¼ŒAtom ã€‚ä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»ä»»ä½• RSS æˆ– Atom è®¢é˜…æºå¾—åˆ°æ ‡é¢˜ã€é“¾æ¥å’Œæ–‡ç« çš„æ¡ç›®äº†ã€‚</p></blockquote><p>æ ‡å‡†çš„itemæ ¼å¼:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;![CDATA[å¦é—¨å…¬äº¤è½¦æ”¾ç«æ¡ˆæ­»è€…åå•å…¬å¸ƒ&lt;br/&gt;è­¦æ–¹å…¬å¸ƒå«ŒçŠ¯çŠ¯ç½ªè¯æ®]]&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span>&gt;</span>http://www.infzm.com/content/91404<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>&lt;![CDATA[6æœˆ11æ—¥ä¸‹åˆï¼Œå¦é—¨BRTå…¬äº¤è½¦æ”¾ç«æ¡ˆ47åæ­»äº¡è€…åå•å…¬å¸ƒã€‚å¦é—¨æ”¿åºœæ–°é—»åŠ6æœˆ10æ—¥å‘å¸ƒæ¶ˆæ¯ç§°ï¼Œæœ‰è¯æ®è¡¨æ˜ï¼Œé™ˆæ°´æ€»æºå¸¦æ±½æ²¹ä¸Šäº†é—½DY7396å…¬äº¤è½¦ã€‚ä¸”æœ‰å¤šåå¹¸å­˜è€…æŒ‡è®¤å…¶åœ¨è½¦ä¸Šçºµç«ï¼Œè‡´ä½¿æ•´éƒ¨è½¦å¼•èµ·çŒ›çƒˆç‡ƒçƒ§ã€‚ç»ç¬”è¿¹é‰´å®šï¼Œé™ˆæ°´æ€»6æœˆ7æ—¥è‡´å¦»ã€å¥³çš„ä¸¤å°ç»ç¬”ä¹¦ç³»é™ˆæ°´æ€»æœ¬äººæ‰€å†™ã€‚]]&gt;<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">category</span>&gt;</span>å—æ–¹å‘¨æœ«-çƒ­ç‚¹æ–°é—»<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">author</span>&gt;</span>infzm<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>2013-06-11 11:24:32<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br></pre></td></tr></table></figure><p>feedparseræ¨¡å—api</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> feedparser</span><br><span class="line">d=feedparser.parse(<span class="string">'http://feed.cnblogs.com/blog/sitehome/rss'</span>)</span><br><span class="line"><span class="comment"># d.feedä¸ºæ•°æ®å­—å…¸, ä¸entriesç›¸æ¯”ä¸€ä¸ªæ˜¯dictä¸€ä¸ªæ˜¯list, å…¶æ¬¡entriesä¸­æ˜¯æ›´åŠ å‡ç»ƒç‚¹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">#   è¾“å‡ºå­—å…¸ä¸­çš„é”®å€¼æœ‰å“ªäº›ï¼Œä¸€å…±æœ‰10ä¸­å¦‚ä¸‹ï¼š</span></span><br><span class="line">[<span class="string">'feed'</span>, <span class="string">'status'</span>, <span class="string">'version'</span>, <span class="string">'encoding'</span>, <span class="string">'bozo'</span>, <span class="string">'headers'</span>, <span class="string">'href'</span>, <span class="string">'namespaces'</span>, <span class="string">'entries'</span>, <span class="string">'bozo_exception'</span>]</span><br><span class="line">&#123;<span class="string">'feed'</span>: &#123;&#125;, <span class="string">'encoding'</span>: <span class="string">u'utf-8'</span>, <span class="string">'bozo'</span>: <span class="number">1</span>, <span class="string">'version'</span>: <span class="string">u''</span>, <span class="string">'namespaces'</span>: &#123;&#125;, <span class="string">'entries'</span>: [], <span class="string">'bozo_exception'</span>: SAXParseException(<span class="string">'no element found'</span>,)&#125;</span><br><span class="line"><span class="comment"># d.channelä¸‹çš„å±æ€§ä¸ºchannelä¸­ä¸­çš„å­—æ®µï¼Œæ¯”å¦‚titleã€linkã€descriptionã€generatorã€webMasterã€lastBuildDate</span></span><br><span class="line">&gt;&gt;&gt;d[<span class="string">'feed'</span>][<span class="string">'title'</span>]</span><br><span class="line"><span class="string">'åšå®¢å›­_é¦–é¡µ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.title    <span class="comment">#é€šè¿‡å±æ€§çš„æ–¹å¼è®¿é—®</span></span><br><span class="line"><span class="string">'åšå®¢å›­_é¦–é¡µ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.subtitle</span><br><span class="line"><span class="string">'ä»£ç æ”¹å˜ä¸–ç•Œ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.link</span><br><span class="line"><span class="string">'uuid:1b90fd0c-6080-4ea5-86b1-b87c64b95d69;id=4466'</span></span><br><span class="line">d.entries <span class="comment">#è¯¥å±æ€§ç±»å‹ä¸ºåˆ—è¡¨ï¼Œè¡¨ç¤ºä¸€ç»„æ–‡ç« çš„æ¡ç›®</span></span><br><span class="line">&gt;&gt;&gt;type(d.entries)    <span class="comment">#ç±»å‹ä¸ºåˆ—è¡¨, ä¸ºitemæ ‡ç­¾ä¸­çš„å†…å®¹</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">len</span><span class="params">(d.entries)</span>   #ä¸€å…±20ç¯‡æ–‡ç« </span></span><br><span class="line"><span class="class">20</span></span><br></pre></td></tr></table></figure><p>æ¯ä¸ªRSSå’ŒAtomè®¢é˜…æºéƒ½åŒ…å«ä¸€ä¸ªæ ‡é¢˜ï¼ˆd.feed.titleï¼‰å’Œä¸€ç»„æ–‡ç« æ¡ç›®(d.entries)</p><p><strong>é€šå¸¸</strong>æ¯ä¸ªæ–‡ç« æ¡ç›®éƒ½æœ‰ä¸€æ®µæ‘˜è¦ï¼ˆd.entries[i].summaryï¼‰,æˆ–è€…æ˜¯åŒ…å«äº†æ¡ç›®ä¸­å®é™…æ–‡æœ¬çš„æè¿°æ€§æ ‡ç­¾ï¼ˆd.entries[i].descriptionï¼‰</p></li><li><p>è‡ªå®šä¹‰æ·»åŠ Rssé“¾æ¥-&gt;<a href="https://docs.rsshub.app/joinus/quick-start.html%E3%80%81" target="_blank" rel="noopener">https://docs.rsshub.app/joinus/quick-start.htmlã€</a><a href="https://github.com/DIYgod/RSSHub/pull/1768/files#" target="_blank" rel="noopener"><br>æ·»åŠ æµ™æ±Ÿå·¥å•†å¤§å­¦æ•™åŠ¡å¤„å’Œå­¦æ ¡é¦–é¡µé€šçŸ¥</a></p><blockquote><p>é™¤äº†æŒ‰ç…§Rsshubæ¥è‡ªå®šä¹‰Rssè®¢é˜…æºä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <a href="https://github.com/huginn/huginn" target="_blank" rel="noopener">Huginn</a>ã€Feed43ç­‰å·¥å…·ï¼Œå¦‚<a href="https://www.jianshu.com/p/1024956c8396" target="_blank" rel="noopener">ç”¨Feed43ä¸ºæ•™åŠ¡å¤„ç½‘ç«™åˆ¶ä½œRSS</a></p></blockquote><ol><li><p>æš´éœ²è·¯ç”±é“¾æ¥ï¼šåœ¨ <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/router.js" target="_blank" rel="noopener">/lib/router.js (opens new window)</a>é‡Œæ·»åŠ è·¯ç”±</p></li><li><p>ç¼–å†™æ•°æ®æºè„šæœ¬ï¼šåœ¨ <a href="https://github.com/DIYgod/RSSHub/tree/master/lib/routes" target="_blank" rel="noopener">/lib/routes/ (opens new window)</a>ä¸­çš„è·¯ç”±å¯¹åº”è·¯å¾„ä¸‹åˆ›å»ºæ–°çš„ js è„šæœ¬ï¼š</p><ol><li>ä½¿ç”¨ got è¯·æ±‚ HTML æ•°æ®ï¼š</li><li>ä½¿ç”¨ cheerio è§£æè¿”å›çš„ HTML:</li><li>ä½¿ç”¨ map éå†æ•°ç»„ï¼Œè§£æå‡ºæ¯ä¸€ä¸ª item çš„ç»“æœ â€”â€”å¯¹æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ï¼Œç”Ÿæˆç¬¦åˆ RSS è§„èŒƒçš„å¯¹è±¡ï¼ŒæŠŠè·å–çš„æ ‡é¢˜ã€é“¾æ¥ã€æè¿°ã€å‘å¸ƒæ—¶é—´ç­‰æ•°æ®èµ‹å€¼ç»™ ctx.state.data, <a href="https://docs.rsshub.app/joinus/quick-start.html#%E7%94%9F%E6%88%90-rss-%E6%BA%90" target="_blank" rel="noopener">ç”Ÿæˆ RSS æº</a>ï¼š</li></ol><blockquote><p>ç”Ÿæˆ RSS æºåŸç†ï¼šè·å–åˆ°çš„æ•°æ®èµ‹ç»™ ctx.state.data, ç„¶åæ•°æ®ä¼šç»è¿‡ <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/middleware/template.js" target="_blank" rel="noopener">template.js (opens new window)</a>ä¸­é—´ä»¶å¤„ç†ï¼Œæœ€åä¼ åˆ° <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/views/rss.art" target="_blank" rel="noopener">/lib/views/rss.art (opens new window)</a>æ¥ç”Ÿæˆæœ€åçš„ RSS ç»“æœï¼Œæ¯ä¸ªå­—æ®µçš„å«ä¹‰å¦‚ä¸‹ï¼š<a href="https://docs.rsshub.app/joinus/quick-start.html#ti-jiao-xin-de-rsshub-gui-ze-bian-xie-jiao-ben" target="_blank" rel="noopener">https://docs.rsshub.app/joinus/quick-start.html#ti-jiao-xin-de-rsshub-gui-ze-bian-xie-jiao-ben</a></p></blockquote></li></ol><p>3.æ·»åŠ è„šæœ¬æ–‡æ¡£: <code>&lt;Route author=&quot;HenryQW&quot; example=&quot;/github/issue/DIYgod/RSSHub&quot; path=&quot;/github/issue/:user/:repo&quot; :paramsDesc=&quot;['ç”¨æˆ·å', 'ä»“åº“å']&quot; /&gt;</code></p></li></ul><h2 id="ddt-sharp-shooter"><a class="markdownIt-Anchor" href="#ddt-sharp-shooter"></a> <strong><a href="https://github.com/boring-plans/ddt-sharp-shooter" target="_blank" rel="noopener"> ddt-sharp-shooter</a></strong></h2><blockquote><p>ä½¿ç”¨åˆ°çš„åº“: <code>screeninfoã€pillowã€ddddocrã€pynput</code></p><ul><li>pynput: æ§åˆ¶å’Œç›‘è§†è¾“å…¥è®¾å¤‡ï¼›ç±»ä¼¼çš„æœ‰PyHook3ï¼ˆç›‘è§†é”®é¼ ï¼‰ã€pywin32 ï¼ˆæ¨¡æ‹Ÿé”®é¼ ï¼‰</li><li>ddddocrï¼šè¯†åˆ«éªŒè¯ç ï¼Œè¿™è¾¹ç”¨æ¥è¯†åˆ«æ•°å­—</li></ul></blockquote><ol><li><p>è¿›ç¨‹é—´é€šä¿¡ã€‚ Tkinterç•Œé¢å¼€å¯mainloopè¿›ç¨‹ï¼Œå…¶ä¸­åˆå¼€è¾Ÿå‡ºä¸€ä¸ªå­çº¿ç¨‹æ¥ä¾¦å¬å…¶ä»–è¿›ç¨‹å‘é€çš„æ•°æ®æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡<code>tk.Text</code>æ§ä»¶æ¥å±•ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="comment"># å£°æ˜å…¨å±€å¯¹è±¡åŠç±»å‹</span></span><br><span class="line">_tk: tkinter.Tk</span><br><span class="line">_text: tkinter.Text</span><br><span class="line">_terminate = <span class="keyword">False</span></span><br><span class="line">_queue: multiprocessing.Queue</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_text</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""å­çº¿ç¨‹ä¾¦å¬è¿›ç¨‹æ¶ˆæ¯"""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> _terminate:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _queue.empty():</span><br><span class="line">            text = _queue.get(<span class="keyword">False</span>)</span><br><span class="line">            append_text(text)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_text</span><span class="params">(text)</span>:</span></span><br><span class="line">    _text.config(state=<span class="string">'normal'</span>)</span><br><span class="line">    _text.insert(<span class="string">'end'</span>, <span class="string">f'\n<span class="subst">&#123;text&#125;</span>'</span>)</span><br><span class="line">    _text.see(<span class="string">'end'</span>)</span><br><span class="line">    _text.config(state=<span class="string">'disabled'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(gui_queue)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> _tk, _text, _queue, _screen_size</span><br><span class="line">    _queue = gui_queue</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    threading.Thread(target=update_text).start()</span><br><span class="line">    </span><br><span class="line">    _tk.mainloop()</span><br></pre></td></tr></table></figure></li><li><p><code>py2app setup</code>ï¼Œåœ¨macosä¸‹åˆ›å»ºpythonåº”ç”¨ï¼Œ <code>python setup.py py2app</code></p></li><li><p>å¯¹çº¯æ•°å­—è¯†åˆ«ç»“æœè¿›è¡Œæ¸…æ´—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recognize_digits</span><span class="params">(image: bytes)</span>:</span></span><br><span class="line">    ocr = ddddocr.DdddOcr(show_ad=<span class="keyword">False</span>)</span><br><span class="line">    result = ocr.classification(image)</span><br><span class="line">    <span class="keyword">return</span> wash_digits(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wash_digits</span><span class="params">(digits: str)</span>:</span></span><br><span class="line">    <span class="string">"""ç”±äºä¸ä¼šå‡ºç°éæ•°å­—, æ‰€ä»¥å¯¹æ˜“è¯†åˆ«é”™è¯¯çš„å­—ç¬¦è¿›è¡Œæ›¿æ¢"""</span></span><br><span class="line">    washed = digits \</span><br><span class="line">        .replace(<span class="string">'g'</span>, <span class="string">'9'</span>).replace(<span class="string">'q'</span>, <span class="string">'9'</span>) \</span><br><span class="line">        .replace(<span class="string">'l'</span>, <span class="string">'1'</span>).replace(<span class="string">'i'</span>, <span class="string">'1'</span>) \</span><br><span class="line">        .replace(<span class="string">'z'</span>, <span class="string">'2'</span>) \</span><br><span class="line">        .replace(<span class="string">'o'</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r'\D'</span>, <span class="string">'0'</span>, washed)</span><br></pre></td></tr></table></figure></li></ol><h1 id="æ–‡ç« è®°å½•"><a class="markdownIt-Anchor" href="#æ–‡ç« è®°å½•"></a> æ–‡ç« è®°å½•</h1><h2 id="githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®"><a class="markdownIt-Anchor" href="#githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®"></a> Githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®</h2><ul><li><strong><a href="https://github.com/danistefanovic/build-your-own-x" target="_blank" rel="noopener">build-your-own-x</a></strong>â€”â€”è‡ªå·±é€ è½®å­</li><li><strong><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">system-design-primer</a></strong>â€”â€”ç³»ç»Ÿæ¶æ„è®¾è®¡</li><li><strong><a href="https://github.com/doocs/advanced-java" target="_blank" rel="noopener">advanced-java</a></strong>â€”â€”äº’è”ç½‘ Java å·¥ç¨‹å¸ˆè¿›é˜¶çŸ¥è¯†å®Œå…¨æ‰«ç›²</li><li><a href="https://juejin.cn/post/6844903624062009352" target="_blank" rel="noopener">https://juejin.cn/post/6844903624062009352</a></li><li></li></ul><h2 id="goå¥½ç”¨çš„ä¸‰æ–¹åº“"><a class="markdownIt-Anchor" href="#goå¥½ç”¨çš„ä¸‰æ–¹åº“"></a> Goå¥½ç”¨çš„ä¸‰æ–¹åº“</h2><ul><li><p>ä¸°å¯ŒåŸç”Ÿæ•°æ®ç»“æ„mapã€sliceçš„å·¥å…·åº“ï¼š<a href="https://github.com/samber/lo" target="_blank" rel="noopener">https://github.com/samber/lo</a></p></li><li><p>è¾“å…¥å‚æ•°è§£æåº“: <a href="https://github.com/jessevdk/go-flags" target="_blank" rel="noopener">go-flags</a></p></li><li><p>æ“ä½œexcelçš„åº“ï¼š<a href="https://github.com/qax-os/excelize" target="_blank" rel="noopener">excelize</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;çˆ¬è™«ç³»åˆ—&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#çˆ¬è™«ç³»åˆ—&quot;&gt;&lt;/a&gt; çˆ¬è™«ç³»åˆ—&lt;/h1&gt;
&lt;h2 id=&quot;æŠ¢è´­-ç§’æ€&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æŠ¢è´­-ç§’æ€&quot;&gt;&lt;/a&gt; æŠ¢è´­ã€ç§’æ€&lt;
      
    
    </summary>
    
    
      <category term="ä»£ç é˜…è¯»" scheme="https://nymrli.top/tags/%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring</title>
    <link href="https://nymrli.top/2022/02/27/%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring/"/>
    <id>https://nymrli.top/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/</id>
    <published>2022-02-27T05:52:08.000Z</published>
    <updated>2022-02-27T05:54:23.566Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>From : <a href="https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6</a></p></blockquote><h2 id="åˆ›å»ºbeançš„æ–¹å¼"><a class="markdownIt-Anchor" href="#åˆ›å»ºbeançš„æ–¹å¼"></a> åˆ›å»ºbeançš„æ–¹å¼ï¼š</h2><h3 id="å£°æ˜å¼"><a class="markdownIt-Anchor" href="#å£°æ˜å¼"></a> å£°æ˜å¼</h3><h4 id="beanbean"><a class="markdownIt-Anchor" href="#beanbean"></a> <code>&lt;bean&gt;&lt;/bean&gt;</code></h4><ul><li><p><code>&lt;bean&gt;&lt;/bean&gt;</code>ï¼š é€šè¿‡xmlæ¥é…ç½®bean</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop/spring-aop-3.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"p1"</span> <span class="attr">class</span>=<span class="string">"top.nymrli.tryboot.po.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å¼ ä¸‰"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testPerson()</span><br><span class="line">    &#123;</span><br><span class="line"> ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");</span><br><span class="line"></span><br><span class="line">        User user = annotationConfigApplicationContext.getBean("p1", User.class);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="bean"><a class="markdownIt-Anchor" href="#bean"></a> <code>@Bean</code></h4><ul><li><p><code>@Bean</code>: é€šè¿‡æ³¨è§£æ¥æ ‡æ³¨SpringBeanå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"name"</span>, <span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">        ctx.register(Config.class);</span><br><span class="line">        <span class="comment">// æˆ–è€… AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext(Config.class);</span></span><br><span class="line"></span><br><span class="line">        ctx.refresh();</span><br><span class="line"></span><br><span class="line">        User user = ctx.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext(Config.class);</code>ä¸<code>ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</code>ä¸€æ ·ï¼Œéƒ½æ˜¯æŒ‡å®šbeançš„é…ç½®è·¯å¾„åè§£æï¼Œè·å¾—beançš„é…ç½®ã€‚</p></li></ul><h4 id="component"><a class="markdownIt-Anchor" href="#component"></a> <code>@Component</code></h4><ul><li><p><code>@Component</code>: é€šè¿‡æ ‡æ³¨æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶SpringBeanå¯¹è±¡ï¼Œå¦‚ä¸‹çš„Userã€‚ ==&gt; ç­‰ä»·äº<code>ctx.registerBean(User.class)</code>ï¼ŒregisterBeanæ–¹æ³•çš„å®ç°æœ€ç»ˆä¹Ÿæ˜¯è°ƒç”¨äº†registerBeanDefinition</p><p>è€ŒConfigä¸æ˜¯ä¸€ä¸ªbeanï¼Œä»–çš„ä½œç”¨è·ŸapplicationContext.xmlä¸€æ ·ï¼Œä»–æ˜¯å­˜æ”¾beanå®šä¹‰è·¯å¾„çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæ˜¯é€šè¿‡ComponentScanè®©Springèƒ½å¤Ÿæ‰¾åˆ°top.nymrli.tryboot.poä¸‹çš„æ‰€æœ‰Beanå¹¶è§£ææˆSpringBean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span>(<span class="string">"top.nymrli.tryboot.po"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span><span class="comment">// ==&gt; beanNameä¸ºuser, ç±»åå°å†™</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line"></span><br><span class="line">    User user = ctx.getBean(User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šè‡ªåŠ¨è°ƒç”¨Userçš„æ— å‚æ„é€ æ–¹å¼æ¥åˆ›å»ºJavaBeanï¼Œ å› æ­¤å¾—åˆ°çš„Useræ˜¯<code>User(name=null, age=0)</code></p></li></ul><p>â–².ä¸Šè¿°ä¸‰ç§åˆ›å»ºæ–¹å¼æœ¬è´¨ä¸Šéƒ½æ˜¯åˆ›å»ºäº†BeanDefinitionï¼Œåªä¸è¿‡Springè¿›è¡Œäº†å°è£…ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥æ¯”è¾ƒç®€å•ç›´è§‚</p><h4 id="import"><a class="markdownIt-Anchor" href="#import"></a> @Import</h4><blockquote><p>spring4.2ä¹‹å<code>@Import</code>æ³¨è§£å¯ä»¥å®ä¾‹åŒ–æ™®é€šç±»çš„beanå®ä¾‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Import</span>(Role.class)<span class="comment">// @Import(&#123;Role.class, User.class&#125;)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Role role;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(role);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Springåœ¨åˆ›å»ºMyConfigçš„æ—¶å€™ï¼Œä¼šæ ¹æ®@Importå°†Roleä¹Ÿå®ä¾‹åŒ–æˆä¸€ä¸ªBean</p><h3 id="ç¼–ç¨‹å¼"><a class="markdownIt-Anchor" href="#ç¼–ç¨‹å¼"></a> ç¼–ç¨‹å¼</h3><h4 id="beandefinition"><a class="markdownIt-Anchor" href="#beandefinition"></a> BeanDefinition</h4><blockquote><p>é€šè¿‡åˆ›å»ºå¹¶é…ç½® BeanDefinition æ¥åˆ›å»ºä¸€ä¸ªBean</p><p>Q: ä»€ä¹ˆæ˜¯BeanDefinition?</p><p>A: BeanDefinitionè¡¨ç¤ºBeançš„å®šä¹‰ä¿¡æ¯ï¼Œ Springä¼šæ ¹æ®BeanDefinitionæ¥åˆ›å»ºBeanå¯¹è±¡ã€‚BeanDefinitionæœ‰å¾ˆå¤šçš„å±æ€§ç”¨æ¥æè¿°Beanï¼Œ BeanDefinitionæ˜¯Springä¸­éå¸¸æ ¸å¿ƒçš„æ¦‚å¿µã€‚</p><ul><li>beanClass: è¡¨ç¤ºBeanå¯¹è±¡çš„ç±»ç±»å‹ï¼Œ Springåœ¨åˆ›å»ºBeançš„è¿‡ç¨‹ä¸­æ ¹æ®æ­¤å±æ€§æ¥åˆ¤æ–­å®ä¾‹åŒ–å¯¹è±¡å…·ä½“çš„ç±»ç±»å‹</li><li>scopeï¼šä½œç”¨åŸŸï¼Œ[singletonã€prototype]ï¼Œå•ä¾‹æˆ–è€…åŸå‹bean</li><li>isLazyï¼šæ˜¯å¦éœ€è¦æ‡’åŠ è½½ï¼ŒåŸå‹Beançš„æ‡’åŠ è½½ä¸å¥æ•ˆã€‚æ‡’åŠ è½½çš„å•ä¾‹beanï¼Œä¼šåœ¨ç¬¬ä¸€æ¬¡getBeançš„æ—¶å€™ç”Ÿæˆè¯¥beanï¼Œéæ‡’åŠ è½½çš„å•ä¾‹beanï¼Œåˆ™ä¼šåœ¨Spring.å¯åŠ¨è¿‡ç¨‹ä¸­ç›´æ¥ç”Ÿæˆå¥½ã€‚</li><li>dependsOnï¼šè¡¨ç¤ºä¸€ä¸ªbeanåœ¨åˆ›å»ºä¹‹å‰æ‰€ä¾é¢—çš„å…¶ä»–beanï¼Œåœ¨ä¸€ä¸ªbeanåˆ›å»ºä¹‹å‰ï¼Œå®ƒæ‰€ä¾èµ–çš„è¿™äº›beanå¾—å…ˆå…¨éƒ¨åˆ›å»ºå¥½ã€‚</li><li>primaryï¼šè¡¨ç¤ºä¸€ä¸ªbeanæ˜¯ä¸»beanï¼Œåœ¨Springä¸­ä¸€ä¸ªç±»å‹å¯ä»¥æœ‰å¤šä¸ªbeanå¯¹è±¡ï¼Œåœ¨è¿›è¡Œä¾èµ–æ³¨å…¥æ—¶ï¼Œå¦‚æœæ ¹æ®ç±»å‹æ‰¾åˆ°äº†å¤šä¸ªbÂ©anï¼Œæ­¤æ—¶ä¼šåˆ¤æ–­è¿™äº›beanä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªä¸»beanï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥å°†è¿™ä¸ªbeanæ³¨å…¥ç»™å±æ€§ã€‚</li><li>initMethodNameï¼š è¡¨ç¤ºä¸€ä¸ªbeançš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸€ä¸ªbeançš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ­¥éª¤å«åˆå§‹åŒ–ï¼ŒSpringä¼šåœ¨è¿™ä¸ªæ­¥éª¤ä¸­å»è°ƒç”¨beançš„åˆå§‹åŒ–æ–¹æ³•ã€‚åˆå§‹åŒ–é€»è¾‘ç”±ç¨‹åºå‘˜è‡ªå·±æ§åˆ¶ï¼Œä½¿å¾—ç¨‹åºå‘˜å¯ä»¥è‡ªå®šä¹‰é€»è¾‘å¯¹beanè¿›è¡ŒåŠ å·¥ã€‚</li></ul><p>é€šè¿‡<code>&lt;bean&gt;&lt;/bean&gt;</code>ã€<code>@Bean</code>ã€<code>@Component</code>æ ‡æ³¨çš„ç±»éƒ½ä¼šè§£æä¸ºBeanDefinitionï¼Œä¾›Springåˆ›å»ºï¼ˆå®ä¾‹åŒ–ï¼‰å…·ä½“çš„Beanã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line">    AbstractBeanDefinition bd = BeanDefinitionBuilder.genericBeanDefinition().getBeanDefinition();</span><br><span class="line">    bd.setBeanClass(User.class);</span><br><span class="line">    <span class="comment">// å°†BeanDefinitionæ³¨å†Œåˆ°ä¸Šä¸‹æ–‡ä¸­</span></span><br><span class="line">    ctx.registerBeanDefinition(<span class="string">"user"</span>, bd);</span><br><span class="line">    <span class="comment">// è·å¾—Beanå¯¹è±¡</span></span><br><span class="line">    User user = (User)ctx.getBean(<span class="string">"user"</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="factorybean"><a class="markdownIt-Anchor" href="#factorybean"></a> FactoryBean</h4><blockquote><p>FactoryBeanæ˜¯Spring.æ‰€æä¾›çš„ä¸€ç§è¾ƒçµæ´»çš„åˆ›å»ºBeançš„æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡å®ç°FactoryBeanï¼šæ¥å£ä¸­çš„getObject()æ–¹æ³•æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æœ€ç»ˆçš„Beanå¯¹è±¡ã€‚</p></blockquote><p>FactoryBeanæ¥å£ä¸­çš„æ–¹æ³•</p><ul><li>Object getObject()ï¼šè¿”å›çš„æ˜¯Beanå¯¹è±¡</li><li>boolean isSingleton()ï¼šè¿”å›çš„æ˜¯å¦æ˜¯å•ä¾‹Beanå¯¹è±¡</li><li>Class getObjectType()ï¼šè¿”å›çš„æ˜¯Beanå¯¹è±¡çš„ç±»å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"zhouyu"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZhouyuFactoryBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"cl"</span>, <span class="number">18</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> User.class;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œå®é™…ä¸Šå¯¹åº”äº†ä¸¤ä¸ªBeanå¯¹è±¡ï¼š<br>1ã€beanNameä¸º&quot;zhouyuâ€™ï¼Œbeanå¯¹è±¡ä¸ºgetObjectæ–¹æ³•æ‰€è¿”å›çš„Userå¯¹è±¡ã€‚=&gt;<code>applicationcontext.getBean(nameï¼š&quot;zhouyu&quot;ï¼ŒZhouyuFactory.class);</code><br>2ã€beanNameä¸º&quot;&amp;zhouyuâ€™ï¼Œbeanå¯¹è±¡ä¸ºZhouyuFactoryBeanç±»çš„å®ä¾‹å¯¹è±¡ã€‚=&gt;<code>applicationcontext.getBean(nameï¼š&quot;&amp;zhouyu&quot;ï¼ŒZhouyuFactoryBean.class);</code></p><p>ä¸BeanFactoryçš„åŒºåˆ«ï¼š</p><ul><li>FactoryBeanå¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªBeanï¼ŒåŒæ—¶å®ƒç›¸å½“äºä¸€ä¸ªå°å‹å·¥å‚ï¼Œå¯ä»¥ç”Ÿäº§å‡º<strong>å¦å¤–</strong>çš„Beanã€‚==ã€‹æŒ‡å®šç±»å‹çš„Beanå¯¹è±¡<ul><li>FactoryBeanæœºåˆ¶è¢«å¹¿æ³›çš„åº”ç”¨åœ¨Springå†…éƒ¨å’ŒSpring-ä¸ç¬¬ä¸‰æ–¹æ¡†æ¶æˆ–ç»„ä»¶çš„æ•´åˆè¿‡ç¨‹ä¸­ã€‚</li></ul></li><li>BeanFactoryæ˜¯ä¸€ä¸ªSpringå®¹å™¨ï¼Œæ˜¯ä¸€ä¸ªå¤§å‹å·¥å‚ï¼Œå®ƒå¯ä»¥ç”Ÿäº§å‡º<strong>å„ç§å„æ ·</strong>çš„Beano</li></ul><h4 id="supplier"><a class="markdownIt-Anchor" href="#supplier"></a> Supplier</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line">        ctx.registerBean(User.class, <span class="keyword">new</span> Supplier&lt;User&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> User <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                User userx = <span class="keyword">new</span> User();</span><br><span class="line">                userx.setAge(<span class="number">222</span>);</span><br><span class="line">                userx.setName(<span class="string">"supplier"</span>);</span><br><span class="line">                <span class="keyword">return</span> userx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        User user = (User)ctx.getBean(<span class="string">"user"</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="beanfactory"><a class="markdownIt-Anchor" href="#beanfactory"></a> BeanFactory</h2><p>BeanFactoryæ˜¯ä¸€ç§â€œSpringå®¹å™¨â€ï¼Œ BeanFactoryç¿»è¯‘è¿‡æ¥å°±æ˜¯Beanå·¥å‚ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºBeanã€è·å–Beanã€‚</p><p>æ¦‚å¿µåŒºåˆ†ï¼š</p><ul><li>BeanFactoryå°†åˆ©ç”¨BeanDefinitionï¼šæ¥ç”ŸæˆBeanå¯¹è±¡</li><li>BeanDefinitionç›¸å½“äºBeanFactoryçš„åŸææ–™</li><li>Beanå¯¹è±¡å°±ç›¸å½“äºBeanFactoryï¼‰æ‰€ç”Ÿäº§å‡ºæ¥çš„äº§å“</li></ul><p>BeanFactoryçš„æ ¸å¿ƒå­æ¥å£å’Œå®ç°ç±»ï¼š</p><ul><li>ListableBeanFactory</li><li>ConfigurableBeanFactory</li><li>AutowireCapableBeanFactory</li><li>AbstractBeanFactory</li><li>DefaultListableBeanFactory</li></ul><p>Â·Â·Â·</p><h2 id="beanç”Ÿå‘½å‘¨æœŸ"><a class="markdownIt-Anchor" href="#beanç”Ÿå‘½å‘¨æœŸ"></a> Beanç”Ÿå‘½å‘¨æœŸ</h2><blockquote><p>Beanç”Ÿå‘½å‘¨æœŸæè¿°çš„æ˜¯Springä¸­ä¸€ä¸ªBeanåˆ›å»ºè¿‡ç¨‹å’Œé”€æ¯è¿‡ç¨‹ä¸­æ‰€ç»å†çš„æ­¥éª¤ï¼Œå…¶ä¸­Beanåˆ›å»ºè¿‡ç¨‹æ˜¯é‡ç‚¹ã€‚ç¨‹åºå‘˜å¯ä»¥åˆ©ç”¨Beanç”Ÿå‘½å‘¨æœŸæœºåˆ¶å¯¹Beanè¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</p></blockquote><ul><li>Beanå®šä¹‰ï¼šé€šè¿‡xmlæˆ–è€…ç¼–å†™ç±»çš„å½¢å¼æ¥åˆ›å»ºBeanDefinition</li><li>æ„é€ æ–¹æ³•æ¨æ–­ï¼šä»beançš„å¤šä¸ªæ„é€ æ–¹æ³•ä¸­é€‰å‡ºä¸€ä¸ªæ„é€ æ–¹æ³•</li><li>å®ä¾‹åŒ–ï¼šé€šè¿‡æ„é€ æ–¹æ³•åå°„è·å¾—å¯¹è±¡ï¼Œåœ¨Springä¸­å¯ä»¥é€šè¿‡BeanPostProcessoræœºåˆ¶å¯¹å®ä¾‹åŒ–è¿›è¡Œå¹²é¢„</li><li>å±æ€§å¡«å……(è‡ªåŠ¨æ³¨å…¥ã€ä¾èµ–æ³¨å…¥)ï¼šç»™å±æ€§è¿›è¡Œè‡ªåŠ¨å¡«å……ï¼Œæ¯”å¦‚@Valueï¼Œ@AutoWired</li><li>åˆå§‹åŒ–ï¼šåœ¨ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¡«å……ä¹‹åï¼ŒSpringæä¾›äº†åˆå§‹åŒ–æœºåˆ¶ï¼Œè®©ç¨‹åºå‘˜å¯ä»¥å¯¹å…¶ä»–å±æ€§è¿›è¡Œèµ‹å€¼ã€æ ¡éªŒç­‰è‡ªå®šä¹‰åŠ å·¥(åˆ©ç”¨InitializingBeanæ¥å£)</li><li>åˆå§‹åŒ–åï¼šAopã€ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚å¸¸è¯´çš„Aopæœºåˆ¶å°±æ˜¯åœ¨è¿™ä¸ªæ­¥éª¤ä¸­é€šè¿‡BeanPostProcessoræœºåˆ¶å®ç°çš„ï¼Œè¿™æ­¥ä¹‹åè·å¾—çš„å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„Beanå¯¹è±¡</li></ul><p>åˆ›å»ºè¿‡ç¨‹ï¼š</p><p><img src="/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/E:%5Chexo%5Csource_posts%5C%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring%5Cbean%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B.jpg" alt="beanåˆ›å»ºè¿‡ç¨‹"></p><p>ç”Ÿå‘½å‘¨æœŸå›¾ï¼š</p><p><img src="/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/E:%5Chexo%5Csource_posts%5C%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring%5Cbean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-1.jpg" alt="beanç”Ÿå‘½å‘¨æœŸ-1"></p><h2 id="å±æ€§å¡«å……æ³¨è§£autowired-resource-value"><a class="markdownIt-Anchor" href="#å±æ€§å¡«å……æ³¨è§£autowired-resource-value"></a> å±æ€§å¡«å……æ³¨è§£ï¼š@Autowiredã€@Resourceã€@Value</h2><h3 id="autowired"><a class="markdownIt-Anchor" href="#autowired"></a> @Autowired.</h3><p>è¡¨ç¤ºæŸä¸ªå±æ€§æ˜¯å¦éœ€è¦è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå¯ä»¥å†™åœ¨å±æ€§å’Œæ–¹æ³•ä¸Šã€‚æ³¨è§£ä¸­çš„requiredå±æ€§é»˜è®¤ä¸ºtureï¼Œè¡¨ç¤ºå¦‚æœæ²¡æœ‰å¯¹è±¡å¯ä»¥æ³¨å…¥ç»™å±æ€§åˆ™æŠ›å¼‚å¸¸ã€‚</p><ul><li><p>@Autowiredï¼šåŠ åœ¨æŸä¸ª<strong>å±æ€§</strong>ä¸Šï¼ŒSpringåœ¨è¿›è¡ŒBeançš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­ï¼Œåœ¨<strong>å±æ€§å¡«å……</strong>è¿™ä¸€æ­¥ä¼šåŸºäºå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œå¯¹è¯¥å¯¹è±¡ä¸­åŠ äº†@Autowiredçš„å±æ€§è‡ªåŠ¨ç»™å±æ€§èµ‹å€¼ã€‚å…·ä½“å®ç°ä¸ºï¼š Springä¼šå…ˆæ ¹æ®å±æ€§çš„ç±»å‹å»Springå®¹å™¨ä¸­æ‰¾å‡ºè¯¥ç±»å‹æ‰€æœ‰çš„Beanå¯¹è±¡ï¼Œå¦‚æœæ‰¾å‡ºæ¥å¤šä¸ªï¼Œåˆ™å†æ ¹æ®å±æ€§çš„åå­—ä»å¤šä¸ªä¸­å†ç¡®å®šä¸€ä¸ªã€‚å¦‚æœrequiredå±æ€§ä¸ºtrueï¼Œå¹¶ä¸”æ ¹æ®å±æ€§ä¿¡æ¯æ‰¾ä¸åˆ°å¯¹è±¡ï¼Œåˆ™ç›´æ¥æŠ›å¼‚å¸¸ã€‚</p></li><li><p>å½“@Autowiredæ³¨è§£å†™åœ¨<strong>æŸä¸ªæ–¹æ³•</strong>ä¸Šæ—¶ï¼ŒSpringåœ¨B eanç”Ÿå‘½å‘¨æœŸçš„å±æ€§å¡«å……é˜¶æ®µï¼Œä¼šæ ¹æ®æ–¹æ³•çš„å‚æ•°ç±»å‹ã€å‚æ•°åå­—ä»Springå®¹å™¨æ‰¾åˆ°å¯¹è±¡å½“åšæ–¹æ³•å…¥å‚ï¼Œè‡ªåŠ¨åå°„è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p></li><li><p>@AutowiredåŠ åœ¨<strong>æ„é€ æ–¹æ³•</strong>ä¸Šæ—¶ï¼ŒSpringä¼šåœ¨<strong>æ¨æ–­æ„é€ æ–¹æ³•é˜¶æ®µ</strong>ï¼Œ<u>é€‰æ‹©è¯¥æ„é€ æ–¹æ³•æ¥è¿›è¡Œå®ä¾‹åŒ–</u>ï¼Œåœ¨åå°„è°ƒç”¨æ„é€ æ–¹æ³•ä¹‹å‰ï¼Œä¼šå…ˆæ ¹æ®æ„é€ æ–¹æ³•å‚æ•°ç±»å‹ã€å‚æ•°åä»Springå®¹å™¨ä¸­æ‰¾åˆ°Beanå¯¹è±¡ï¼Œå½“åšæ„é€ æ–¹æ³•å…¥å‚ã€‚</p></li></ul><h3 id="resource"><a class="markdownIt-Anchor" href="#resource"></a> @Resource</h3><p>@Resourceæ³¨è§£ä¸@Autowiredç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨æ¥è¿›è¡Œä¾èµ–æ³¨å…¥çš„ï¼Œ@Resourceæ˜¯<strong>Javaå±‚é¢</strong>æ‰€æä¾›çš„æ³¨è§£ï¼Œ@Autowired.æ˜¯<strong>Spring</strong>æ‰€æä¾›çš„æ³¨è§£ï¼Œå®ƒä»¬ä¾èµ–æ³¨å…¥çš„åº•å±‚å®ç°é€»è¾‘ä¹Ÿä¸åŒã€‚</p><p>@Resourceï¼šæ³¨è§£ä¸­æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œé’ˆå¯¹na meå±æ€§æ˜¯å¦æœ‰å€¼ï¼Œ@Resourceçš„ä¾èµ–æ³¨å…¥åº•å±‚æµç¨‹æ˜¯ä¸åŒçš„ã€‚</p><ul><li>@Reousrceï¼šå¦‚æœnameå±æ€§æœ‰å€¼ï¼Œé‚£ä¹ˆSpringä¼šç›´æ¥æ ¹æ®æ‰€æŒ‡å®šçš„nameå€¼å»Springå®¹å™¨æ‰¾Beanå¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™æˆåŠŸï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æŠ¥é”™ã€‚</li><li>å¦‚æœ@Resourceä¸­çš„nameå±æ€§æ²¡æœ‰å€¼ï¼Œåˆ™ï¼š<ol><li>å…ˆåˆ¤æ–­è¯¥å±æ€§åå­—åœ¨Springå®¹å™¨ä¸­æ˜¯å¦å­˜åœ¨Beanå¯¹è±¡ã€‚</li><li>å¦‚æœå­˜åœ¨ï¼Œåˆ™æˆåŠŸæ‰¾åˆ°Beanå¯¹è±¡è¿›è¡Œæ³¨å…¥ã€‚</li><li>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ ¹æ®å±æ€§ç±»å‹å»Springå®¹å™¨æ‰¾Beanå¯¹è±¡ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ™è¿›è¡Œæ³¨å…¥ã€‚</li></ol></li></ul><h3 id="value"><a class="markdownIt-Anchor" href="#value"></a> @Value</h3><p>@Valueæ³¨è§£å’Œ@Resourceã€@Autowiredç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨æ¥å¯¹å±æ€§è¿›è¡Œä¾èµ–æ³¨å…¥çš„ï¼Œåªä¸è¿‡@Valueæ˜¯ç”¨æ¥ä»<strong>Properties.æ–‡ä»¶ä¸­</strong>æ¥è·å–<strong>å€¼</strong>çš„ï¼Œå¹¶ä¸”@Valueå¯ä»¥è§£æSpELï¼ˆSpringè¡¨è¾¾å¼ï¼‰ã€‚</p><ul><li><p><code>@Value(&quot;yuzhou&quot;)</code>: ç›´æ¥å°†å­—ç¬¦ä¸²â€œzhouyuâ€èµ‹å€¼ç»™å±æ€§ï¼Œå¦‚æœå±æ€§ç±»å‹ä¸æ˜¯Stringï¼Œæˆ–æ— æ³•è¿›è¡Œç±»å‹è½¬åŒ–ï¼Œåˆ™æŠ¥é”™ã€‚</p></li><li><p><code>@Value(${&quot;yuzhou&quot;})</code>ï¼š å°†ä¼šæŠŠ<code>${}</code>ä¸­çš„å­—ç¬¦ä¸²å½“åškeyï¼Œä»Propertiesæ–‡ä»¶ä¸­æ‰¾å‡ºå¯¹åº”çš„valueèµ‹å€¼ç»™å±æ€§ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠŠ<code>${zhouyu}</code>å½“åšæ™®é€šå­—ç¬¦ä¸²æ³¨å…¥ç»™å±æ€§ã€‚</p></li><li><p><code>@Value(#{&quot;yuzhou&quot;})</code>:ä¼šå°†<code>#{}</code>ä¸­çš„å­—ç¬¦ä¸²å½“åšSpringè¡¨è¾¾å¼è¿›è¡Œè§£æï¼ŒSpringä¼šæŠŠ&quot;zhouyu&quot;å½“åšbeanNameï¼Œå¹¶ä»Springå®¹å™¨ä¸­æ‰¾å¯¹åº”beanï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿›è¡Œå±æ€§æ³¨å…¥ï¼Œæ²¡æ‰¾åˆ°åˆ™æŠ¥é”™ã€‚</p></li><li></li></ul><h2 id="applicationcontext"><a class="markdownIt-Anchor" href="#applicationcontext"></a> ApplicationContext</h2><p>ApplicationContextæ˜¯æ¯”BeanFactoryæ›´åŠ å¼ºå¤§çš„Springå®¹å™¨ï¼Œå®ƒæ—¢å¯ä»¥åˆ›å»ºbeanã€è·å–beanï¼Œè¿˜æ”¯æŒå›½é™…åŒ–ã€äº‹ä»¶å¹¿æ’­ã€è·å–èµ„æºç­‰BeanFactor yä¸å…·å¤‡çš„åŠŸèƒ½ã€‚</p><p>Application Contextï¼Œæ‰€ç»§æ‰¿çš„æ¥å£</p><ul><li>EnvironmentCapableï¼šæ‹¥æœ‰è·å–ç¯å¢ƒå˜é‡çš„èƒ½åŠ›ï¼šæ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡å’ŒJvmç¯å¢ƒå˜é‡</li><li>ListableBeanFactoryï¼šæ‹¥æœ‰äº†è·å–æ‰€æœ‰beanNamesã€åˆ¤æ–­æŸä¸ªbean Nameæ˜¯å¦å­˜åœ¨peanDefinitionå¯¹è±¡ã€ç»Ÿè®¡Be anDefinitionä¸ªæ•°ã€è·å–æŸä¸ªç±»å‹å¯¹åº”çš„æ‰€æœ‰beanNamesç­‰åŠŸèƒ½ã€‚</li><li>HierarchicalBeanFactoryï¼šæ‹¥æœ‰äº†è·å–çˆ¶BeanFactoryã€ã€‚åˆ¤æ–­æŸä¸ªnameæ˜¯å¦å­˜åœ¨beanå¯¹è±¡çš„åŠŸèƒ½ã€‚</li><li>MessageSourceï¼šæ‹¥æœ‰äº†å›½é™…åŒ–åŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥åˆ©ç”¨Messa geSourceå¯¹è±¡è·å–æŸä¸ªå›½é™…åŒ–èµ„æºï¼ˆæ¯”å¦‚ä¸åŒå›½å®¶è¯­è¨€æ‰€å¯¹åº”çš„å­—ç¬¦ï¼‰</li><li>ApplicationEventPublisherï¼š æ‹¥æœ‰äº†äº‹ä»¶å‘å¸ƒåŠŸèƒ½ï¼Œå¯ä»¥å‘å¸ƒäº‹ä»¶ï¼Œè¿™æ˜¯Application Contextç›¸å¯¹äºBeanFactoryæ¯”è¾ƒçªå‡ºã€å¸¸ç”¨çš„åŠŸèƒ½ã€‚</li><li>ResourcePatternResolver: æ‹¥æœ‰äº†åŠ è½½å¹¶è·å–èµ„æºçš„åŠŸèƒ½ï¼Œè¿™é‡Œçš„èµ„æºå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œå›¾ç‰‡ç­‰æŸä¸ªURLèµ„æºéƒ½å¯ä»¥ã€‚</li></ul><h3 id="è·å¾—beançš„æ–¹å¼"><a class="markdownIt-Anchor" href="#è·å¾—beançš„æ–¹å¼"></a> è·å¾—beançš„æ–¹å¼ï¼š</h3><blockquote><p><em>getBean() API</em></p></blockquote><ul><li><p>æŒ‰åç§°è·å–Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object lion = context.getBean(<span class="string">"lion"</span>);</span><br><span class="line"> </span><br><span class="line">assertEquals(Lion.class, lion.getClass());</span><br></pre></td></tr></table></figure><p>æ ¹æ®beanåç§°è·å–beanï¼Œå¦‚æœåœ¨spring icoå®¹å™¨ä¸­å­˜åœ¨å’Œbeanï¼Œåˆ™è¿”å›<em>Object</em> ç±»çš„å®ä¾‹ã€‚å¦åˆ™ï¼ŒæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸NoSuchBeanDefinitionExceptionã€‚</p><p>â–²: ä¸»è¦çš„ç¼ºç‚¹æ˜¯ï¼Œåœ¨è·å–beanä¹‹åï¼Œæˆ‘ä»¬<strong>å¿…é¡»å°†å®ƒæŒ‡å®šè½¬æ¢ä¸ºæ‰€éœ€çš„ç±»å‹</strong>ã€‚å¦‚æœè¿”å›çš„beançš„ç±»å‹ä¸æˆ‘ä»¬æœŸæœ›çš„ä¸åŒï¼Œåˆ™å¯èƒ½ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚</p></li><li><p>é€šè¿‡åç§°å’Œç±»å‹è·å–Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Lion lion = context.getBean(<span class="string">"lion"</span>, Lion.class);</span><br><span class="line"><span class="comment">// ä¸æŒ‰åç§°è·å–Beanç›¸æ¯”ï¼Œæ­¤æ–¹æ³•æ›´å®‰å…¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç¼–è¯‘é˜¶æ®µå°±å‘ç°é”™è¯¯è€Œä¸æ˜¯åœ¨è¿è¡Œé˜¶æ®µã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assertThrows(BeanNotOfRequiredTypeException.class, () -&gt; </span><br><span class="line">    context.getBean(<span class="string">"lion"</span>, Tiger.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰ç±»å‹è·å–Bean</p></li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// right</span></span><br><span class="line">Lion lion = context.getBean(Lion.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„: åœ¨ä¸‹é¢çš„æƒ…å†µä¸‹ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„å¯èƒ½å­˜åœ¨çš„æ­§ä¹‰ï¼š</span></span><br><span class="line">assertThrows(NoUniqueBeanDefinitionException.class, () -&gt; </span><br><span class="line">    context.getBean(Animal.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº<em>Lion</em>å’Œ<em>Tigeréƒ½</em>å®ç°äº†<em>Animal</em>æ¥å£ï¼Œå› æ­¤ä»…æŒ‡å®šç±»å‹ä¸è¶³ä»¥æ˜ç¡®ç¡®å®šç»“æœã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª*<code>NoUniqueBeanDefinitionException</code>*ã€‚å³åœ¨<strong>åŒä¸€ä¸ªIOC å®¹å™¨ä¸­ï¼Œå¦‚æœ<u>æœ‰ç›¸åŒç±»å‹çš„å¤šä¸ªbean</u>ï¼Œåˆ™ä¸èƒ½é€šè¿‡ç±»å‹è·å–bean</strong>ã€‚</p><ul><li>æŒ‰åç§°å’Œæ„é€ å‡½æ•°å‚æ•°å¯¹Beanè¿›è¡Œç­›é€‰</li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tiger tiger = (Tiger) context.getBean(<span class="string">"tiger"</span>, <span class="string">"Siberian"</span>);</span><br><span class="line">Tiger secondTiger = (Tiger) context.getBean(<span class="string">"tiger"</span>, <span class="string">"Striped"</span>);</span><br><span class="line"> </span><br><span class="line">assertEquals(<span class="string">"Siberian"</span>, tiger.getName());</span><br><span class="line">assertEquals(<span class="string">"Striped"</span>, secondTiger.getName());</span><br></pre></td></tr></table></figure><ul><li><p>æŒ‰ç±»å‹å’Œæ„é€ å‡½æ•°å‚æ•°å¯¹Beanè¿›è¡Œç­›é€‰</p><blockquote><p>â–²: è¿™ä¸ªæ–¹æ³•æœ‰ç‚¹ä¸åŒï¼Œå› ä¸ºå®ƒ<strong>åªé€‚ç”¨äºå…·æœ‰åŸå‹ä½œç”¨åŸŸ</strong>çš„beanã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tiger tiger = context.getBean(Tiger.class, <span class="string">"Shere Khan"</span>);</span><br><span class="line">assertEquals(<span class="string">"Shere Khan"</span>, tiger.getName());</span><br></pre></td></tr></table></figure></li></ul><h2 id="beanpostprocessoræœºåˆ¶"><a class="markdownIt-Anchor" href="#beanpostprocessoræœºåˆ¶"></a> BeanPostProcessoræœºåˆ¶</h2><p>BeanPostProcessoræ˜¯Springæ‰€æä¾›çš„ä¸€ç§æ‰©å±•æœºåˆ¶ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æœºåˆ¶å¯¹Beanè¿›è¡Œå®šåˆ¶åŒ–åŠ å·¥ï¼Œåœ¨Springåº•å±‚æºç å®ç°ä¸­ï¼Œä¹Ÿå¹¿æ³›çš„ç”¨åˆ°äº†è¯¥æœºåˆ¶ï¼ŒBeanPostProcessoré€šå¸¸ä¹Ÿå«åš<strong>Beanåç½®å¤„ç†å™¨</strong>ã€‚</p><p>BeanPostProcessoråœ¨Springä¸­æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£ï¼Œåœ¨Springä¸­è¿˜å­˜åœ¨ä¸€äº›æ¥å£ç»§æ‰¿äº†BeanPostProcessorï¼Œè¿™äº›å­æ¥å£æ˜¯åœ¨BeanPostProcessorçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›å…¶ä»–çš„åŠŸèƒ½ã€‚</p><p>BeanPostProcessoriä¸­çš„æ–¹æ³•</p><ul><li>postProcessBeforelnitialization()ï¼šåˆå§‹åŒ–å‰æ–¹æ³•ï¼Œè¡¨ç¤ºå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¯¹Beanåœ¨åˆå§‹åŒ–å‰è¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</li><li>postProcessAfterInitialization()ï¼šåˆå§‹åŒ–åæ–¹æ³•ï¼Œè¡¨ç¤ºå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¯¹Beanåœ¨åˆå§‹åŒ–åè¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</li></ul><h3 id="instantiationawarebeanpostprocessor"><a class="markdownIt-Anchor" href="#instantiationawarebeanpostprocessor"></a> InstantiationAwareBeanPostProcessor</h3><blockquote><p>BeanPostProcessorçš„ä¸€ä¸ªå­æ¥å£</p></blockquote><ul><li>postProcessBeforelnstantiation()ï¼šå®ä¾‹åŒ–å‰</li><li>postProcessAfterInstantiation()ï¼šå®ä¾‹åŒ–å</li><li>postProcessProperties()ï¼šå±æ€§æ³¨å…¥å</li></ul><h2 id="aopæ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#aopæ˜¯ä»€ä¹ˆ"></a> AOPæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>AOPå°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ˜¯ä¸€ç§éå¸¸é€‚åˆåœ¨<strong>æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç çš„å‰æ</strong>ä¸‹ï¼Œå¯¹<u>æŸä¸ªæˆ–æŸäº›ä¸šåŠ¡å¢åŠ ç»Ÿä¸€çš„åŠŸèƒ½</u>ï¼ˆæ¨ªå‘å¢åŠ åŠŸèƒ½ï¼‰ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€æƒé™æ§åˆ¶ã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œèƒ½å¾ˆå¥½çš„ä½¿å¾—ä»£ç è§£è€¦ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><ul><li></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;From : &lt;a href=&quot;https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/vid
      
    
    </summary>
    
    
      <category term="Web" scheme="https://nymrli.top/tags/Web/"/>
    
      <category term="Spring" scheme="https://nymrli.top/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…</title>
    <link href="https://nymrli.top/2022/02/26/%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    <id>https://nymrli.top/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/</id>
    <published>2022-02-26T07:24:46.000Z</published>
    <updated>2022-03-09T13:33:00.468Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åœ°å›¾åŒ¹é…"><a class="markdownIt-Anchor" href="#åœ°å›¾åŒ¹é…"></a> åœ°å›¾åŒ¹é…</h1><p>æ¦‚å¿µï¼š</p><blockquote><ul><li>åœ°å›¾åŒ¹é…ï¼ˆMap-Matchingï¼‰æ˜¯å°†è¿è¥è½¦è¾†çš„æœ‰åºçš„GPSä½ç½®å…³è”åˆ°ç”µå­åœ°å›¾çš„è·¯ç½‘ä¸Šï¼Œå°†GPSåæ ‡ä¸‹é‡‡æ ·åºåˆ—è½¬æ¢ä¸ºæ•°å­—è·¯ç½‘åæ ‡åºåˆ—çš„è¿‡ç¨‹ï¼›æœ¬è´¨ä¸Šæ˜¯å¹³é¢çº¿æ®µåºåˆ—çš„æ¨¡å¼åŒ¹é…é—®é¢˜ï¼ˆ Altç­‰ï¼Œ2003ï¼‰</li><li>åœ°å›¾åŒ¹é…æ˜¯ä¸€ç§å°†åŸå§‹GPSä½ç½®æ˜ å°„åˆ°è·¯ç½‘ä¸Šçš„è·¯æ®µçš„è¿‡ç¨‹ï¼Œä»¥åˆ›å»ºå¯¹è½¦è¾†æ‰€èµ°è·¯çº¿çš„ä¼°ç®—ã€‚</li></ul></blockquote><p>ä¸¤ä¸ªä¸»è¦çš„åœ°å›¾åŒ¹é…ç”¨ä¾‹</p><ul><li>ä¹˜è½¦ç»“æŸæ—¶ï¼Œè®¡ç®—é©¾é©¶å‘˜è¡Œè¿›çš„è·ç¦»ï¼Œä»¥è®¡ç®—ç¥¨ä»·ã€‚â€”â€”è·¯çº¿å›¾åŒ¹é…(EORMM)</li><li><strong>å®æ—¶</strong> ï¼Œä¸ºETAå›¢é˜Ÿæä¾›å‡†ç¡®çš„ä½ç½®å¹¶åšå‡º<strong>è°ƒåº¦</strong>å†³ç­–ï¼Œå¹¶åœ¨rideråº”ç”¨ç¨‹åºä¸Š<strong>æ˜¾ç¤º</strong>é©¾é©¶å‘˜çš„æ±½è½¦ã€‚â€”â€”å®æ—¶åœ°å›¾åŒ¹é…(RTMM)</li></ul><p>ä¸åŒç‚¹åœ¨äºï¼Œ<em>å®æ—¶åœ°å›¾åŒ¹é…</em>çš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¿…é¡»ä½å»¶æ—¶ï¼Œå› æ­¤ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<em>è·¯çº¿å›¾åŒ¹é…</em>å¯¹ç­‰å¾…æ—¶é—´çš„è¦æ±‚ä¸é‚£ä¹ˆä¸¥æ ¼ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¹˜è½¦çš„å…¨éƒ¨å†å²è®°å½•</p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒï¼š</h3><ul><li><p><a href="https://zhuanlan.zhihu.com/p/83039334" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/83039334</a></p></li><li><p><a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">Lyftçš„åœ°å›¾åŒ¹é…ç®—æ³•è®ºæ–‡ç¿»è¯‘</a></p><ul><li><p>åœ°å›¾åŒ¹é…ç®—æ³•çš„æ€§èƒ½å–å†³äº<strong>é“è·¯ç½‘ç»œæ•°æ®</strong>çš„<strong>è´¨é‡</strong></p></li><li><p>è§£å†³é—®é¢˜çš„ä¸€ç§å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨<strong>çŠ¶æ€ç©ºé—´æ¨¡å‹</strong> ã€‚ çŠ¶æ€ç©ºé—´æ¨¡å‹æ˜¯æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œå…¶ä¸­ç³»ç»Ÿå…·æœ‰â€œéšè—â€çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ— æ³•ç›´æ¥è§‚å¯Ÿåˆ°ï¼Œä½†ä¼šå¼•èµ·å¯è§çš„è§‚å¯Ÿã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„éšè—çŠ¶æ€æ˜¯æˆ‘ä»¬è¦ä¼°ç®—çš„æ±½è½¦åœ¨é“è·¯ç½‘ç»œä¸Šçš„å®é™…ä½ç½®ã€‚ æˆ‘ä»¬ä»…è§‚å¯Ÿåˆ°éšè—çŠ¶æ€çš„ä¿®æ”¹ç‰ˆæœ¬ï¼šè§‚å¯Ÿå€¼(åŸå§‹ä½ç½®æ•°æ®)ã€‚ æˆ‘ä»¬å‡è®¾ç³»ç»Ÿçš„çŠ¶æ€ä»¥ä»…å–å†³äºå½“å‰çŠ¶æ€çš„æ–¹å¼æ¼”åŒ–(é©¬å°”å¯å¤«å‡è®¾)ï¼Œå¹¶è¿›ä¸€æ­¥å®šä¹‰äº†ä»éšè—çŠ¶æ€åˆ°éšè—çŠ¶æ€çš„è½¬ç§»å¯†åº¦å’Œä»éšè—çŠ¶æ€åˆ°è§‚å¯Ÿçš„å¯†åº¦ã€‚</p><p>å¸¸ç”¨çš„åœ°å›¾åŒ¹é…çŠ¶æ€ç©ºé—´æ¨¡å‹æ˜¯ç¦»æ•£çŠ¶æ€<strong>éšé©¬å°”å¯å¤«æ¨¡å‹</strong> (Newsonï¼†Krumm [2]ï¼ŒDiDiçš„IJCAI-19æ•™ç¨‹[3]ï¼ŒUberçš„Map Matching [4])ã€‚ åœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹è·¯æ®µä¸Šçš„æœ€è¿‘ç‚¹æ¥ç”Ÿæˆå€™é€‰å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">ç»´ç‰¹æ¯”ç®—æ³•</a>æŸ¥æ‰¾æœ€å¯èƒ½çš„éšè—çŠ¶æ€åºåˆ—ã€‚</p><ul><li>å¯¹äºä¸åŒçš„å»ºæ¨¡é€‰æ‹©å’Œè¾“å…¥æ•°æ®è€Œè¨€ï¼Œå®ƒç›¸å¯¹ä¸çµæ´»</li><li>å®ƒç¼©æ”¾ä¸¥é‡(O(NÂ²)ï¼Œå…¶ä¸­Næ˜¯æ¯ä¸ªçŠ¶æ€ä¸‹å¯èƒ½çš„å€™é€‰æ•°)</li><li>å®ƒä¸èƒ½å¾ˆå¥½åœ°åº”å¯¹é«˜é¢‘è§‚æµ‹(è¯·å‚é˜…Newsonï¼†Krumm [2])ã€‚</li></ul></li></ul></li><li><p><a href="http://qikan.cqvip.com/Qikan/Article/Detail?id=1000359922&amp;from=Qikan_Search_Index" target="_blank" rel="noopener">GPSå®šä½ä¸åœ°å›¾åŒ¹é…æ–¹æ³•ç ”ç©¶</a></p><ul><li>åœ°å›¾åŒ¹é…ç®—æ³•ä»åŸç†ä¸Šå¯ä»¥è§£é‡Šä¸ºä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼šï¼ˆ1ï¼‰æ‰¾åˆ°è½¦è¾†å½“å‰è¡Œä½¿çš„é“è·¯â€”â€”ç¡®å®šå€™é€‰è·¯æ®µï¼ˆ2ï¼‰å°†å½“å‰GPSå®šä½ç‚¹æŠ•å½±åˆ°è½¦è¾†è¡Œä½¿çš„é“è·¯ä¸Šâ€”â€”å€™é€‰è·¯æ®µåŒ¹é…è§„åˆ™<ul><li>åœ†å¿ƒæ‹“å±•åŠå¾„æ‰¾åˆ°æœ€è¿‘çš„è·¯æ®µï¼ˆå”¯ä¸€ï¼‰â€”â€”æ„å»ºç¬¬ä¸€æ¡è¾¹çš„ç®—æ³•</li></ul></li></ul></li><li><p>[1]è‹æ´, å‘¨ä¸œæ–¹, å²³æ˜¥ç”Ÿ. GPSè½¦è¾†å¯¼èˆªä¸­çš„å®æ—¶åœ°å›¾åŒ¹é…ç®—æ³•[J]. æµ‹ç»˜å­¦æŠ¥, 2001, 30(3):5.</p><ul><li>å¦å¤–ï¼Œä¸ºäº†æé«˜ç®—æ³•çš„é²æ£’æ€§ï¼Œå¯¹äºè¯¯å·®å¼•èµ· çš„é€Ÿåº¦å¼‚å¸¸ï¼Œæˆ‘ä»¬åˆ©ç”¨æ¨æµ‹èˆªä½æ³•å’Œçº¿æ€§æ’å€¼æ¥ è¿›è¡Œ GPSæ•°æ®è¡¥å¿ï¼Œä»¥æ¶ˆé™¤éƒ¨åˆ†GPSæ¥æ”¶å¤–éƒ¨ ç²—å·®</li></ul></li><li><p>[1]ææ¸…æ³‰, é»„ç»ƒ. åŸºäºGPSè½¨è¿¹æ•°æ®çš„åœ°å›¾åŒ¹é…ç®—æ³•[J]. æµ‹ç»˜å­¦æŠ¥, 2010(2):6.</p><ul><li>é’ˆå¯¹ä¼ ç»Ÿå¯¼èˆªç³»ç»Ÿçš„åœ°å›¾åŒ¹é…æ–¹æ³•çš„ç ”ç©¶è¾ƒå¤šã€‚å…¶ä¸­ç‚¹åˆ°çº¿çš„åŒ¹é…ç”±äºç¼ºä¹å¯¹æ•´ä½“è½¨è¿¹è¶‹åŠ¿çš„è€ƒè™‘ï¼Œåœ¨å¤æ‚çš„é“è·¯ç½‘ç¯å¢ƒä¸‹çš„åŒ¹é…æ˜“å¯¼è‡´è¯¯åŒ¹é…ã€‚ä¹Ÿæœ‰æ–¹æ³•ä½¿ç”¨DRã€å·®åˆ†GPSç­‰è¾…åŠ©è®¾å¤‡ï¼Œé‡‡ç”¨æ»¤æ³¢ã€æ¨¡ç³Šé€»è¾‘ã€è¯æ®ç†è®ºç­‰æ–¹æ³•æé«˜åœ°å›¾åŒ¹é…çš„å‡†ç¡®ç‡ã€‚GPSæµ®åŠ¨è½¦è½¨è¿¹æ•°æ®æä¾›äº†æ•´ä½“æ›²çº¿çš„å˜åŒ–è¶‹åŠ¿ï¼Œå¯ä»¥é‡‡ç”¨å…¨å±€æ•´ä½“åŒ¹é…çš„æ€æƒ³ï¼Œä¿è¯è½¨è¿¹çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§14ï¼Ÿã€‚åŸºäºæ›²çº¿ç›¸ä¼¼åº¦çš„ç®—æ³•ä¸€èˆ¬ è¾ƒä¸ºå¤æ‚ï¼Œä½†åŒ¹é…ç²¾åº¦é«˜ï¼Œåˆ©äºè½¨è¿¹çš„ç›´æ¥æ¢å¤ï¼Œé€‚åˆè¿›è¡Œæ•°æ®çš„åå¤„ç†</li><li>ä¸æ•´ä¸ªè½¨è¿¹ç›¸å¯¹ åº”çš„è·¯å¾„å¿…ç„¶æ˜¯è¿é€š çš„è·¯æ®µé›† ï¼Œå¯ä»¥åŸºäºé“è·¯æ‹“æ‰‘ä¸è¿é€šæ€§è®¾è®¡åœ°å›¾åŒ¹é…ç®—æ³•</li><li>keyï¼šé™¤äº†é“è·¯çš„å‡ ä½•è¿é€šæ€§ï¼Œå®é™…è¡Œè½¦è¿˜ä¼šå—åˆ°äº¤é€šè§„åˆ™çš„é™åˆ¶ï¼Œæœ¬æ–‡åŸºäºé“è·¯ç½‘çš„è¡Œè½¦é™åˆ¶ä¿¡æ¯æå‡ºäº†ä¸€ç§GPSæµ®åŠ¨è½¦è½¨è¿¹æ•°æ®çš„å…¨å±€åœ°å›¾åŒ¹é…ç®—æ³•ï¼Œç»¼åˆè€ƒè™‘å¤‡é€‰è·¯æ®µçš„å‡ ä½•è¿é€šæ€§ä¸äº¤é€šç½‘ç»œæ¡ä»¶çº¦æŸæ„å»ºæ•´ä½“å¤‡é€‰è·¯å¾„ï¼Œç„¶åä½¿ç”¨<strong>æ”¹è¿›çš„æ‰«æçº¿æ³•</strong>åˆ¤æ–­å…¨å±€è½¨è¿¹æ›²çº¿ä¸å¤‡é€‰è·¯å¾„çš„ç›¸ä¼¼åº¦ï¼Œå®Œæˆåœ°å›¾åŒ¹é… ã€‚<ul><li>ä¸€å¥è¯æ¦‚æ‹¬ç®—æ³•ï¼šé€šè¿‡è¡Œè½¦é™åˆ¶å°†å€™é€‰çº¿æ®µæ‰¾å‡ºæ¥åï¼Œé€‰æ‹©æ›²çº¿ç›¸ä¼¼åº¦æœ€é«˜çš„</li></ul></li></ul></li><li><p>[1]é™ˆæ»¨, ç‹å¹³, æ–½æ–‡ç¶,ç­‰. GPSè½¨è¿¹æ•°æ®çš„ç»¼åˆåœ°å›¾åŒ¹é…ç®—æ³•ç ”ç©¶[J]. ç”µå­ç§‘æŠ€, 2014, 27(12):4.</p><ul><li>ä»å®é™…çš„åŒ¹é…æ•ˆæœæ¥çœ‹ï¼Œæ­¤åŒ¹é…ç®—æ³•åœ¨äº¤å‰è·¯å£ç­‰è·¯æ®µè¾ƒå¤æ‚çš„åœ°æ–¹å¯æœ‰è¾ƒé«˜åœ°åŒ¹é…å‡†ç¡®ç‡ï¼Œä½†è¯¥æ–¹æ³•ä¾èµ–äºå‰åGPSå®šä½ç‚¹åŒ¹é…å‡†ç¡®åº¦ï¼Œè‹¥å‰ä¸€å®šä½ç‚¹åŒ¹é…é”™è¯¯å°±ä¼šå‡ºç°è¿é”ååº”ï¼Œä»è€Œå¯¼è‡´åé¢ä¸€ç³»åˆ—ç‚¹åŒ¹é…é”™è¯¯ï¼›ä¸”å†å²è½¨è¿¹æ¨ç®—åŒ¹é…æ³•è®¡ç®—é‡è¾ƒå¤§ï¼ŒåŒ¹é…é€Ÿåº¦è¾ƒæ…¢ï¼Œä¸åˆ©äºé«˜é€Ÿå®æ—¶å®šä½ã€‚å› æ­¤ï¼Œéœ€å’Œå…¶ä»–åœ°å›¾åŒ¹é…æ–¹æ³•ç›¸ç»“åˆä½¿ç”¨æ‰èƒ½å–å¾—è¾ƒå¥½çš„åŒ¹é…æ•ˆæœã€‚</li></ul></li><li><p>æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­GPSåœ°å›¾åŒ¹é…ç®—æ³•è®¾è®¡ä¸å®ç°_ç½—æ°æ¶›</p><ul><li>æ¨¡ç³Šé€»è¾‘ï¼š æ•ˆç‡é«˜ï¼Œå®æ—¶æ€§å¥½ï¼Œå¯¹ç»å¤§å¤šæ•°çš„è·¯æ®µçŠ¶å†µéƒ½é€‚ç”¨ã€‚ä¸è¿‡åœ¨è½¦ä¿©æ‹å¼¯å¤„ä»¥åŠè½¦é€Ÿè¾ƒæ…¢çš„æƒ…å†µä¸‹åŒ¹é…æ•ˆæœä¸å°½å¦‚äººæ„ï¼Œä¸”ä¸åŒè·¯æ®µå»ºæ¨¡çš„ç³»æ•°å‡­é ç»éªŒå€¼ï¼Œæ²¡æœ‰ç›¸åº”çš„ç¼ºä¹ç†è®ºä¾æ®ã€‚â€”â€”01ã€06ã€08è®ºæ–‡</li></ul></li><li><p>é«˜çº§åœ°å›¾åŒ¹é…ç®—æ³•ï¼šç ”ç©¶ç°çŠ¶å’Œè¶‹åŠ¿[2021]</p><ul><li><p>ä»å®ç°æŠ€æœ¯æˆ–æ¨¡å‹è§’åº¦å¯¹è¿‘åå¹´æå‡ºçš„ç®—æ³•è¿›è¡Œåˆ†ç±»ï¼Œç®­å¤´æ ‡è®°ç®—æ³•é—´çš„ç»§æ‰¿å…³ç³»ã€‚ä»å›¾2å¯è§ï¼ŒHMMæ¨¡å‹æ˜¯ä¸»æµï¼Œå…¶æ¬¡æ˜¯åŸºäºæœ€å¤§æƒé‡çš„æ¨¡å‹.HMM-News-onã€ST-Matching2 3IVMM3å’ŒHRIS8è¢«å¼•ç”¨å¯¹æ¯”æœ€å¤šï¼Œæ˜¯å…·æœ‰å¼€åˆ›æ€§çš„å·¥ä½œã€‚å¦å¤–ï¼Œä»2019å¹´å¼€å§‹ï¼Œæœ‰ç ”ç©¶é‡‡ç”¨æ·±åº¦å­¦ä¹ æŠ€æœ¯æ¥è§£å†³åœ°å›¾åŒ¹é…é—®é¢˜ã€‚</p><p><img src="/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/E:%5Chexo%5Csource_posts%5C%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%5C09-20%E5%B9%B4%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B.jpg" alt="09-20å¹´åœ°å›¾åŒ¹é…ç®—æ³•å‘å±•å†ç¨‹"></p></li></ul></li></ul><h3 id="points"><a class="markdownIt-Anchor" href="#points"></a> Points:</h3><ul><li><p>å¦å¤–ï¼Œä¸€ä¸ªé‡è¦çš„å®é™…é—®é¢˜æ˜¯ï¼Œå³ä½¿è½¦è¾†å®šä½ç²¾åº¦å¯ä»¥ä¿è¯åœ¨10ç±³ä»¥å†…ï¼Œå½“ç”µå­åœ°å›¾ç¼©æ”¾åˆ°è¾ƒå¤§çš„æ¯”ä¾‹å°ºæ—¶ï¼Œä¹Ÿä¼š<br>å‡ºç°è½¦è¾†åç¦»è¡Œä½¿çš„é“è·¯è€Œé€ æˆçš„è§†è§‰æ··ä¹±ç°è±¡.</p></li><li><p>ç”±äºåŸåŒºå†…åœ°ç‰©ç‰¹å¾å¤æ‚ï¼Œå—å¯†é›†çš„é«˜å¤§å»ºç­‘ç‰©ã€éš§é“ã€ç«‹äº¤æ¡¥ã€æ ‘æœ¨ç­‰åœ°ç‰©çš„åå°„å’Œé®è”½ç­‰å½±å“ï¼Œè½¦æ ½GPSæ¥æ”¶æœºæ¥æ”¶åˆ°çš„å«æ˜Ÿä¿¡å·å­˜åœ¨ä¸¥é‡çš„å¤šå¾„æ•ˆåº”ï¼Œåœ¨æŸäº›åŒºåŸŸå†…ç”šè‡³ä¼šå½¢æˆGPSå®šä½è‚²åŒºï¼Œè§£å†³GPSç›²åŒºé—®é¢˜ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡ç”¨èˆªä½æ¨ç®—æ³•ï¼ˆDR-Dead Reckoningï¼‰ï¼Œè¿™ç§æ–¹æ³•éœ€è¦å°†DRè®¾å¤‡è£…åœ¨è½¦è¾†å‰ç«¯ï¼Œä¸€èˆ¬åœ¨GPSæ¥æ”¶æœºå«æ˜Ÿä¿¡å·å—é˜»æ—¶ä¸€æ ·å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç”¨æˆ·ä½ç½®ï¼Œä½†è¿™ç§æ–¹æ³•éœ€è¦é™„åŠ è®¾å¤‡ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨è®°å¿†æ­£ç¡®GPSä½ç½®ä¿¡æ¯çš„åŸºç¡€ä¸Šåœ¨ä¸€æ®µæ—¶é—´å†…é¢„æµ‹è½¦è¾†ä½ç½®ï¼Œè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æ˜“äºå®ç°ï¼Œç¼ºç‚¹æ˜¯ç²¾åº¦ä¸å¤Ÿï¼ˆæ²¡æœ‰ï¼Œä½œè€…ä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢è¿›è¡Œä½ç½®é¢„æµ‹ï¼Œé¢„æµ‹ç»“æœå¦‚å›¾æ‰€ç¤ºã€‚åœ¨è§„åˆ™è¡Œè¿›æ—¶ï¼Œé¢„æµ‹æ•ˆæœè¾ƒå¥½ï¼Œè§å›¾3ã€å›¾4.ä½†æ˜¯å½“è½¦è¾†è½¬å¼¯æ—¶ï¼Œæ•ˆæœå¾ˆå·®ï¼Œè§å›¾5ã€å›¾6</p></li><li><p>åˆ°æŠ˜çº¿çš„è·ç¦»å®šä¹‰ä¸ºç‚¹åˆ°æŠ˜çº¿ä¸Šæ‰€æœ‰ç›´çº¿æ®µçš„æœ€çŸ­è·ç¦»ï¼šç‚¹åˆ°çº¿æ®µçš„è·ç¦»å®šä¹‰ä¸ºå¦‚æœç‚¹åˆ°ç›´çº¿æ®µæ‰€åœ¨ç›´çº¿çš„æŠ•å½±åœ¨ç›´çº¿æ®µä¸Šï¼Œåˆ™ä¸ºå‚çº¿é•¿åº¦ï¼Œå¦åˆ™ä¸ºå…¶åˆ°ä¸¤ä¸ªç«¯ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚</p></li><li><p>å®šä½è¯¯å·®ï¼š GPSè¯¯å·®ã€ç”µå­åœ°å›¾åº“è¯¯å·®ã€åæ ‡æŠ•å½±å˜æ¢æŠ•å½±</p></li><li><p>éš¾ç‚¹ï¼š</p><ul><li><a href="http://qikan.cqvip.com/Qikan/Article/ReadIndex?id=33650279&amp;info=X19Wa%2bQedw8TOqUh1eM7U0SrEn1nIM08tSny4w0YhPo%3d" target="_blank" rel="noopener">Y-junctioné—®é¢˜</a>â€”â€”ç‚¹åˆ°çº¿çš„åŒ¹é…æ–¹å¼ï¼Œæ²¡æœ‰è€ƒè™‘å…¨å±€åŒ¹é…</li><li>å¹³è¡ŒåŒçº¿è·¯</li></ul></li><li><p>MapMatchingå®ç°çš„æ€è·¯</p><ul><li><strong>ç¦»æ•£ç‚¹é›†åŒ¹é…</strong>ï¼šç›¸å¯¹ç®€å•ï¼Œéšæœºç¦»æ•£ç‚¹æ²¡æœ‰å½¢çŠ¶å’Œæ‹“æ‰‘å…³ç³»ï¼Œç”¨æ¬§æ°è·ç¦»ä½œå¸é™„å³å¯ï¼Œå…¸å‹åº”ç”¨å¦‚ç¦»æ•£çƒ­åŠ›å›¾ã€‚</li><li><strong>æ›²çº¿æ‹Ÿåˆ</strong>ï¼š å®é™…ä¸­æ›´æœ‰åº”ç”¨ä»·å€¼çš„æ˜¯æ›²çº¿æ‹ŸåˆåŒ¹é…å…³ç³»ï¼Œæ¯”å¦‚è½¨è¿¹å’Œè·¯ç½‘ï¼ŒGPSåºåˆ—å’Œå¯¼èˆªè·¯çš„ç›¸ä¼¼æ€§ã€‚</li></ul></li><li><p>MapMatchingç®—æ³•çš„åˆ†ç±»ï¼š</p><p><strong>ä»¥ä½¿ç”¨åˆ°çš„ä¿¡æ¯æ¥åˆ’åˆ†</strong></p><p>ç°æœ‰çš„ç®—æ³•å¯è¢«åˆ†æˆå››ç±»ï¼šå‡ ä½•ã€æ‹“æ‰‘ã€æ¦‚ç‡ã€é«˜çº§ã€‚</p><p>aï¼‰åŸºäºå‡ ä½•çš„ç®—æ³•è€ƒè™‘GPSç‚¹ä¸é“è·¯çš„å‡ ä½•ä¿¡æ¯ï¼Œå¦‚è·ç¦»ã€è§’åº¦ç­‰ï¼›</p><p>bï¼‰åŸºäºæ‹“æ‰‘çš„ç®—æ³•ä½¿ç”¨é“è·¯æ‹“æ‰‘ä¿¡æ¯æ¥æ§åˆ¶ï¼›</p><p>cï¼‰æ¦‚ç‡æ–¹æ³•é€šè¿‡è€ƒè™‘GPSç‚¹çš„æ¦‚ç‡ï¼›</p><p>dï¼‰é«˜çº§çš„ç®—æ³•å¾€å¾€ç»¼åˆè€ƒè™‘ä½¿ç”¨å…¨é¢ä¿¡æ¯ï¼Œæœ‰å¡å°”æ›¼æ»¤æ³¢ã€æ¨¡ç³Šé€»è¾‘æ¨¡å‹ã€éšå¼é©¬å°”å¯å¤«æ¨¡å‹ç­‰ç­‰ã€‚</p><p><strong>2.2 ä»¥è€ƒè™‘é‡‡æ ·ç‚¹çš„èŒƒå›´æ¥åˆ’åˆ†</strong></p><p>æ ¹æ®è€ƒè™‘é‡‡æ ·ç‚¹çš„èŒƒå›´ï¼Œå¯åˆ†æˆå±€éƒ¨/å¢é‡ç®—æ³•ã€å…¨å±€ç®—æ³•ã€‚</p><p>aï¼‰å±€éƒ¨/å¢é‡ç®—æ³•æ˜¯è´ªå©ªç®—æ³•ï¼Œæ¯æ¬¡ç¡®å®šä¸€ä¸ªåŒ¹é…ç‚¹ï¼Œä¸‹ä¸ªç‚¹ä»å·²ç»ç¡®å®šçš„åŒ¹é…ç‚¹å¼€å§‹ã€‚è¿™äº›æ–¹æ³•æ ¹æ®è·ç¦»å’Œæ–¹å‘ç›¸ä¼¼æ€§æ¥æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹æˆ–è¾¹ã€‚ï¼ˆåœ¨çº¿åŒ¹é…ï¼‰</p><p>bï¼‰å…¨å±€ç®—æ³•æ˜¯è¦ä»è·¯ç½‘ä¸­æ‰¾åˆ°ä¸€æ¡ä¸é‡‡æ ·è½¨è¿¹æœ€æ¥è¿‘çš„åŒ¹é…è½¨è¿¹ã€‚ä¸ºäº†æµ‹é‡é‡‡æ ·è½¨è¿¹å’ŒåŒ¹é…è½¨è¿¹çš„ç›¸ä¼¼æ€§ï¼Œå¤§å¤šæ•°ç®—æ³•ä½¿ç”¨â€œFrechetè·ç¦»â€æˆ–è€…æ˜¯â€œå¼±Frechetè·ç¦»â€ã€‚è¿˜æœ‰æ—¶ç©ºåŒ¹é…ç®—æ³•ã€æŠ•ç¥¨ç®—æ³•ç­‰ã€‚ï¼ˆç¦»çº¿åŒ¹é…ï¼‰</p><p><strong>ä»¥é‡‡æ ·ç‚¹çš„é¢‘ç‡æ¥åˆ’åˆ†</strong></p><p>æ ¹æ®è½¨è¿¹æ•°æ®çš„é‡‡æ ·é¢‘ç‡ï¼Œç°æœ‰çš„åœ°å›¾åŒ¹é…ç®—æ³•å¯åˆ†æˆï¼š</p><p>aï¼‰é«˜é¢‘é‡‡æ ·ç®—æ³•ï¼ˆæ‰€æœ‰å±€éƒ¨ç®—æ³•ã€éƒ¨åˆ†å…¨å±€ç®—æ³•å¦‚Frechetè·ç¦»åˆ¤åˆ«æ³•ç­‰ï¼‰</p><p>bï¼‰ä½é¢‘é‡‡æ ·ç®—æ³•ï¼ˆST-matchingç®—æ³•ã€IVVMç®—æ³•ï¼‰</p><p>ä¸€èˆ¬è®¤ä¸º30såŠå…¶ä»¥ä¸Šä¸ºä½é¢‘é‡‡æ ·ï¼Œ1sï½10sä¸ºé«˜é¢‘é‡‡æ ·ã€‚</p><p><a href="https://www.cnblogs.com/LBSer/p/4612031.html#!comments" target="_blank" rel="noopener">https://www.cnblogs.com/LBSer/p/4612031.html#!comments</a></p></li><li><p>æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­GPSåœ°å›¾åŒ¹é…ç®—æ³•è®¾è®¡ä¸å®ç°</p><p><img src="/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/E:%5Chexo%5Csource_posts%5C%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%5C%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%E7%BB%84%E4%BB%B6.jpg" alt="åœ°å›¾åŒ¹é…ç»„ä»¶"></p></li></ul><h3 id="ç®—æ³•è¯„ä¼°çš„æ ‡å‡†"><a class="markdownIt-Anchor" href="#ç®—æ³•è¯„ä¼°çš„æ ‡å‡†"></a> ç®—æ³•è¯„ä¼°çš„æ ‡å‡†</h3><ul><li>å®æ—¶æ€§</li><li>å¯é æ€§(é²æ£’æ€§)</li><li>åŒ¹é…çš„ç²¾åº¦</li></ul><h2 id="æœ´ç´ ç®—æ³•"><a class="markdownIt-Anchor" href="#æœ´ç´ ç®—æ³•"></a> æœ´ç´ ç®—æ³•ï¼š</h2><p>å¿«é€ŸåŒ¹é…ç®—æ³•çš„æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ­¥1æ¥æ”¶GPSå®šä½æ•°æ®ï¼›</li><li>æ­¥2åˆ¤æ–­å®šä½æ•°æ®æ˜¯å¦æ— æ•ˆï¼Œè‹¥æ— æ•ˆï¼Œåˆ™æ ¹æ®å†å²å®šä½æ•°æ®è¿›è¡Œæ¨æµ‹åŒ¹é…ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›</li><li>æ­¥3åˆ¤æ–­è½¦è¾†å½“å‰æ˜¯å¦å¤„äºåœæ­¢æˆ–ä½é€Ÿæ»‘è¡ŒçŠ¶æ€ï¼Œè‹¥æ˜¯ï¼Œå¯¹å…¶ä½œç›¸åº”å¤„ç†ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›</li><li>æ­¥4ç”±è½¦è¾†å½“å‰ä½ç½®ç‚¹è®¡ç®—å…¶å¯¹åº”çš„å€™é€‰ç½‘æ ¼ï¼Œè¿›è€Œè·å–å…¶ä¸­çš„è·¯æ®µï¼›</li><li>æ­¥5å¯¹æ­¥4å¾—åˆ°çš„è·¯æ®µè¿›è¡Œ<strong>è¿æ¥æ€§æ‹“æ‰‘æ£€æŸ¥</strong>ï¼Œå°†é€šè¿‡æ‹“æ‰‘æ£€æŸ¥çš„è·¯æ®µä½œä¸ºåŒ¹é…å€™é€‰è·¯æ®µï¼›</li><li>æ­¥6åˆ¤æ–­åŒ¹é…å€™é€‰è·¯æ®µæ•°ç›®ï¼Œè‹¥å”¯ä¸€ï¼Œåˆ™ç›´æ¥å°†å…¶ä½œä¸ºåŒ¹é…è·¯æ®µï¼Œå¹¶ç”±å®šä½ç‚¹å‘å…¶ä½œæŠ•å½±ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›å¦åˆ™ï¼Œè®¡ç®—æ‰€æœ‰å€™é€‰è·¯æ®µçš„åŒ¹é…åº¦åº¦é‡å€¼fï¼Œï¼ˆi=1,2ï¼Œâ€¦ï¼ŒNï¼‰ï¼Œä»ä¸­é€‰å‡ºæœ€å¤§å€¼fmå’Œæ¬¡å¤§å€¼fmï¼›</li><li>æ­¥7åˆ¤æ–­æœ€å¤§å€¼fmå’Œæ¬¡å¤§å€¼fmä¹‹å·®æ˜¯å¦å¤§äºé˜ˆå€¼fhï¼Œä¸”æœ€å¤§å€¼fmæ˜¯å¦å¤§äºé˜ˆå€¼fhï¼Œå¦‚æœå¤§äºï¼Œåˆ™å°†è·¯æ®µmä½œä¸ºåŒ¹é…è·¯æ®µï¼Œå¹¶ç”±å®šä½ç‚¹å‘å…¶ä½œæŠ•å½±ï¼›å¦åˆ™ï¼Œæš‚ä¸å¯¹æœ¬æ¬¡å®šä½ç»“æœè¿›è¡ŒåŒ¹é…ï¼Œå¾…åé¢å¯¹å…¶è¿›è¡Œå»¶æ—¶åŒ¹é…å¤„ç†ï¼›</li><li>æ­¥8ç»“æŸæœ¬æ¬¡åŒ¹é…</li></ol><p>from : <a href="https://wenku.baidu.com/view/14551bfcfab069dc50220144.html?fr=xueshu_top" target="_blank" rel="noopener">ä¸€ç§é€‚äºè½¦è¾†å¯¼èˆªç³»ç»Ÿçš„å¿«é€Ÿåœ°å›¾åŒ¹é…ç®—æ³•</a>â€”â€”2003</p><h2 id="key"><a class="markdownIt-Anchor" href="#key"></a> Key:</h2><ul><li><p>å‡ºè¡Œæ•°æ®ï¼šé‡‡ç”¨GPSå®šä½ï¼Œé‚£ä¹ˆæ˜¯å¦æ˜¯WGS-84æ•°æ®ï¼Œä½†æ˜¯GISéƒ¨é—¨çš„è·¯ç½‘æ•°æ®åæ ‡æ˜¯ä»€ä¹ˆåæ ‡ç³»ä¸‹çš„</p></li><li><p>åŒçº¿è·¯ï¼š</p></li><li><p>å½“ä¸‹ï¼Œç°åœ¨å¾ˆå¤šç”¨äºMapMatchingçš„æ–¹æ³•ï¼Œå¤§å¤šæ¥è‡ªäºæ¨ç†ã€é¢„æµ‹çš„æ•°å­¦æ–¹æ³•ï¼Œå¦‚éšé©¬å°”å¯å¤«é“¾ã€è´å¶æ–¯æ¨¡å‹ã€ç¥ç»ç½‘ç»œæ¨¡å‹ç­‰ï¼Œä½†åœ¨æ•°æ®ç»“æ„ä¸Šçš„åˆ›æ–°æ¯”è¾ƒå°‘ï¼ŒGISç®—æ³•ï¼Œæ›´å¤šè¦åœ¨è®¡ç®—æœºçš„åŸºç¡€ä¸Šï¼Œç»“åˆæ¯”å¦‚æ—¶ç©ºè§‚å¿µã€æ•°æ®ç‰¹å¾ã€æ‹“æ‰‘å…³ç³»ç­‰å¯¹äºGISç›¸å…³çš„åŸºç¡€ç†è®º</p></li></ul><h2 id="è½¯ä»¶"><a class="markdownIt-Anchor" href="#è½¯ä»¶"></a> è½¯ä»¶</h2><ul><li>mapinfo: å½“ä»Šä¸–ç•Œä¸Šæµè¡Œçš„æ¡Œé¢åœ°ç†ä¿¡æ¯ç³»ç»Ÿ</li><li>graphhopper: è·¯å¾„è§„åˆ’åº“</li><li>arcgis</li><li>openstreetmapâ€”â€”å¼€æºåœ°å›¾ï¼Œç®€ç§°ä¸ºOSM</li></ul><p>çº¿è¦ç´ çš„åŒ¹é…ï¼Œä¸»è¦é€šè¿‡å‡ ä½•ã€æ‹“æ‰‘æˆ–è¯­ä¹‰ç›¸ä¼¼åº¦æ¥è¿›è¡Œè¯†åˆ«ï¼Œå…¶ä¸­é€šè¿‡ç©ºé—´è·ç¦»æ¥è¿›è¡Œè¦ç´ åŒ¹é…çš„å¸¸ç”¨æ–¹å¼æœ‰ï¼š</p><ul><li>é—µå¯å¤«æ–¯åŸºè·ç¦»(Minkowski Distance)</li><li>æ¬§æ°è·ç¦»(Euclidean Distance)</li><li>æ›¼å“ˆé¡¿è·ç¦»(Manhattan Distance)</li><li>åˆ‡æ¯”é›ªå¤«è·ç¦»(Chebyshev Distance)</li><li>æ±‰æ˜è·ç¦»(Hamming distance)</li><li>æ°å¡å¾·ç›¸ä¼¼ç³»æ•°(Jaccard similarity coefficient)</li><li>è±ªæ–¯å¤šå¤«è·ç¦»(Hausdorff Distance)</li><li>å¼—é›·æ­‡è·ç¦»(FrÃ©chetè·ç¦»)</li></ul><p>fromï¼š<a href="http://www.biaozhu.net/9224.html" target="_blank" rel="noopener">é«˜å¾·åœ°å›¾ï¼šåœ°å›¾æ•°æ®å¤„ç†ä¹‹é“è·¯åŒ¹é…ç¯‡</a></p><h1 id="éšé©¬å°”ç§‘å¤«hmm"><a class="markdownIt-Anchor" href="#éšé©¬å°”ç§‘å¤«hmm"></a> éšé©¬å°”ç§‘å¤«HMM</h1><p><strong>HMMæœ‰ä¸‰ä¸ªå…¸å‹(canonical)é—®é¢˜</strong>:</p><ul><li><strong>æ¦‚ç‡è®¡ç®—é—®é¢˜</strong>ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°ï¼Œè®¡ç®—æŸä¸€ç‰¹å®šè¾“å‡ºåºåˆ—çš„æ¦‚ç‡.é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Forward_algorithm" target="_blank" rel="noopener">Forward</a>ç®—æ³•**è§£å†³ï¼›</li><li><strong>é¢„æµ‹é—®é¢˜æˆ–è€…è§£ç ï¼ˆdecodingï¼‰é—®é¢˜</strong>ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°ï¼Œå¯»æ‰¾æœ€å¯èƒ½çš„èƒ½äº§ç”ŸæŸä¸€ç‰¹å®šè¾“å‡ºåºåˆ—çš„<strong>éšå«çŠ¶æ€</strong>çš„åºåˆ—ã€‚é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•**è§£å†³ï¼›</li><li><strong>å­¦ä¹ é—®é¢˜</strong>ï¼šå·²çŸ¥è¾“å‡ºåºåˆ—ï¼Œå¯»æ‰¾æœ€å¯èƒ½çš„çŠ¶æ€è½¬ç§»ä»¥åŠè¾“å‡ºæ¦‚ç‡ã€‚é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Baum-Welch_algorithm" target="_blank" rel="noopener">Baum-Welch</a>ç®—æ³•**ã€‚</li></ul><h2 id="hmmçš„å‡ ä¸ªé‡è¦å…ƒç´ "><a class="markdownIt-Anchor" href="#hmmçš„å‡ ä¸ªé‡è¦å…ƒç´ "></a> HMMçš„å‡ ä¸ªé‡è¦å…ƒç´ ï¼š</h2><ul><li><p>Ï€(startprob_): éšè—çŠ¶æ€åˆå§‹å‘é‡</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>Ï€</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>:</mo><msub><mi>Ï€</mi><mi>i</mi></msub><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo>=</mo><mi>i</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>i</mi><mo>â‰¤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\pi=\left(\pi_{i}\right): \pi_{i}=P\left(q_{1}=i\right), 1 \leq i \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p></li><li><p>A(transmat_):  çŠ¶æ€è½¬ç§»æ¦‚ç‡çŸ©é˜µ:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">]</mo></mrow><mrow><mi>N</mi><mo>Ã—</mo><mi>N</mi></mrow></msub><mtext>,Â å…¶ä¸­Â </mtext><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>j</mi><mo>âˆ£</mo><msub><mi>q</mi><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>â‰¤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">A=\left[a_{i j}\right]_{N \times N} \text {, å…¶ä¸­ } a_{i j}=P\left(q_{t+1}=j \mid q_{t}=i\right), 1 \leq i, j \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.144139em;vertical-align:-0.394139em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.14252299999999996em;"><span style="top:-2.364192em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394139em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">,Â </span><span class="mord cjk_fallback">å…¶ä¸­</span><span class="mord">Â </span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p></li><li><p>B(emissionprob_): è§‚æµ‹çŠ¶æ€æ¦‚ç‡çŸ©é˜µ</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mrow><mi>N</mi><mo>Ã—</mo><mi>M</mi></mrow></msub><mi mathvariant="normal">ï¼Œ</mi><mtext>Â å…¶ä¸­Â </mtext><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><msub><mi>o</mi><mi>k</mi></msub><mo>âˆ£</mo><msub><mi>q</mi><mi>t</mi></msub><mo>=</mo><mi>j</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>j</mi><mo>â‰¤</mo><mi>N</mi><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B=\left[b_{j}(k)\right]_{N \times M} ï¼Œ \text { å…¶ä¸­ } b_{j}(k)=P\left(o_{t}=o_{k} \mid q_{t}=j\right), 1 \leq j \leq N, 1 \leq k \leq M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.144139em;vertical-align:-0.394139em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.14252299999999996em;"><span style="top:-2.364192em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394139em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord text"><span class="mord">Â </span><span class="mord cjk_fallback">å…¶ä¸­</span><span class="mord">Â </span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></span></p></li><li><p>HMMçš„çŠ¶æ€å˜é‡æ•°ç›®ï¼šN</p></li><li><p>HMMçš„è§‚å¯Ÿå˜é‡æ•°ç›®ï¼šM</p></li></ul><p>å¦‚æœè§‚æµ‹åºåˆ—æ˜¯ä¸€ç»´çš„ï¼Œåˆ™è§‚æµ‹çŠ¶æ€çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯ä¸€ç»´çš„æ™®é€šé«˜æ–¯åˆ†å¸ƒã€‚å¦‚æœè§‚æµ‹åºåˆ—æ˜¯Nç»´çš„ï¼Œåˆ™éšè—çŠ¶æ€å¯¹åº”çš„è§‚æµ‹çŠ¶æ€çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯Nç»´é«˜æ–¯åˆ†å¸ƒã€‚é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å‚æ•°å¯ä»¥ç”¨Î¼Î¼è¡¨ç¤ºé«˜æ–¯åˆ†å¸ƒçš„æœŸæœ›å‘é‡ï¼ŒÎ£è¡¨ç¤ºé«˜æ–¯åˆ†å¸ƒçš„åæ–¹å·®çŸ©é˜µã€‚åœ¨GaussianHMMç±»ä¸­ï¼Œâ€œmeansâ€ç”¨æ¥è¡¨ç¤ºå„ä¸ªéšè—çŠ¶æ€å¯¹åº”çš„é«˜æ–¯åˆ†å¸ƒæœŸæœ›å‘é‡Î¼å½¢æˆçš„çŸ©é˜µï¼Œè€Œâ€œcovarsâ€ç”¨æ¥è¡¨ç¤ºå„ä¸ªéšè—çŠ¶æ€å¯¹åº”çš„é«˜æ–¯åˆ†å¸ƒåæ–¹å·®çŸ©é˜µÎ£å½¢æˆçš„ä¸‰ç»´å¼ é‡ã€‚</p><p>from :<a href="https://www.cnblogs.com/pinard/p/7001397.html" target="_blank" rel="noopener">ç”¨hmmlearnå­¦ä¹ éšé©¬å°”ç§‘å¤«æ¨¡å‹HMM</a></p><h2 id="mapmatchingä¸hmm"><a class="markdownIt-Anchor" href="#mapmatchingä¸hmm"></a> MapMatchingä¸Hmm</h2><ul><li>è§‚å¯Ÿå˜é‡ï¼šä»GPSè®¾å¤‡ä¸­å¾—åˆ°çš„ä½ç½®ä¿¡æ¯ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼‰</li><li>éšè—çŠ¶æ€ï¼šæ‹¥æœ‰GPSè®¾å¤‡çš„ç‰©ä½“ï¼ˆè½¦ï¼Œäººç­‰ï¼‰å®é™…æ‰€åœ¨çš„ä½ç½®è·¯æ®µã€‚</li><li>è§‚æµ‹æ¦‚ç‡ï¼šä¾‹å¦‚ï¼Œç°æµ‹çš„GPSç‚¹ç¦»æ—è¾¹è·¯æ®µä¸Šçš„ä½ç½®è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸå®ç‚¹åœ¨è¿™ä¸ªè·¯æ®µä¸Šçš„æ¦‚ç‡è¶Šå¤§çŠ¶æ€ã€‚</li><li>çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼šä¾‹å¦‚ï¼Œå‰åä¸¤ä¸ªçœŸå®çš„ä½ç½®ç‚¹çš„è·ç¦»è¶Šè¿‘ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»çš„æ¦‚ç‡è¶Šå¤§</li></ul><p>åœ¨ä¸‹é¢ç›¸å…³è®ºæ–‡å·¥ä½œä¸­ä¼šè¯´æ˜åœ¨è¿™å‡ ç¯‡è®ºæ–‡ä¸­å…¶å®åªç”¨åˆ°äº†é¢„æµ‹é—®é¢˜çš„<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•,ä¸‹é¢ä¹Ÿä¼šå¦å¼€ä¸€å°èŠ‚å…·ä½“æè¿°ä¸‹<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•ã€‚</p><p><strong>Map-Matchingçš„ä¸¤ä¸ªå˜é‡</strong>ï¼š</p><ul><li>ä»GPSè®¾å¤‡ä¸­å¾—åˆ°çš„ä½ç½®ä¿¡æ¯ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼‰ï¼šHMMä¸­è§‚å¯Ÿå˜é‡ï¼›</li><li>æ‹¥æœ‰GPSè®¾å¤‡çš„ç‰©ä½“ï¼ˆè½¦ï¼Œäººç­‰ï¼‰å®é™…æ‰€åœ¨çš„ä½ç½®ï¼šHMMä¸­çš„éšè—çŠ¶æ€å˜é‡ï¼Œå®é™…åœ°å›¾æ˜¯ä¸çŸ¥é“GPSè®¾å¤‡çš„å‡†ç¡®ä½ç½®çš„ã€‚</li></ul><p>è¿™æ ·å°±æŠŠMap-Matchingé—®é¢˜ä¸HMMç»“åˆèµ·æ¥äº†ã€‚ä¸‰ä¸ªé—®é¢˜åœ¨Map-Matchingä¸­æœ‰ç”¨çš„æ˜¯ä¸¤ä¸ªé—®é¢˜ï¼šï¼ˆ1ï¼‰é¢„æµ‹é—®é¢˜ï¼›ï¼ˆ2ï¼‰å­¦ä¹ é—®é¢˜ã€‚</p><p>åœ¨è®ºæ–‡ä¸­ï¼Œå®šä¹‰çš„è§„åˆ™è¦æ»¡è¶³äººçš„ç›´è§‚ä¸Šçš„æ„Ÿè§‰ï¼Œå³äººçš„å…ˆéªŒçŸ¥è¯†ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li>è§‚æµ‹æ¦‚ç‡ï¼šè§‚æµ‹çš„GPSç‚¹ç¦»æ—è¾¹è·¯æ®µä¸Šçš„ä½ç½®è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸå®ç‚¹åœ¨è¿™ä¸ªè·¯æ®µä¸Šçš„æ¦‚ç‡è¶Šå¤§ã€‚</li><li>çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼šè¿™é‡Œæœ‰ä¸¤ç§è§£å†³æ€è·¯ï¼šï¼ˆ1ï¼‰å‰åä¸¤ä¸ªçœŸå®çš„ä½ç½®ç‚¹çš„è·ç¦»è¶Šè¿‘ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»çš„æ¦‚ç‡è¶Šå¤§ï¼›æˆ–è€…ï¼ˆ2ï¼‰çœŸå®è·¯æ®µä¸Šçš„å‰åä¸¤ä¸ªç‚¹çš„è·ç¦»ä¸GPSè§‚æµ‹çš„å‰åä¸¤ä¸ªç‚¹çš„è·ç¦»è¶Šæ¥è¿‘ï¼ŒçŠ¶æ€è½¬ç§»æ¦‚ç‡è¶Šå¤§ã€‚</li></ul><p>from: <a href="https://www.cnblogs.com/mindpuzzle/p/3653043.html" target="_blank" rel="noopener">åŸºäºéšé©¬å°”ç§‘å¤«æ¨¡å‹(HMM)çš„åœ°å›¾åŒ¹é…(Map-Matching)ç®—æ³•</a></p><h3 id="barefoot"><a class="markdownIt-Anchor" href="#barefoot"></a> <a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">barefoot</a></h3><ul><li>è§‚æµ‹æ¦‚ç‡: æµ‹é‡ä½ç½®ä¸å…¶çœŸå®ä½ç½®ä¹‹é—´çš„è·ç¦»ï¼Œç”¨äºå¯¹æµ‹é‡è¯¯å·®è¿›è¡Œå»ºæ¨¡ï¼Œæµ‹é‡è¯¯å·®ç”¨å…·æœ‰ä¸€äº›æ ‡å‡†åå·®<em>Ïƒ</em>çš„é«˜æ–¯åˆ†å¸ƒæ¥æè¿°ï¼ˆé»˜è®¤ä¸º<em>Ïƒ = 5 ç±³</em>ï¼‰ã€‚</li><li>è½¬ç§»æ¦‚ç‡: ç”¨å„ä¸ªä½ç½®æµ‹é‡ä¹‹é—´çš„è·¯ç”±è·ç¦»å’Œè§†çº¿è·ç¦»çš„å·®å¼‚æ¥é‡åŒ–çš„ã€‚è½¬ç§»æ¦‚ç‡å‘ˆè´ŸæŒ‡æ•°åˆ†å¸ƒï¼Œé€Ÿç‡å‚æ•°<em>Î»</em>ï¼ˆé»˜è®¤ä¸º<em>Î» = 0.1</em>ï¼‰æ˜¯å‡å€¼çš„å€’æ•°</li></ul><p>==&gt;</p><ul><li><p><em><strong>åºåˆ—æ¦‚ç‡</strong></em>ï¼š å®šä¹‰<em>p(s 0 â€¦ s t |z 0 â€¦ z t )<em>ä¸ºæœ€å¯èƒ½çš„åºåˆ—åˆ°è¾¾åŒ¹é…å€™é€‰</em>s t</em>çš„æ¦‚ç‡ï¼Œç§°ä¸º s t çš„åºåˆ—æ¦‚ç‡ï¼Œ å¯ä»¥é€šè¿‡é€’å½’ç¡®å®š</p></li><li><p><em><strong>è¿‡æ»¤æ¦‚ç‡</strong></em>ï¼šæˆ‘ä»¬çš„ HMM æ»¤æ³¢å™¨ç¡®å®šå¯¹è±¡å½“å‰ä½ç½®çš„ä¼°è®¡å€¼<em>sÌ… t</em>ï¼Œå®ƒæ˜¯æœ€å¯èƒ½åŒ¹é…çš„å€™é€‰å¯¹è±¡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>âˆˆ</mo><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t âˆˆ S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç»™å®šæµ‹é‡å€¼<code>z0 ... zt</code>ï¼Œå…¶å®šä¹‰ä¸ºï¼š<code>sÌ…t = argmax(st âˆˆ St) p(st|z0 ... zt)</code>, <code>p(st|z0 ... zt)</code>ç§°ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„è¿‡æ»¤æ¦‚ç‡***ï¼Œå¯ä»¥é€’å½’ç¡®å®šï¼š</p><p><code>p(st|z0...zt) = p(st|zt) Â· Î£(st-1 âˆˆ St-1) p(st|st-1) Â· p(st-1|z0 ... zt-1)</code>ã€‚</p></li></ul><p>from: <a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers</a></p><h2 id="coding"><a class="markdownIt-Anchor" href="#coding"></a> Coding</h2><blockquote><p>åœ¨ä¹‹å‰çš„<a href="http://www.cnblogs.com/pinard/p/6945257.html" target="_blank" rel="noopener">HMMç³»åˆ—</a>ä¸­ï¼Œæˆ‘ä»¬å¯¹éšé©¬å°”ç§‘å¤«æ¨¡å‹HMMçš„åŸç†ä»¥åŠä¸‰ä¸ªé—®é¢˜çš„æ±‚è§£æ–¹æ³•åšäº†æ€»ç»“ã€‚æœ¬æ–‡æˆ‘ä»¬å°±ä»å®è·µçš„è§’åº¦ç”¨Pythonçš„<a href="https://hmmlearn.readthedocs.io/en/latest/api.html#hmmlearn-hmm" target="_blank" rel="noopener">hmmlearn</a>åº“æ¥å­¦ä¹ HMMçš„ä½¿ç”¨ã€‚sklearnåº“ä¸­å°†HMMå¼ƒç”¨äº†ï¼Œæ–°å¼€äº†ä¸€ä¸ª<code>hmmlearn</code>çš„æ–°åº“ï¼Œå®‰è£…å‘½ä»¤ä¸ºï¼š<code>pip install hmmlearn</code>ï¼Œå…³äºhmmlearnçš„æ›´å¤šèµ„æ–™åœ¨<a href="http://hmmlearn.readthedocs.io/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>æœ‰ä»‹ç»ã€‚</p></blockquote><p>hmmlearnå®ç°äº†ä¸‰ç§HMMæ¨¡å‹ç±»ï¼ŒæŒ‰ç…§è§‚æµ‹çŠ¶æ€æ˜¯è¿ç»­çŠ¶æ€è¿˜æ˜¯ç¦»æ•£çŠ¶æ€ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ã€‚</p><ol><li>GaussianHMM è§‚æµ‹çŠ¶æ€è¿ç»­å‹ä¸”ç¬¦åˆé«˜æ–¯åˆ†å¸ƒ</li><li>GMMHMM è§‚æµ‹çŠ¶æ€è¿ç»­å‹ä¸”ç¬¦åˆæ··åˆé«˜æ–¯åˆ†å¸ƒ</li><li>MultinomialHMM è§‚æµ‹çŠ¶æ€ç¦»æ•£å‹</li></ol><p><strong>HMMä¸»è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜</strong><br>å‡è®¾éšè—çŠ¶æ€åºåˆ—å’Œè§‚æµ‹çŠ¶æ€åºåˆ—åˆ†åˆ«ä½¿ç”¨Zå’ŒXè¡¨ç¤ºï¼Œåˆ™è§£å†³çš„3ä¸ªé—®é¢˜å¯è¡¨ç¤ºä¸º:<br>1.è§£ç é—®é¢˜ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡æœ€å¯èƒ½çš„Zï¼›ç»´ç‰¹æ¯”ç®—æ³•<br>2.æ¦‚ç‡é—®é¢˜ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡Xå‡ºç°çš„æ¦‚ç‡ï¼›å‘å‰-å‘åç®—æ³•<br>3.å­¦ä¹ é—®é¢˜ï¼šä»…ç»™å‡ºXå’Œéšè—å±‚ä¸ªæ•°ï¼Œä¼°è®¡æ¨¡å‹å‚æ•°ã€‚ B-Wç®—æ³•ï¼Œé€šå¸¸æ˜¯ç»è¿‡ä¸€å®šæ•°é‡çš„è®­ç»ƒä»¥åï¼Œå¾—åˆ°æ¨¡å‹ï¼Œç„¶åè§£å†³é—®é¢˜1å’Œ2ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Created on 2017-12-4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è§£ç é—®é¢˜ï¼šæœ¬ä¾‹ä¸ºå¤©æ°”å’Œè¡Œä¸ºçš„å…³ç³»</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># hmmlearnå¯ä»¥åœ¨å®‰è£…numpyä»¥åï¼Œå†ä½¿ç”¨pip install hmmlearnå®‰è£…</span></span><br><span class="line"><span class="keyword">from</span> hmmlearn <span class="keyword">import</span> hmm</span><br><span class="line"></span><br><span class="line">states = [<span class="string">"Rainy"</span>, <span class="string">"Sunny"</span>]<span class="comment">##éšè—çŠ¶æ€</span></span><br><span class="line">n_states = len(states)<span class="comment">##éšè—çŠ¶æ€é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">observations = [<span class="string">"walk"</span>, <span class="string">"shop"</span>, <span class="string">"clean"</span>]<span class="comment">##å¯è§‚å¯Ÿçš„çŠ¶æ€</span></span><br><span class="line">n_observations = len(observations)<span class="comment">##å¯è§‚å¯Ÿåºåˆ—çš„é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">start_probability = np.array([<span class="number">0.6</span>, <span class="number">0.4</span>])<span class="comment">##å¼€å§‹è½¬ç§»æ¦‚ç‡ï¼Œå³å¼€å§‹æ˜¯Rainyå’ŒSunnyçš„æ¦‚ç‡</span></span><br><span class="line"><span class="comment">##éšè—é—´å¤©æ°”è½¬ç§»æ··æ·†çŸ©é˜µï¼Œå³Rainyå’ŒSunnyä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼Œä¾‹å¦‚[0,0]è¡¨ç¤ºä»Šå¤©Rainyï¼Œæ˜å¤©Rainyçš„æ¦‚ç‡</span></span><br><span class="line">transition_probability = np.array([</span><br><span class="line">  [<span class="number">0.7</span>, <span class="number">0.3</span>],</span><br><span class="line">  [<span class="number">0.4</span>, <span class="number">0.6</span>]</span><br><span class="line">])</span><br><span class="line"><span class="comment">##éšè—çŠ¶æ€å¤©æ°”å’Œå¯è§†è¡Œä¸ºæ··æ·†çŸ©é˜µï¼Œä¾‹å¦‚[0,0]è¡¨ç¤ºä»Šå¤©Rainyï¼Œwalkè¡Œä¸ºçš„æ¦‚ç‡ä¸º0.1</span></span><br><span class="line">emission_probability = np.array([</span><br><span class="line">  [<span class="number">0.1</span>, <span class="number">0.4</span>, <span class="number">0.5</span>],</span><br><span class="line">  [<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.1</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ„å»ºäº†ä¸€ä¸ªMultinomialHMMæ¨¡å‹ï¼Œè¿™æ¨¡å‹åŒ…æ‹¬å¼€å§‹çš„è½¬ç§»æ¦‚ç‡ï¼Œéšè—é—´å¤©æ°”è½¬æ¢æ··æ·†çŸ©é˜µï¼ˆtransmatï¼‰ï¼Œéšè—çŠ¶æ€å¤©æ°”å’Œå¯è§†è¡Œä¸ºæ··æ·†çŸ©é˜µemissionprobï¼Œå¯¹æ¨¡å‹å‚æ•°åˆå§‹åŒ–</span></span><br><span class="line">model = hmm.MultinomialHMM(n_components=n_states)</span><br><span class="line">model.startprob_= start_probability</span><br><span class="line">model.transmat_ = transition_probability</span><br><span class="line">model.emissionprob_ = emission_probability</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç»™å‡ºä¸€ä¸ªå¯è§åºåˆ—</span></span><br><span class="line">bob_Actions = np.array([[<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]]).T</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³é—®é¢˜1,è§£ç é—®é¢˜,å·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡æœ€å¯èƒ½çš„Zï¼› ç»´ç‰¹æ¯”ç®—æ³• </span></span><br><span class="line">logprob, weathers = model.decode(bob_Actions, algorithm=<span class="string">"viterbi"</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Bob Actions:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: observations[x], bob_Actions))</span><br><span class="line"><span class="keyword">print</span> <span class="string">"weathers:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: states[x], weathers))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è§£ç é—®é¢˜ï¼š ç›’å­</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> hmmlearn <span class="keyword">import</span> hmm</span><br><span class="line"></span><br><span class="line">states = [<span class="string">"box 1"</span>, <span class="string">"box 2"</span>, <span class="string">"box3"</span>]</span><br><span class="line">n_states = len(states)</span><br><span class="line"></span><br><span class="line">observations = [<span class="string">"red"</span>, <span class="string">"white"</span>]</span><br><span class="line">n_observations = len(observations)</span><br><span class="line"></span><br><span class="line">start_probability = np.array([<span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.4</span>])</span><br><span class="line"></span><br><span class="line">transition_probability = np.array([</span><br><span class="line">  [<span class="number">0.5</span>, <span class="number">0.2</span>, <span class="number">0.3</span>],</span><br><span class="line">  [<span class="number">0.3</span>, <span class="number">0.5</span>, <span class="number">0.2</span>],</span><br><span class="line">  [<span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.5</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">emission_probability = np.array([</span><br><span class="line">  [<span class="number">0.5</span>, <span class="number">0.5</span>],</span><br><span class="line">  [<span class="number">0.4</span>, <span class="number">0.6</span>],</span><br><span class="line">  [<span class="number">0.7</span>, <span class="number">0.3</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model = hmm.MultinomialHMM(n_components=n_states)</span><br><span class="line">model.startprob_=start_probability</span><br><span class="line">model.transmat_=transition_probability</span><br><span class="line">model.emissionprob_=emission_probability</span><br><span class="line"></span><br><span class="line">seen = np.array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>]]).T</span><br><span class="line">logprob, box = model.decode(seen, algorithm=<span class="string">"viterbi"</span>)</span><br><span class="line">print(<span class="string">"The ball picked:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: observations[x], seen)))</span><br><span class="line">print(<span class="string">"The hidden box"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: states[x], box)))</span><br><span class="line">(<span class="string">'The ball picked:'</span>, <span class="string">'red, white, red'</span>)</span><br><span class="line">(<span class="string">'The hidden box'</span>, <span class="string">'box3, box3, box3'</span>)</span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶"><a class="markdownIt-Anchor" href="#é™åˆ¶"></a> é™åˆ¶</h2><ul><li>å¯¹äºä¸åŒçš„å»ºæ¨¡é€‰æ‹©å’Œè¾“å…¥æ•°æ®è€Œè¨€ï¼Œå®ƒç›¸å¯¹ä¸çµæ´»</li><li>å®ƒç¼©æ”¾ä¸¥é‡(O(NÂ²)ï¼Œå…¶ä¸­Næ˜¯æ¯ä¸ªçŠ¶æ€ä¸‹å¯èƒ½çš„å€™é€‰æ•°)</li><li>å®ƒä¸èƒ½å¾ˆå¥½åœ°åº”å¯¹é«˜é¢‘è§‚æµ‹(è¯·å‚é˜…Newsonï¼†Krumm [2])ã€‚</li></ul><p>åŸºäº(æ— å‘³)å¡å°”æ›¼æ»¤æ³¢å™¨çš„æ–°æ¨¡å‹â€”â€”<a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">https://blog.csdn.net/weixin_26713521/article/details/108134220</a></p><h1 id="help-code"><a class="markdownIt-Anchor" href="#help-code"></a> help Code:</h1><ul><li><a href="https://github.com/bmwcarit/barefoot" target="_blank" rel="noopener">https://github.com/bmwcarit/barefoot</a></li><li><a href="https://github.com/oldrev/mapmatchingkit" target="_blank" rel="noopener">https://github.com/oldrev/mapmatchingkit</a></li></ul><h1 id="ç½‘ç»œæ–‡ç« "><a class="markdownIt-Anchor" href="#ç½‘ç»œæ–‡ç« "></a> ç½‘ç»œæ–‡ç« </h1><ul><li><a href="https://blog.csdn.net/weixin_42599077/article/details/114801735" target="_blank" rel="noopener">åœ°å›¾åŒ¹é…å®ä¾‹-å‡ ä½•åŒ¹é…</a>â€”â€”æ•ˆæœå›¾</li><li><a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">å®šä½åŒ¹é… æ¨¡æ¿åŒ¹é… åœ°å›¾_ä»€ä¹ˆæ˜¯åœ°å›¾åŒ¹é…ï¼Ÿ</a></li><li><a href="https://blog.csdn.net/Feng512275/article/details/96199675?spm=1001.2014.3001.5502" target="_blank" rel="noopener">å‡ºç§Ÿè½¦è½¨è¿¹ç‚¹åœ°å›¾åŒ¹é…ç ”ç©¶</a></li><li><a href="https://blog.csdn.net/yixianfeng41/article/details/73010792" target="_blank" rel="noopener">åœ°å›¾åŒ¹é…å°ç»“</a></li><li><a href="https://www.cnblogs.com/mindpuzzle/p/3653043.html" target="_blank" rel="noopener">åŸºäºéšé©¬å°”ç§‘å¤«æ¨¡å‹(HMM)çš„åœ°å›¾åŒ¹é…(Map-Matching)ç®—æ³•</a></li></ul><h1 id="å·¥ä½œå®‰æ’"><a class="markdownIt-Anchor" href="#å·¥ä½œå®‰æ’"></a> å·¥ä½œå®‰æ’</h1><p>ä½ çš„å·¥ä½œä¸»è¦å®Œæˆä»€ä¹ˆï¼ˆæ¦‚æ‹¬è¯´æ˜å°±è¡Œï¼‰ï¼Œåˆ†ä¸ºé‚£å‡ æ­¥ï¼Œæ¯ä¸€æ­¥å®Œæˆä»€ä¹ˆï¼ˆæ¦‚æ‹¬è¯´æ˜å°±è¡Œï¼‰ï¼Œæ¯ä¸€æ­¥çš„å·¥ä½œé‡ï¼ˆé¢„è®¡å®Œæˆè¿™æ­¥å·¥ä½œéœ€è¦å¤šå°‘ä¸ªå°æ—¶ï¼‰ï¼Œæ¯ä¸€æ­¥å·¥ä½œé¢„è®¡åœ¨ä»€ä¹ˆæ—¶å€™å®Œæˆï¼ˆæ¯”å¦‚ 3.5ï¼‰</p><ul><li>å·¥ä½œåŒ…å«ï¼šåœ°å›¾åŒ¹é…ï¼Œå°†è½¦è¾†çš„æœ‰åºGPSä½ç½®æ•°æ®å…³è”åˆ°ç”µå­åœ°å›¾çš„è·¯ç½‘ä¸Šï¼Œå°†GPSåæ ‡ä¸‹é‡‡æ ·åºåˆ—è½¬æ¢ä¸ºæ•°å­—è·¯ç½‘è·¯å¾„åºåˆ—çš„è¿‡ç¨‹ã€‚å·¥ä½œå†…å®¹ï¼šè§£æè¿‡æ»¤ç‚¹å¹¶è¿›è¡Œåæ ‡è½¬æ¢-&gt;ç‚¹è¿‡æ»¤(ç‚¹ç¨€ç–)-&gt;åœ°å›¾åŒ¹é…ç®—æ³•-&gt;ç‚¹æ˜ å°„</li></ul><table><thead><tr><th>å†…å®¹</th><th>é¢„ä¼°æ—¶é—´</th></tr></thead><tbody><tr><td>æŸ¥é˜…åœ°å›¾åŒ¹é…ç®—æ³•ç›¸å…³çš„è®ºæ–‡-&gt;æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ(16å°æ—¶)</td><td>2022å¹´2æœˆ28æ—¥</td></tr><tr><td>å­¦ä¹ éšé©¬å°”ç§‘å¤«æ¨¡å‹ç›¸å…³ç†è®ºçŸ¥è¯† (6å°æ—¶)</td><td>2022å¹´3æœˆ2æ—¥</td></tr><tr><td>æ‰¾å¯»éšé©¬å°”ç§‘å¤«æ¨¡å‹èµ„æ–™ã€ä»£ç (8å°æ—¶)â€”â€”barefootã€graphhopper</td><td>2022å¹´3æœˆ4æ—¥</td></tr><tr><td>ç†Ÿæ‚‰é¡¹ç›®ä¸­æœ‰å…³åœ°å›¾å¯¹è±¡çš„ä»£ç ï¼ˆ4å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ5æ—¥</td></tr><tr><td>ç§»æ¤éšé©¬å°”ç§‘å¤«æ¨¡å‹åˆ°é¡¹ç›®ä¸­ï¼Œç›®å‰å‚è€ƒï¼šå¼€æº<a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">barefoot</a>å®ç°ï¼šç†Ÿæ‚‰ä»£ç (16å°æ—¶)ã€åæ ‡è½¬æ¢ï¼ˆ3å°æ—¶ï¼‰ã€è¾“å…¥è¾“å‡ºæ•°æ®æ ¼å¼æ”¹é€ (10å°æ—¶)ã€é€‚é…ç±»(56å°æ—¶)ã€æ•ˆæœæ£€éªŒï¼ˆ10å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ20æ—¥</td></tr><tr><td>ç‚¹è¿‡æ»¤ï¼ˆ24å°æ—¶ï¼‰: æ …æ ¼åŒ–ï¼ˆ16å°æ—¶ï¼‰ + åŒé˜Ÿåˆ—ï¼ˆ8å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ24æ—¥</td></tr><tr><td>ç‚¹æ˜ å°„ï¼ˆ6å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ25æ—¥</td></tr></tbody></table><h1 id="åº“"><a class="markdownIt-Anchor" href="#åº“"></a> åº“ï¼š</h1><ul><li><a href="https://developers.arcgis.com/javascript/latest/api-reference/esri-geometry-geometryEngine.html" target="_blank" rel="noopener">geometryEngine</a></li><li>net.sf.geographiclib</li><li>com.esri.core.geometryâ€”â€”QuadTree</li><li>graphhopperâ€”â€”org.locationtech.jts.geom  ==&gt; Envelope --&gt; findCandidateSnapsInBBox</li></ul><hr><h1 id="ç®€å•ç‰ˆå®ç°æ€è·¯"><a class="markdownIt-Anchor" href="#ç®€å•ç‰ˆå®ç°æ€è·¯"></a> ç®€å•ç‰ˆå®ç°æ€è·¯</h1><ol><li>æ‰¾åˆ°èµ·å§‹ç‚¹Oå’Œç»ˆç‚¹Dï¼Œä»¥ä¸¤ç‚¹ä¸ºåŠå¾„ç”»åœ†ï¼ŒæŠŠæ‰€æœ‰èŒƒå›´å†…çš„NormalEdgeå…¨éƒ¨åŠ å…¥Listï¼ˆåªè¦èµ·å§‹ç‚¹orç»ˆæ­¢ç‚¹æœ‰ä¸€ä¸ªåœ¨èŒƒå›´å†…ï¼‰</li><li>ç¡®å®šç¬¬ä¸€æ¡===&gt; æ‰¾ç¦»ç¬¬ä¸€ä¸ªGPSç‚¹æœ€è¿‘çš„è¾¹</li><li>likelyRoute.forEachä»ä¸Šä¸€æ¡çš„lowerNormalEdgeä¸­(ä¿è¯æ‹“æ‰‘å¯è¾¾è¿æ¥)ï¼Œä»ä¸­é€‰æ‹©å¾—åˆ†æœ€é«˜ï¼ˆè·ç¦»å’Œæ–¹å‘ï¼‰çš„è¾¹ä½œä¸ºåç»­è¾¹ ã€‚  å¦‚æœæ²¡æœ‰lowerNormalEdgeï¼ˆå¦‚æœæ‰€æœ‰å‰©ä½™çš„ç‚¹éƒ½èƒ½æ˜ å°„åˆ°æœ€åçš„è¿™æ¡è¾¹ä¸Šï¼Œåˆ™è®¤ä¸ºæ˜¯ç»ˆç‚¹ï¼Œæ­¤æ—¶ä¸åœ¨æ„æ­»è·¯ï¼‰ï¼Œ å¹³å¸¸å¦‚æœæ˜¯æ­»è·¯ï¼Œåˆ™æ”¾å¼ƒè¿™æ¡åºåˆ—è·¯å¾„ã€‚TODOï¼šæ²¡æœ‰åç»­è·¯å¾„æ—¶æ˜¯å¦è¦è€ƒè™‘å¢åŠ å¯èƒ½è¾¹é›†ï¼Ÿ</li><li>åˆ°è¾¾ç»ˆç‚¹è¾¹ç»“æŸ</li><li>ä»likelyRouteä¸­é€‰æ‹©å¾—åˆ†æœ€é«˜çš„è·¯å¾„</li></ol><p>ç”¨åˆ°çš„ç»“æ„ï¼š</p><ul><li><code>likelyRoute: list[list]</code>, å­˜æ”¾å¤šæ¡å¯èƒ½</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åœ°å›¾åŒ¹é…&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#åœ°å›¾åŒ¹é…&quot;&gt;&lt;/a&gt; åœ°å›¾åŒ¹é…&lt;/h1&gt;
&lt;p&gt;æ¦‚å¿µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åœ°å›¾åŒ¹é…ï¼ˆMap-Matchingï¼‰æ˜¯å°†è¿è¥è½¦è¾†çš„æœ‰åºçš„GPSä½ç½®å…³è”åˆ°
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç§æœ‰Gitlabé…ç½®SSHè¿æ¥</title>
    <link href="https://nymrli.top/2022/02/25/%E7%A7%81%E6%9C%89Gitlab%E9%85%8D%E7%BD%AESSH%E8%BF%9E%E6%8E%A5/"/>
    <id>https://nymrli.top/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/</id>
    <published>2022-02-25T05:38:19.000Z</published>
    <updated>2022-02-25T06:04:05.992Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>SSHè¿æ¥å¹¶ä¸æ˜¯åƒ<a href="https://so.csdn.net/so/search?q=http&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">http</a>è¿æ¥ä¸€æ ·ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥äº†ã€‚SSHè¿æ¥éœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®</p></blockquote><h1 id="ç”Ÿæˆsshç§˜é’¥å’Œå…¬é’¥"><a class="markdownIt-Anchor" href="#ç”Ÿæˆsshç§˜é’¥å’Œå…¬é’¥"></a> ç”ŸæˆSSHç§˜é’¥å’Œå…¬é’¥</h1><h2 id="æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±"></a> æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±</h2><p>é¦–å…ˆè¦ç¡®å®šä½¿ç”¨çš„é‚®ç®±ï¼Œæ˜¯ä¸æ˜¯è‡ªå·±è®¤ä¸ºçš„é‚®ç®±ï¼Œæ¯”å¦‚æˆ‘ä»¥ä¸ºæ˜¯<code>chenli@sucsoft.com</code>ç»“æœï¼Œå´å‘ç°æ˜¯<code>399-chenli@sucsoft.com</code>ï¼Œé‚£ä¹ˆæŒ‰ç…§è‡ªè®¤ä¸ºçš„é‚®ç®±ç”³è¯·çš„keysé‚£è‡ªç„¶ä¸ä¼šworkã€‚â€”â€”ä¸€èˆ¬æƒ…å†µä¸ä¼šæœ‰æ­§ä¹‰é‚®ç®±å‡ºç°ï¼Œä½†æˆ‘è¿™è¾¹ç¡®å®è·Ÿæƒ³çš„ä¸å¤ªä¸€æ ·</p><h3 id="æŸ¥è¯¢æ–¹æ³•ä¸€æ–°å»ºé¡¹ç›®"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ–¹æ³•ä¸€æ–°å»ºé¡¹ç›®"></a> æŸ¥è¯¢æ–¹æ³•(ä¸€)â€”â€”æ–°å»ºé¡¹ç›®</h3><p>åˆ›å»ºç©ºçš„ä»“åº“ï¼Œæç¤ºä¸­æåŠçš„é‚®ç®±å°±æ˜¯æœ‰æ•ˆé‚®ç®±</p><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/gitlab-ssh.jpg" alt="gitlab-ssh"></p><h3 id="æŸ¥è¯¢æ–¹æ³•äºŒä¸ªäººpreference"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ–¹æ³•äºŒä¸ªäººpreference"></a> æŸ¥è¯¢æ–¹æ³•(äºŒ)â€”â€”ä¸ªäººPreference</h3><ol><li>æ‰“å¼€<code>User Settings-&gt;Profile</code>ï¼Œå…¶ä¸­æœ‰<code>Email</code>ã€<code>public email</code>å’Œ<code>commit email</code>ä¸‰ä¸ªé‚®ç®±ï¼Œå…¶ä¸­è·Ÿæˆ‘ä»¬å¼€å‘å‘½ä»¤æ¯”è¾ƒæœ‰å…³çš„å°±æ˜¯è¿™ä¸ªCommit Emailï¼Œä¹‹å‰æˆ‘çš„é»˜è®¤æ˜¯<code>399-chenli@sucsoft.com</code>ï¼Œè¿™è¾¹è¦è®¾ç½®è‡ªå·±æƒ³è¦çš„ï¼Œæ¯”å¦‚<code>chenli@sucsoft.com</code></li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/email_settings.jpg" alt="email_settings"></p><p>â–²é€‰æ‹©å®Œæˆåï¼Œæ»‘åˆ°æœ€ä¸‹é¢é€‰æ‹©Update profile settings</p><ol start="2"><li>æ‰“å¼€<code>User Settings-&gt;Emails</code>å¯ä»¥çœ‹åˆ°ï¼Œ<code>chenli@sucsoft@sucsoft.com</code>çš„æ ‡ç­¾ä¸­æœ‰commit emailï¼Œå³è®¾ç½®æˆåŠŸ</li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/preference_email.jpg" alt="preference_email"></p><h2 id="gitlabè®¾ç½®å…¬é’¥"><a class="markdownIt-Anchor" href="#gitlabè®¾ç½®å…¬é’¥"></a> Gitlabè®¾ç½®å…¬é’¥</h2><p>ç¡®ä¿é‚®ç®±æ˜¯æœ‰æ•ˆçš„åå°±å¯ä»¥ç”Ÿæˆç§˜é’¥äº†ã€‚</p><ol><li>è®¾ç½®gitä¿¡æ¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. è®¾ç½®gitä¿¡æ¯</span></span><br><span class="line">git config --global user.name <span class="string">"chenli"</span></span><br><span class="line">git config --global user.email <span class="string">"chenli@sucsoft.com"</span></span><br><span class="line"><span class="comment"># 2. ç”Ÿæˆç§˜é’¥å’Œå…¬é’¥</span></span><br><span class="line">$ ssh-keygen -t rsa -C chenli@sucsoft.com</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/c/Users/mrli/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /c/Users/mrli/.ssh/id_rsa</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /c/Users/mrli/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:zKPeKkm0bNzDqZcHUEDcvvDqPG2znRqDrD30yoBb8MM chenli@sucsoft.com</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 3072]----+</span></span><br><span class="line"><span class="string">|   ooo           |</span></span><br><span class="line"><span class="string">|    . o          |</span></span><br><span class="line"><span class="string">|     o           |</span></span><br><span class="line"><span class="string">|    + .o         |</span></span><br><span class="line"><span class="string">|.  + B oS        |</span></span><br><span class="line"><span class="string">| = .B.O. .       |</span></span><br><span class="line"><span class="string">|. E+o*++         |</span></span><br><span class="line"><span class="string">| o BB.B=..       |</span></span><br><span class="line"><span class="string">|. ..*B=*+        |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®å‘½ä»¤è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„ç»“æœåœ¨<code>C:\Users\mrli\.ssh</code>è·¯å¾„ä¸‹ï¼Œæœ‰<code>id_rsa</code>ã€<code>id_rsa.pub</code>ï¼Œå…¶ä¸­<code>id_rsa.pub</code>ä¸ºå…¬é’¥ã€‚</p><ol start="2"><li><p>å°†SSHå…¬é’¥æ·»åŠ åˆ°GitHubè´¦æˆ·</p><ol><li>å¤åˆ¶æ–‡ä»¶è·¯å¾„å†….pubåç¼€é‡Œçš„å†…å®¹</li><li>è¿›å…¥SSH Keysçš„è®¾ç½®é¡µé¢ï¼ˆç™»å½•GitHubï¼Œåœ¨å³ä¸Šè§’å¤´åƒç‚¹å‡»è®¾ç½®ï¼‰</li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/add_ssh.jpg" alt="add_ssh"></p><ol start="3"><li>ç²˜è´´åï¼ŒTitleä¼šè‡ªåŠ¨æå–ç”Ÿæˆï¼Œç‚¹å‡»<code>Add key</code>åˆ™å®Œæˆæ·»åŠ </li></ol></li></ol><h2 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@gitlab.sucsoft.com</span><br><span class="line">Welcome to GitLab, @chenli!</span><br></pre></td></tr></table></figure><h1 id="more"><a class="markdownIt-Anchor" href="#more"></a> More</h1><h2 id="é…ç½®å¤šä¸ªgitä¿¡æ¯"><a class="markdownIt-Anchor" href="#é…ç½®å¤šä¸ªgitä¿¡æ¯"></a> é…ç½®å¤šä¸ªGitä¿¡æ¯</h2><ol><li>å°†é»˜è®¤çš„<code>id_rsa</code>å’Œ<code>id_rsa.pub</code>æ”¹æˆæŒ‡å®šçš„å¦‚<code>id_rsa_sucsoft.pub</code></li><li><code>.ssh/</code>è·¯å¾„ä¸‹æ·»åŠ <code>config</code>é…ç½®æ–‡ä»¶ï¼Œå¯¹åº”å¡«å†™</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Host github.com                 </span><br><span class="line">    HostName github.com</span><br><span class="line">    IdentityFile C:\\Users\\mrli\\.ssh\\id_rsa_github</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    User Freedomisgood</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Host gitlab.sucsoft.com</span><br><span class="line">    HostName gitlab.sucsoft.com</span><br><span class="line">    IdentityFile C:\\Users\\mrli\\.ssh\\id_rsa_sucsoft</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    User chenli</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šHoståå†™çš„å°±æ˜¯<code>ssh -T git@gitlab.sucsoft.com</code>ä¸­@åé¢çš„å†…å®¹ï¼Œå¦‚æœå†™çš„æ˜¯<code>sucsoft</code>ï¼Œåˆ™å†™æˆ<code>ssh -T git@sucsoft</code>ï¼Œä½†æ˜¯è¿™æ ·å…¶å®è·ŸGitlabé¡µé¢ä¸­ç›´æ¥æä¾›çš„ä¸ä¸€æ ·: <code>git@gitlab.sucsoft.com:suc-frame/xxxx.git</code>ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯è§„èŒƒçš„å†™<code>gitlab.sucsoft.com</code></p><p>â˜…é…ç½®å®Œæˆåæœ€ç»ˆæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼š</p><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/more-1.jpg" alt="more-1"></p><p>æ³¨ï¼š known_hostæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¦‚æœç¬¬ä¸€æ¬¡SSHè¿æ¥ç½‘ç«™ï¼Œåˆ™ä¼šå°†hostæ·»åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;SSHè¿æ¥å¹¶ä¸æ˜¯åƒ&lt;a href=&quot;https://so.csdn.net/so/search?q=http&amp;amp;spm=1001.2101.3001.7020&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http&lt;/a&gt;è¿
      
    
    </summary>
    
    
      <category term="git" scheme="https://nymrli.top/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶</title>
    <link href="https://nymrli.top/2022/01/26/%E8%AF%AD%E4%B9%89%E5%8C%96%E7%9A%84%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
    <id>https://nymrli.top/2022/01/26/è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶/</id>
    <published>2022-01-26T14:30:00.000Z</published>
    <updated>2022-01-26T14:40:45.998Z</updated>
    
    <content type="html"><![CDATA[<p>è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ï¼š ç”¨ä¸€ç»„ç®€å•çš„è§„åˆ™åŠæ¡ä»¶æ¥çº¦æŸç‰ˆæœ¬å·çš„é…ç½®å’Œå¢é•¿</p><blockquote><p>ä½œä¸ºä¸€ä½è´Ÿè´£ä»»çš„å¼€å‘è€…ï¼Œä½ ç†å½“ç¡®ä¿æ¯æ¬¡åŒ…å‡çº§çš„è¿ä½œä¸ç‰ˆæœ¬å·çš„è¡¨è¿°ä¸€è‡´ã€‚ç°å®ä¸–ç•Œæ˜¯å¤æ‚çš„ï¼Œæˆ‘ä»¬é™¤äº†æé«˜è­¦è§‰å¤–èƒ½åšçš„ä¸å¤šã€‚ä½ æ‰€èƒ½åšçš„å°±æ˜¯è®©è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ä¸ºä½ æä¾›ä¸€ä¸ªå¥å…¨çš„æ–¹å¼æ¥å‘è¡Œä»¥åŠå‡çº§åŒ…ï¼Œè€Œæ— éœ€æ¨å‡ºæ–°çš„ä¾èµ–åŒ…ï¼ŒèŠ‚çœä½ çš„æ—¶é—´åŠçƒ¦æ¼ã€‚</p><p>å¦‚æœæ²¡æœ‰æŸä¸ªæ­£å¼çš„è§„èŒƒå¯å¾ªï¼Œç‰ˆæœ¬å·å¯¹äºä¾èµ–çš„ç®¡ç†å¹¶æ— å®è´¨æ„ä¹‰ã€‚å°†ä¸Šè¿°çš„æƒ³æ³•å‘½åå¹¶ç»™äºˆæ¸…æ¥šçš„å®šä¹‰ï¼Œè®©ä½ å¯¹è½¯ä»¶ä½¿ç”¨è€…ä¼ è¾¾æ„å‘å˜å¾—å®¹æ˜“ã€‚ä¸€æ—¦è¿™äº›æ„å‘å˜å¾—æ¸…æ¥šï¼Œå¼¹æ€§ï¼ˆä½†åˆä¸ä¼šå¤ªå¼¹æ€§ï¼‰çš„ä¾èµ–è§„èŒƒå°±èƒ½è¾¾æˆã€‚</p><p>å¦‚æœä½ å¯¹æ­¤è®¤åŒï¼Œå¸Œæœ›ç«‹å³å¼€å§‹ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼Œä½ åªéœ€å£°æ˜ä½ çš„å‡½æ•°åº“æ­£åœ¨ä½¿ç”¨å®ƒå¹¶éµå¾ªè¿™äº›è§„åˆ™å°±å¯ä»¥äº†ã€‚è¯·åœ¨ä½ çš„ README æ–‡ä»¶ä¸­ä¿ç•™<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener">æ­¤é¡µé“¾æ¥</a>ï¼Œè®©åˆ«äººä¹ŸçŸ¥é“è¿™äº›è§„åˆ™å¹¶ä»ä¸­å—ç›Šã€‚</p></blockquote><h2 id="target"><a class="markdownIt-Anchor" href="#target"></a> Target:</h2><p>ç‰ˆæœ¬æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼Œç‰ˆæœ¬å·é€’å¢è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li>ä¸»ç‰ˆæœ¬å·ï¼šå½“ä½ åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹ï¼Œ</li><li>æ¬¡ç‰ˆæœ¬å·ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢ï¼Œ</li><li>ä¿®è®¢å·ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£ã€‚</li></ol><p>å…ˆè¡Œç‰ˆæœ¬å·åŠç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ä»¥åŠ åˆ°â€œä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·â€çš„åé¢ï¼Œä½œä¸ºå»¶ä¼¸ã€‚</p><h2 id="è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒsemver"><a class="markdownIt-Anchor" href="#è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒsemver"></a> è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒï¼ˆSemVerï¼‰</h2><p>ä»¥ä¸‹å…³é”®è¯ MUSTã€MUST NOTã€REQUIREDã€SHALLã€SHALL NOTã€SHOULDã€SHOULD NOTã€ RECOMMENDEDã€MAYã€OPTIONAL ä¾ç…§ RFC 2119 çš„å™è¿°è§£è¯»ã€‚</p><ol><li>ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è½¯ä»¶å¿…é¡»ï¼ˆMUSTï¼‰å®šä¹‰å…¬å…± APIã€‚è¯¥ API å¯ä»¥åœ¨ä»£ç ä¸­è¢«å®šä¹‰æˆ–å‡ºç°äºä¸¥è°¨çš„æ–‡ä»¶å†…ã€‚æ— è®ºä½•ç§å½¢å¼éƒ½åº”è¯¥åŠ›æ±‚ç²¾ç¡®ä¸”å®Œæ•´ã€‚</li><li>æ ‡å‡†çš„ç‰ˆæœ¬å·å¿…é¡»ï¼ˆMUSTï¼‰é‡‡ç”¨ X.Y.Z çš„æ ¼å¼ï¼Œå…¶ä¸­ Xã€Y å’Œ Z ä¸ºéè´Ÿçš„æ•´æ•°ï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨æ•°å­—å‰æ–¹è¡¥é›¶ã€‚X æ˜¯ä¸»ç‰ˆæœ¬å·ã€Y æ˜¯æ¬¡ç‰ˆæœ¬å·ã€è€Œ Z ä¸ºä¿®è®¢å·ã€‚æ¯ä¸ªå…ƒç´ å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ•°å€¼æ¥é€’å¢ã€‚ä¾‹å¦‚ï¼š1.9.1 -&gt; 1.10.0 -&gt; 1.11.0ã€‚</li><li>æ ‡è®°ç‰ˆæœ¬å·çš„è½¯ä»¶å‘è¡Œåï¼Œç¦æ­¢ï¼ˆMUST NOTï¼‰æ”¹å˜è¯¥ç‰ˆæœ¬è½¯ä»¶çš„å†…å®¹ã€‚ä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ–°ç‰ˆæœ¬å‘è¡Œã€‚</li><li>ä¸»ç‰ˆæœ¬å·ä¸ºé›¶ï¼ˆ0.y.zï¼‰çš„è½¯ä»¶å¤„äºå¼€å‘åˆå§‹é˜¶æ®µï¼Œä¸€åˆ‡éƒ½å¯èƒ½éšæ—¶è¢«æ”¹å˜ã€‚è¿™æ ·çš„å…¬å…± API ä¸åº”è¯¥è¢«è§†ä¸ºç¨³å®šç‰ˆã€‚</li><li>1.0.0 çš„ç‰ˆæœ¬å·ç”¨äºç•Œå®šå…¬å…± API çš„å½¢æˆã€‚è¿™ä¸€ç‰ˆæœ¬ä¹‹åæ‰€æœ‰çš„ç‰ˆæœ¬å·æ›´æ–°éƒ½åŸºäºå…¬å…± API åŠå…¶ä¿®æ”¹å†…å®¹ã€‚</li><li><strong>ä¿®è®¢å·</strong> Zï¼ˆx.y.Z <code>|</code> x &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨åªåšäº†å‘ä¸‹å…¼å®¹çš„ä¿®æ­£æ—¶æ‰é€’å¢ã€‚è¿™é‡Œçš„ä¿®æ­£æŒ‡çš„æ˜¯é’ˆå¯¹ä¸æ­£ç¡®ç»“æœè€Œè¿›è¡Œçš„å†…éƒ¨ä¿®æ”¹ã€‚</li><li><strong>æ¬¡ç‰ˆæœ¬å·</strong> Yï¼ˆx.Y.z <code>|</code> x &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰å‘ä¸‹å…¼å®¹çš„æ–°åŠŸèƒ½å‡ºç°æ—¶é€’å¢ã€‚åœ¨ä»»ä½•å…¬å…± API çš„åŠŸèƒ½è¢«æ ‡è®°ä¸ºå¼ƒç”¨æ—¶ä¹Ÿå¿…é¡»ï¼ˆMUSTï¼‰é€’å¢ã€‚ä¹Ÿå¯ä»¥ï¼ˆMAYï¼‰åœ¨å†…éƒ¨ç¨‹åºæœ‰å¤§é‡æ–°åŠŸèƒ½æˆ–æ”¹è¿›è¢«åŠ å…¥æ—¶é€’å¢ï¼Œå…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬ä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“æ¬¡ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚</li><li><strong>ä¸»ç‰ˆæœ¬å·</strong> Xï¼ˆX.y.z <code>|</code> X &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰ä»»ä½•ä¸å…¼å®¹çš„ä¿®æ”¹è¢«åŠ å…¥å…¬å…± API æ—¶é€’å¢ã€‚å…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“ä¸»ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œæ¬¡ç‰ˆæœ¬å·å’Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚</li><li><strong>å…ˆè¡Œç‰ˆæœ¬å·</strong>ï¼šå¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆä¹‹åï¼Œå…ˆåŠ ä¸Š<strong>ä¸€ä¸ªè¿æ¥å·</strong>å†åŠ ä¸Š<strong>ä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”</strong>çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚æ•°å­—å‹çš„æ ‡è¯†ç¬¦ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨å‰æ–¹è¡¥é›¶ã€‚å…ˆè¡Œç‰ˆçš„ä¼˜å…ˆçº§ä½äºç›¸å…³è”çš„æ ‡å‡†ç‰ˆæœ¬ã€‚è¢«æ ‡ä¸Šå…ˆè¡Œç‰ˆæœ¬å·åˆ™è¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬å¹¶éç¨³å®šè€Œä¸”å¯èƒ½æ— æ³•æ»¡è¶³é¢„æœŸçš„å…¼å®¹æ€§éœ€æ±‚ã€‚èŒƒä¾‹ï¼š1.0.0-alphaã€1.0.0-alpha.1ã€1.0.0-0.3.7ã€1.0.0-x.7.z.92ã€‚</li><li><strong>ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯</strong>å¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆæˆ–å…ˆè¡Œç‰ˆæœ¬å·ä¹‹åï¼Œå…ˆåŠ ä¸Š<strong>ä¸€ä¸ªåŠ å·</strong>å†åŠ ä¸Šä¸€è¿ä¸²ä»¥<strong>å¥ç‚¹åˆ†éš”</strong>çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚å½“åˆ¤æ–­ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æ—¶ï¼Œç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ï¼ˆSHOULDï¼‰è¢«å¿½ç•¥ã€‚å› æ­¤å½“ä¸¤ä¸ªç‰ˆæœ¬åªæœ‰åœ¨ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯æœ‰å·®åˆ«æ—¶ï¼Œå±äºç›¸åŒçš„ä¼˜å…ˆå±‚çº§ã€‚èŒƒä¾‹ï¼š1.0.0-alpha+001ã€1.0.0+20130313144700ã€1.0.0-beta+exp.sha.5114f85ã€‚</li><li>ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æŒ‡çš„æ˜¯ä¸åŒç‰ˆæœ¬åœ¨æ’åºæ—¶å¦‚ä½•æ¯”è¾ƒã€‚åˆ¤æ–­ä¼˜å…ˆå±‚çº§æ—¶ï¼Œå¿…é¡»ï¼ˆMUSTï¼‰æŠŠç‰ˆæœ¬ä¾åºæ‹†åˆ†ä¸ºä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·ã€ä¿®è®¢å·åŠå…ˆè¡Œç‰ˆæœ¬å·åè¿›è¡Œæ¯”è¾ƒï¼ˆç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯ä¸åœ¨è¿™ä»½æ¯”è¾ƒçš„åˆ—è¡¨ä¸­ï¼‰ã€‚ç”±å·¦åˆ°å³ä¾åºæ¯”è¾ƒæ¯ä¸ªæ ‡è¯†ç¬¦ï¼Œç¬¬ä¸€ä¸ªå·®å¼‚å€¼ç”¨æ¥å†³å®šä¼˜å…ˆå±‚çº§ï¼šä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·ä»¥æ•°å€¼æ¯”è¾ƒï¼Œä¾‹å¦‚ï¼š1.0.0 &lt; 2.0.0 &lt; 2.1.0 &lt; 2.1.1ã€‚å½“ä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·éƒ½ç›¸åŒæ—¶ï¼Œæ”¹ä»¥ä¼˜å…ˆå±‚çº§æ¯”è¾ƒä½çš„å…ˆè¡Œç‰ˆæœ¬å·å†³å®šã€‚ä¾‹å¦‚ï¼š1.0.0-alpha &lt; 1.0.0ã€‚æœ‰ç›¸åŒä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·çš„ä¸¤ä¸ªå…ˆè¡Œç‰ˆæœ¬å·ï¼Œå…¶ä¼˜å…ˆå±‚çº§å¿…é¡»ï¼ˆMUSTï¼‰é€è¿‡ç”±å·¦åˆ°å³çš„æ¯ä¸ªè¢«å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥æ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå·®å¼‚å€¼åå†³å®šï¼šåªæœ‰æ•°å­—çš„æ ‡è¯†ç¬¦ä»¥æ•°å€¼é«˜ä½æ¯”è¾ƒï¼Œæœ‰å­—æ¯æˆ–è¿æ¥å·æ—¶åˆ™é€å­—ä»¥ ASCII çš„æ’åºæ¥æ¯”è¾ƒã€‚æ•°å­—çš„æ ‡è¯†ç¬¦æ¯”éæ•°å­—çš„æ ‡è¯†ç¬¦ä¼˜å…ˆå±‚çº§ä½ã€‚è‹¥å¼€å¤´çš„æ ‡è¯†ç¬¦éƒ½ç›¸åŒæ—¶ï¼Œæ ä½æ¯”è¾ƒå¤šçš„å…ˆè¡Œç‰ˆæœ¬å·ä¼˜å…ˆå±‚çº§æ¯”è¾ƒé«˜ã€‚èŒƒä¾‹ï¼š1.0.0-alpha &lt; 1.0.0-alpha.1 &lt; 1.0.0-alpha.beta &lt; 1.0.0-beta &lt; 1.0.0-beta.2 &lt; 1.0.0-beta.11 &lt; 1.0.0-rc.1 &lt; 1.0.0ã€‚</li></ol><h2 id="faq"><a class="markdownIt-Anchor" href="#faq"></a> FAQ</h2><p><strong>åœ¨ 0.y.z åˆå§‹å¼€å‘é˜¶æ®µï¼Œæˆ‘è¯¥å¦‚ä½•è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Ÿ</strong></p><p>æœ€ç®€å•çš„åšæ³•æ˜¯ä»¥ 0.1.0 ä½œä¸ºä½ çš„åˆå§‹åŒ–å¼€å‘ç‰ˆæœ¬ï¼Œå¹¶åœ¨åç»­çš„æ¯æ¬¡å‘è¡Œæ—¶é€’å¢æ¬¡ç‰ˆæœ¬å·ã€‚</p><p><strong>å¦‚ä½•åˆ¤æ–­å‘å¸ƒ 1.0.0 ç‰ˆæœ¬çš„æ—¶æœºï¼Ÿ</strong></p><p>å½“ä½ çš„è½¯ä»¶è¢«ç”¨äºæ­£å¼ç¯å¢ƒï¼Œå®ƒåº”è¯¥å·²ç»è¾¾åˆ°äº† 1.0.0 ç‰ˆã€‚å¦‚æœä½ å·²ç»æœ‰ä¸ªç¨³å®šçš„ API è¢«ä½¿ç”¨è€…ä¾èµ–ï¼Œä¹Ÿä¼šæ˜¯ 1.0.0 ç‰ˆã€‚å¦‚æœä½ å¾ˆæ‹…å¿ƒå‘ä¸‹å…¼å®¹çš„é—®é¢˜ï¼Œä¹Ÿåº”è¯¥ç®—æ˜¯ 1.0.0 ç‰ˆäº†ã€‚</p><p><strong>è¿™ä¸ä¼šé˜»ç¢å¿«é€Ÿå¼€å‘å’Œè¿­ä»£å—ï¼Ÿ</strong></p><p>ä¸»ç‰ˆæœ¬å·ä¸ºé›¶çš„æ—¶å€™å°±æ˜¯ä¸ºäº†åšå¿«é€Ÿå¼€å‘ã€‚å¦‚æœä½ æ¯å¤©éƒ½åœ¨æ”¹å˜ APIï¼Œé‚£ä¹ˆä½ åº”è¯¥ä»åœ¨ä¸»ç‰ˆæœ¬å·ä¸ºé›¶çš„é˜¶æ®µï¼ˆ0.y.zï¼‰ï¼Œæˆ–æ˜¯æ­£åœ¨ä¸‹ä¸ªä¸»ç‰ˆæœ¬çš„ç‹¬ç«‹å¼€å‘åˆ†æ”¯ä¸­ã€‚</p><p><strong>å¯¹äºå…¬å…± APIï¼Œè‹¥å³ä½¿æ˜¯æœ€å°ä½†ä¸å‘ä¸‹å…¼å®¹çš„æ”¹å˜éƒ½éœ€è¦äº§ç”Ÿæ–°çš„ä¸»ç‰ˆæœ¬å·ï¼Œå²‚ä¸æ˜¯å¾ˆå¿«å°±è¾¾åˆ° 42.0.0 ç‰ˆï¼Ÿ</strong></p><p>è¿™æ˜¯å¼€å‘çš„è´£ä»»æ„Ÿå’Œå‰ç»æ€§çš„é—®é¢˜ã€‚ä¸å…¼å®¹çš„æ”¹å˜ä¸åº”è¯¥è½»æ˜“è¢«åŠ å…¥åˆ°æœ‰è®¸å¤šä¾èµ–ä»£ç çš„è½¯ä»¶ä¸­ã€‚å‡çº§æ‰€ä»˜å‡ºçš„ä»£ä»·å¯èƒ½æ˜¯å·¨å¤§çš„ã€‚è¦é€’å¢ä¸»ç‰ˆæœ¬å·æ¥å‘è¡Œä¸å…¼å®¹çš„æ”¹ç‰ˆï¼Œæ„å‘³ç€ä½ å¿…é¡»ä¸ºè¿™äº›æ”¹å˜æ‰€å¸¦æ¥çš„å½±å“æ·±æ€ç†Ÿè™‘ï¼Œå¹¶ä¸”è¯„ä¼°æ‰€æ¶‰åŠçš„æˆæœ¬åŠæ•ˆç›Šæ¯”ã€‚</p><p><strong>ä¸ºæ•´ä¸ªå…¬å…± API å†™æ–‡ä»¶å¤ªè´¹äº‹äº†ï¼</strong></p><p>ä¸ºä¾›ä»–äººä½¿ç”¨çš„è½¯ä»¶ç¼–å†™é€‚å½“çš„æ–‡ä»¶ï¼Œæ˜¯ä½ ä½œä¸ºä¸€åä¸“ä¸šå¼€å‘è€…åº”å°½çš„èŒè´£ã€‚ä¿æŒä¸“æ¡ˆé«˜æ•ˆä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨ä»½æ˜¯æŒæ§è½¯ä»¶çš„å¤æ‚åº¦ï¼Œå¦‚æœæ²¡æœ‰äººçŸ¥é“å¦‚ä½•ä½¿ç”¨ä½ çš„è½¯ä»¶æˆ–ä¸çŸ¥é“å“ªäº›å‡½æ•°çš„è°ƒç”¨æ˜¯å¯é çš„ï¼Œè¦æŒæ§å¤æ‚åº¦ä¼šæ˜¯å›°éš¾çš„ã€‚é•¿è¿œæ¥çœ‹ï¼Œä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ä»¥åŠå¯¹äºå…¬å…± API æœ‰è‰¯å¥½è§„èŒƒçš„åšæŒï¼Œå¯ä»¥è®©æ¯ä¸ªäººåŠæ¯ä»¶äº‹éƒ½è¿è¡Œé¡ºç•…ã€‚</p><p><strong>ä¸‡ä¸€ä¸å°å¿ƒæŠŠä¸€ä¸ªä¸å…¼å®¹çš„æ”¹ç‰ˆå½“æˆäº†æ¬¡ç‰ˆæœ¬å·å‘è¡Œäº†è¯¥æ€ä¹ˆåŠï¼Ÿ</strong></p><p>ä¸€æ—¦å‘ç°è‡ªå·±ç ´åäº†è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è§„èŒƒï¼Œå°±è¦ä¿®æ­£è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å‘è¡Œä¸€ä¸ªæ–°çš„æ¬¡ç‰ˆæœ¬å·æ¥æ›´æ­£è¿™ä¸ªé—®é¢˜å¹¶ä¸”æ¢å¤å‘ä¸‹å…¼å®¹ã€‚å³ä½¿æ˜¯è¿™ç§æƒ…å†µï¼Œä¹Ÿä¸èƒ½å»ä¿®æ”¹å·²å‘è¡Œçš„ç‰ˆæœ¬ã€‚å¯ä»¥çš„è¯ï¼Œå°†æœ‰é—®é¢˜çš„ç‰ˆæœ¬å·è®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œå‘Šè¯‰ä½¿ç”¨è€…é—®é¢˜æ‰€åœ¨ï¼Œè®©ä»–ä»¬èƒ½å¤Ÿæ„è¯†åˆ°è¿™æ˜¯æœ‰é—®é¢˜çš„ç‰ˆæœ¬ã€‚</p><p><strong>å¦‚æœæˆ‘æ›´æ–°äº†è‡ªå·±çš„ä¾èµ–ä½†æ²¡æœ‰æ”¹å˜å…¬å…± API è¯¥æ€ä¹ˆåŠï¼Ÿ</strong></p><p>ç”±äºæ²¡æœ‰å½±å“åˆ°å…¬å…± APIï¼Œè¿™å¯ä»¥è¢«è®¤å®šæ˜¯å…¼å®¹çš„ã€‚è‹¥æŸä¸ªè½¯ä»¶å’Œä½ çš„åŒ…æœ‰å…±åŒä¾èµ–ï¼Œåˆ™å®ƒä¼šæœ‰è‡ªå·±çš„ä¾èµ–è§„èŒƒï¼Œä½œè€…ä¹Ÿä¼šå‘ŠçŸ¥å¯èƒ½çš„å†²çªã€‚è¦åˆ¤æ–­æ”¹ç‰ˆæ˜¯å±äºä¿®è®¢ç­‰çº§æˆ–æ˜¯æ¬¡ç‰ˆç­‰çº§ï¼Œæ˜¯ä¾æ®ä½ æ›´æ–°çš„ä¾èµ–å…³ç³»æ˜¯ä¸ºäº†ä¿®å¤é—®é¢˜æˆ–æ˜¯åŠ å…¥æ–°åŠŸèƒ½ã€‚å¯¹äºåè€…ï¼Œæˆ‘ç»å¸¸ä¼šé¢„æœŸä¼´éšç€æ›´å¤šçš„ä»£ç ï¼Œè¿™æ˜¾ç„¶ä¼šæ˜¯ä¸€ä¸ªæ¬¡ç‰ˆæœ¬å·çº§åˆ«çš„é€’å¢ã€‚</p><p><strong>å¦‚æœæˆ‘å˜æ›´äº†å…¬å…± API ä½†æ— æ„ä¸­æœªéµå¾ªç‰ˆæœ¬å·çš„æ”¹åŠ¨æ€ä¹ˆåŠå‘¢ï¼Ÿï¼ˆæ„å³åœ¨ä¿®è®¢ç­‰çº§çš„å‘å¸ƒä¸­ï¼Œè¯¯å°†é‡å¤§ä¸”ä¸å…¼å®¹çš„æ”¹å˜åŠ åˆ°ä»£ç ä¹‹ä¸­ï¼‰</strong></p><p>è‡ªè¡Œåšæœ€ä½³çš„åˆ¤æ–­ã€‚å¦‚æœä½ æœ‰åºå¤§çš„ä½¿ç”¨è€…ç¾¤åœ¨ä¾ç…§å…¬å…± API çš„æ„å›¾è€Œå˜æ›´è¡Œä¸ºåä¼šå¤§å—å½±å“ï¼Œé‚£ä¹ˆæœ€å¥½åšä¸€æ¬¡ä¸»ç‰ˆæœ¬çš„å‘å¸ƒï¼Œå³ä½¿ä¸¥æ ¼æ¥è¯´è¿™ä¸ªä¿®å¤ä»…æ˜¯ä¿®è®¢ç­‰çº§çš„å‘å¸ƒã€‚è®°ä½ï¼Œ è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶å°±æ˜¯é€è¿‡ç‰ˆæœ¬å·çš„æ”¹å˜æ¥ä¼ è¾¾æ„ä¹‰ã€‚è‹¥è¿™äº›æ”¹å˜å¯¹ä½ çš„ä½¿ç”¨è€…æ˜¯é‡è¦çš„ï¼Œé‚£å°±é€è¿‡ç‰ˆæœ¬å·æ¥å‘ä»–ä»¬è¯´æ˜ã€‚</p><p><strong>æˆ‘è¯¥å¦‚ä½•å¤„ç†å³å°†å¼ƒç”¨çš„åŠŸèƒ½ï¼Ÿ</strong></p><p>å¼ƒç”¨ç°å­˜çš„åŠŸèƒ½æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„å®¶å¸¸ä¾¿é¥­ï¼Œä¹Ÿé€šå¸¸æ˜¯å‘å‰å‘å±•æ‰€å¿…é¡»çš„ã€‚å½“ä½ å¼ƒç”¨éƒ¨ä»½å…¬å…± API æ—¶ï¼Œä½ åº”è¯¥åšä¸¤ä»¶äº‹ï¼šï¼ˆ1ï¼‰æ›´æ–°ä½ çš„æ–‡ä»¶è®©ä½¿ç”¨è€…çŸ¥é“è¿™ä¸ªæ”¹å˜ï¼Œï¼ˆ2ï¼‰åœ¨é€‚å½“çš„æ—¶æœºå°†å¼ƒç”¨çš„åŠŸèƒ½é€è¿‡æ–°çš„æ¬¡ç‰ˆæœ¬å·å‘å¸ƒã€‚åœ¨æ–°çš„ä¸»ç‰ˆæœ¬å®Œå…¨ç§»é™¤å¼ƒç”¨åŠŸèƒ½å‰ï¼Œè‡³å°‘è¦æœ‰ä¸€ä¸ªæ¬¡ç‰ˆæœ¬åŒ…å«è¿™ä¸ªå¼ƒç”¨ä¿¡æ¯ï¼Œè¿™æ ·ä½¿ç”¨è€…æ‰èƒ½å¹³é¡ºåœ°è½¬ç§»åˆ°æ–°ç‰ˆ APIã€‚</p><p><strong>è¯­ä¹‰åŒ–ç‰ˆæœ¬å¯¹äºç‰ˆæœ¬çš„å­—ä¸²é•¿åº¦æ˜¯å¦æœ‰é™åˆ¶å‘¢ï¼Ÿ</strong></p><p>æ²¡æœ‰ï¼Œè¯·è‡ªè¡Œåšé€‚å½“çš„åˆ¤æ–­ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œé•¿åˆ° 255 ä¸ªå­—å…ƒçš„ç‰ˆæœ¬å·²è¿‡åº¦å¤¸å¼ ã€‚å†è€…ï¼Œç‰¹å®šçš„ç³»ç»Ÿå¯¹äºå­—ä¸²é•¿åº¦å¯èƒ½ä¼šæœ‰ä»–ä»¬è‡ªå·±çš„é™åˆ¶ã€‚</p><h2 id="ç‰ˆæœ¬alpha-beta-rc"><a class="markdownIt-Anchor" href="#ç‰ˆæœ¬alpha-beta-rc"></a> ç‰ˆæœ¬ï¼šAlphaã€betaã€RC</h2><blockquote><p>è¿™äº›å«åšå…ˆè¡Œç‰ˆæœ¬å·ã€‚è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆä¹‹åï¼Œå…ˆåŠ ä¸Šä¸€ä¸ªè¿æ¥å·å†åŠ ä¸Šä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ï¼Œå¦‚1.0.0-alphaã€1.0.0-alpha.1ã€1.0.0-0.3.7ã€1.0.0-x.7.z.92</p></blockquote><p>å¸¸è§çš„ RC ç‰ˆæœ¬ï¼Œå…¨ç§°æ˜¯ Release Candidateã€‚å…¶ä¸­ Release æ˜¯å‘è¡Œã€å‘å¸ƒçš„æ„æ€ã€‚Candidate æ˜¯å€™é€‰äººçš„æ„æ€ï¼Œç”¨åœ¨è½¯ä»¶æˆ–è€…æ“ä½œç³»ç»Ÿä¸Šå°±æ˜¯å€™é€‰ç‰ˆæœ¬ã€‚å› æ­¤ Release Candidate å°±æ˜¯å‘è¡Œå€™é€‰ç‰ˆæœ¬ã€‚</p><table><thead><tr><th>ç‰ˆæœ¬åç§°</th><th>ä»‹ç»</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Alpha</td><td>å†…æµ‹ç‰ˆæœ¬</td><td>å†…éƒ¨æµ‹è¯•ç‰ˆæœ¬ã€‚</td></tr><tr><td>Beta</td><td>å…¬æµ‹ç‰ˆæœ¬</td><td>Beta é˜¶æ®µä¼šä¸€ç›´åŠ å…¥æ–°çš„åŠŸèƒ½ã€‚</td></tr><tr><td>RC</td><td>å€™é€‰ç‰ˆæœ¬</td><td>å‡ ä¹å°±ä¸ä¼šåŠ å…¥æ–°çš„åŠŸèƒ½äº†ï¼Œè€Œä¸»è¦ç€é‡äºé™¤é”™ã€‚</td></tr><tr><td>Release</td><td>æ­£å¼ç‰ˆæœ¬</td><td>ç¨³å®šç‰ˆæœ¬ã€‚</td></tr></tbody></table><p>RC ç‰ˆæœ¬å’Œ Beta ç‰ˆæœ€å¤§çš„å·®åˆ«åœ¨äº Beta é˜¶æ®µä¼š<strong>ä¸€ç›´åŠ å…¥æ–°çš„åŠŸèƒ½</strong>ï¼Œä½†æ˜¯åˆ°äº† RC é˜¶æ®µï¼Œå‡ ä¹å°±ä¸ä¼šåŠ å…¥æ–°çš„åŠŸèƒ½äº†ï¼Œè€Œä¸»è¦ç€é‡äº<strong>é™¤é”™</strong>ã€‚</p><p>RC ç‰ˆæœ¬ï¼Œå®ƒä¸æ˜¯æœ€ç»ˆçš„ç‰ˆæœ¬ï¼Œè€Œæ˜¯æœ€ç»ˆç‰ˆï¼ˆRTMï¼ŒRelease To Manufactureï¼‰ä¹‹å‰çš„æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚å¹¿ä¹‰ä¸Šå¯¹æµ‹è¯•æœ‰ä¸‰ä¸ªä¼ ç»Ÿçš„ç§°å‘¼ï¼šAlphaï¼ˆÎ±ï¼‰ã€Betaï¼ˆÎ²ï¼‰ã€Gammaï¼ˆÎ³ï¼‰ï¼Œç”¨æ¥æ ‡è¯†æµ‹è¯•çš„é˜¶æ®µå’ŒèŒƒå›´ã€‚Alpha æ˜¯æŒ‡å†…æµ‹ï¼Œå³ç°åœ¨è¯´çš„ CBï¼ŒæŒ‡å¼€å‘å›¢é˜Ÿå†…éƒ¨æµ‹è¯•çš„ç‰ˆæœ¬æˆ–è€…æœ‰é™ç”¨æˆ·ä½“éªŒæµ‹è¯•ç‰ˆæœ¬ã€‚Beta æ˜¯æŒ‡å…¬æµ‹ï¼Œå³é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·å…¬å¼€çš„æµ‹è¯•ç‰ˆæœ¬ã€‚ç„¶ååšè¿‡ä¸€äº›ä¿®æ”¹ï¼Œæˆä¸ºæ­£å¼å‘å¸ƒçš„å€™é€‰ç‰ˆæœ¬æ—¶å«åš Gammaï¼Œç°åœ¨å«åš RCã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ï¼š ç”¨ä¸€ç»„ç®€å•çš„è§„åˆ™åŠæ¡ä»¶æ¥çº¦æŸç‰ˆæœ¬å·çš„é…ç½®å’Œå¢é•¿&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½œä¸ºä¸€ä½è´Ÿè´£ä»»çš„å¼€å‘è€…ï¼Œä½ ç†å½“ç¡®ä¿æ¯æ¬¡åŒ…å‡çº§çš„è¿ä½œä¸ç‰ˆæœ¬å·çš„è¡¨è¿°ä¸€è‡´ã€‚ç°å®ä¸–ç•Œæ˜¯å¤æ‚çš„ï¼Œæˆ‘ä»¬é™¤äº†æé«˜è­¦è§‰å¤–èƒ½åšçš„ä¸å¤šã€‚ä½ æ‰€èƒ½åšçš„å°±æ˜¯è®©è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ä¸ºä½ æä¾›ä¸€ä¸ªå¥å…¨
      
    
    </summary>
    
    
      <category term="è®¡ç®—æœºåŸºç¡€çŸ¥è¯†" scheme="https://nymrli.top/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£SpringBootæ³¨è§£s</title>
    <link href="https://nymrli.top/2021/12/30/%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s/"/>
    <id>https://nymrli.top/2021/12/30/ç†è§£SpringBootæ³¨è§£s/</id>
    <published>2021-12-30T12:30:45.000Z</published>
    <updated>2021-12-30T14:25:40.982Z</updated>
    
    <content type="html"><![CDATA[<h2 id="reuqestbodyå’Œrequestparam"><a class="markdownIt-Anchor" href="#reuqestbodyå’Œrequestparam"></a> @ReuqestBodyå’Œ@RequestParam</h2><p>è¿™ä¸¤ä¸ªæ³¨è§£éƒ½æ˜¯åœ¨ControlleræŸä¸ªMappingå‡½æ•°çš„å½¢å‚å‰åŠ ä¸Šçš„ï¼Œä½†ä¸¤ä¸ªå…·ä½“æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿåœ¨ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬è¯¥å¦‚ä½•é€‰æ‹©å‘¢? è¿™è·Ÿæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·ä»¥ä»€ä¹ˆå½¢å¼æ¥è¯·æ±‚æ¥å£æœ‰å…³ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè¯·æ±‚å¤´çš„Content-typeæœ‰å¤šä¸ªï¼Œå¦‚</p><p>å¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š</p><ul><li>text/html ï¼š HTMLæ ¼å¼</li><li>text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼</li><li>text/xml ï¼š XMLæ ¼å¼</li><li>image/gif ï¼šgifå›¾ç‰‡æ ¼å¼</li><li>image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼</li><li>image/pngï¼špngå›¾ç‰‡æ ¼å¼</li></ul><p>ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š</p><ul><li>application/xhtml+xml ï¼šXHTMLæ ¼å¼</li><li>application/xmlï¼š XMLæ•°æ®æ ¼å¼</li><li>application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼</li><li>â­ï¸application/jsonï¼š JSONæ•°æ®æ ¼å¼</li><li>application/pdfï¼špdfæ ¼å¼</li><li>application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼</li><li>application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰</li><li>â­ï¸application/x-www-form-urlencoded ï¼š<code>&lt;form encType=&quot;&quot;&gt;</code>ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰</li></ul><p>å¦å¤–ä¸€ç§å¸¸è§çš„åª’ä½“æ ¼å¼æ˜¯ä¸Šä¼ æ–‡ä»¶ä¹‹æ—¶ä½¿ç”¨çš„ï¼š</p><ul><li>multipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼</li></ul><p>å…¶ä¸­ï¼ŒPOSTè¯·æ±‚æœ€å¸¸ç”¨çš„æ˜¯<code>application/x-www-form-urlencoded</code>,æµè§ˆå™¨çš„åŸç”Ÿ form è¡¨å•ï¼Œå¦‚æœä¸è®¾ç½® enctype å±æ€§ï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šä»¥ application/x-www-form-urlencoded æ–¹å¼æäº¤æ•°æ®ã€‚æ•°æ®æŒ‰ç…§ key1=val1&amp;key2=val2 çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œkey å’Œ val éƒ½è¿›è¡Œäº† URL è½¬ç ã€‚è¯·æ±‚ç±»ä¼¼äºä¸‹é¢è¿™æ ·</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-www.png" alt="post-www"></p><p>æ­¤å¤–ï¼Œ<code>application/json</code>ä¹Ÿæ˜¯POSTæ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å½¢å¼ï¼Œä¹Ÿæ˜¯ç›®å‰æ¯”è¾ƒæ¨èçš„ï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²ã€‚åœ¨è¿™ç§ç¼–ç æ–¹å¼ä¸‹ï¼Œè¯·æ±‚å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-json.png" alt="post-json"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯å“ªç§ç¼–ç ï¼ŒPOSTåŸºæœ¬ä¸Šéƒ½æ˜¯ä»è¯·æ±‚ä½“ä¸­å–æ•°æ®è§£æçš„ã€‚è€Œ<code>@RequestBody</code>æ­£æ˜¯å¯¹åº”çš„è¯·æ±‚ä½“ï¼›<code>@RequestParam</code>å‘¢ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯<strong>æ¥è‡ªrequestHeader</strong>ä¸­ï¼Œå³<strong>è¯·æ±‚å¤´</strong>ã€‚<strong>é€šå¸¸ç”¨äºGETè¯·æ±‚</strong>ï¼ŒåŠŸèƒ½æ˜¯<em>ä»URLä¸­æå–è¯·æ±‚å‚æ•°</em>ã€‚æ¯”å¦‚å¸¸è§çš„urlï¼š<code>http://localhost:8081/spring-boot-study/novel/findByAuthorAndType?author=å”å®¶ä¸‰å°‘&amp;type=å·²å®Œç»“</code>ã€‚å¯¹åº”çš„æ¥å£ä¸º<code>public List&lt;NovelEntity&gt; findByAuthorAndType(@RequestParam(value=&quot;author&quot;, required=false,defaultValue=&quot;å¤©èš•åœŸè±†&quot;) String author, @RequestParam(value=&quot;type&quot;) String type)</code></p><p>@RequestParamæœ‰ä¸‰ä¸ªé…ç½®å‚æ•°ï¼š</p><ul><li><code>required</code> è¡¨ç¤ºæ˜¯å¦å¿…é¡»ï¼Œé»˜è®¤ä¸º <code>true</code>ï¼Œå¿…é¡»ã€‚</li><li><code>defaultValue</code> å¯è®¾ç½®è¯·æ±‚å‚æ•°çš„é»˜è®¤å€¼ã€‚</li><li><code>value</code> ä¸ºæ¥æ”¶urlå‚æ•°çš„å‚æ•°åï¼ˆç›¸å½“äºkeyå€¼ï¼‰ã€‚</li></ul><p><strong>@RequestParamç”¨æ¥å¤„ç† <code>Content-Type</code> ä¸º <code>application/x-www-form-urlencoded</code> ç¼–ç çš„å†…å®¹ï¼Œ<code>Content-Type</code>é»˜è®¤ä¸ºè¯¥å±æ€§ã€‚</strong></p><p><strong>@RequestParamä¹Ÿå¯ç”¨äºå…¶å®ƒç±»å‹çš„è¯·æ±‚ï¼Œä¾‹å¦‚ï¼šGETã€POSTã€DELETEç­‰è¯·æ±‚</strong>ã€‚æ¯”å¦‚å‘è¡¨ä¸­æ’å…¥å•æ¡æ•°æ®ï¼Œ<code>Controller</code> å±‚çš„å†™æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>ä½†æ˜¯ï¼Œè¿™æ ·ä¸æ”¯æŒæ‰¹é‡æ’å…¥æ•°æ®ï¼Œç›¸å¯¹ä¹‹ä¸‹ï¼Œjsonæ¥è¡¨è¾¾çš„ä¼˜åŠ¿å°±å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯@RequestParamæ²¡åŠæ³•å¤„ç†<code>application/json</code>ï¼Œç‚¹å‡»å‘é€çš„è¯ï¼Œä¼šæŠ¥é”™åå°æ¥æ”¶ä¸åˆ°å€¼ï¼Œä¸º <code>null</code>ã€‚</p><p>æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨å¯¹åº”çš„<code>@RequestBody</code>ï¼Œå®ƒä¸€èˆ¬ç”¨äºå¤„ç†é <code>Content-Type: application/x-www-form-urlencoded</code>ç¼–ç æ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚ï¼š<code>application/json</code>ã€<code>application/xml</code>ç­‰ç±»å‹çš„æ•°æ®ã€‚å°±<code>application/json</code>ç±»å‹çš„æ•°æ®è€Œè¨€ï¼Œä½¿ç”¨æ³¨è§£@RequestBodyå¯ä»¥å°†bodyé‡Œé¢æ‰€æœ‰çš„jsonæ•°æ®ä¼ åˆ°åç«¯ï¼Œåç«¯å†è¿›è¡Œè§£æã€‚å¦‚<code>public Map&lt;String, Boolean&gt; saveBatchNovel(@RequestBody List&lt;NovelEntity&gt; novelEntityList)</code></p><p>æ­¤å¤–ï¼Œé’ˆå¯¹å¸Œæœ›ç”¨æˆ·ä¼ å…¥çš„ä¸ºæŒ‡å®šå‚æ•°çš„è¯ï¼Œæœ‰ç›¸åº”çš„Entityï¼Œä½¿ç”¨@RequestBodyä¼šæ ¹æ®è¯·æ±‚ä¸»ä½“ä¸­çš„å‚æ•°åä¸å¯¹è±¡çš„å±æ€§åè¿›è¡ŒåŒ¹é…å¹¶ç»‘å®šå€¼ï¼Œè‡ªåŠ¨å°†å‚æ•°å°è£…æˆè¯¥å¯¹è±¡ï¼Œå¹¶ä¸”è¿˜å¯ä»¥é€šè¿‡@Validæ³¨è§£å¯¹è¯·æ±‚ä¸»ä½“ä¸­çš„å‚æ•°è¿›è¡Œæ ¡éªŒã€‚</p><p>æ€»ç»“ï¼š</p><ul><li><code>@RequestParam</code>çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯<em>ä»URLä¸­æå–è¯·æ±‚å‚æ•°</em>ï¼Œå³æ¥æ”¶çš„å‚æ•°æ˜¯æ¥è‡ªHTTPè¯·æ±‚å¤´çš„QueryStringä¸­ã€‚</li><li><code>@RequestBody</code>åŠŸèƒ½æ˜¯ä»è¯·æ±‚ä½“é‡æå–å‚æ•°ï¼Œå¹¶å°è£…æˆå¯¹è±¡</li></ul><p>é¢å¤–ç»éªŒæ€»ç»“ï¼š</p><blockquote><p>æ ‡å‡†åè®®ä¸‹ï¼Œé€šå¸¸è®¤ä¸ºGETè¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„ï¼Œåªæœ‰POSTè¯·æ±‚æœ‰è¯·æ±‚ä½“</p></blockquote><ul><li><p>getè¯·æ±‚åªèƒ½ä¼ queryå‚æ•°ï¼Œqueryå‚æ•°éƒ½æ˜¯æ‹¼åœ¨è¯·æ±‚åœ°å€ä¸Šçš„</p></li><li><p>postå¯ä»¥åŒæ—¶ä¼ bodyå’Œqueryä¸¤ç§å½¢å¼çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/post/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">postHello</span><span class="params">(@PathVariable Long id,</span></span></span><br><span class="line"><span class="function"><span class="params">                                         @RequestParam(value = <span class="string">"name"</span>, required = <span class="keyword">false</span>, defaultValue = <span class="string">"CL"</span>)</span> String name,</span></span><br><span class="line"><span class="function">                                         @RequestBody User user</span></span><br><span class="line"><span class="function">    ) </span>&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HashMap&lt;String, String&gt;() &#123;&#123;</span><br><span class="line">            put(<span class="string">"name"</span>, name);</span><br><span class="line">            put(<span class="string">"id"</span>, String.valueOf(id));</span><br><span class="line">        &#125;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>talent-API</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-query+body.png" alt="post-query+body"></p><p>postman-web</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost+body+query2.png" alt="post+body+query2"></p><p>é’ˆå¯¹æ¥å£çš„æµ‹è¯•ï¼Œæœ€å¥½è¿˜æ˜¯æ‰‹åŠ¨è®¾ç½®Content-typeæ¯”è¾ƒå¥½</p></li></ul><p><strong>@PathVariable</strong></p><blockquote><p>æ‰¿æ¥ä¸Šæ–‡ï¼ŒåŒæ ·ä½œä¸ºå‚æ•°ä¼ å…¥çš„è¿˜æœ‰@PathVariableï¼Œå®ƒå¯ä»¥ä»URLä¸­æå–å˜é‡</p></blockquote><p><code>@PathVariable</code>æ³¨è§£æ˜¯å°†æ–¹æ³•ä¸­çš„å‚æ•°ç»‘å®šåˆ°è¯·æ±‚URIä¸­çš„æ¨¡æ¿å˜é‡ä¸Šã€‚å¯ä»¥é€šè¿‡<code>@RequestMapping</code>æ³¨è§£æ¥æŒ‡å®šURIçš„æ¨¡æ¿å˜é‡ï¼Œç„¶åä½¿ç”¨<code>@PathVariable</code>æ³¨è§£å°†æ–¹æ³•ä¸­çš„å‚æ•°ç»‘å®šåˆ°æ¨¡æ¿å˜é‡ä¸Šã€‚ç‰¹åˆ«åœ°ï¼Œ<code>@PathVariable</code>æ³¨è§£å…è®¸æˆ‘ä»¬ä½¿ç”¨valueæˆ–nameå±æ€§æ¥ç»™å‚æ•°å–ä¸€ä¸ªåˆ«åã€‚ä¸‹é¢æ˜¯ä½¿ç”¨æ­¤æ³¨è§£çš„ä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/users/&#123;id&#125;/roles/&#123;roleId&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Role <span class="title">getUserRole</span><span class="params">(@PathVariable <span class="keyword">long</span> id, @PathVariable <span class="keyword">long</span> roleId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿å˜é‡åéœ€è¦ä½¿ç”¨<code>{ }</code>è¿›è¡ŒåŒ…è£¹ï¼Œå¦‚æœæ–¹æ³•çš„å‚æ•°åä¸URIæ¨¡æ¿å˜é‡åä¸€è‡´ï¼Œåˆ™åœ¨<code>@PathVariable</code>ä¸­å°±å¯ä»¥çœç•¥åˆ«åçš„å®šä¹‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;reuqestbodyå’Œrequestparam&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#reuqestbodyå’Œrequestparam&quot;&gt;&lt;/a&gt; @ReuqestBodyå’Œ@RequestParam&lt;/h2&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ³¨
      
    
    </summary>
    
    
      <category term="å¼€å‘ç¬”è®°" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ+PicGo</title>
    <link href="https://nymrli.top/2021/12/29/%E4%BD%BF%E7%94%A8%E4%B8%83%E7%89%9B%E4%BA%91%E4%BD%9C%E5%9B%BE%E5%BA%8A-PicGo/"/>
    <id>https://nymrli.top/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/</id>
    <published>2021-12-29T13:48:37.000Z</published>
    <updated>2021-12-29T14:12:11.451Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è‡ªå·±åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œé€šè¿‡å›¾ç‰‡æ¥è¡¨è¾¾è‡ªå·±çš„æ€è·¯æ— ç–‘æ˜¯ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¹³å¸¸æˆ‘çš„ç¬”è®°éƒ½æ˜¯é€šè¿‡hexoç”Ÿæˆçš„ï¼Œå› æ­¤ä¿å­˜åœ¨æœ¬åœ°è·¯å¾„å³å¯ã€‚ä½†æ˜¯å¦‚æœæƒ³æŠŠæ–‡ç« å‘è¡¨åœ¨ç¬¬ä¸‰æ–¹çš„å¹³å°ä¸Šï¼Œé‚£ä¹ˆè¿™äº›ç›¸å¯¹è·¯å¾„çš„å›¾ç‰‡åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­å°±æ— æ³•è¢«æ£€ç´¢ï¼Œå› æ­¤å¦‚æœèƒ½åœ¨ä¸€ä¸ªå¤§å®¶éƒ½èƒ½è®¿é—®åˆ°çš„åœ°æ–¹å­˜æ”¾è¿™äº›å›¾ç‰‡ï¼Œå†ç»™å‡ºè¿™äº›åœ°æ–¹çš„é“¾æ¥æ—¶é‚£å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚è¦è¾¾åˆ°è¿™ä¸ªéœ€æ±‚ï¼Œåˆ™å°±éœ€è¦ä½¿ç”¨OSSå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p><p>è¿™è¾¹æˆ‘æ¨èçš„æ˜¯ä¸ƒç‰›äº‘ã€‚ä¸ƒç‰›äº‘åœ¨æ³¨å†Œè®¤è¯åæœ‰10Gæ°¸ä¹…å…è´¹ç©ºé—´ï¼Œæ¯æœˆ10Gå›½å†…å’Œ10Gå›½å¤–æµé‡ï¼Œé€Ÿåº¦ç›¸å½“å¿«ï¼Œä¸ƒç‰›äº‘æ˜¯å›½å†…ä¸“ä¸šCDNæœåŠ¡å•†ï¼Œæ’ä»¶æ”¯æŒæ¯”è¾ƒå¤šï¼Œæœ‰å…è´¹SSLè¯ä¹¦ï¼Œä½†httpsæµé‡æ”¶è´¹ã€‚åŒæ—¶ä¸ƒç‰›äº‘è¿˜ä¼šæä¾›30å¤©çš„æµ‹è¯•åŸŸåï¼Œä¸è¿‡è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸ƒç‰›äº‘30å¤©åä¼šå›æ”¶æµ‹è¯•åŸŸåï¼Œå¹¶ä¸”é€šè¿‡æµ‹è¯•åŸŸåå­˜å‚¨çš„æ–‡ä»¶ä¼šåœ¨30å¤©åä¸€èµ·è¢«æ€å‡ºï¼Œå› æ­¤æœ€å¥½è¿˜æ˜¯è¦ç»‘å®šè‡ªå·±çš„å·²å¤‡æ¡ˆçš„åŸŸåã€‚</p></blockquote><h1 id="ä¸ƒç‰›äº‘"><a class="markdownIt-Anchor" href="#ä¸ƒç‰›äº‘"></a> <a href="https://www.qiniu.com/" target="_blank" rel="noopener">ä¸ƒç‰›äº‘</a>åˆ›å»ºä¸é…ç½®</h1><h2 id="åˆ›å»ºç©ºé—´"><a class="markdownIt-Anchor" href="#åˆ›å»ºç©ºé—´"></a> åˆ›å»ºç©ºé—´</h2><p>å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥æ–°å»ºè‡ªå·±çš„å­˜å‚¨ç©ºé—´ï¼Œç‚¹å‡»ã€æ–°å»ºç©ºé—´ã€‘ï¼Œå¯¹ç©ºé—´è¿›è¡Œé…ç½®ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>å­˜å‚¨ç©ºé—´åç§°ä¸èƒ½é‡å¤ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ–°å»ºä¸€ä¸ªåç§°ä¸ºï¼šonestar-blog-img</li><li>å­˜å‚¨åŒºåŸŸé€‰æ‹©ä¸€ä¸ªç¦»ä½ è¿‘ç‚¹çš„ï¼Œæˆ‘é€‰çš„æ˜¯åä¸œï¼Œæ¯ä¸ªåœ°ç‚¹æœ‰ä¸ªç¼–å·çš„ï¼Œåé¢è¦ç”¨æ¥é…ç½®PicGoï¼Œè¿™é‡Œå…ˆè¯´ä¸€ä¸‹åŒºåŸŸå¯¹åº”ç¼–å·: åä¸œï¼šz0ï¼›ååŒ—ï¼šz1ï¼›åå—ï¼šz2ï¼šåŒ—ç¾ï¼šna0ï¼šä¸œå—äºšï¼šas0</li><li>è®¿é—®æ§åˆ¶é€‰æ‹©å…¬å¼€ï¼Œå› ä¸ºè¦ä½œä¸ºå¤–é“¾è¿›è¡Œè®¿é—®</li></ul><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E5%88%9B%E5%BB%BA%E7%A9%BA%E9%97%B4.png" alt="åˆ›å»ºç©ºé—´"></p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F.png" alt="åˆ›å»ºæˆåŠŸ"></p><h2 id="é…ç½®åŸŸåå¹¶ç»‘å®š"><a class="markdownIt-Anchor" href="#é…ç½®åŸŸåå¹¶ç»‘å®š"></a> é…ç½®åŸŸåå¹¶ç»‘å®š</h2><ol><li>ç‚¹å‡»&quot;+ç»‘å®šåŸŸå&quot;æŒ‰é’®</li></ol><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E7%BB%91%E5%AE%9A%E5%9F%9F%E5%90%8D.png" alt="ç»‘å®šåŸŸå"></p><p>2.å°±ä¼šè¿›å…¥å¦‚ä¸‹çš„æ·»åŠ åŸŸåé¡µé¢ï¼Œéœ€è¦åšçš„å°±æ˜¯å¡«å…¥ä¸€ä¸ªä¸‰çº§åŸŸåï¼Œå¦‚æˆ‘ç”³è¯·çš„äºŒçº§åŸŸåä¸ºnymrli.topï¼Œé‚£ä¹ˆè¿™è¾¹æˆ‘å¯ä»¥å†™<code>xxx.nymrli.top</code>ï¼Œè¿™ä¸ªxxxå°±æ˜¯nymrli.topä¸‹çš„å­åŸŸåï¼Œä½†æ˜¯è¿™ä¸ªæ¯•ç«Ÿæ˜¯æˆ‘ä»¬ä¸´æ—¶æƒ³å‡ºæ¥çš„ï¼Œå› æ­¤è¦è®©ä»–ç”Ÿæ•ˆçš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨DNSæœåŠ¡å•†é‚£è¾¹è¿›è¡Œé…ç½®ã€‚</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E6%B7%BB%E5%8A%A0%E5%9F%9F%E5%90%8D.png" alt="æ·»åŠ åŸŸå"></p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E7%82%B9%E5%87%BB%E9%85%8D%E7%BD%AECname.png" alt="ç‚¹å‡»é…ç½®Cname"></p><ol start="3"><li>æ¥ä¸‹æ¥å¼€å§‹é…ç½®CNAMEè§£æï¼Œç”±äºæˆ‘çš„åŸŸåè§£ææ˜¯åœ¨é˜¿é‡Œäº‘åšçš„ï¼Œå› æ­¤éœ€è¦åˆ°é˜¿é‡Œäº‘çš„åŸŸåç®¡ç†æ§åˆ¶å°æ·»åŠ è¿™ä¸ªCNAMEçš„è§£æ</li></ol><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/DNS%E8%AE%B0%E5%BD%95.png" alt="DNSè®°å½•"></p><p>æ·»åŠ å¥½CNAMEè®°å½•åç­‰å¾…ä¸€ä¼šè®©å…¶ç”Ÿæ•ˆåï¼Œå°±èƒ½åˆ°ä¸ƒç‰›äº‘çš„â€œåŸŸåç®¡ç†â€é¡µé¢æŸ¥çœ‹çŠ¶æ€å•¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™è¾¹çš„â€œçŠ¶æ€â€æ˜¾ç¤ºæˆåŠŸäº†</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E6%9F%A5%E7%9C%8B%E5%9F%9F%E5%90%8D%E6%98%AF%E5%90%A6%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F%E6%88%90%E5%8A%9F.png" alt="æŸ¥çœ‹åŸŸåæ˜¯å¦é…ç½®æˆåŠŸæˆåŠŸ"></p><h1 id="picgoå›¾åºŠè½¯ä»¶"><a class="markdownIt-Anchor" href="#picgoå›¾åºŠè½¯ä»¶"></a> <a href="https://github.com/Molunerfinn/PicGo/releases/tag/v2.3.0" target="_blank" rel="noopener">Picgoå›¾åºŠè½¯ä»¶</a>é…ç½®</h1><p>è‡ªå¸¦å…è´¹çš„SM.MSå›¾åºŠé…ç½®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ä½†æ˜¯ç”¨åˆ«äººçš„é…ç½®ï¼Œå åˆ«äººçš„èµ„æºæ¯•ç«Ÿä¸å¤ªå¥½ï¼Œå®¹æ˜“è¶…é¢ï¼Œè€Œä¸”å®‰å…¨æ€§ä¹Ÿä¸é«˜ã€‚å› æ­¤é…ç½®è‡ªå·±çš„å­˜å‚¨APIï¼Œè¿™è¾¹ä½¿ç”¨ä¸Šè¿°é…ç½®å¥½çš„ä¸ƒç‰›äº‘ã€‚</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/picgo%E9%85%8D%E7%BD%AE.png" alt="picgoé…ç½®"></p><ul><li>accessKeyå’ŒSecretKeyå¯ä»¥ç‚¹å‡»å¤´åƒåˆ°â€œä¸ªäººä¸­å¿ƒâ€å»æŸ¥çœ‹å¹¶å¤åˆ¶è¿›å»</li><li>å­˜å‚¨ç©ºé—´åå°±æ˜¯ä¸€å¼€å§‹åˆ›å»ºç©ºé—´çš„åå­—</li><li>ç½‘å€çš„è¯å°±æ˜¯è‡ªå·±ç»‘å®šçš„ä¸‰çº§åŸŸå</li><li>è¿™è¾¹æ¯”è¾ƒå®¹æ˜“å¡«é”™çš„æ˜¯å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”çš„å…¶å®æ˜¯åå—ã€åä¸œâ€¦â€¦ä½†éœ€è¦å¡«ç¼–å·ï¼Œè¿™è¾¹ç¼–å·å…³ç³»å¦‚ä¸‹ï¼š<ul><li>z0ï¼›ååŒ—ï¼šz1ï¼›åå—ï¼šz2ï¼šåŒ—ç¾ï¼šna0ï¼šä¸œå—äºšï¼šas0</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;è‡ªå·±åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œé€šè¿‡å›¾ç‰‡æ¥è¡¨è¾¾è‡ªå·±çš„æ€è·¯æ— ç–‘æ˜¯ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¹³å¸¸æˆ‘çš„ç¬”è®°éƒ½æ˜¯é€šè¿‡hexoç”Ÿæˆçš„ï¼Œå› æ­¤ä¿å­˜åœ¨æœ¬åœ°è·¯å¾„å³å¯ã€‚ä½†æ˜¯å¦‚æœæƒ³æŠŠæ–‡ç« å‘è¡¨åœ¨ç¬¬ä¸‰æ–¹çš„å¹³å°ä¸Šï¼Œé‚£ä¹ˆè¿™äº›ç›¸å¯¹è·¯å¾„çš„å›¾ç‰‡åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­å°±æ— æ³•è¢«æ£€ç´¢ï¼Œå› æ­¤å¦‚æœèƒ½åœ¨ä¸€ä¸ªå¤§å®¶éƒ½èƒ½è®¿é—®åˆ°çš„åœ°
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¼€å‘æ–¹å‘-æŠ€æœ¯æ ˆ</title>
    <link href="https://nymrli.top/2021/12/28/%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91-%E6%8A%80%E6%9C%AF%E6%A0%88/"/>
    <id>https://nymrli.top/2021/12/28/å¼€å‘æ–¹å‘-æŠ€æœ¯æ ˆ/</id>
    <published>2021-12-28T13:02:43.000Z</published>
    <updated>2021-12-28T16:10:43.781Z</updated>
    
    <content type="html"><![CDATA[<h1 id="cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶"><a class="markdownIt-Anchor" href="#cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶"></a> Cloud å¾®æœåŠ¡å…¨å®¶æ¡¶</h1><blockquote><p>å¾®æœåŠ¡å¼€å‘çš„ä¸»æµæŠ€æœ¯æ ˆ</p></blockquote><ul><li>æœåŠ¡æ³¨å†Œä¸­å¿ƒ<ul><li>:error:eureka åœæ­¢æ›´æ–°</li><li>âŒconsul</li><li>zookeeper</li><li>â­ï¸nacos</li></ul></li><li>æœåŠ¡è´Ÿè½½ä¸è°ƒç”¨<ul><li>âŒ netflix oss ribbon ==&gt; spring cloud loadbalance</li><li>netflix feign ==&gt; Spring cloud OpenFeign</li></ul></li><li>å®¹é‡é™æµ(ç†”æ–­)<ul><li>âŒhystrix: æœ€å…ˆçš„è€å¤§å“¥</li><li>resilience4jï¼šå›½å¤–ä½¿ç”¨è¾ƒå¤š</li><li>â­ï¸spring cloud alibaba sentinel</li></ul></li><li>é…ç½®ä¸­å¿ƒ<ul><li>âŒspring cloud config</li><li>æºç¨‹: apollo</li><li>spring cloud alibaba nacos</li></ul></li><li>æœåŠ¡å¼€å‘<ul><li>spring boot</li></ul></li><li>æµé‡ç›‘æ§</li><li>æœåŠ¡æ€»çº¿:<ul><li>âŒspring cloud bus</li><li>spring cloud alibaba nacos</li></ul></li><li>æœåŠ¡æ²»ç†</li><li>é“¾è·¯è¿½è¸ª<ul><li>spring cloud sleuth</li></ul></li><li>æœåŠ¡ç½‘å…³<ul><li>âŒ(netflix) zuul</li><li>zuul2: èƒæ­»è…¹ä¸­</li><li>â­ï¸spring cloud gateway</li></ul></li><li>matricsï¼ˆæŒ‡æ ‡ï¼‰ç›‘æ§ï¼š<ul><li>kairosDB</li></ul></li><li>æ—¥å¿—ç›‘æ§ï¼š<ul><li>ELK</li></ul></li><li>å¥åº·æ£€æŸ¥å’Œå‘Šè­¦ï¼š<ul><li>zalando</li><li>zmon</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶&quot;&gt;&lt;/a&gt; Cloud å¾®æœåŠ¡å…¨å®¶æ¡¶&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;å¾®æœåŠ¡å¼€å‘çš„ä¸»æµæŠ€æœ¯æ ˆ&lt;/p&gt;
&lt;/blockquote&gt;
      
    
    </summary>
    
    
      <category term="å¼€å‘" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>å¼€å‘è¿‡ç¨‹ä¸­Mysql APIè®°å½•</title>
    <link href="https://nymrli.top/2021/12/26/%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADMysql-API%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2021/12/26/å¼€å‘è¿‡ç¨‹ä¸­Mysql-APIè®°å½•/</id>
    <published>2021-12-26T12:52:57.000Z</published>
    <updated>2021-12-26T13:27:57.967Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ—¶é—´æ“ä½œ"><a class="markdownIt-Anchor" href="#æ—¶é—´æ“ä½œ"></a> æ—¶é—´æ“ä½œ</h1><h2 id="time_to_sec"><a class="markdownIt-Anchor" href="#time_to_sec"></a> TIME_TO_SEC</h2><blockquote><p><a href="http://c.biancheng.net/mysql/" target="_blank" rel="noopener">MySQL</a> TIME_TO_SEC(time) å‡½æ•°è¿”å›å°†<strong>å‚æ•° time è½¬æ¢ä¸ºç§’æ•°çš„æ—¶é—´å€¼</strong>ï¼Œè½¬æ¢å…¬å¼ä¸ºâ€œå°æ—¶ Ã—3600+ åˆ†é’Ÿ Ã—60+ ç§’â€ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT TIME_TO_SEC(&apos;15:15:15&apos;);</span><br><span class="line">+-------------------------+</span><br><span class="line">| TIME_TO_SEC(&apos;15:15:15&apos;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                   54915 |</span><br><span class="line">+-------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select TIME_TO_SEC(&quot;2021-02-02 04:04:04&quot;);-- åªä¼šè€ƒè™‘æ—¶åˆ†ç§’ï¼Œä¸ä¼šè€ƒè™‘å¹´æœˆæ—¥</span><br><span class="line">+-------------------------+</span><br><span class="line">| TIME_TO_SEC(&quot;2021-02-02 04:04:04&quot;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                   14644 |</span><br><span class="line">+-------------------------+</span><br></pre></td></tr></table></figure><p>å…·ä½“å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT SEC_TO_TIME(TIME_TO_SEC(æ—¶é—´å­—æ®µ)- TIME_TO_SEC(æ—¶é—´å­—æ®µ)%(15*60)) as intervals from tablename</span><br><span class="line">group by intervals</span><br></pre></td></tr></table></figure><h2 id="sec_to_time"><a class="markdownIt-Anchor" href="#sec_to_time"></a> SEC_TO_TIME</h2><blockquote><p>è¿”å›å°†å‚æ•° seconds è½¬æ¢ä¸ºå°æ—¶ã€åˆ†é’Ÿå’Œç§’æ•°çš„æ—¶é—´å€¼ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT SEC_TO_TIME(&apos;54925&apos;);</span><br><span class="line">+----------------------+</span><br><span class="line">| SEC_TO_TIME(&apos;54925&apos;) |</span><br><span class="line">+----------------------+</span><br><span class="line">| 15:15:25             |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="date_format"><a class="markdownIt-Anchor" href="#date_format"></a> <a href="https://www.w3school.com.cn/sql/func_date_format.asp" target="_blank" rel="noopener">DATE_FORMAT</a></h2><blockquote><p>ç”¨äºä»¥ä¸åŒçš„æ ¼å¼æ˜¾ç¤ºæ—¥æœŸ/æ—¶é—´æ•°æ®: <code>DATE_FORMAT(date, format)</code></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DATE_FORMAT(NOW(),&apos;%b %d %Y %h:%i %p&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%m-%d-%Y&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%d %b %y&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%d %b %Y %T:%f&apos;)</span><br><span class="line"></span><br><span class="line">Dec 29 2008 11:45 PM</span><br><span class="line">12-29-2008</span><br><span class="line">29 Dec 08</span><br><span class="line">29 Dec 2008 16:25:46.635</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ—¶é—´æ“ä½œ&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ—¶é—´æ“ä½œ&quot;&gt;&lt;/a&gt; æ—¶é—´æ“ä½œ&lt;/h1&gt;
&lt;h2 id=&quot;time_to_sec&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#time_to_sec&quot;
      
    
    </summary>
    
    
      <category term="Mysql" scheme="https://nymrli.top/tags/Mysql/"/>
    
      <category term="å¼€å‘è®°å½•" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>è½¯ä»¶æ¶æ„è¯¾ç¨‹å­¦ä¹ ç¬”è®°</title>
    <link href="https://nymrli.top/2021/12/12/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://nymrli.top/2021/12/12/è½¯ä»¶æ¶æ„è¯¾ç¨‹å­¦ä¹ ç¬”è®°/</id>
    <published>2021-12-12T06:44:53.000Z</published>
    <updated>2021-12-13T14:51:58.689Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æœ¯è¯­"><a class="markdownIt-Anchor" href="#æœ¯è¯­"></a> æœ¯è¯­</h1><p>â€“å¾®æœåŠ¡</p><p>â€“äº‘åŒ–</p><p>â€“åˆ†å¸ƒå¼</p><p>â€“é«˜å¹¶å‘</p><p>â€“é«˜å¯ç”¨</p><h2 id="æ¶æ„è§’è‰²"><a class="markdownIt-Anchor" href="#æ¶æ„è§’è‰²"></a> æ¶æ„è§’è‰²</h2><ul><li>æ¢ç´¢è€…</li><li>è®¾è®¡å¸ˆ</li><li>å€¡å¯¼äºº</li></ul><h2 id="åˆ°åº•å¦‚ä½•åŒºåˆ†ä»€ä¹ˆæ˜¯æ¶æ„-æ¡†æ¶-æ¨¡å¼å’Œå¹³å°"><a class="markdownIt-Anchor" href="#åˆ°åº•å¦‚ä½•åŒºåˆ†ä»€ä¹ˆæ˜¯æ¶æ„-æ¡†æ¶-æ¨¡å¼å’Œå¹³å°"></a> åˆ°åº•å¦‚ä½•åŒºåˆ†ä»€ä¹ˆæ˜¯æ¶æ„ã€æ¡†æ¶ã€æ¨¡å¼å’Œå¹³å° ï¼Ÿ</h2><p>è®¾è®¡æ¨¡å¼&lt;æ¡†æ¶&lt;æ¶æ„&lt;å¹³å°ï¼Œä»å¤ç”¨è§’åº¦è®²ï¼Œè®¾è®¡æ¨¡å¼æ˜¯ä»£ç çº§å¤ç”¨ã€æ¡†æ¶æ˜¯æ¨¡å—çº§å¤ç”¨ã€æ¶æ„æ˜¯ç³»ç»Ÿçº§å¤ç”¨ã€å¹³å°æ˜¯ä¼ä¸šåº”ç”¨çº§å¤ç”¨ã€‚</p><p>æ¨¡å¼:åˆ†ä¸ºä»£ç æ¨¡å¼ã€è®¾è®¡æ¨¡å¼ã€æ¡†æ¶æ¨¡å¼è¿™äº›</p><ul><li>è®¾è®¡æ¨¡å¼æœ‰ä¸åŒçš„åˆ†ç±»ï¼Œå¦‚ä¸‹<ul><li>åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå¦‚å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰æ¨¡å¼ã€æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰æ¨¡å¼ã€åŸå‹ï¼ˆPrototypeï¼‰æ¨¡å¼ã€å•ä¾‹ï¼ˆSingletonï¼‰æ¨¡å¼ï¼Œå»ºé€ ï¼ˆBuilderï¼‰æ¨¡å¼ç­‰</li><li>ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå¦‚åˆæˆï¼ˆCompositeï¼‰æ¨¡å¼ã€è£…é¥°ï¼ˆDecoratorï¼‰æ¨¡å¼ç­‰</li></ul></li><li>æ¡†æ¶ï¼šä¹Ÿæœ‰å«æ„æ¶çš„ï¼Œä¸€èˆ¬ç­‰åŒäºï¼­ï¼¶ï¼£ã€MVPã€MVVMè¿™ç§ã€‚</li></ul><p>ä¸¾ä¸ªæ —å­ï¼Œå†œæ‘è¦ç›–æˆ¿ï¼Œæ¶æ„å°±æ˜¯ï¼šä½ å¾—è€ƒè™‘è‡ªå·±çš„ç»æµå®åŠ›ã€å–œæ¬¢ä»€ä¹ˆæ ·çš„æˆ¿å­ã€æœ‰ä»€ä¹ˆè¦æ±‚ï¼Œé€‰å“ªä¸ªé è°±çš„æ–½å·¥é˜Ÿã€‚é€‰å¥½äº†ä¹‹åï¼Œæ¯”å¦‚è¯´è¦ç›–æ¥¼æˆ¿ï¼Œé‚£ä¹ˆæ¡†æ¶å°±æ˜¯æ–½å·¥é˜Ÿçš„æ¨¡å¼ï¼Œæœ‰çš„æ–½å·¥é˜Ÿå…ˆè¿™æ ·åšå†é‚£æ ·åšï¼Œè€Œæœ‰çš„å´ç›¸åï¼Œåæ­£èƒ½æŠŠæ¥¼ç»™ä½ ç›–èµ·æ¥å°±è¡Œã€‚æ¨¡å¼å°±æ˜¯å±€éƒ¨çš„å…·ä½“å®ç°ï¼Œæ¯”å¦‚è¯´é—¨è¿™æ ·å®‰ã€çª—æˆ·è¿™æ ·ã€‚</p><h2 id="ç›®æ ‡"><a class="markdownIt-Anchor" href="#ç›®æ ‡"></a> ç›®æ ‡</h2><p>è¾¾åˆ°æœ€ä½³çš„åŠŸèƒ½å’ŒæœåŠ¡è¡¨ç°</p><p>èµ„æºåˆ©ç”¨ç‡</p><p>çµæ´»çš„å¼€å‘ã€éƒ¨ç½²ã€è¿è¡Œã€ç»´æŠ¤å’Œåˆ›æ–°</p><p>å®‰å…¨æ€§ã€ç¨³å®šæ€§ã€å¯é æ€§ç­‰è´¨é‡å±æ€§</p><h2 id="å½±å“ç»“æ„çš„å› ç´ "><a class="markdownIt-Anchor" href="#å½±å“ç»“æ„çš„å› ç´ "></a> å½±å“ç»“æ„çš„å› ç´ </h2><p>åˆ©ç›Šç›¸å…³è€…</p><p>å¼€å‘å›¢é˜Ÿ</p><p>æ¶æ„å¸ˆ</p><p>ç¯å¢ƒå…¶ä»–å› ç´ ï¼Œæ¯”å¦‚å†²çªï¼Œéšæ€§éœ€æ±‚</p><h2 id="typical-design-trade-offs"><a class="markdownIt-Anchor" href="#typical-design-trade-offs"></a> <strong>Typical Design Trade-offs</strong></h2><p>åŠŸèƒ½å’Œå¯ç”¨æ€§</p><p>æ€§èƒ½å’Œå¯ä¿®æ”¹æ€§</p><p>æˆæœ¬ä¸é²æ£’æ€§æ•ˆç‡å’Œå¯ç§»æ¤æ€§</p><p>å¿«é€Ÿå¼€å‘vs.åŠŸèƒ½æ€§</p><p>æˆæœ¬ä¸å¯é‡ç”¨æ€§</p><p>å‘åå…¼å®¹æ€§ä¸å¯è¯»æ€§</p><p>æ¶æ„ï¼šåšä¸€ä¸ªåŸºå‡†è®©è½¯ä»¶èƒ½å¤Ÿä¸æ–­å®Œå–„ã€‚æ¶æ„æœ¬èº«åœ¨åšçš„äº‹æƒ…å°±æ˜¯è¡”æ¥è½¯ä»¶ä»æ— åºçš„éœ€æ±‚å˜æˆæœ‰ç»„ç»‡ã€æœ‰åºçš„è½¯ä»¶è®¾è®¡å®ç°çš„ä¸­é—´è½¬æ¢ç¯èŠ‚ã€‚==&gt;æ³¨æ„æ¶æ„çš„å¾ˆå¤šå…³æ³¨ç‚¹éƒ½æ˜¯æ¥è‡ªäºæ¶æ„æœ¬èº«é©±åŠ¨çš„å› ç´ å’ŒéåŠŸèƒ½æ€§çš„ç‚¹ï¼ˆarchitectural driverï¼‰ï¼šæ€§èƒ½ã€ä½¿ç”¨ä¸­çš„é«˜å¯ç”¨ã€</p><p>è´¨é‡å±æ€§ï¼š</p><ul><li>æ˜“ç”¨æ€§é«˜â€”â€”ä¸€ä¸ªä¸­ç­‰ä¸šåŠ¡æ°´å¹³çš„å‚¨è“„æ‰€äººå‘˜èƒ½å¤Ÿåœ¨5ä¸ªå·¥ä½œæ—¥å†…ç†Ÿç»ƒæŒæ¡æœ¬ç³»ç»Ÿ80%åŠŸèƒ½</li></ul><p>é—®é¢˜ï¼Ÿå¯ä¿®æ”¹æ€§å’Œæ€§èƒ½ï¼Œæ˜¯å¦å¯ä»¥å¯ä»¥åŒæ—¶æ»¡è¶³ï¼Ÿ A: è¿™ä¸¤ä¸ªå¾ˆå®¹æ˜“å†²çª</p><p>è¿‘å‡ å¹´çš„æ¯•ä¸šè®ºæ–‡â€”â€”æŠŠåŠŸèƒ½å®ç°äº†ï¼Œä½†éåŠŸèƒ½æ€§éœ€æ±‚å°±åªæ˜¯åˆ—äº†å‡ ä¸ªç‚¹ã€‚éåŠŸèƒ½æ€§éœ€æ±‚ååº”äº†è¿™ä¸ªç³»ç»Ÿå…³æ³¨çš„å“ªäº›æŒ‡æ ‡ç‚¹ã€‚åŒæ—¶è¦è€ƒè™‘éåŠŸèƒ½æ€§éœ€æ±‚ä¹‹é—´çš„ä¼˜å…ˆçº§ï¼Œè¦ä½“ç°äº†å“ªä¸ªç›®æ ‡æ˜¯é«˜çš„ï¼Œæ˜¯ä½çš„ã€‚è¿™ç§ä¼˜å…ˆçº§çš„ï¼Œ</p><p>å•ç‚¹â€“&gt;åˆ†å¸ƒå¼==ã€‹é›†ç¾¤åŒ–çš„ï¼Œé›†ç¾¤åŒ–æœåŠ¡çš„ä¸€äº›ç‚¹å°±æ…¢æ…¢ä¼šå½¢æˆä¸€ä¸ªé«˜å¯ç”¨çš„æ¶æ„ï¼Œæ¯”å¦‚ä¸»å¤‡ã€çƒ­å¤‡ã€æ¸©å¤‡ã€å†·å¤‡ï¼Œè¿˜æœ‰ä¸€äº›é€šè¿‡é›†ç¾¤åŒ–çš„æ–¹å¼æ¥å®ç°çš„é«˜å¯ç”¨ï¼Œæ¯”å¦‚å¤šæ´»ã€ä¸¤åœ°ä¸‰æ€»çº¿ã€‚</p><p>å¤šå®ä¾‹åŒ–åº”ç”¨ï¼šæé«˜å†—ä½™æ•°æ®è™½ç„¶æé«˜äº†å¯ç”¨æ€§ä½†æ˜¯å¢åŠ äº†å®‰å…¨æ€§çš„å½±å“ã€åº”ç”¨å±‚ç®¡ç†å®ç°æ–¹å¼ï¼šç»Ÿä¸€èº«ä»½è®¤è¯ï¼ˆç»Ÿä¸€çš„è®¤è¯ä¸­å¿ƒï¼Œé¿å…äº†æ¯ä¸ªç‚¹çš„è®¤è¯ï¼‰ï¼Œæƒé™å±‚ã€è®¤è¯å±‚ã€ç½‘å…³å±‚</p><p>ç»„ä»¶é—´ä¿¡æ¯é€šä¿¡æ¥æ¢æ´»ï¼Œä¿è¯ç»„ä»¶çš„å¯ç”¨æ€§</p><p>æ€§èƒ½ï¼š</p><ul><li>ä¼˜å…ˆçº§è°ƒåº¦ï¼Œæœ‰ä¼˜å…ˆèƒ½æ‰§è¡Œ</li><li>æœ‰è¶³å¤Ÿçš„èµ„æº</li></ul><p>å®‰å…¨</p><ul><li>æ‹¦æˆªè¯·æ±‚</li><li>åŠ å¯†ã€è®¤è¯</li></ul><p>å¤§å‹å•†ä¸šé“¶è¡Œçš„ä¸»è¦ç‰¹å¾ï¼š</p><ul><li>24å°æ—¶ä¸é—´æ–­çš„é«˜æ•ˆæ ¸å¿ƒé“¶è¡Œç³»ç»Ÿ</li><li>è·¨æ¸ é“ã€è·¨ä¸šåŠ¡çº¿ã€è·¨åŒºåŸŸçš„é›†æˆæœåŠ¡èƒ½åŠ›</li><li>é›†å›¢ä¸€ä½“åŒ–æ¶æ„æ¨¡å¼ä¸‹çš„å·®å¼‚åŒ–ã€ä¸ªæ€§åŒ–æ”¯æŒèƒ½åŠ›</li></ul><p>æ¯ä¸€å±‚éƒ½æœ‰ä¸åŒçš„å…³æ³¨ç‚¹ï¼Œæ¯ä¸€ä¸ªå…³æ³¨ç‚¹éƒ½æœ‰å„è‡ªçš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚æ¥å…¥å±‚æœ‰é«˜å¹¶å‘çš„éœ€æ±‚ï¼Œä¸šåŠ¡å¤„ç†å±‚æœ‰å®‰å…¨å¯é çš„å»æ±‚ã€‚å°†å…³æ³¨ç‚¹åˆ†å±‚ä»¥åã€‚</p><p>ä¼˜åŠ¿ï¼šæ¯ä¸€ä¸ªå±‚èƒ½çœ‹åœ°æ›´æ¸…æ™°ï¼Œå¹¶ä¸”æ›´å¥½åœ°å…³æ³¨è‡ªèº«åœ°å¤„ç†æ–¹å¼ã€‚</p><p>åŠ£åŠ¿ï¼šå±‚æ¬¡å±‚æ¬¡äº¤äº’è¿‡ç¨‹ä¸­åœ°trade-offé—®é¢˜</p><p>ä»qualityåœ°è§’åº¦è€ƒè™‘ï¼Œåˆ†å¸ƒå¼æ˜¯åœ¨è§£å†³é«˜å¹¶å‘çš„è®¿é—®ï¼Œå®ç°ç³»ç»Ÿæ›´å¥½çš„åº”ç”¨æ€§ä¸äº¤äº’æ€§</p><p>æ ¸å¿ƒé“¶è¡Œç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚</p><ul><li>è§„æ¨¡</li><li>æ€§èƒ½</li><li>å®‰å…¨æ€§</li><li>å¯ç”¨æ€§å’Œå¼¹æ€§</li><li>è¿ç»´ç®¡ç†</li></ul><h2 id="ç”¨æˆ·æ¥å…¥å¹³å°æŠ€æœ¯æ¶æ„"><a class="markdownIt-Anchor" href="#ç”¨æˆ·æ¥å…¥å¹³å°æŠ€æœ¯æ¶æ„"></a> ç”¨æˆ·æ¥å…¥å¹³å°æŠ€æœ¯æ¶æ„</h2><p>æ‰€æœ‰æ¥å…¥çš„æ¨¡å—éƒ½ä¸æ­¢ä¸€ä¸ªï¼Œä¸ç®¡æ˜¯tcpã€httpã€è¿˜æ˜¯èº«ä»½è®¤è¯çš„è¿˜æ˜¯å¯è§†åŒ–ç®¡ç†çš„ï¼Œéƒ½æ˜¯é€šè¿‡å¢åŠ å¤šä¸ªå®ä¾‹æ¥å®ç°é«˜å¯ç”¨ã€‚==&gt;ä¸»å¤‡ã€å¤šæ´»</p><p>åº”ç”¨å¹³å°-&gt;åº”ç”¨ç³»ç»Ÿ-&gt;ç³»ç»Ÿè¿›ç¨‹-&gt;æŠ€æœ¯æ¨¡å—</p><p>å…³é”®æŠ€æœ¯ç»„ä»¶æ¨¡å—ï¼š</p><ul><li>æ•°æ®è®¿é—®æ¥å£</li><li>åå°è¿›ç¨‹è¿è¡Œæ¨¡å‹</li><li>å®¹é”™å¹³å°æ¶æ„</li><li>æ•°æ®å¯è§†åŒ–</li><li>å…¬å…±æœåŠ¡æ¡†æ¶<ul><li>ç›‘æ§ç®¡ç†<ul><li>ç»Ÿä¸€çš„æ•°æ®æ ¼å¼</li><li>ç›‘æ§æ•°æ®å®šä¹‰</li><li>ç»Ÿä¸€å±•ç¤º</li></ul></li><li>æ—¥å¿—ç®¡ç†</li><li>æ—¶é—´ç®¡ç†</li></ul></li><li>æ’®åˆåº”ç”¨æ¡†æ¶</li><li>è¡Œæƒ…å¤„ç†åº”ç”¨æ¡†æ¶</li><li>äº¤æ˜“æ§åˆ¶æ¶æ„</li></ul><p>å¤§å‹ç½‘ç«™ç³»ç»Ÿç‰¹ç‚¹<br>é«˜å¹¶å‘ï¼Œå¤§æµé‡<br>é«˜å¯ç”¨<br>ç”¨æˆ·åˆ†å¸ƒå¹¿æ³›<br>éœ€æ±‚å¿«é€Ÿå˜æ›´<br>å‘å¸ƒé¢‘ç¹<br>æµ·é‡æ•°æ®<br>å®‰å…¨ç¯å¢ƒæ¶åŠ£<br>æ¸è¿›å¼å‘å±•</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æœ¯è¯­&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æœ¯è¯­&quot;&gt;&lt;/a&gt; æœ¯è¯­&lt;/h1&gt;
&lt;p&gt;â€“å¾®æœåŠ¡&lt;/p&gt;
&lt;p&gt;â€“äº‘åŒ–&lt;/p&gt;
&lt;p&gt;â€“åˆ†å¸ƒå¼&lt;/p&gt;
&lt;p&gt;â€“é«˜å¹¶å‘&lt;/p&gt;
&lt;p&gt;â€“é«˜å¯ç”¨&lt;/p&gt;
&lt;h2 id=&quot;æ¶æ„è§’è‰²&quot;&gt;&lt;a
      
    
    </summary>
    
    
      <category term="è®¡ç®—æœºåŸºç¡€çŸ¥è¯†" scheme="https://nymrli.top/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="Zju" scheme="https://nymrli.top/tags/Zju/"/>
    
  </entry>
  
  <entry>
    <title>åˆ›å»ºVueå·¥ç¨‹ï¼ˆåŒ…å«Vue2å’ŒVue3ï¼‰</title>
    <link href="https://nymrli.top/2021/12/08/%E5%88%9B%E5%BB%BAVue%E5%B7%A5%E7%A8%8B%EF%BC%88%E5%8C%85%E5%90%ABVue2%E5%92%8CVue3%EF%BC%89/"/>
    <id>https://nymrli.top/2021/12/08/åˆ›å»ºVueå·¥ç¨‹ï¼ˆåŒ…å«Vue2å’ŒVue3ï¼‰/</id>
    <published>2021-12-08T08:28:19.000Z</published>
    <updated>2021-12-08T08:28:51.443Z</updated>
    
    <content type="html"><![CDATA[<h2 id="vuecli-init"><a class="markdownIt-Anchor" href="#vuecli-init"></a> @vue/cli-init</h2><blockquote><p><code>vue init</code> æ˜¯vue-cli2.xçš„åˆå§‹åŒ–æ–¹å¼</p></blockquote><ul><li><code>vue init</code> ï¼š éœ€è¦<code>npm i -g @vue/cli-init</code><ul><li><code>vue init webpack [project-name]</code>, webpackä¸ºæ¨¡æ¿<code>&lt;generate a project from a remote template&gt;</code>ï¼Œç„¶åæŒ‰ç…§äº¤äº’ä¿¡æ¯æç¤ºè¾“å…¥å³å¯å®Œæˆå·¥ç¨‹åˆ›å»º</li><li>initåˆ›å»ºå·¥ç¨‹æ—¶ï¼Œäº¤äº’ä¿¡æ¯ä¸­æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯é€‰æ‹©åŒ…ç®¡ç†å·¥å…·ï¼š npmã€yarnï¼Œä¸¤è€…<a href="#%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7">è§</a></li></ul></li></ul><h2 id="vuecli"><a class="markdownIt-Anchor" href="#vuecli"></a> @vue/cli</h2><blockquote><p>ä¼šè®©é€‰æ‹©Vue2è¿˜æ˜¯Vue3</p></blockquote><ul><li><code>vue create router_project</code>: éœ€è¦<code>npm install -g @vue/cli</code></li><li><code>vue ui</code>é€šè¿‡UIåˆ›å»ºï¼š éœ€è¦<code>npm install -g @vue/cli</code><ul><li><code>vue create [project-name]</code></li></ul></li></ul><p>æ³¨ï¼šç»æµ‹è¯•ï¼Œ<code>Vue CLI v4.5.15</code>ä¼šæç¤ºé€‰æ‹©yarnè¿˜æ˜¯npmï¼›<code>@vue/cli 4.5.13</code>æ²¡æç¤º==&gt;åæ¥å‘ç°è²Œä¼¼æ˜¯å¹³å°çš„åŒºåˆ«ï¼Œlinuxä¸Šä¼šæç¤ºé€‰æ‹©ï¼Œwinä¸Šé»˜è®¤æ˜¯yarn</p><p>Vue CLI çš„åŒ…åç§°ç”±vue-cliå·²ç»æ”¹æˆäº†@vue/cliï¼Œå¦‚æœé€šè¿‡vue-cliæ¥æ„å»ºVue3é¡¹ç›®åˆ™éœ€è¦é€šè¿‡ <code>npm uninstall vue-cli -g</code> æˆ– <code>yarn global remove vue-cli</code> å¸è½½å®ƒï¼Œç„¶åå®‰è£…@vue/cliï¼Œå¹¶ä¸”@vue/cliå®‰è£…å¥½åï¼Œå¦‚æœä¸å®‰è£…yarnï¼Œé‚£ä¹ˆåœ¨vue createåˆ›å»ºçš„æ—¶å€™æŠ¥é”™<code>ERROR Error: spawn yarn ENOENT</code></p><h2 id="npm-init-vite-app-hello-vue"><a class="markdownIt-Anchor" href="#npm-init-vite-app-hello-vue"></a> <code>npm init vite-app hello-vue</code></h2><ul><li><blockquote><p><a href="https://so.csdn.net/so/search?from=pc_blog_highlight&amp;q=Vue" target="_blank" rel="noopener">Vue</a>3åˆšå‘å¸ƒä¸ä¹…ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­æ¨èçš„åˆ›å»ºæ–¹æ³•ä¹‹ä¸€å°±æ˜¯é€šè¿‡è„šæ‰‹æ¶Viteæ¥åˆ›å»ºä¸€ä¸ªvue3é¡¹ç›®</p><p>éœ€è¦å®‰è£…<code>create-vite-app</code></p></blockquote><ul><li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ npm init vite-app vue3-vite</span><br><span class="line">Scaffolding project <span class="keyword">in</span> F:\Documents\HBuilderProjects\vue3-vite...</span><br><span class="line">Done. Now run:</span><br><span class="line">$ <span class="built_in">cd</span> vue3-vite</span><br><span class="line">$ npm install (or `yarn`)</span><br><span class="line">$ npm run dev (or `yarn dev`)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ—¶éœ€è¦è¿›å…¥é¡¹ç›®ç›®å½•åï¼Œé‡Œé¢æ²¡æœ‰<code>package-lock</code>æˆ–è€…<code>yarn.loca</code>ï¼Œè€Œæ˜¯éœ€è¦è‡ªå·±ä¸»åŠ¨é€‰æ‹©åŒ…ç®¡ç†å·¥å…·è¿›è¡Œå®‰è£…ä¾èµ–çš„ï¼›<code>vue create</code>å’Œ<code>vue init</code>çš„ä¸éœ€è¦å¯ä»¥ç›´æ¥è¿è¡Œ</p></li></ul></li></ul><h2 id="vitejsapp"><a class="markdownIt-Anchor" href="#vitejsapp"></a> @vitejs/app</h2><ul><li><code>npm init @vitejs/app</code>ç„¶åé€‰æ‹©projectçš„æ¡†æ¶</li></ul><p>æ³¨ï¼š2æ—¢å¯ä»¥åˆ›å»ºVue2ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºvue3ï¼›3åªèƒ½åˆ›å»ºvue3ï¼›åœ¨åˆ›å»ºé€Ÿåº¦ä¸Šï¼Œæ³•3æ¯”æ³•2å¿«ä¸Šå¾ˆå¤š</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;vuecli-init&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#vuecli-init&quot;&gt;&lt;/a&gt; @vue/cli-init&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;vue init&lt;/code&gt; æ˜¯vue-cli
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://nymrli.top/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Vue" scheme="https://nymrli.top/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>å‰åç«¯-å®ç°ä¸Šä¼ å’Œä¸‹è½½</title>
    <link href="https://nymrli.top/2021/12/05/%E5%89%8D%E5%90%8E%E7%AB%AF-%E5%AE%9E%E7%8E%B0%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/"/>
    <id>https://nymrli.top/2021/12/05/å‰åç«¯-å®ç°ä¸Šä¼ å’Œä¸‹è½½/</id>
    <published>2021-12-05T02:56:46.000Z</published>
    <updated>2021-12-05T04:06:54.873Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰ç«¯"><a class="markdownIt-Anchor" href="#å‰ç«¯"></a> å‰ç«¯</h1><h2 id="ä¸Šä¼ "><a class="markdownIt-Anchor" href="#ä¸Šä¼ "></a> ä¸Šä¼ </h2><p>å‰ç«¯ä¸Šä¼ ä¸»è¦æ˜¯æŠŠæ–‡ä»¶å‘é€è¿‡å»ï¼Œä¸€èˆ¬é‡‡ç”¨è¡¨å•çš„å½¢å¼ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥é’ˆå¯¹ä¸Šä¼ æ¥å£å‘é€è¯·æ±‚</p><ul><li>è¡¨å•</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://127.0.0.1:5000/"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"toupdate"</span>/&gt;</span># fileçš„inputä¸å…è®¸è®¾ç½®value</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"ä¸Šä¼ å’¯"</span> /&gt;</span>      # æŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"># actionä¸ºè¡¨å•è¦æäº¤åˆ°çš„è·¯å¾„, å¿…é¡»å¡«å†™ï¼Œå¦‚æœçœç•¥åˆ™é»˜è®¤å½“å‰é¡µé¢</span><br></pre></td></tr></table></figure><ul><li>é’ˆå¯¹æ¥å£ï¼Œå‘é€ç½‘ç»œè¯·æ±‚</li></ul><h2 id="ä¸‹è½½"><a class="markdownIt-Anchor" href="#ä¸‹è½½"></a> ä¸‹è½½</h2><h3 id="aæ ‡ç­¾"><a class="markdownIt-Anchor" href="#aæ ‡ç­¾"></a> aæ ‡ç­¾</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ³•ä¸€: é€šè¿‡`a`æ ‡ç­¾æ¥å®ç°ä¸‹è½½ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://127.0.0.1:5000/download"</span>&gt;</span>ss<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤–ï¼ŒHTML 5 é‡Œé¢ä¸º <code>&lt;a&gt;</code> æ ‡ç­¾æ·»åŠ äº†ä¸€ä¸ª <code>download</code> çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“çš„åˆ©ç”¨å®ƒæ¥å®ç°ä¸‹è½½é‡å‘½åçš„åŠŸèƒ½ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ³•ä¸€: é€šè¿‡`a`æ ‡ç­¾æ¥å®ç°ä¸‹è½½ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://127.0.0.1:5000/download"</span> <span class="attr">download</span>=<span class="string">"something.txt"</span>&gt;</span>ss<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="javascript"><a class="markdownIt-Anchor" href="#javascript"></a> JavaScript</h3><h4 id="æ·»åŠ aå…ƒç´ å¹¶ç‚¹å‡»"><a class="markdownIt-Anchor" href="#æ·»åŠ aå…ƒç´ å¹¶ç‚¹å‡»"></a> æ·»åŠ aå…ƒç´ å¹¶ç‚¹å‡»</h4><p>ç”¨ JavaScript æ¥ä¸‹è½½æ–‡ä»¶ä¹Ÿæ˜¯åˆ©ç”¨è¿™ä¸€ç‰¹æ€§æ¥å®ç°çš„ï¼Œæˆ‘ä»¬çš„ JavaScript ä»£ç ä¸å¤–ä¹å°±æ˜¯ï¼š</p><ul><li>ç”¨ JavaScript åˆ›å»ºä¸€ä¸ªéšè—çš„ <code>&lt;a&gt;</code> æ ‡ç­¾</li><li>è®¾ç½®å®ƒçš„ <code>href</code> å±æ€§</li><li>è®¾ç½®å®ƒçš„ <code>download</code> å±æ€§</li><li>ç”¨ JavaScript æ¥è§¦å‘è¿™ä¸ªå®ƒçš„ <code>click</code> äº‹ä»¶</li></ul><p>ç¿»è¯‘æˆ JavaScript ä»£ç å°±æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    downit()&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">        <span class="comment">// å·²ç»çŸ¥é“ä¸‹è½½é“¾æ¥</span></span><br><span class="line">        <span class="keyword">var</span> url = <span class="string">"http://127.0.0.1:5000/download"</span></span><br><span class="line">        <span class="keyword">var</span> filename = <span class="string">'what-you-want.txt'</span>;</span><br><span class="line">        a.href = url;</span><br><span class="line">        a.download = filename;</span><br><span class="line">        a.click();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fetch-blob"><a class="markdownIt-Anchor" href="#fetch-blob"></a> fetch + blob</h4><p>Blob å…¨ç§°æ˜¯ Binary large objectï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç±»æ–‡ä»¶å¯¹è±¡ï¼Œå¯ä»¥ç”¨å®ƒæ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ã€‚æ ¹æ® <a href="https://link.segmentfault.com/?enc=VjebWZdzKAs9tWBhcUlrkA%3D%3D.DafZfdpskf4%2Bt0pOrxaB0VaeWLs5jCpvfpnGscxz6HFF5viGq4H6%2BYROIgptJNW6PIjakO8ABb0PcnSyKwUkvA%3D%3D" target="_blank" rel="noopener">MDN</a> ä¸Šé¢çš„è¯´æ³•ï¼Œ<code>File API</code> ä¹Ÿæ˜¯åŸºäº blob æ¥å®ç°çš„ã€‚<br>æˆ‘ä»¬æ„å»º blob çš„æ–¹å¼å°±æ˜¯é€šè¿‡æœåŠ¡å™¨è¿”å›çš„æ–‡ä»¶æ¥åˆ›å»º blob æ‹‰ï¼è€Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç”¨ <code>fetch API</code> äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ•´åˆä¸Šé¢çš„ä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">'http://somehost/somefile.zip'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> res.blob().then(<span class="function"><span class="params">blob</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">    <span class="keyword">var</span> url = <span class="built_in">window</span>.URL.createObjectURL(blob);</span><br><span class="line">    <span class="keyword">var</span> filename = <span class="string">'myfile.zip'</span>;</span><br><span class="line">    a.href = url;</span><br><span class="line">    a.download = filename;</span><br><span class="line">    a.click();</span><br><span class="line">    <span class="built_in">window</span>.URL.revokeObjectURL(url);</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure><p>å·²çŸ¥ä¸‹è½½æ¥å£URLï¼Œ å¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downLoad</span>(<span class="params">option</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// ä¸‹è½½æ¥å£+è¯·æ±‚å‚æ•°</span></span><br><span class="line">    fetch(<span class="string">'http://somehost/download'</span>, options).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.code === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">            <span class="comment">// å¾—åˆ°è¯·æ±‚æ–‡ä»¶å®Œæ•´çš„è¯·æ±‚è·¯å¾„</span></span><br><span class="line">            <span class="keyword">var</span> url = res.data.url;</span><br><span class="line">            <span class="keyword">var</span> filename = <span class="string">'myfile.zip'</span>;</span><br><span class="line">            a.href = url;</span><br><span class="line">            a.download = filename;<span class="comment">// w3c: value: filenameâ€”â€”è§„å®šè¢«ä¸‹è½½çš„è¶…é“¾æ¥ç›®æ ‡ã€‚ä»è¿™è¾¹ä¹Ÿå¯ä»¥çœ‹å‡ºå…¶å®å°±æ˜¯æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">            a.click();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            alert(<span class="string">'You have no permission to download the file!'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµç¨‹ä¸ºï¼šé€šè¿‡åç«¯æœåŠ¡å™¨æ¥è®¡ç®—å‡ºç”¨æˆ·çš„ä¸‹è½½é“¾æ¥ï¼Œç„¶åå†åˆ©ç”¨ä¹‹å‰æåˆ°çš„<strong>åŠ¨æ€åˆ›å»º</strong> <code>&lt;a&gt;</code> æ ‡ç­¾çš„æ–¹å¼æ¥å®ç°ä¸‹è½½</p><p>è·Ÿ: <a href="https://blog.csdn.net/weixin_41305441/article/details/85003066" target="_blank" rel="noopener">JSå®ç°æ–‡ä»¶ä¸‹è½½çš„ä¸‰ç§æ–¹å¼â€”aæ ‡ç­¾ä¸‹è½½ã€formè¡¨å•ä¸‹è½½ã€blobè½¬æ¢urlä¸‹è½½</a>ä¸­çš„ä¸€æ ·ï¼Œä¹Ÿéƒ½æ˜¯å…ˆè®¡ç®—å‡ºèµ„æºæ‰€åœ¨çœŸå®çš„URLä½ç½®ï¼Œç„¶åå†è¯·æ±‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downLoadFile</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> ele = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">          ele.setAttribute(<span class="string">'href'</span>,res.url); <span class="comment">//è®¾ç½®ä¸‹è½½æ–‡ä»¶çš„urlåœ°å€</span></span><br><span class="line">          ele.setAttribute(<span class="string">'download'</span> , <span class="string">'download'</span>);<span class="comment">//ç”¨äºè®¾ç½®ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å</span></span><br><span class="line">          ele.click();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"get-file"</span>,</span><br><span class="line">        type:<span class="string">"get"</span>,</span><br><span class="line">        dataType:<span class="string">'JSON'</span></span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(res.bizNO &gt; <span class="number">0</span> )&#123;</span><br><span class="line">            downLoadFile(res);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            alert(res.bizMsg);</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;).always(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">"è¿æ¥å¼‚å¸¸"</span>)ï¼›</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨-javascript-ä¸‹è½½æ–‡ä»¶"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆè¦ç”¨-javascript-ä¸‹è½½æ–‡ä»¶"></a> ä¸ºä»€ä¹ˆè¦ç”¨ JavaScript ä¸‹è½½æ–‡ä»¶</h2><p>å¥½æ‹‰ï¼Œè¯´äº†åŠå¤©ï¼Œå…¶å®æˆ‘ä»¬ä¸€ç›´è¯´çš„éƒ½æ˜¯ï¼šã€Œä¸è¦ç”¨ JavaScript ä¸‹è½½æ–‡ä»¶æ‹‰ï¼Œé™åˆ¶å¤šå¤šï¼Œåˆä¸å¥½ç”¨ï¼Œç›´æ¥ç”¨ html å°±å¥½æ‹‰ï¼Œç®€å•æ–¹ä¾¿åˆå¿«æ·ã€è¿™ä¸ªè®ºè°ƒã€‚äº‹å®ä¸Šä¹Ÿç¡®å®å¦‚æ­¤ï¼Œä½†æœ‰äº›æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦é€šè¿‡ JavaScript æ¥åšä¸€äº›<strong>é¢„</strong>å¤„ç†ï¼Œ å¦‚æƒé™æ ¡éªŒã€‚</p><h3 id="ä¸‹è½½æ–‡ä»¶å‰çš„æƒé™æ ¡éªŒ"><a class="markdownIt-Anchor" href="#ä¸‹è½½æ–‡ä»¶å‰çš„æƒé™æ ¡éªŒ"></a> ä¸‹è½½æ–‡ä»¶å‰çš„æƒé™æ ¡éªŒ</h3><p>æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸‹è½½åšä¸€äº›é™åˆ¶ï¼Œæœ€å¸¸è§çš„å°±æ˜¯æƒé™æ ¡éªŒäº†ï¼Œå¦‚æ£€æŸ¥è¯¥ç”¨æˆ·æ˜¯å¦æœ‰ä¸‹è½½çš„æƒé™ï¼Œæ˜¯å¦æœ‰é«˜é€Ÿä¸‹è½½çš„æƒé™ç­‰ç­‰ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ JavaScript åšä¸€äº›é¢„å¤„ç†ã€‚å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">'http://somehost/check-permission'</span>, options).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (res.code === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">        <span class="keyword">var</span> url = res.data.url;</span><br><span class="line">        <span class="keyword">var</span> filename = <span class="string">'myfile.zip'</span>;</span><br><span class="line">        </span><br><span class="line">        a.href = url;</span><br><span class="line">        a.download = filename;</span><br><span class="line">        a.click();</span><br><span class="line">        </span><br><span class="line">       <span class="comment">//   const ele = document.createElement('a');</span></span><br><span class="line">       <span class="comment">//   ele.setAttribute('href',res.url); //è®¾ç½®ä¸‹è½½æ–‡ä»¶çš„urlåœ°å€</span></span><br><span class="line">       <span class="comment">//   ele.setAttribute('download' , 'download');//ç”¨äºè®¾ç½®ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å</span></span><br><span class="line">       <span class="comment">//   ele.click();</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">'You have no permission to download the file!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><ul><li><a href="https://blog.csdn.net/weixin_41305441/article/details/85003066" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41305441/article/details/85003066</a></li><li><a href="https://segmentfault.com/a/1190000005863250" target="_blank" rel="noopener">https://segmentfault.com/a/1190000005863250</a></li><li><a href="https://www.jianshu.com/p/8ef2c7b8b46c" target="_blank" rel="noopener">å‰ç«¯æ¥å—åç«¯æ–‡ä»¶æµå¹¶ä¸‹è½½çš„å‡ ç§æ–¹æ³•</a></li></ul><h1 id="python-flaskå®ç°ä¸Šä¼ å’Œä¸‹è½½æ¥å£"><a class="markdownIt-Anchor" href="#python-flaskå®ç°ä¸Šä¼ å’Œä¸‹è½½æ¥å£"></a> Python Flaskå®ç°ä¸Šä¼ å’Œä¸‹è½½æ¥å£</h1><h2 id="ä¸Šä¼ -2"><a class="markdownIt-Anchor" href="#ä¸Šä¼ -2"></a> ä¸Šä¼ </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, url_for, send_from_directory</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> send_from_directory, make_response</span><br><span class="line"><span class="comment"># è®¾ç½®ä¸Šä¼ æ–‡ä»¶å…è®¸ç§ç±»</span></span><br><span class="line">ALLOWED_EXTENSIONS = &#123;<span class="string">'png'</span>, <span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'gif'</span>&#125;</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># è®¾ç½®ä¸Šä¼ è·¯å¾„</span></span><br><span class="line">app.config[<span class="string">'UPLOAD_FOLDER'</span>] = os.path.join(os.getcwd(), <span class="string">"updates"</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®ä¸Šä¼ æ–‡ä»¶æœ€å¤§å¤§å°</span></span><br><span class="line">app.config[<span class="string">'MAX_CONTENT_LENGTH'</span>] = <span class="number">16</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line"></span><br><span class="line">html = <span class="string">'''</span></span><br><span class="line"><span class="string">    &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Upload File&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;Photo Upload&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;form method=post enctype=multipart/form-data&gt;</span></span><br><span class="line"><span class="string">         &lt;input type=file name=file&gt;</span></span><br><span class="line"><span class="string">         &lt;input type=submit value=upload&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;a href='http://127.0.0.1:5000/download'&gt;&lt;p&gt;ä¸‹è½½&lt;/p&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">allowed_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ˜¯å¦æ˜¯å…è®¸ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'.'</span> <span class="keyword">in</span> filename <span class="keyword">and</span> \</span><br><span class="line">           filename.rsplit(<span class="string">'.'</span>, <span class="number">1</span>)[<span class="number">1</span>] <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/uploads/&lt;filename&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uploaded_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    è·å¾—ä¸Šä¼ åçš„é“¾æ¥</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">return</span> send_from_directory(app.config[<span class="string">'UPLOAD_FOLDER'</span>],</span><br><span class="line">                               filename)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        file = request.files[<span class="string">'file'</span>]<span class="comment"># å¯ä»¥é€šè¿‡requests.fileså±æ€§æ‹¿åˆ°multipart/form-dataä¸Šä¼ çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line">            filename = secure_filename(file.filename)</span><br><span class="line">            <span class="comment"># ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">            file.save(os.path.join(app.config[<span class="string">'UPLOAD_FOLDER'</span>], filename))</span><br><span class="line">            <span class="comment"># è·å¾—ä¿å­˜åçš„å›¾ç‰‡é“¾æ¥</span></span><br><span class="line">            file_url = url_for(<span class="string">'uploaded_file'</span>, filename=filename)</span><br><span class="line">            print(file_url)</span><br><span class="line">            <span class="keyword">return</span> html + <span class="string">'&lt;br&gt;&lt;img src='</span> + file_url + <span class="string">'&gt;'</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½-2"><a class="markdownIt-Anchor" href="#ä¸‹è½½-2"></a> ä¸‹è½½</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route("/download")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># å¯ä»¥çœ‹åˆ°ä¸Šä¼ ä»£ç ä¸­ä¹Ÿç”¨åˆ°äº†send_from_directoryï¼›è¿™è¾¹çš„åŒºåˆ«ä¸»è¦æ˜¯æ·»åŠ äº†as_attachmentå‚æ•°, ä½¿å¾—å¯ä»¥ä¸‹è½½</span></span><br><span class="line">    <span class="comment"># return make_response(send_from_directory("./", "test.txt", as_attachment=True))</span></span><br><span class="line">    <span class="keyword">return</span> send_from_directory(<span class="string">"./"</span>, <span class="string">"./"</span>, filename=<span class="string">"test.txt"</span>, as_attachment=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><h1 id="javaå®ç°ä¸Šä¼ ä¸‹è½½"><a class="markdownIt-Anchor" href="#javaå®ç°ä¸Šä¼ ä¸‹è½½"></a> Javaå®ç°ä¸Šä¼ ä¸‹è½½</h1><h2 id="ä¸Šä¼ -3"><a class="markdownIt-Anchor" href="#ä¸Šä¼ -3"></a> ä¸Šä¼ </h2><p>application.properties</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ç”¨æ¥æŒ‡å®šæœåŠ¡å™¨ç«¯æ–‡ä»¶å¤§å°çš„é™åˆ¶</span><br><span class="line">spring.servlet.multipart.max-file-size=300MB</span><br><span class="line"># ç”¨æ¥æŒ‡å®šå®¢æˆ·ç«¯æ–‡ä»¶å¤§å°çš„é™åˆ¶</span><br><span class="line">spring.servlet.multipart.max-request-size=300MB</span><br><span class="line"></span><br><span class="line">fileLocation=static/files</span><br></pre></td></tr></table></figure><p>FileUploadController.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„è·¯å¾„ static/files</span></span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;fileLocation&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String fileLocation;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"upload"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">// è·å¾— classpath çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">    String realPath = ResourceUtils.getURL(<span class="string">"classpath:"</span>).getPath() + fileLocation;</span><br><span class="line">    File newFile = <span class="keyword">new</span> File(realPath);</span><br><span class="line">    <span class="comment">// å¦‚æœæ–‡ä»¶å¤¹ä¸å­˜åœ¨ã€åˆ™æ–°å»º</span></span><br><span class="line">    <span class="keyword">if</span> (!newFile.exists()) newFile.mkdirs();</span><br><span class="line">     <span class="comment">// ä¸Šä¼ </span></span><br><span class="line">    String fileName = date.getTime() +<span class="string">"@"</span> + file.getOriginalFilename();</span><br><span class="line">    file.transferTo(<span class="keyword">new</span> File(newFile, fileName));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½-3"><a class="markdownIt-Anchor" href="#ä¸‹è½½-3"></a> ä¸‹è½½</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;fileLocation&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String fileLocation;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"download"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">(String fileName, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">// è·å¾—å¾…ä¸‹è½½æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">    String realPath = ResourceUtils.getURL(<span class="string">"classpath:"</span>).getPath() + fileLocation;</span><br><span class="line">    <span class="comment">// è·å¾—æ–‡ä»¶è¾“å…¥æµ</span></span><br><span class="line">    FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(realPath, fileName));</span><br><span class="line">    <span class="comment">// è®¾ç½®å“åº”å¤´ã€ä»¥é™„ä»¶å½¢å¼æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">    response.setHeader(<span class="string">"content-disposition"</span>, <span class="string">"attachment; fileName="</span> + fileName);</span><br><span class="line">    ServletOutputStream outputStream = response.getOutputStream();</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span> ((len = inputStream.read(data)) != -<span class="number">1</span>) &#123;</span><br><span class="line">        outputStream.write(data, <span class="number">0</span>, len);</span><br><span class="line">    &#125;</span><br><span class="line">    outputStream.close();</span><br><span class="line">    inputStream.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰ç«¯&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å‰ç«¯&quot;&gt;&lt;/a&gt; å‰ç«¯&lt;/h1&gt;
&lt;h2 id=&quot;ä¸Šä¼ &quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ä¸Šä¼ &quot;&gt;&lt;/a&gt; ä¸Šä¼ &lt;/h2&gt;
&lt;p&gt;å‰ç«¯ä¸Šä¼ ä¸»è¦æ˜¯
      
    
    </summary>
    
    
      <category term="åç«¯" scheme="https://nymrli.top/tags/%E5%90%8E%E7%AB%AF/"/>
    
      <category term="å‰ç«¯" scheme="https://nymrli.top/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
</feed>
