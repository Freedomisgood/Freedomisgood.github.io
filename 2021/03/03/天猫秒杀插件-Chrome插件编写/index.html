<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="Mrli"><meta name="renderer" content="webkit"><meta name="copyright" content="Mrli"><meta name="keywords" content="Mrli's Blog"><meta name="description" content="想和你讲，说了会心动 ，缄默会心安。"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Chrome插件编写-天猫秒杀插件 · Mr.li's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="https://avatars1.githubusercontent.com/u/31088082?s=400&amp;u=7a99ff83916afb3f4c5312bd78a1be17fe0e34ed&amp;v=4"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">Mrli</div><div class="profile-signature">别装作很努力,<br>因为结局不会陪你演戏。</div><div class="contacts"><div>Contacts:</div><span><a href="http://sighttp.qq.com/msgrd?v=1&amp;uin=1063052964" target="_black">QQ</a></span><span><a href="https://www.cnblogs.com/nymrli/" target="_black">博客园</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 60vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Mr.li's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">Chrome插件编写-天猫秒杀插件</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-edit"></i><span>2021/12/04</span></span><span class="busuanzi-pv" id="busuanzi_container_page_pv"><i class="post-intro-calendar fa fa-user-o"></i><span id="busuanzi_value_page_pv"></span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="脚本"> 脚本</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">2,732</span> | Reading time: <span class="post-count">13</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="chrome插件开发"><a class="markdownIt-Anchor" href="#chrome插件开发"></a> chrome插件开发</h1>
<blockquote>
<p>借鉴TODO-List：<a href="https://www.w3cschool.cn/kesyi/kesyi-m5uo24rx.html" target="_blank" rel="noopener">Chrome插件开发简要指南</a></p>
</blockquote>
<h2 id="文件结构"><a class="markdownIt-Anchor" href="#文件结构"></a> 文件结构</h2>
<p>在应用商店中下载下来的插件基本上都是以<code>.crx</code>为文件后缀，该文件其实就是一个压缩包（文件夹压缩而来），包括插件所需要的<strong>html</strong>、css、<strong>javascript</strong>、图片资源等等文件。</p>
<p>其中，</p>
<ul>
<li><code>manifest.json</code>是整个插件的功能及文件配置清单，非常重要。</li>
<li><code>static</code>目录是放置整个插件的静态资源文件的，包括css、js、图片等等资源</li>
<li><code>template</code>目录是放置整个插件的功能页面模板的。</li>
<li><code>_locales</code>目录是放置整个插件的国际化语言脚本的。</li>
</ul>
<p>一般来说，<strong>清单文件<code>manifest.json</code>文件是必须的</strong>，且必须放在插件开发目录的根目录上。其他的目录都可以自定义。</p>
<h2 id="弹出窗口和后台页面"><a class="markdownIt-Anchor" href="#弹出窗口和后台页面"></a> 弹出窗口和后台页面</h2>
<p>弹出窗口一般用于插件和用户的交互，而后台页面一般用于插件本身做一些额外的事情。比如有时候，插件需要联网进行数据同步等操作，这种操作用户是无感知的，所有就要求插件需要有一个后台页面来运行这部分的逻辑。</p>
<p>其实后台页面还可以分为持久运行的后端页面和事件页面，这里对这两者就不多做说明了，更多的内容可以参阅具体的文档。</p>
<h2 id="弹出式插件教程todo-list"><a class="markdownIt-Anchor" href="#弹出式插件教程todo-list"></a> 弹出式插件教程TODO-LIST</h2>
<h3 id="manifestjson"><a class="markdownIt-Anchor" href="#manifestjson"></a> manifest.json</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"todo-plugin"</span>,</span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"0.9.0"</span>,</span><br><span class="line">    <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">"description"</span>: <span class="string">"chrome plugin demo"</span>,</span><br><span class="line">    <span class="attr">"browser_action"</span>: &#123;</span><br><span class="line">        <span class="attr">"default_icon"</span>: <span class="string">"icon.png"</span>,</span><br><span class="line">        <span class="attr">"default_title"</span>: <span class="string">"Todo List"</span>,</span><br><span class="line">        <span class="attr">"default_popup"</span>: <span class="string">"popup.html"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="popuphtml"><a class="markdownIt-Anchor" href="#popuphtml"></a> popup.html</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    body &#123;</span></span><br><span class="line"><span class="undefined">        width: 150px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#add-new-item</span> &#123;</span></span><br><span class="line"><span class="undefined">        cursor: pointer;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>: <span class="selector-id">#CCC</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.hide</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: none;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.show</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: block;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="undefined">        cursor: pointer;</span></span><br><span class="line"><span class="undefined">        margin: 5px 0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: inline-block;</span></span><br><span class="line"><span class="undefined">        width: 12px;</span></span><br><span class="line"><span class="undefined">        height: 12px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    input &#123;</span></span><br><span class="line"><span class="undefined">        width: 120px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"add-new-item"</span>&gt;</span>添加新项<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"add-new-item-input"</span> <span class="attr">class</span>=<span class="string">"hide"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"new-item-title"</span> <span class="attr">placeholder</span>=<span class="string">"添加新任务"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"item-list"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="mainjs"><a class="markdownIt-Anchor" href="#mainjs"></a> main.js</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $ = <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> Tasks = &#123;</span><br><span class="line">        show: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            obj.className = <span class="string">''</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        hide: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            obj.className = <span class="string">'hide'</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        $addNewItem: $(<span class="string">'add-new-item'</span>),</span><br><span class="line">        $addNewItemInput: $(<span class="string">'add-new-item-input'</span>),</span><br><span class="line">        $itemList: $(<span class="string">'item-list'</span>),</span><br><span class="line">        $newItemTitle: $(<span class="string">'new-item-title'</span>),</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//打开添加文本框</span></span><br><span class="line">            Tasks.$addNewItem.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                Tasks.show(Tasks.$addNewItemInput).hide(Tasks.$addNewItem);</span><br><span class="line">                Tasks.$newItemTitle.focus();</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//回车添加任务</span></span><br><span class="line">            Tasks.$newItemTitle.addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> ev = ev || <span class="built_in">window</span>.event;</span><br><span class="line">                <span class="keyword">if</span> (ev.keyCode == <span class="number">13</span>) &#123;</span><br><span class="line">                    <span class="comment">//<span class="doctag">TODO:</span>写入本地数据</span></span><br><span class="line">                    <span class="keyword">var</span> task = Tasks.$newItemTitle.value;</span><br><span class="line">                    Tasks.AppendHtml(task);</span><br><span class="line">                    Tasks.$newItemTitle.value = <span class="string">''</span>;</span><br><span class="line">                    Tasks.hide(Tasks.$addNewItemInput).show(Tasks.$addNewItem);</span><br><span class="line">                &#125;</span><br><span class="line">                ev.preventDefault();</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//取消添加</span></span><br><span class="line">            Tasks.$newItemTitle.addEventListener(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                Tasks.$newItemTitle.value = <span class="string">''</span>;</span><br><span class="line">                Tasks.hide(Tasks.$addNewItemInput).show(Tasks.$addNewItem);</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//TODO 初始化数据，加载本地数据，生成html</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//增加</span></span><br><span class="line">        Add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//修改</span></span><br><span class="line">        Edit: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//删除</span></span><br><span class="line">        Del: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        AppendHtml: <span class="function"><span class="keyword">function</span> (<span class="params">title</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            oDiv.className = <span class="string">'item item-todo'</span>;</span><br><span class="line">            <span class="keyword">var</span> oInput = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span><br><span class="line">            oInput.type = <span class="string">'checkbox'</span>;</span><br><span class="line">            <span class="keyword">var</span> oTitle = <span class="built_in">document</span>.createElement(<span class="string">'span'</span>);</span><br><span class="line">            oTitle.innerHTML = title;</span><br><span class="line">            oDiv.appendChild(oInput);</span><br><span class="line">            oDiv.appendChild(oTitle);</span><br><span class="line">            Tasks.$itemList.appendChild(oDiv);</span><br><span class="line">            oDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">//TODO</span></span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        RemoveHtml: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Tasks.init();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h1 id="天猫秒杀插件-tmall_kill"><a class="markdownIt-Anchor" href="#天猫秒杀插件-tmall_kill"></a> 天猫秒杀插件 Tmall_Kill</h1>
<p>Code Template： <a href="https://link.zhihu.com/?target=https%3A//github.com/cehui0303/Tmall_Tickets" target="_blank" rel="noopener">https://link.zhihu.com/?target=https%3A//github.com/cehui0303/Tmall_Tickets</a></p>
<p>代码比较简单，实现原理为，打开浏览器后执行插件，JS脚本将会在指定时间点击“结算”按钮，然后发起订单，从而锁定库存抢货。</p>
<h3 id="mainjs-2"><a class="markdownIt-Anchor" href="#mainjs-2"></a> main.js</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定时器</span></span><br><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//检测状态</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkElementState</span>(<span class="params">path,callback</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ele = <span class="built_in">document</span>.querySelector(path);</span><br><span class="line">	<span class="keyword">if</span>(ele)&#123;</span><br><span class="line">		callback &amp;&amp; callback();</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'异步加载元素中....'</span> + path );</span><br><span class="line">		setTimeout( <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;checkElementState(path,callback);&#125;,<span class="number">200</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//结算</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkOut</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'结算开始....'</span>);</span><br><span class="line">	<span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'J_Go'</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(btn)&#123;</span><br><span class="line">		btn.click();</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'结算按钮没找到'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// S1: 1. 点击结算按钮  =&gt;  2. checkElementState()检测结算按钮是否加载出来 --&gt; 3.checkOut()点击结算按钮</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkOutAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	checkElementState(<span class="string">'#J_Go'</span>,checkOut);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// S2: 提交订单</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitOrder</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'提交订单开始....'</span>);</span><br><span class="line">	checkElementState(<span class="string">'.go-btn'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">".go-btn"</span>);</span><br><span class="line">		<span class="keyword">if</span>(btn)&#123;</span><br><span class="line">			btn.click();</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'提交订单按钮没找到'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//目标时间</span></span><br><span class="line"> <span class="keyword">var</span> dDate = <span class="keyword">new</span> <span class="built_in">Date</span>();  <span class="comment">//10点和20点开抢</span></span><br><span class="line"> <span class="keyword">if</span>( dDate.getHours() &lt; <span class="number">10</span> )&#123;</span><br><span class="line">  dDate.setHours(<span class="number">9</span>,<span class="number">59</span>,<span class="number">59.2</span>);</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  dDate.setHours(<span class="number">19</span>,<span class="number">59</span>,<span class="number">59.2</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进入时间判断循环</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enterTimeCheckLoop</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">	<span class="keyword">var</span> diff = <span class="built_in">Date</span>.parse(dDate) - <span class="built_in">Date</span>.parse(date) ;</span><br><span class="line">	<span class="built_in">console</span>.log(diff);</span><br><span class="line">	<span class="keyword">if</span>(diff &lt; <span class="number">-90</span> )&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'时间过了！'</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(diff &lt; <span class="number">50</span> ) &#123;</span><br><span class="line">		callback &amp;&amp; callback();</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'时间到了！！！'</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; enterTimeCheckLoop(callback);&#125;,<span class="number">400</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//主要函数</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'############################天猫枪杀脚本############################'</span>);</span><br><span class="line">	<span class="keyword">var</span> href = <span class="built_in">window</span>.location.href;</span><br><span class="line">	<span class="comment">//结算页面</span></span><br><span class="line">	<span class="keyword">if</span>(href.indexOf(<span class="string">'cart.tmall.com'</span>) &gt; <span class="number">-1</span> )&#123;</span><br><span class="line">		<span class="comment">//进入时间判断</span></span><br><span class="line">		enterTimeCheckLoop( checkOutAsync );</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(href.indexOf(<span class="string">'buy.tmall.com'</span>) &gt; <span class="number">-1</span> )&#123;</span><br><span class="line">	<span class="comment">//提交订单页面</span></span><br><span class="line">		submitOrder();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p>这种理论上是可行的，只不过肯定会有刷新上的问题，效率不及网络请求，但思路依旧是值得学习的，因此借此机会也是学下Chrome插件的编写。</p>
<h3 id="manifestjson-2"><a class="markdownIt-Anchor" href="#manifestjson-2"></a> manifest.json</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "manifest_version": 2,			// manifest文件版本号。Chrome18开始必须为2</span><br><span class="line">  "name": "Tmall-tickets",			 // crx扩展名称</span><br><span class="line">  "version": "1.0",					// 插件版本</span><br><span class="line">  "description": "天猫超市枪杀脚本",	</span><br><span class="line">  "browser_action": &#123;				// 地址栏右侧图标管理。含图标及弹出页面的设置等</span><br><span class="line">    "default_icon": "icon.png"</span><br><span class="line">  &#125;,</span><br><span class="line">  "content_scripts": [				// 指定要向Web页面内注入的脚本。可注入多个css与js。</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"matches"</span>: [<span class="string">"https://chaoshi.detail.tmall.com/*"</span>,<span class="string">"https://cart.tmall.com/*"</span>,<span class="string">"https://buy.tmall.com/*"</span>],</span><br><span class="line">      <span class="attr">"js"</span>: [<span class="string">"maotai.js"</span>],</span><br><span class="line">	  <span class="attr">"run_at"</span>: <span class="string">"document_idle"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">    "permissions": [</span><br><span class="line">       "https://www.baidu.com/*",</span><br><span class="line">       "background",</span><br><span class="line">       <span class="string">"tabs"</span></span><br><span class="line">    ], 				//权限</span><br><span class="line">    "plugins": [&#123;</span><br><span class="line">       "path": "extension_plugin.dll",</span><br><span class="line">       "public": true</span><br><span class="line">    &#125;], // 扩展。可调用第三方扩展</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>content_scripts</strong>，其数组元素的字段有：</p>
<ol>
<li>
<p>matches：String数组，必须。定义content_scripts对哪些页面生效。其规则符合permissions的模式匹配。</p>
</li>
<li>
<p>css：String数组，可选。定义哪些css文件在web页面DOM创建前注入到web页面中。</p>
</li>
<li>
<p>js：String数组，可选。定义哪些js文件注入到web页面中。其js文件的注入顺序与数组中定义的顺序相同。至于这些js与web页面中所定义js的顺序关系，取决于run_at字段。</p>
</li>
<li>
<p>run_at：String，可选。定义content_scripts的注入时机，从而影响到js与web页面所定义js的顺序关系。取值有：</p>
<ul>
<li>
<p>document_start：所有css加载完毕，但DOM尚未创建时。</p>
</li>
<li>
<p>document_end：DOM创建完成，但图片及frame等子资源尚未加载时。</p>
</li>
<li>
<p>document_idle：document_end之后，window.onload之前。</p>
<p>默认是document_idle，也就是content_scripts的js都罗列在web页面的js之后。</p>
</li>
</ul>
</li>
<li>
<p>all_frames：boolean，可选。是否运行在页面所有的frame中。若为false，则只运行在最上层的frame中。默认为false。</p>
</li>
<li>
<p>include_globs：String数组，可选。用于规定页面匹配的白名单。一个URL，必须同时满足：匹配matches，匹配include_globs白名单，不匹配exclude_globs黑名单这三个条件才可以。注意include_globs和exclude_globs中的匹配语法与permissions和matches所用的匹配模式不同。</p>
</li>
<li>
<p>exclude_globs：String数组，可选。用于规定页面匹配的黑名单。同⑥。</p>
</li>
</ol>
<p><strong>permissions</strong>：扩展所需要的权限。permissions是一个String数组，每一个权限都使用String来表示。某些权限在安装前会告知用户。</p>
<ol>
<li>模式配匹：用于指定扩展会在哪些URL中生效。例如：</li>
<li>background：启用扩展后端环境。即在浏览器运行期始终运行，与单个页面无关。可以在这里调用浏览器的API，通常在这里进行扩展主要逻辑的开发。配合manifest.json的background字段使用。</li>
</ol>
<p><strong>background</strong>： 这是一个比较重要的属性，如果你需要运行一些后台脚本，比如监听用户在扩展信息栏按下你的插件图标，或者你要监听用户新建tab页，这个时候你就需要有一个background的页面。background你可以指定一个HTML页面（如我的插件），也可以指定一个JS文件，如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"My extension"</span>,</span><br><span class="line">  ...</span><br><span class="line">  "background": &#123;</span><br><span class="line">    "scripts": ["background.js"]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">// 需要注意两点：</span><br><span class="line">// 1、是HTML不能写JS代码，JS代码需要写到JS文件中后引入；</span><br><span class="line">// 2、不能使用jquery（没有详细测试，可能是我没用正确）；</span><br></pre></td></tr></table></figure>
<p>background.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// background.js</span></span><br><span class="line"><span class="comment">// @describtion: 监听用户在扩展信息栏按下你的插件图标时，显示当前活动页的URL：</span></span><br><span class="line">chrome.browserAction.onClicked.addListener(<span class="function"><span class="keyword">function</span> (<span class="params">tab</span>) </span>&#123;</span><br><span class="line">	alert(tab.url);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="改进tmall_kill"><a class="markdownIt-Anchor" href="#改进tmall_kill"></a> 改进Tmall_Kill</h2>
<p>需要修改的功能为：</p>
<ol>
<li>插件中设定时间=&gt;时间框选择时间</li>
<li>匹配网站自动运行-&gt;弹出页面手动点击运行</li>
<li>选中购物车商品后结算-&gt;到时间后自动勾选商品结算</li>
<li>弹出页+时间框 popup.html</li>
</ol>
<p><a href="https://blog.csdn.net/z_xiaocun/article/details/46934223" target="_blank" rel="noopener">HTML5日期输入框(date)</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Author: Mrli</span></span><br><span class="line"><span class="comment"> * @Date: 2021-03-02 17:19:02</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2021-03-03 22:18:02</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    body &#123;</span></span><br><span class="line"><span class="undefined">        width: 250px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#add-new-item</span> &#123;</span></span><br><span class="line"><span class="undefined">        cursor: pointer;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>: <span class="selector-id">#CCC</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.hide</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: none;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.show</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: block;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="undefined">        cursor: pointer;</span></span><br><span class="line"><span class="undefined">        margin: 5px 0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="undefined">        display: inline-block;</span></span><br><span class="line"><span class="undefined">        width: 12px;</span></span><br><span class="line"><span class="undefined">        height: 12px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    input &#123;</span></span><br><span class="line"><span class="undefined">        width: 200px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"add-new-item"</span>&gt;</span>add new item<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"add-new-item-input"</span> <span class="attr">class</span>=<span class="string">"hide"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"new-item-title"</span> <span class="attr">placeholder</span>=<span class="string">"add new"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"meeting"</span>&gt;</span>killTime:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"meeting"</span> <span class="attr">type</span>=<span class="string">"datetime-local"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"item-list"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>配套的manifest.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"todo-plugin"</span>,</span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"0.9.0"</span>,</span><br><span class="line">    <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">"description"</span>: <span class="string">"chrome plugin demo"</span>,</span><br><span class="line">    <span class="attr">"browser_action"</span>: &#123;</span><br><span class="line">        <span class="attr">"default_icon"</span>: <span class="string">"icon.png"</span>,</span><br><span class="line">        <span class="attr">"default_title"</span>: <span class="string">"Todo List"</span>,</span><br><span class="line">        <span class="attr">"default_popup"</span>: <span class="string">"popup.html"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $ = <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> Tasks = &#123;</span><br><span class="line">        show: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            obj.className = <span class="string">''</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        hide: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            obj.className = <span class="string">'hide'</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        $addNewItem: $(<span class="string">'add-new-item'</span>),</span><br><span class="line">        $addNewItemInput: $(<span class="string">'add-new-item-input'</span>),</span><br><span class="line">        $itemList: $(<span class="string">'item-list'</span>),</span><br><span class="line">        $newItemTitle: $(<span class="string">'new-item-title'</span>),</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//打开添加文本框</span></span><br><span class="line">            Tasks.$addNewItem.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                Tasks.show(Tasks.$addNewItemInput).hide(Tasks.$addNewItem);</span><br><span class="line">                Tasks.$newItemTitle.focus();</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//回车添加任务</span></span><br><span class="line">            Tasks.$newItemTitle.addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> ev = ev || <span class="built_in">window</span>.event;</span><br><span class="line">                <span class="keyword">if</span> (ev.keyCode == <span class="number">13</span>) &#123;</span><br><span class="line">                    <span class="comment">//<span class="doctag">TODO:</span>写入本地数据</span></span><br><span class="line">                    <span class="keyword">var</span> task = Tasks.$newItemTitle.value;</span><br><span class="line">                    Tasks.AppendHtml(task);</span><br><span class="line">                    Tasks.$newItemTitle.value = <span class="string">''</span>;</span><br><span class="line">                    Tasks.hide(Tasks.$addNewItemInput).show(Tasks.$addNewItem);</span><br><span class="line">                &#125;</span><br><span class="line">                ev.preventDefault();</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//取消添加</span></span><br><span class="line">            Tasks.$newItemTitle.addEventListener(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                Tasks.$newItemTitle.value = <span class="string">''</span>;</span><br><span class="line">                Tasks.hide(Tasks.$addNewItemInput).show(Tasks.$addNewItem);</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//TODO 初始化数据，加载本地数据，生成html</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//增加</span></span><br><span class="line">        Add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//修改</span></span><br><span class="line">        Edit: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//删除</span></span><br><span class="line">        Del: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;,</span><br><span class="line">        AppendHtml: <span class="function"><span class="keyword">function</span> (<span class="params">title</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            oDiv.className = <span class="string">'item item-todo'</span>;</span><br><span class="line">            <span class="keyword">var</span> oInput = <span class="built_in">document</span>.createElement(<span class="string">'input'</span>);</span><br><span class="line">            oInput.type = <span class="string">'checkbox'</span>;</span><br><span class="line">            <span class="keyword">var</span> oTitle = <span class="built_in">document</span>.createElement(<span class="string">'span'</span>);</span><br><span class="line">            oTitle.innerHTML = title;</span><br><span class="line">            oDiv.appendChild(oInput);</span><br><span class="line">            oDiv.appendChild(oTitle);</span><br><span class="line">            Tasks.$itemList.appendChild(oDiv);</span><br><span class="line">            oDiv.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">//TODO</span></span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        RemoveHtml: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Tasks.init();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h2 id="学习案例"><a class="markdownIt-Anchor" href="#学习案例"></a> 学习案例：</h2>
<ul>
<li><a href="https://www.extfans.com/web-development/dmkhgkeoafabappeigncmifgkiecjcpp" target="_blank" rel="noopener">cookies-list</a></li>
<li><a href="https://juejin.cn/post/7005598387634438175" target="_blank" rel="noopener">Chrome 插件开发不完全指南</a></li>
</ul>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://nymrli.top">Mrli</a></p><p> <span>Link:  </span><a href="https://nymrli.top/2021/03/03/天猫秒杀插件-Chrome插件编写/">https://nymrli.top/2021/03/03/天猫秒杀插件-Chrome插件编写/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2021/08/11/Shiro使用学习/" title="Shiro使用学习"><span>< PreviousPost</span><br><span class="prevTitle">Shiro使用学习</span></a><a class="nextSlogan" href="/2021/01/24/认真学次DP——动态规划/" title="认真学次DP——动态规划"><span>NextPost ></span><br><span class="nextTitle">认真学次DP——动态规划</span></a><div class="clear"></div></div><div id="comment"><div id="container"></div><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>var gitment = new Gitment({
  id: 'Chrome插件编写-天猫秒杀插件',
  owner: 'Freedomisgood',
  repo: 'Freedomisgood.github.io',
  oauth: {
    client_id: 'bc5a81fe36017dcd8b63',
    client_secret: '949cec3a1b91742c6249c47259791e4b80a6fa69',
  },
})
gitment.render('container')</script></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><p class="beian"><a href="https://beian.miit.gov.cn/"> <span>备案号:苏ICP备18015439号</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 60vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#chrome插件开发"><span class="toc-number">1.</span> <span class="toc-text"> chrome插件开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#文件结构"><span class="toc-number">1.1.</span> <span class="toc-text"> 文件结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弹出窗口和后台页面"><span class="toc-number">1.2.</span> <span class="toc-text"> 弹出窗口和后台页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弹出式插件教程todo-list"><span class="toc-number">1.3.</span> <span class="toc-text"> 弹出式插件教程TODO-LIST</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestjson"><span class="toc-number">1.3.1.</span> <span class="toc-text"> manifest.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popuphtml"><span class="toc-number">1.3.2.</span> <span class="toc-text"> popup.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mainjs"><span class="toc-number">1.3.3.</span> <span class="toc-text"> main.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#天猫秒杀插件-tmall_kill"><span class="toc-number">2.</span> <span class="toc-text"> 天猫秒杀插件 Tmall_Kill</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mainjs-2"><span class="toc-number">2.0.1.</span> <span class="toc-text"> main.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manifestjson-2"><span class="toc-number">2.0.2.</span> <span class="toc-text"> manifest.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#改进tmall_kill"><span class="toc-number">2.1.</span> <span class="toc-text"> 改进Tmall_Kill</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#学习案例"><span class="toc-number">2.2.</span> <span class="toc-text"> 学习案例：</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>