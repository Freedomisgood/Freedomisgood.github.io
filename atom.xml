<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mrli&#39;s Blog</title>
  
  <subtitle>别装作很努力，结局不会陪你演戏。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://nymrli.top/"/>
  <updated>2019-09-14T06:03:02.174Z</updated>
  <id>https://nymrli.top/</id>
  
  <author>
    <name>Mrli</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>如何成为一位老司机——考驾照经历</title>
    <link href="https://nymrli.top/2019/09/14/%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E4%B8%80%E4%BD%8D%E8%80%81%E5%8F%B8%E6%9C%BA%E2%80%94%E2%80%94%E8%80%83%E9%A9%BE%E7%85%A7%E7%BB%8F%E5%8E%86/"/>
    <id>https://nymrli.top/2019/09/14/如何成为一位老司机——考驾照经历/</id>
    <published>2019-09-14T04:32:33.000Z</published>
    <updated>2019-09-14T06:03:02.174Z</updated>
    
    <content type="html"><![CDATA[<h1 id="如何成为一位老司机考驾照经历"><a class="markdownIt-Anchor" href="#如何成为一位老司机考驾照经历"></a> 如何成为一位老司机——考驾照经历</h1><p>大一下报的名，几经转折，终于在2019-9-12，中秋放假前一天拿到了本本。</p><h2 id="科一理论考试"><a class="markdownIt-Anchor" href="#科一理论考试"></a> 科一理论考试</h2><p>太久远了，已经忘记了…</p><h2 id="科二"><a class="markdownIt-Anchor" href="#科二"></a> 科二</h2><h3 id="训练"><a class="markdownIt-Anchor" href="#训练"></a> 训练</h3><h4 id="倒车入库"><a class="markdownIt-Anchor" href="#倒车入库"></a> 倒车入库：</h4><p>左边小镜子底座盖过黄线，向左打死。<br>正手倒车时，靠近左边直角距离3个手指回正，然后看左边镜子出现直角，然后。<br>左手是一到二指头。</p><p>▲入库重在自己调整，记住准则：左右镜子，哪边空隙大，方向盘往哪边打</p><h4 id="小四项"><a class="markdownIt-Anchor" href="#小四项"></a> 小四项：</h4><h5 id="直角转弯"><a class="markdownIt-Anchor" href="#直角转弯"></a> 直角转弯:</h5><ul><li>人在路中间，直角重合于车窗黑线后向左打死。</li></ul><h5 id="s弯道"><a class="markdownIt-Anchor" href="#s弯道"></a> S弯道：</h5><ul><li>确保人在路中间，可以略微偏左。左边小镜子底座压住右边黄线。方向盘一圈右手放在2点方向。如果黄线偏下，那么往1点方向调整，否则往3点方向调整。然后保持到车头中间碰到左边黄线回正；然后向前一小段距离，使得右边镜子与黄线只差一条线的距离，然后向右一圈，左手11点，保持小镜子与黄线夹角是钝角，然后一直保持到项目结束。</li></ul><h5 id="坡道停车"><a class="markdownIt-Anchor" href="#坡道停车"></a> 坡道停车：</h5><ul><li>对准坡道上的黄线大约在车头的右边三分之一处。上去之后，保持黄线在小镜子的左边三分之一处，大约与车身成三角形，接近接触。</li></ul><h5 id="侧方停车"><a class="markdownIt-Anchor" href="#侧方停车"></a> 侧方停车：</h5><ul><li><p>车头盖过蓝线后看右边后视镜，到第二根白线在后视镜中央开始倒车，直至消失时，向右一圈到11点，然后保持直至右边的黄线跑到两个把手的中间时回正，接着看左边，头伸出一点，看后车轮压倒虚线时立马向左打死，然后直至车身完全进入。</p></li><li><p>出去时，左方向灯和换1档，缓速出来，等到车头中央碰到黄线时回正，然后稍微开个0.5s向后一圈左右，车身回正。</p></li></ul><p><a href="https://pan.baidu.com/s/1NKVIC6cgtvp_8tGO4pk2xw" target="_blank" rel="noopener">视频资源——SXH科二教练</a>,提取码：gvqa</p><h3 id="考试"><a class="markdownIt-Anchor" href="#考试"></a> 考试</h3><p>我考的是6号线，也就是S弯结束后立马是直角的那条线。考试的直角给我的感觉是比谷峰训练的时候多很多，所以其实不用担心。至于这个S弯结束后立马是直角，根据模拟的时候开就行了，即出来就向右打死，然后开到路中间</p><h2 id="科三"><a class="markdownIt-Anchor" href="#科三"></a> 科三</h2><blockquote><p>灯光+上路行驶</p></blockquote><h3 id="训练-2"><a class="markdownIt-Anchor" href="#训练-2"></a> 训练</h3><h4 id="灯光"><a class="markdownIt-Anchor" href="#灯光"></a> 灯光</h4><p><img src="/2019/09/14/如何成为一位老司机——考驾照经历/E:%5Chexo%5Csource_posts%5C%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E4%B8%80%E4%BD%8D%E8%80%81%E5%8F%B8%E6%9C%BA%E2%80%94%E2%80%94%E8%80%83%E9%A9%BE%E7%85%A7%E7%BB%8F%E5%8E%86%5Ckes2.jpg" alt="kes2"></p><h4 id="起步和靠边停车"><a class="markdownIt-Anchor" href="#起步和靠边停车"></a> 起步和靠边停车</h4><p><img src="/2019/09/14/如何成为一位老司机——考驾照经历/E:%5Chexo%5Csource_posts%5C%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E4%B8%80%E4%BD%8D%E8%80%81%E5%8F%B8%E6%9C%BA%E2%80%94%E2%80%94%E8%80%83%E9%A9%BE%E7%85%A7%E7%BB%8F%E5%8E%86%5Ckes1.jpg" alt="kes1"></p><p>图片来自于科三教练——杨作栋</p><h3 id="考试-2"><a class="markdownIt-Anchor" href="#考试-2"></a> 考试</h3><p>科三比科二简单很多。科二10节课，科三只有8节也能说明一二。但感觉科三与科二最不同的地方是，科三记的点比科二自然很多。在转头看左右后视镜，我在临近考试的最后两天最后一节课上才练的，一开始觉得右边的后视镜为什么离得那么远，跑了两圈后就发现，看后视镜是件很自然的事，因为你就需要右边的信息。</p><p>而在考试过程中，虽然有安全员在旁边，可能会比科二紧张一些，但是整体上来讲，科三还是很容易的，只要记得，每次完成一个东西后，左右看后视镜基本上就行了。</p><p>▲.我考试的时候，前面有个挂了的人倒是补上了我一个盲点，原来提示前方路口后，如果你打了右方向灯，那么接着往后看。之前我还以为只有真过路口、点刹的时候才需要。只不过面对这种现象，还是之前说的，不管做了什么，左右摇头就是了。</p><p>挂到五档也不用担心，我当时考试时有两条路的路况绝对算不上好，但是我一共还是3次挂到了五档，所以其实升挡的机会还是很多的。</p><p>最后，需要注意的是灯光一定不能错。我是第三个考的，第一个女生灯光挂了一次；第二个男生，起步没打左方向灯，也挂了。</p><h2 id="科四理论考试"><a class="markdownIt-Anchor" href="#科四理论考试"></a> 科四理论考试</h2><p>刷了1280道题，由于有10道多选题的存在，所以真正考试的时候还是比较慌的，一上来就错了两题，最终考了94.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;如何成为一位老司机考驾照经历&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#如何成为一位老司机考驾照经历&quot;&gt;&lt;/a&gt; 如何成为一位老司机——考驾照经历&lt;/h1&gt;
&lt;p&gt;大一下报的名，几经转折，终于在2019-9-12，中秋放假前一天拿到
      
    
    </summary>
    
    
      <category term="生活福利" scheme="https://nymrli.top/tags/%E7%94%9F%E6%B4%BB%E7%A6%8F%E5%88%A9/"/>
    
  </entry>
  
  <entry>
    <title>Java系列环境变量配置</title>
    <link href="https://nymrli.top/2019/09/13/Java%E7%B3%BB%E5%88%97%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/"/>
    <id>https://nymrli.top/2019/09/13/Java系列环境变量配置/</id>
    <published>2019-09-13T04:30:10.000Z</published>
    <updated>2019-09-13T04:30:10.294Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Java自动化构建工具——Maven</title>
    <link href="https://nymrli.top/2019/09/13/Java%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E2%80%94%E2%80%94Maven/"/>
    <id>https://nymrli.top/2019/09/13/Java自动化构建工具——Maven/</id>
    <published>2019-09-13T03:45:50.000Z</published>
    <updated>2019-09-13T03:46:03.714Z</updated>
    
    <content type="html"><![CDATA[<h1 id="java自动化构建工具maven"><a class="markdownIt-Anchor" href="#java自动化构建工具maven"></a> Java自动化构建工具——Maven</h1><h2 id="目前的技术在开发中存在的问题-maven作用"><a class="markdownIt-Anchor" href="#目前的技术在开发中存在的问题-maven作用"></a> 目前的技术在开发中存在的问题、Maven作用</h2><p>①一个项目就是一个工程</p><ul><li>如果项目非常庞大，就不适合继续使用package来划分模块。最好是每一个模块对应一个工程，利于分工协作。</li></ul><p>△借助于Maven就可以将一个项目拆分成多个工程。</p><p>②项目中需要的jar包必须手动“复制”、“粘贴”到WEB-INF/lib目录下</p><ul><li>带来的问题是：同样的jar包文件重复出现在不同的项目工程中，一方面浪费存储空间，另外也让工程比较臃肿。</li></ul><p>△借助Maven，可以将jar包仅仅保存在“仓库”中，有需要使用的工程“引用”这个文件接口，并不需要真的把jar包复制过来。</p><p>③jar包需要别人替我们准备好，或到官网下载</p><ul><li>不同技术的官网提供jar包下载的形式是五花八门的。<br>有些技术的官网就是通过Maven或SVN等专门的工具来提供下载的。<br>如果是以不规范的方式下载的jar包，那么其中的内容很可能也是不规范的。</li></ul><p>△借助于Maven可以以一种规范的方式下载jar包。因为所有知名框架或第三方工具的jar包以及按照统一的规范存放在了Maven的中央仓库中。<br>以规范的方式下载的jar包，内容也是可靠的。</p><p>④一个jar包依赖的其他jar包需要自己手动加入到项目中</p><ul><li>FileUpload组件→IO组件。commons-fileupload-1.3.jar依赖于commons-io-2.0.1.jar。如果所有jar包之间的依赖关系都需要程序员自己非常清楚的了解，那么就会极大的增加学习成本。</li></ul><p>△Maven会自动将被依赖的jar包导入进来。</p><h2 id="maven是什么what"><a class="markdownIt-Anchor" href="#maven是什么what"></a> Maven是什么[What]</h2><p>①Maven是一款服务于Java平台的自动化构建工具。<br>Make→Ant→Maven→Gradle妹文、麦文<br>②构建<br>[1]概念：以&quot;ava源文件”、“框架配置文件”、&quot;JSP”、“HTML”、“图片”等资源为“原材料”，去“生产”一个可以运行的项目的过程。</p><ul><li>编译</li><li>部署</li><li>搭建</li></ul><p>[2]编译：Java源文件[User.java]→编译→Class字节码文件[User.class]→交给JVM去执行<br>[3]部署：一个BS项目最终运行的并不是动态Web工程本身，而是这个动态Web工程“编译的结果&quot;<br>生的鸡→处理一熟的鸡<br>动态Web工程→编译、部署→编译结果</p><h2 id="构建过程中的各个环节"><a class="markdownIt-Anchor" href="#构建过程中的各个环节"></a> 构建过程中的各个环节</h2><p>[1]清理：将以前编译得到的旧的class字节码文件删除，为下一次编译做准备<br>[2]编译：将Java源程序编程成class字节码文件<br>[3]测试：自动测试，自动调用junit程序<br>[4]报告：测试程序执行的结果<br>[5]打包：动态Web工程打war包，Java工程打jar包<br>[6]安装：Maven特定的概念——将打包得到的文件复制到“仓库”中的指定位置<br>[7]部署：将动态Web工程生成的war包复制到Servlet容器的指定目录下，使其可以运行</p><h2 id="常用maven命令"><a class="markdownIt-Anchor" href="#常用maven命令"></a> 常用Maven命令</h2><p>①注意：执行与构建过程相关的Maven命令，必须进入pom.xml所在的目录。<br>与构建过程相关：编译、测试、打包、……<br>②常用命令<br>[1]mvn clean：清理<br>[2]mvn compile：编译主程序<br>[3]mvn test-compile：编译测试程序<br>[4]mvn test：执行测试<br>[5]mvn package：打包</p><h2 id="联网问题"><a class="markdownIt-Anchor" href="#联网问题"></a> 联网问题</h2><p>①Maven的核心程序中仅仅定义了抽象的生命周期，但是具体的工作必须由特定的插件来完成。而插件本身并不包含在Maven的核心程序中。<br>②当我们执行的Maven命令需要用到某些插件时，Maven核心程序会首先到本地仓库中查找。<br>③本地仓库的默认位置：[系统中当前用户的家目录].m2\repository 如<code>C:\Users\[登录当前系统的用户名]\.m2\repository</code><br>④Maven核心程序如果在本地仓库中找不到需要的插件，那么它会自动连接外网，到中央仓库下载。<br>⑤如果此时无法连接外网，则构建失败。<br>⑥修改默认本地仓库的位置可以让Maven核心程序到我们事先准备好的目录下查找插件<br>[1]找到Maven解压目录<code>\conf/settings.xml</code><br>[2]在settings.xml文件中找到localRepository标签<br>[3]将<code>&lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</code>从注释中取出<code>E:\apache-maven-3.6.2\MavenRepo</code><br>[4]将标签体内容修改为已经准备好的Maven仓库目录</p><h3 id="补充"><a class="markdownIt-Anchor" href="#补充"></a> 补充:</h3><p>换镜像,可以在settings.xml的第153行左右,设置阿里云镜像</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://www.bilibili.com/video/av63847523/?p=3" target="_blank" rel="noopener">介绍Maven的视频</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;java自动化构建工具maven&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#java自动化构建工具maven&quot;&gt;&lt;/a&gt; Java自动化构建工具——Maven&lt;/h1&gt;
&lt;h2 id=&quot;目前的技术在开发中存在的问题-maven作用&quot;
      
    
    </summary>
    
    
      <category term="Java" scheme="https://nymrli.top/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>打jar包和使用jar包</title>
    <link href="https://nymrli.top/2019/09/13/%E6%89%93jar%E5%8C%85%E5%92%8C%E4%BD%BF%E7%94%A8jar%E5%8C%85/"/>
    <id>https://nymrli.top/2019/09/13/打jar包和使用jar包/</id>
    <published>2019-09-13T03:45:11.000Z</published>
    <updated>2019-09-13T03:45:28.252Z</updated>
    
    <content type="html"><![CDATA[<h1 id="打jar包和使用jar包"><a class="markdownIt-Anchor" href="#打jar包和使用jar包"></a> 打jar包和使用jar包</h1><h2 id="一-为什么要打jar包"><a class="markdownIt-Anchor" href="#一-为什么要打jar包"></a> 一、为什么要打jar包</h2><p>给别人用的时候一般给别人的是class文件。如果有很多类这么办？把类变成一个压缩包！windows下的压缩包是.zip格式等，而eclipse压缩包是.jar格式。</p><h2 id="二-如何查看jar包"><a class="markdownIt-Anchor" href="#二-如何查看jar包"></a> 二、如何查看jar包</h2><p>用<strong>解压缩软件解压</strong>即可。可以看到里面有哪些class文件。</p><h2 id="三-如何开发jar包"><a class="markdownIt-Anchor" href="#三-如何开发jar包"></a> 三、如何开发jar包</h2><p>开发jar包的人员开发流程：</p><h3 id="步骤1编写类"><a class="markdownIt-Anchor" href="#步骤1编写类"></a> 步骤1:编写类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//GetSum.java</span></span><br><span class="line"><span class="keyword">package</span> cn.itcast.sum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetSum</span></span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">getSum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a+b;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="步骤2打包成jar包"><a class="markdownIt-Anchor" href="#步骤2打包成jar包"></a> 步骤2:打包成jar包</h3><p>在要导出的类上,右键-&gt;Export-&gt;java -&gt; JAR file,然后选择路径,如D:\sum.jar -&gt;导出。</p><p>打开jar包可以看到jar包中含有class文件。</p><h2 id="四-如何使用jar包"><a class="markdownIt-Anchor" href="#四-如何使用jar包"></a> 四、如何使用jar包</h2><p>当别人发过来一个jar包(jar包里面有很多class文件)后，比如上面的sum.jar包，如何使用呢？</p><p>有两种方法。第一种方法一般不用，太low了。</p><h4 id="使用方法一这个方法太low了不用"><a class="markdownIt-Anchor" href="#使用方法一这个方法太low了不用"></a> 使用方法一：这个方法太low了，不用</h4><p>步骤1:编写Test.java文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Test.java</span></span><br><span class="line"><span class="keyword">import</span> cn.itcast.sum.*;<span class="comment">//光设置classpath的环境变量还是不够，还要导入包 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">            <span class="keyword">int</span> a = GetSum.getSum(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">            System.out.println(); </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>步骤2:在cmd窗口中使用</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="built_in">set</span> classpath = D:\sum.jar;                        //设置环境变量，知道在哪里找jar包。只在当前的窗口有效。</span><br><span class="line">&gt;javac Test.java</span><br><span class="line">&gt;java Test</span><br></pre></td></tr></table></figure><h4 id="使用方法二一般使用这个方法"><a class="markdownIt-Anchor" href="#使用方法二一般使用这个方法"></a> 使用方法二：一般使用这个方法</h4><p>步骤1:在工程目录下新建文件夹lib：File-&gt;New-&gt;Folder,文件名lib，将需要使用的jar包复制进去（ctrl c、ctrl v）。在工程上右键刷新就可以看到jar包了</p><p>步骤2:在需要使用的jar包上，右键-&gt;build path -&gt;Add to build Path，发现多了一个小奶瓶～</p><p>步骤3:编写测试类Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Test.java</span></span><br><span class="line"><span class="keyword">import</span> cn.itcast.GetSum;<span class="comment">//不用自己导入。当下面输入GetSum.getSum()时候，按Ctrl+Shift+o自动输入包名。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">            <span class="keyword">int</span> a = GetSum.getSum(<span class="number">1</span>,<span class="number">2</span>);            <span class="comment">//直接使用jar包下面的class类</span></span><br><span class="line">            System.out.println(); </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><p>鼠标点到getSum()上，然后按F3，是看不到源码的。出现下面这种界面。这是因为<strong>源码不在jdk里面</strong>。<br>可以点击Attach Source按钮，然后点击&quot;External File…&quot;或者&quot;External Folder&quot;找到jar包对应的源码。（jar包中有class文件，并不是源码。）</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;打jar包和使用jar包&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#打jar包和使用jar包&quot;&gt;&lt;/a&gt; 打jar包和使用jar包&lt;/h1&gt;
&lt;h2 id=&quot;一-为什么要打jar包&quot;&gt;&lt;a class=&quot;markdownIt-Anc
      
    
    </summary>
    
    
      <category term="Java" scheme="https://nymrli.top/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>验证码识别程序设计流程</title>
    <link href="https://nymrli.top/2019/09/09/%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B/"/>
    <id>https://nymrli.top/2019/09/09/验证码识别程序设计流程/</id>
    <published>2019-09-09T13:31:35.000Z</published>
    <updated>2019-09-09T13:47:30.577Z</updated>
    
    <content type="html"><![CDATA[<h1 id="验证码识别程序设计流程"><a class="markdownIt-Anchor" href="#验证码识别程序设计流程"></a> 验证码识别程序设计流程</h1><blockquote><p>以<a href="http://jwxt.njupt.edu.cn/" target="_blank" rel="noopener">南邮正方教务系统</a>为例</p></blockquote><h2 id="找到验证码图片的链接"><a class="markdownIt-Anchor" href="#找到验证码图片的链接"></a> 找到验证码图片的链接</h2><blockquote><p>“<a href="http://jwxt.njupt.edu.cnCheckCode.aspx" target="_blank" rel="noopener">http://jwxt.njupt.edu.cnCheckCode.aspx</a>”</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getCaptcha</span><span class="params">()</span>:</span></span><br><span class="line">    CAPTCHA_URL = <span class="string">"http://jwxt.njupt.edu.cn/CheckCode.aspx"</span></span><br><span class="line"></span><br><span class="line">    r = requests.get(CAPTCHA_URL)</span><br><span class="line">    img = r.content</span><br><span class="line">    img = Image.open(BytesIO(img))</span><br><span class="line">    <span class="keyword">return</span> img</span><br></pre></td></tr></table></figure><h2 id="对图片去噪"><a class="markdownIt-Anchor" href="#对图片去噪"></a> 对图片去噪</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_pre_process</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="comment"># 去除杂色点</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(self.image.width):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> range(self.image.height):</span><br><span class="line">            pix = self.image.getpixel((x, y))</span><br><span class="line">            <span class="keyword">if</span> pix == <span class="number">43</span>:</span><br><span class="line">                self.image.putpixel((x, y), WHITE)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.image.putpixel((x, y), BLACK)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># 去除单像素噪点并进行二值化(八值法)</span></span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> range(self.image.width):</span><br><span class="line">                        <span class="keyword">for</span> y <span class="keyword">in</span> range(self.image.height):</span><br><span class="line">                            count = <span class="number">0</span></span><br><span class="line">                            <span class="keyword">if</span> x != <span class="number">0</span> <span class="keyword">and</span> y != <span class="number">0</span> <span class="keyword">and</span> x != self.image.width - <span class="number">1</span> <span class="keyword">and</span> y != self.image.height - <span class="number">1</span>:</span><br><span class="line">                                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">-1</span>, <span class="number">2</span>):</span><br><span class="line">                                    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">-1</span>, <span class="number">2</span>):</span><br><span class="line">                                        tx = x + i</span><br><span class="line">                                        ty = y + j</span><br><span class="line">                                        <span class="keyword">if</span> self.image.getpixel((tx, ty)) == BLACK:</span><br><span class="line">                                            count += <span class="number">1</span></span><br><span class="line">                                            <span class="keyword">if</span> self.image.getpixel((x, y)) == WHITE <span class="keyword">and</span> count == <span class="number">8</span>:</span><br><span class="line">                                                <span class="comment"># 如果一个白色区域的附近八连通区域都是黑色,那么该点也认为是黑色</span></span><br><span class="line">                                                self.image.putpixel((x, y), BLACK)</span><br><span class="line">                                                self.image = self.image.convert(<span class="string">'1'</span>)</span><br></pre></td></tr></table></figure><p>△二值化:将需要识别的蓝色字符(43)转为白色(WHITE),其他的全部变为黑色(BLACK)</p><ul><li>二值化的过程需要灵性一点,不能直接用convert函数,那样的效果并不理想。</li></ul><p>直接convert的效果:</p><p><img src="/2019/09/09/验证码识别程序设计流程/E:%5Chexo%5Csource_posts%5C%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B%5C%E7%9B%B4%E6%8E%A5%E4%BA%8C%E5%80%BC%E5%8C%96.bmp" alt="直接二值化"></p><p>先对蓝色43进行二值化，然后去单点噪声、最后二值化的效果：</p><p><img src="/2019/09/09/验证码识别程序设计流程/E:%5Chexo%5Csource_posts%5C%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B%5C%E5%8E%BB%E5%99%AA%E5%86%8D%E4%BA%8C%E5%80%BC%E5%8C%96.bmp" alt="去噪再二值化"></p><h2 id="设计打码程序设计"><a class="markdownIt-Anchor" href="#设计打码程序设计"></a> 设计打码程序设计</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">方便收集验证码的简单打码工具</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageTk</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaGUI</span>:</span></span><br><span class="line">    captcha_url = <span class="string">"http://jwxt.njupt.edu.cn/CheckCode.aspx"</span></span><br><span class="line">    login_url = <span class="string">"http://jwxt.njupt.edu.cn/default2.aspx"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line"></span><br><span class="line">        self.s = requests.session()</span><br><span class="line">        self.get_viewstate()</span><br><span class="line">        self.r = self.s.get(self.captcha_url)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line"></span><br><span class="line">        self.root = tkinter.Tk()</span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel = tkinter.Label(self.root, image=self.tkimg)</span><br><span class="line">        self.imgLabel.pack()</span><br><span class="line">        self.message = tkinter.Entry(self.root)</span><br><span class="line">        self.message.pack()</span><br><span class="line">        self.root.bind(<span class="string">'&lt;Return&gt;'</span>, self.judge_and_save)</span><br><span class="line">        self.root.mainloop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_viewstate</span><span class="params">(self)</span>:</span></span><br><span class="line">        r = self.s.get(self.login_url)</span><br><span class="line">        soup = BeautifulSoup(r.content, <span class="string">"lxml"</span>)</span><br><span class="line">        self.viewstate = soup.find(<span class="string">'input'</span>, attrs=&#123;<span class="string">"name"</span>: <span class="string">"__VIEWSTATE"</span>&#125;).get(<span class="string">"value"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">judge_and_save</span><span class="params">(self, event)</span>:</span></span><br><span class="line">        captcha_value = self.message.get()</span><br><span class="line">        print(captcha_value)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"__VIEWSTATE"</span>: self.viewstate,</span><br><span class="line">            <span class="string">'txtUserName'</span>: <span class="string">""</span>,  <span class="comment"># 账号</span></span><br><span class="line">            <span class="string">'TextBox2'</span>: <span class="string">""</span>,  <span class="comment"># 密码</span></span><br><span class="line">            <span class="string">'RadioButtonList1'</span>: <span class="string">"%D1%A7%C9%FA"</span>,</span><br><span class="line">            <span class="string">"Button1"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"txtSecretCode"</span>: captcha_value,</span><br><span class="line">            <span class="string">"hidPdrs"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"hidsc"</span>: <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = self.s.post(self.login_url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"请到信息维护中完善个人联系方式"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            print(<span class="string">"成功！"</span>)</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">"captchas/&#123;&#125;.gif"</span>.format(captcha_value), <span class="string">'wb+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(self.r.content)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"验证码输错了"</span>)</span><br><span class="line">        self.get_viewstate()</span><br><span class="line">        self.r = self.s.get(self.captcha_url)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel.config(image=self.tkimg)</span><br><span class="line">        self.message.delete(<span class="number">0</span>, <span class="string">'end'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    captcha_gui = CaptchaGUI()</span><br></pre></td></tr></table></figure><h2 id="将结果分割到每个字符"><a class="markdownIt-Anchor" href="#将结果分割到每个字符"></a> 将结果分割到每个字符</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_split_image</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="comment"># 切割验证码，返回包含四个字符图像的列表</span></span><br><span class="line">    y_min, y_max = <span class="number">0</span>, <span class="number">22</span></span><br><span class="line">    split_lines = [<span class="number">5</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">41</span>, <span class="number">53</span>]</span><br><span class="line">    ims = [rotate_img(self.image.crop([u, y_min, v, y_max])) <span class="keyword">for</span> u, v <span class="keyword">in</span> zip(split_lines[:<span class="number">-1</span>], split_lines[<span class="number">1</span>:])]</span><br><span class="line">    <span class="keyword">return</span> ims</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spilt2chars</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    分割已有的数据为字符并保存</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        shutil.rmtree(<span class="string">'captcha_chars'</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    os.mkdir(<span class="string">"captcha_chars"</span>)</span><br><span class="line">    values = <span class="string">"abcdefghijklmnopqrstuvwxyz1234567890"</span></span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> values:</span><br><span class="line">        os.mkdir(<span class="string">'captcha_chars/&#123;&#125;'</span>.format(value))</span><br><span class="line"></span><br><span class="line">    file_names = os.listdir(<span class="string">'captchas'</span>)</span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:  <span class="comment">#</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(file_name) <span class="keyword">and</span> file_name != <span class="string">'.DS_Store'</span>:</span><br><span class="line">            values = file_name[:<span class="number">4</span>]</span><br><span class="line">            im = Image.open(<span class="string">'captchas/&#123;&#125;'</span>.format(file_name))</span><br><span class="line">            captcha = ZhengfangCaptcha(im)</span><br><span class="line">            <span class="comment"># 用的是去噪、二值化的图片</span></span><br><span class="line">            <span class="keyword">for</span> im_part, value <span class="keyword">in</span> zip(captcha.handle_split_image(), values):</span><br><span class="line">                m = hashlib.md5()</span><br><span class="line">                m.update(<span class="string">"&#123;&#125;&#123;&#125;"</span>.format(time.time(), value).encode(<span class="string">'utf8'</span>))</span><br><span class="line">                im_part.save(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;.png"</span>.format(value, m.hexdigest()))</span><br></pre></td></tr></table></figure><h2 id="保存模型数据"><a class="markdownIt-Anchor" href="#保存模型数据"></a> 保存模型数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># spilt2chars()</span></span><br><span class="line">    letters = list(<span class="string">'qwertyuiopasdfghjklzcxvbnm1234567890'</span>)</span><br><span class="line">    <span class="comment"># 将图像数据转为向量数据并保存</span></span><br><span class="line">    imageset = []</span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> letters:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> os.listdir(<span class="string">'captcha_chars/&#123;&#125;/'</span>.format(letter)):</span><br><span class="line">                <span class="keyword">if</span> img != <span class="string">"Thumbs.db"</span> <span class="keyword">and</span> img != <span class="string">".DS_Store"</span>:</span><br><span class="line">                    vector = ZhengfangCaptcha.buildvector(Image.open(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;"</span>.format(letter, img)))</span><br><span class="line">                    imageset.append(&#123;letter: vector&#125;)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'image_data.json'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(imageset, f)</span><br></pre></td></tr></table></figure><h2 id="识别"><a class="markdownIt-Anchor" href="#识别"></a> 识别</h2><p>辅助函数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">BLACK = <span class="number">0</span></span><br><span class="line">WHITE = <span class="number">255</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">magnitude</span><span class="params">(concordance)</span>:</span></span><br><span class="line">    total = reduce(operator.add, map(<span class="keyword">lambda</span> x: x ** <span class="number">2</span>, concordance))</span><br><span class="line">    <span class="keyword">return</span> math.sqrt(total)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算矢量之间的余弦距离</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">distance_cos</span><span class="params">(vector1, vector2)</span>:</span></span><br><span class="line">    sum_value = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> value1, value2 <span class="keyword">in</span> zip(vector1, vector2):</span><br><span class="line">        sum_value += value1 * value2</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> - sum_value / (magnitude(vector1) * magnitude(vector2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">distance_hanmming</span><span class="params">(vector1, vector2)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    计算两向量的汉明距，（向量只包含0，1时）</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> value1, value2 <span class="keyword">in</span> zip(vector1, vector2):</span><br><span class="line">        <span class="keyword">if</span> value1 != value2:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_vector</span><span class="params">(image, binary=True)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    图像转一维特征向量</span></span><br><span class="line"><span class="string">    :param image: pillow Image object with mode 1 or mode L</span></span><br><span class="line"><span class="string">    :param binary: 黑白图是否生成为0，1向量</span></span><br><span class="line"><span class="string">    :return: list of int</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    vector = []</span><br><span class="line">    <span class="keyword">for</span> pixel <span class="keyword">in</span> image.getdata():</span><br><span class="line">        <span class="keyword">if</span> binary:</span><br><span class="line">            vector.append(<span class="number">1</span> <span class="keyword">if</span> pixel == <span class="number">255</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            vector.append(pixel)</span><br><span class="line">    <span class="keyword">return</span> vector</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotate_img</span><span class="params">(image)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    根据图像在x轴方向投影大小确定字符的摆放方向</span></span><br><span class="line"><span class="string">    :param image: PIL.Image object</span></span><br><span class="line"><span class="string">    :return: rotated Image object</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    min_count = <span class="number">1000</span></span><br><span class="line">    final_angle = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> angle <span class="keyword">in</span> range(<span class="number">-45</span>, <span class="number">45</span>):</span><br><span class="line">        x_count = <span class="number">0</span></span><br><span class="line">        ti = image.rotate(angle, expand=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(ti.width):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(ti.height):</span><br><span class="line">                <span class="keyword">if</span> ti.getpixel((x, y)) == WHITE:</span><br><span class="line">                    x_count += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> x_count &lt; min_count:</span><br><span class="line">            min_count = x_count</span><br><span class="line">            final_angle = angle</span><br><span class="line">    image = image.rotate(final_angle, expand=<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">return</span> image</span><br></pre></td></tr></table></figure><p>识别部分:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xxx</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    knn 识别正方验证码</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, image)</span>:</span></span><br><span class="line">        self.image = image</span><br><span class="line">        self.image_pre_process()</span><br><span class="line">        <span class="comment"># 初始化时就对图片进行去噪和二值化</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">crack</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="comment"># 加载数据</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(current_dir, <span class="string">'image_data.json'</span>), <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            image_data = json.load(f)</span><br><span class="line">            <span class="keyword">for</span> letter <span class="keyword">in</span> self.handle_split_image():</span><br><span class="line">                letter_vector = build_vector(letter)</span><br><span class="line">                guess = []</span><br><span class="line">                <span class="keyword">for</span> image <span class="keyword">in</span> image_data:</span><br><span class="line">                    <span class="keyword">for</span> x, y <span class="keyword">in</span> image.items():</span><br><span class="line">                        guess.append((distance_hanmming(y, letter_vector), x))</span><br><span class="line">                        guess.sort()</span><br><span class="line">                        neighbors = guess[:<span class="number">15</span>]  <span class="comment"># 距离最近的十五个向量</span></span><br><span class="line">                        class_votes = &#123;&#125;  <span class="comment"># 投票</span></span><br><span class="line">                        <span class="keyword">for</span> neighbor <span class="keyword">in</span> neighbors:</span><br><span class="line">                            class_votes.setdefault(neighbor[<span class="number">-1</span>], <span class="number">0</span>)</span><br><span class="line">                            class_votes[neighbor[<span class="number">-1</span>]] += <span class="number">1</span></span><br><span class="line">                            sorted_votes = sorted(class_votes.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="keyword">True</span>)</span><br><span class="line">                            result.append(sorted_votes[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">                            <span class="keyword">return</span> <span class="string">''</span>.join(result)</span><br></pre></td></tr></table></figure><p>△.在对象的识别上,一定要保证两者的统一性。而因为进行预处理的图片识别率更高。即<strong>模型需要保存去噪、二值化的数据，识别的图片在识别前也要做相应的处理</strong>。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;验证码识别程序设计流程&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#验证码识别程序设计流程&quot;&gt;&lt;/a&gt; 验证码识别程序设计流程&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;以&lt;a href=&quot;http://jwxt.njupt.edu.
      
    
    </summary>
    
    
      <category term="爬虫" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>新加坡游玩经验</title>
    <link href="https://nymrli.top/2019/09/09/%E6%96%B0%E5%8A%A0%E5%9D%A1%E6%B8%B8%E7%8E%A9%E7%BB%8F%E9%AA%8C/"/>
    <id>https://nymrli.top/2019/09/09/新加坡游玩经验/</id>
    <published>2019-09-09T11:35:49.000Z</published>
    <updated>2019-09-09T11:36:14.839Z</updated>
    
    <content type="html"><![CDATA[<h1 id="新加坡南洋理工大学访学"><a class="markdownIt-Anchor" href="#新加坡南洋理工大学访学"></a> 新加坡南洋理工大学访学</h1><p>此次访学长达14天，不少安排都是学校安排，在此仅列出个人安排、经验心得。</p><hr><h2 id="门票购买"><a class="markdownIt-Anchor" href="#门票购买"></a> 门票购买：</h2><p>番薯游：这是老师推荐我们的，但下载以后感觉界面还是比较丑的，而且价格也不是非常便宜。这家是唯一一家促进扫码买门票的公司。</p><p>KLOOK客路：界面比番薯游好多了，还是非常精致的。最大的优势在于可以找到经典的位置及景点介绍、门票时间等信息。</p><p>淘宝：跟好几个平台对比之后，价格应该是最低的，并且时间限制比较小，其他的可能要预约，而TB当天购买就行（强调：动物园门票）</p><p>▲特别说明下，动物园的门票水很深。当面购买$50,我当时去时没有预约，结果在KLOOK上看当天的票已经没有库存了，于是问了下换票机旁边的黄牛，他看我一个人，给我的报价也是50，不知道他咋想的。最后这个预约问题是通过淘宝解决的，￥156一张夜间动物园门票，5分钟就出票了。购买后会有一张带有二维码的PDF发到邮箱中，用机子扫出后即可。</p><hr><h2 id="地铁卡购买"><a class="markdownIt-Anchor" href="#地铁卡购买"></a> 地铁卡购买：</h2><p>网上的说法都推荐购买<strong>EZ-LINK</strong>，但我们在NTU里的711便利店买时最后一张正好卖掉了，于是我们买的是这样的卡，后来发现这卡比EZ-LINK强多了。</p><p>由于它支持多家银行支付（由于种种原因，扫码支付在新加坡很难推行），因此其实这张卡十分的方便。既能在学校食堂消费，又能在外消费，同时地铁公交也都支持。</p><h2 id="地铁公交价格明细"><a class="markdownIt-Anchor" href="#地铁公交价格明细"></a> 地铁公交价格明细：</h2><p>如果有卡和没卡，价格区别是很大的，因此如果出行需要坐公交、地铁的话，强烈建议直接办地铁卡。</p><p>虽然每次充钱最低10$，但几乎每次坐车都在0.83$以上，所以开销还是非常大的。2.坐地铁低于2$就无法进站，公交低于1$（不知道是不是所有）</p><hr><h2 id="行为规范"><a class="markdownIt-Anchor" href="#行为规范"></a> 行为规范：</h2><p>新加坡的治安、素质是相当高的。其中比较明显的现象有：不乱丢垃圾；在地铁上不能饮食；地铁、公交先下后上；</p><p>▲1.如果有残疾人士，会有人帮忙放下挡板，帮残疾人士下车。我看到的那次是车上只有司机，坐轮椅的老奶奶要下公交，司机特地跑来放挡板，帮老人下车。</p><p>2.问司机路，他甚至会下车下来给你指往哪个方向怎么走</p><p>3.公交车到站需要按<strong>BUS STOPPING</strong>按钮，不然司机是真的不会停的！地铁的话几乎每站都会停。还有个非常重要的是，BUS每一站是不会报的，因此在新加坡坐公交很容易坐过头，这就需要看清楚地图定位和留意每一站名字。</p><hr><h2 id="地图推荐"><a class="markdownIt-Anchor" href="#地图推荐"></a> 地图推荐</h2><p>高德不支持国外，因此我主要使用的是两个：Google Maps、百度地图。</p><p>其实百度地图挺好用的，我同学都用的百度，没必要特地去下载Google Maps。而在此我说一下我用Google Maps碰到的问题。1.坐地铁、公交时不会提醒花费。2.没有Google Player服务，周围推荐功能无法使用。3.我用的是MI6，但总感觉有时定位效果特别差，不知道是我手机GPS功能问题，还是Google Maps的问题</p><hr><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>新加坡是非常适合国人旅游的，首先是新加坡双语教学，很多人都会说中文，遇上麻烦，看看周围的人总能碰到说中文的；其次是商城里也大多有中文介绍，买东西时几乎每个店都会有说中文的店员来做国人生意，也几乎不太会碰上麻烦。</p><p>新加坡有70%的人是中国人或是华裔，10%是印度人，10%是马来人，还有10%是来自欧洲和日本、韩国等地。总的来说中国人比例还是非常大的，而且85%左右的旅客都来自中国，所以其实路上看到很多说中文的说不定也是跟你一样的游客。我交流比较多的都是中国人，特别是彭年纪大的老奶奶或是老爷爷，你如果向他问路，他们都会非常热心地帮助，恨不得亲自带你去了。</p><hr><h2 id="外文缩写"><a class="markdownIt-Anchor" href="#外文缩写"></a> 外文缩写</h2><p>新加坡，几乎都有双语标注，因此英语不好的问题也不大。这边就列出几个常见的缩写</p><p>st --&gt; street</p><p>rd --&gt; road</p><p>sch --&gt; school</p><hr><h2 id="景点推荐"><a class="markdownIt-Anchor" href="#景点推荐"></a> 景点推荐：</h2><h3 id="乌节路-orchard-road"><a class="markdownIt-Anchor" href="#乌节路-orchard-road"></a> 乌节路 Orchard road</h3><ul><li>购物一条街，ION商城，义乌城……里面全是品牌。</li></ul><h3 id="圣淘沙-sentosa"><a class="markdownIt-Anchor" href="#圣淘沙-sentosa"></a> 圣淘沙 Sentosa</h3><ul><li>环球影城就在这岛上，门票350+，我没去，同学去了，感觉很不错，类似迪士尼的游乐园，有多种的主题</li></ul><h3 id="滨海湾-marina-bay"><a class="markdownIt-Anchor" href="#滨海湾-marina-bay"></a> 滨海湾 Marina Bay</h3><ul><li>superTree Grove是免费的，晚上有表演，大约在8：45左右开始，非常的好看。此处景点有两个收费的地方，我也没去。</li><li>靠近湖边，有两个博物馆，一个是<strong>红点设计博物馆</strong>（这个我去了，门票大约￥70，地方很小，出来的商店卖的东西很贵）；另一个是<strong>金沙艺术科学博物馆</strong>（主题是“超越未来”，看介绍有点像是失恋博物馆里的光影效果）</li></ul><h3 id="鱼尾狮公园-merlion-park"><a class="markdownIt-Anchor" href="#鱼尾狮公园-merlion-park"></a> 鱼尾狮公园 Merlion  Park</h3><ul><li>其实没啥好看的，有鱼尾狮，打个卡、拍个照差不多了。</li></ul><h3 id="植物园-botanic-garden"><a class="markdownIt-Anchor" href="#植物园-botanic-garden"></a> 植物园 Botanic garden</h3><ul><li>免费，徒步走还挺大的，大约半小时。里面植物很多，一般都是国内看不到的，喜欢看植物的人可以去看一下。同时那也有不少动物，都可以当个小型动物园了。</li></ul><h3 id="小印度-little-indian"><a class="markdownIt-Anchor" href="#小印度-little-indian"></a> 小印度 Little Indian</h3><ul><li>印度人很多，印度氛围很重。其他的话个人感觉没什么意思，在那边比较有名的印度餐馆里吃了咖喱鱼头，味道还不错，只不过两个人吃点中份的有点太多了。</li><li>Mustafa百货商城，真的很大，有两栋楼互相连通，深不见底，一共有四层。那边的东西也是比较便宜的，比如在NTU超市里买的饮料$2.5，这边只要$1.8左右；还有oldTown咖啡，在fairprice超市卖$7.2，在Mustafa只要$5.4。这边非常值得去，可以在这捎点带给朋友的东西</li></ul><h3 id="夜间动物园"><a class="markdownIt-Anchor" href="#夜间动物园"></a> 夜间动物园</h3><ul><li>比较偏，去和回都很麻烦，坐地铁转公交啥的回NTU要1个半钟头，打车回只要15分钟。门票现场买时$50，淘宝上￥150。买了门票进去后现有游览车观光，但是如果不加钱是英文讲解的（几乎听不懂w_w）。由于夜色较暗（灯光考虑到对动物的效果也不是很亮），且大多动物都已睡眠，所以游览车观光没什么意思。比较有意思的是<strong>动物表演</strong>，去的人几乎都会推荐，但需要注意的是，要提前等，因为先来先得位置，位置满后就不能进了，超时10分钟也不会让进了（表演一共15-20分钟左右）。游览车观光后的自由行也是比较有意思的，氛围就像是在丛林中，隔一段距离就是一个品种的动物。有很多平时没见过的大动物与小动物，小动物一般都有玻璃格挡，大动物的站台与马路就一道坎的隔离，管理员似乎很放心他们不会跑出来（老虎除外）</li></ul><h3 id="城市规划馆ura"><a class="markdownIt-Anchor" href="#城市规划馆ura"></a> 城市规划馆URA</h3><ul><li>很有意思，由60岁的Steven给我们讲解了新加坡建设的历史以及未雨绸缪地规划，其中3D立体模型图非常精致地还原了各地地细节，在游玩之前看一下这个对出游有极大的帮助</li></ul><h3 id="国家博物馆"><a class="markdownIt-Anchor" href="#国家博物馆"></a> 国家博物馆</h3><ul><li>真的很有意思，比国内的博物馆真实多了。在里面能看到新加坡的发展史、侵略史，能看到英军的身影，也能看到中国和日本的身影。当然其中比较有意思的是有真的坦克在里面展览。</li><li>比较遗憾的是我们是上午10点开门的时候去的，而讲解在11：30才开始，因此我们全参观完后讲解正刚开始，侥幸还听到了一点，真的很有意思，建议要去的话凑着这个时间点去，因为虽然有手册介绍，但是自己看真的可能看不明白</li></ul><h3 id="国家美术馆"><a class="markdownIt-Anchor" href="#国家美术馆"></a> 国家美术馆</h3><ul><li>由于8月上旬新加坡国庆在美术馆附近举行，因此8月9日之前都关闭着，因此没几乎进去看看。</li></ul><h2 id="美食推荐"><a class="markdownIt-Anchor" href="#美食推荐"></a> 美食推荐</h2><p>叻沙</p><p>沙爹</p><p>福建炒面</p><p>印度飞饼</p><p>辣椒螃蟹(Big Eater seafood)</p><p>肉骨茶</p><hr><h2 id="附录2019年8月9日新加坡国庆节节目安排"><a class="markdownIt-Anchor" href="#附录2019年8月9日新加坡国庆节节目安排"></a> <strong><a href="https://mp.weixin.qq.com/s/UCpV10WZm8lcKNH08YNoTA" target="_blank" rel="noopener">附录：2019年8月9日新加坡国庆节节目安排</a></strong></h2><blockquote><p>（万事通根据预演推测独家整理）</p></blockquote><p>下午6点3分-6点10分 红狮跳伞队表演（随天气变化时间）</p><p>下午6点27分-下午6点30分 特遣队入场</p><p>下午6:35-6:38 国家色彩和荣誉护卫队入场</p><p>下午6:39 总理抵达</p><p>下午6:44 总统抵达</p><p>下午6:45-6:46 国旗飞扬</p><p>下午6:47 新加坡空军空中表演（F15战斗机）</p><p>下午6:49-6:52  鸣礼炮21响致敬</p><p>下午6:56-6:57 欢乐之火（大型篝火）</p><p>下午6:57 飞行表演</p><p>晚上7:00-7:01 新加坡空军多架F15战斗机飞行表演</p><p>晚上7:01-7:12 阅兵仪式</p><p>晚上7:14-7:39 机动部队出动</p><p>晚上8:00-8:05 新加坡河烟花表演（亚洲文明博物馆附近）</p><p>晚上8:10-8:18 烟花表演</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;新加坡南洋理工大学访学&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#新加坡南洋理工大学访学&quot;&gt;&lt;/a&gt; 新加坡南洋理工大学访学&lt;/h1&gt;
&lt;p&gt;此次访学长达14天，不少安排都是学校安排，在此仅列出个人安排、经验心得。&lt;/p&gt;
&lt;hr&gt;
      
    
    </summary>
    
    
      <category term="生活福利" scheme="https://nymrli.top/tags/%E7%94%9F%E6%B4%BB%E7%A6%8F%E5%88%A9/"/>
    
  </entry>
  
  <entry>
    <title>CDN加速个人博客——又拍云</title>
    <link href="https://nymrli.top/2019/09/09/CDN%E5%8A%A0%E9%80%9F%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E2%80%94%E2%80%94%E5%8F%88%E6%8B%8D%E4%BA%91/"/>
    <id>https://nymrli.top/2019/09/09/CDN加速个人博客——又拍云/</id>
    <published>2019-09-09T11:34:27.000Z</published>
    <updated>2019-09-15T06:43:31.761Z</updated>
    
    <content type="html"><![CDATA[<h1 id="cdn加速个人博客又拍云"><a class="markdownIt-Anchor" href="#cdn加速个人博客又拍云"></a> CDN加速个人博客——又拍云</h1><blockquote><p>CDN(Content Delivery Network)内容发布网络，基本思路就是将你网站放置在各地节点服务器，用户访问时找最近的节点服务器获取数据，达到加速的目的。</p></blockquote><h2 id="几大厂商的cdn方案"><a class="markdownIt-Anchor" href="#几大厂商的cdn方案"></a> 几大厂商的CDN方案</h2><table><thead><tr><th>资费介绍页面</th><th>免费额度</th><th>是否支持HTTPS</th><th>额外限制</th><th>注册邀请链接</th></tr></thead><tbody><tr><td><a href="https://www.qiniu.com/prices?source=fusion" target="_blank" rel="noopener">七牛云</a></td><td>10GB/月</td><td>按量付费支持</td><td>/</td><td><a href="https://portal.qiniu.com/signup?code=3liwfwr7z4eoi" target="_blank" rel="noopener">&gt;&gt;&gt; 点击注册</a></td></tr><tr><td><a href="https://buy.cloud.tencent.com/price/cdn/overview" target="_blank" rel="noopener">腾讯云</a></td><td>10GB/月</td><td>免费支持</td><td>加了腾讯云CDN没有感觉多大加速</td><td>/</td></tr><tr><td><a href="https://su.baidu.com/plan.html#compare" target="_blank" rel="noopener">百度云</a></td><td>10GB/天</td><td>年费付费支持</td><td>巨贵…</td><td>/</td></tr><tr><td><a href="https://www.upyun.com/league" target="_blank" rel="noopener">又拍云</a></td><td>15GB/月</td><td>免费支持</td><td>加入又拍云联盟，并在网站底部放置logo</td><td><a href="https://console.upyun.com/register/?invite=r1A6SzenN" target="_blank" rel="noopener">&gt;&gt;&gt; 点击注册</a></td></tr></tbody></table><p>因此，选择尝试了下“又拍云”。</p><h2 id="一创建cdn服务"><a class="markdownIt-Anchor" href="#一创建cdn服务"></a> 一.创建CDN服务</h2><p>1.服务名称为唯一的ID</p><p>2.加速域名就是自己的网站域名</p><p>3.选择一个应用场景，在这，我选的是“网页图片”</p><p>4.回源管理-&gt;源站设置，网站原本是什么协议就选择什么协议。</p><blockquote><p>回源: 当缓存服务器(CDN提供的服务器)上找不到资源的时候,将会去回源服务器(自己的服务器)上找相应的资源</p></blockquote><p>当然最省事的是选择“<strong>协议跟随</strong>”</p><p>5.选择“创建”，则服务创建完成</p><p>6.需要完成“实名认证”，否则服务将处于“关闭”状态</p><p>有“支付宝认证”和“身份认证”，“<strong>支付宝认证</strong>”是直接拍照采取你的个人照片，拍完即认证完毕比较迅速，但可能会泄露更多的个人信息， 毕竟支付宝上已经收集了很多个人信息了。&quot;身份认证&quot;通过提交手持身份证正反面的照片来认证，提交后会有一天的审核期，相对于“支付宝认证”来说可能慢一点。</p><h2 id="二配置ssl证书非必须"><a class="markdownIt-Anchor" href="#二配置ssl证书非必须"></a> 二.配置SSL证书（非必须）</h2><p>7.如果博客没有配置HTTPS，可以在这申请免费的SSL证书配置</p><blockquote><p>又拍云提供了两款证书的免费申请方案，用户可通过 <a href="https://console.upyun.com/toolbox/createCertificate/" target="_blank" rel="noopener">SSL 证书申购</a>平台，免费申请 Symantec-TrustAsia、Let’s Encrypt 的 DV（域名型） SSL 证书，帮助用户零成本实现全站部署 HTTPS。并且还实现了 Let’s Encrypt 证书到期自动续签，用户无需担心证书过期时间，降低维护成本。</p></blockquote><p>服务中的&quot;HTTPS&quot;-&gt;“HTTPS配置”–&gt;“无证书，可前往 SSL <a href="https://console.upyun.com/toolbox/ssl/" target="_blank" rel="noopener">证书管理</a> 添加自有证书或申购新证书”</p><p><img src="/2019/09/09/CDN加速个人博客——又拍云/CDN%E5%8A%A0%E9%80%9F%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E2%80%94%E2%80%94%E5%8F%88%E6%8B%8D%E4%BA%91%5CSSL%E8%AF%81%E4%B9%A6.png" alt="SSL证书"></p><p>短信验证，付款完成后，需要“<strong>请前往证书申购界面补全后续信息</strong>&quot;，在”SSL证书服务“中能看到证书，但还需要执行”补全“步骤。</p><p><img src="/2019/09/09/CDN加速个人博客——又拍云/CDN%E5%8A%A0%E9%80%9F%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E2%80%94%E2%80%94%E5%8F%88%E6%8B%8D%E4%BA%91%5C%E8%A1%A5%E5%85%A8.png" alt="补全"></p><p>之后，如果当前域名为第一次配置证书，那么需要”域名所有权验证“。可以查看又拍云提供的<a href="https://help.upyun.com/knowledge-base/ssl-product/#dv-ssle8af81e4b9a6e9aa8ce8af81" target="_blank" rel="noopener">帮助文档</a>，分为<strong>OV 或 EV SSL 证书</strong>和<strong>DV SSL证书验证</strong>，其中DV SSL证书验证又分为”文件检验“和&quot;DNS 验证&quot;.</p><p>DNS验证，需要修改域名的 DNS，添加 <code>TXT 记录</code>，然后 CA 机构通过解析域名的 <code>TXT 记录</code>来验证域名所有权。其中如果是阿里云解析，在设置过CNAME记录的同时再添加新的TXT记录会报错，说有冲突。此时可查看<a href="#%E9%98%BF%E9%87%8C%E4%BA%91%E7%BB%91%E5%AE%9A%E5%8A%A0%E9%80%9F%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E6%97%B6%EF%BC%8C%E6%8F%90%E7%A4%BATXT%E4%B8%8E@%E8%AE%B0%E5%BD%95%E5%86%B2%E7%AA%81%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">解决方案</a></p><p><img src="/2019/09/09/CDN加速个人博客——又拍云/CDN%E5%8A%A0%E9%80%9F%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E2%80%94%E2%80%94%E5%8F%88%E6%8B%8D%E4%BA%91%5CCNAME%E8%AE%A4%E8%AF%81.png" alt="CNAME认证"></p><p>只不过此时状态仍为“审核中”，即CA 机构信息审核验证状态，一般需要 1 个工作日。</p><p><img src="/2019/09/09/CDN加速个人博客——又拍云/CDN%E5%8A%A0%E9%80%9F%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E2%80%94%E2%80%94%E5%8F%88%E6%8B%8D%E4%BA%91%5C%E5%AE%A1%E6%A0%B8.png" alt="审核"></p><p>▲我测试了两个免费的证书，发现“Let’s Encrypt DV SSL 单域名证书”审核比&quot;TrustAsia DV SSL 单域名证书&quot;快多了，几乎5分钟就自动审核通过了。</p><p>e.g.由于我的博客是搭建在Github pages的，所以配置了HTTPS，因此，这个我就不需要再弄了。</p><h2 id="附录"><a class="markdownIt-Anchor" href="#附录"></a> 附录</h2><h3 id="阿里云绑定加速域名解析时提示txt与记录冲突解决办法"><a class="markdownIt-Anchor" href="#阿里云绑定加速域名解析时提示txt与记录冲突解决办法"></a> 阿里云绑定加速域名解析时，提示TXT与@记录冲突解决办法</h3><h3 id="方法一"><a class="markdownIt-Anchor" href="#方法一"></a> 方法一：</h3><p>实际上，TXT记录的作用只是做域名所有权验证。也就是说，一旦域名被验证，就可以删除它。</p><p>知道了这个原理，我们可以在解析时先删除其他@主机记录的解析，然后添加百度云加速TXT记录。</p><p>通过百度云加速后台显示验证后，我们删除TXT并解析其他@主机记录就可以了。</p><h3 id="方法二"><a class="markdownIt-Anchor" href="#方法二"></a> 方法二：</h3><p>如果你是使用免费智能 DNS 解析服务——CloudXNS 来解析域名应该是不会遇到这些问题，但是如果使用阿里云解析的话，应该或多或少都会遇到解析记录冲突的问题。所以可以采取更换解析商，即把<strong>阿里云解析更换为 CloudXNS 解析</strong></p><h3 id="方法三"><a class="markdownIt-Anchor" href="#方法三"></a> 方法三：</h3><p>**解析到不同的线路来解决。**默认情况下，我们 CNAME 解析时，只填写主机记录和记录值，其他都是默认，这个时候“解析线路”就是默认线路。如果后续你添加 TXT 记录或 MX 记录时，解析线路也是默认线路，那么就会出现解析记录冲突从而无法成功解析。此时，需要做的就是在解析 TXT 或 MX 记录时，把“解析线路”选择到其他线路，如选择“中国电信”或其他线路，然后保存就不会与 CNANE 的默认线路冲突了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;cdn加速个人博客又拍云&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#cdn加速个人博客又拍云&quot;&gt;&lt;/a&gt; CDN加速个人博客——又拍云&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;CDN(Content Delivery Networ
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>RL强化学习概念</title>
    <link href="https://nymrli.top/2019/09/09/RL%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%A6%82%E5%BF%B5/"/>
    <id>https://nymrli.top/2019/09/09/RL强化学习概念/</id>
    <published>2019-09-09T11:33:12.000Z</published>
    <updated>2019-09-09T11:33:46.258Z</updated>
    
    <content type="html"><![CDATA[<h1 id="rl强化学习概念"><a class="markdownIt-Anchor" href="#rl强化学习概念"></a> RL强化学习概念</h1><h2 id="方法汇总"><a class="markdownIt-Anchor" href="#方法汇总"></a> 方法汇总</h2><h3 id="价值-直接-想象"><a class="markdownIt-Anchor" href="#价值-直接-想象"></a> 价值-直接-想象</h3><p>通过价值选择行为：</p><ul><li>Q Learning</li><li>Sarsa</li><li>Deep Q Network</li></ul><p>直接选择行为：</p><ul><li>Policy Gradients</li></ul><p>想象环境并从中学习</p><ul><li>Model Based RL</li></ul><h3 id="基于模型"><a class="markdownIt-Anchor" href="#基于模型"></a> 基于模型</h3><ul><li><p>Model-Free RL（无模型）不需要去理解环境的含义</p><ul><li>Q Learning</li><li>Sarsa</li><li>Policy Gradients</li></ul></li><li><p>Model-Based RL（有环境）需要去理解环境的含义，在&quot;脑子&quot;中模拟虚拟环境</p><ul><li>Q Learning</li><li>Sarsa</li><li>Policy Gradient</li></ul><p>前者需要一步一步得到环境的反馈后才能进行下一步；而后者通过想象来预判断接下来会发生的情况。</p><p><img src="/2019/09/09/RL强化学习概念/C:%5CUsers%5C10630%5CDocuments%5C20190831224947.png" alt="20190831224947"></p></li></ul><h3 id="基于概率-价值"><a class="markdownIt-Anchor" href="#基于概率-价值"></a> 基于概率-价值</h3><p>基于概率（Policy Based RL）：</p><ul><li>Policy Gradients</li></ul><p>即使是概率最高的也不一定能被选择到，因此基于价值的结果更为铁定</p><p>基于价值（Value Based RL）：</p><ul><li>Q Learning</li><li>Sarsa</li></ul><p>不能用于连续动作，但基于概率能使用概率分布在连续动作中选择一个动作</p><p>两者的统一体：Actor-Critic</p><h3 id="回合-单步"><a class="markdownIt-Anchor" href="#回合-单步"></a> 回合-单步</h3><p>回合更新（Monte-Carlo update）</p><ul><li>基础版Policy Gradients</li><li>Monte-Carlo Learning</li></ul><p>在整个回合结束后再学习转折点</p><p>单步更新（Temporal-Difference update）</p><ul><li>Q Learning</li><li>Sarsa</li><li>升级版Policy Gradients</li></ul><p>不需要等待回合结束，边玩边学习</p><p>更多的情况下单步更新效率更高，但围棋游戏一般采用的都是回合更新</p><p><img src="/2019/09/09/RL强化学习概念/C:%5CUsers%5C10630%5CDocuments%5Csetp.png" alt="setp"></p><h3 id="在线-离线"><a class="markdownIt-Anchor" href="#在线-离线"></a> 在线-离线</h3><p>在线学习（online ）</p><blockquote><p>本人在场，本人边玩边学习。</p></blockquote><ul><li>Sarsa</li><li>Sarsa(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">λ</span></span></span></span>)</li></ul><p>离散学习（offline）</p><blockquote><p>可以选择自己玩或者看别人玩。可以从保存的结果中学习</p></blockquote><ul><li>Q Learning</li><li>Deep Q Network</li></ul><h3 id="onpolicy-offpolicy"><a class="markdownIt-Anchor" href="#onpolicy-offpolicy"></a> onPolicy-offPolicy</h3><p>on-policy</p><blockquote><p>Agent必然执行使Q函数最大的动作MAX_ACTION</p></blockquote><ul><li>Sarsa</li></ul><p>off-plicy</p><blockquote><p>Agent实际不一定执行使Q函数最大的动作MAX_ACTION</p></blockquote><ul><li>Q Learning</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;rl强化学习概念&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#rl强化学习概念&quot;&gt;&lt;/a&gt; RL强化学习概念&lt;/h1&gt;
&lt;h2 id=&quot;方法汇总&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#方法汇总&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="RL" scheme="https://nymrli.top/tags/RL/"/>
    
  </entry>
  
  <entry>
    <title>强化学习——QLearning</title>
    <link href="https://nymrli.top/2019/09/09/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94QLearning/"/>
    <id>https://nymrli.top/2019/09/09/强化学习——QLearning/</id>
    <published>2019-09-09T11:32:08.000Z</published>
    <updated>2019-09-09T11:34:05.902Z</updated>
    
    <content type="html"><![CDATA[<h1 id="强化学习qlearning"><a class="markdownIt-Anchor" href="#强化学习qlearning"></a> 强化学习——QLearning</h1><p>价值转移公式只有一条<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>&lt;</mo><mo>=</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mo>∗</mo><mo>(</mo><mi>r</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo>−</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><mi>Q</mi><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>)</mo><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo><mo>∗</mo><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>α</mi><mo>∗</mo><mo>(</mo><mi>r</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo>+</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><mi>Q</mi><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a) &lt;= Q(s,a) + \alpha*(reward - Q(s,a) + \gamma*max_aQ(s&#x27;,a)) = (1-\alpha)*Q(s,a) + \alpha*(reward + \gamma*max_aQ(s&#x27;,a))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">d</span><span class="mbin">−</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mbin">∗</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">d</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mbin">∗</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>，即新Q(s1,a2) = 老Q(s1,a2) + \alpha * 差距(现实-估计)</p><ul><li>ALPHA为学习率，设置<strong>估计与现实的差距</strong>有多少被学习。能够使得更新比较平缓，防止模型过早收敛到局部解<ul><li>如果有两种途径都能得到Reward宝藏，如果直接设置1，那么很大程度上，算法都会沿着已尝试出有Reward的路走，虽然有E-Greedy的探索，但是那样的得分可能不至于让第二条路成为更优的选择。所以设置学习率有助于找到第二条路。</li></ul></li><li>GAMMA为衰减系数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><mi>Q</mi><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">max_aQ(s&#x27;,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>是下一个时间点的最大期望奖励，因此需要用衰减系数来权衡下。即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mn>1</mn><mo>)</mo><mo>=</mo><mi>r</mi><mn>2</mn><mo>+</mo><mi>γ</mi><mi>Q</mi><mo>(</mo><mi>s</mi><mn>2</mn><mo>)</mo><mo>=</mo><mi>r</mi><mn>2</mn><mo>+</mo><mi>γ</mi><mo>(</mo><mi>r</mi><mn>3</mn><mo>+</mo><mi>γ</mi><mi>Q</mi><mo>(</mo><mi>S</mi><mn>3</mn><mo>)</mo><mo>)</mo><mo>=</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>=</mo><mi>r</mi><mn>2</mn><mo>+</mo><mi>γ</mi><mo>∗</mo><mi>r</mi><mn>3</mn><mo>+</mo><msup><mi>γ</mi><mrow><mn>2</mn></mrow></msup><mo>∗</mo><mi>r</mi><mn>4</mn><mo>+</mo><msup><mi>γ</mi><mrow><mn>3</mn></mrow></msup><mi>r</mi><mn>5</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">Q(s1) = r2 + \gamma Q(s2) = r2 + \gamma(r3+\gamma Q(S3)) = ...= r2 + \gamma *r3+\gamma^{2} *r4+ \gamma^{3} r5 + ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">3</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathrm">3</span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mbin">∗</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">3</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">4</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">5</span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span>，约后面的影响越小<ul><li>GAMMA == 1时，Agent能看到之后所有步的奖励。<ul><li>只不过真正的理解应该时反序的，即最后一步是得到最终的reward，然后之前的状态的动作选择回报是在这个最终的reward上不断乘以GAMMA进行衰减，使得S1的选择不至于被最后的选择而过多影响</li></ul></li><li>GAMMA == 0时，Agent只能看到眼前的奖励</li></ul></li></ul><p>▲需要注意的是，这个公式是更新公式，而不是等式，因此两边不能化简，用代码来表示就是<code>Q[state, action] = (1-ALPHA)*Q[state, action] + ALPHA*(reward + GAMMA*Q[newstate, action].max())</code></p><p><img src="/2019/09/09/强化学习——QLearning/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94QLearning%5Cf2.png" alt="f2"></p><p><img src="/2019/09/09/强化学习——QLearning/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94QLearning%5Cf1.png" alt="f1"></p><h2 id="qlearning-maze夺宝藏"><a class="markdownIt-Anchor" href="#qlearning-maze夺宝藏"></a> QLearning-Maze夺宝藏：</h2><h3 id="demo代码"><a class="markdownIt-Anchor" href="#demo代码"></a> demo代码：</h3><p>环境代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># env.py</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MAP = \</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">.........</span></span><br><span class="line"><span class="string">.       .</span></span><br><span class="line"><span class="string">.     o .</span></span><br><span class="line"><span class="string">.       .</span></span><br><span class="line"><span class="string">.........</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MAP = \</span></span><br><span class="line"><span class="comment">#     '''</span></span><br><span class="line"><span class="comment"># .........</span></span><br><span class="line"><span class="comment"># .  x    .</span></span><br><span class="line"><span class="comment"># .   x o .</span></span><br><span class="line"><span class="comment"># .       .</span></span><br><span class="line"><span class="comment"># .........</span></span><br><span class="line"><span class="comment"># '''</span></span><br><span class="line">MAP = MAP.strip().split(<span class="string">'\n'</span>)</span><br><span class="line">MAP = [[c <span class="keyword">for</span> c <span class="keyword">in</span> line] <span class="keyword">for</span> line <span class="keyword">in</span> MAP]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DX = [<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">DY = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Env</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.map = copy.deepcopy(MAP)</span><br><span class="line">        self.x = <span class="number">1</span></span><br><span class="line">        self.y = <span class="number">1</span></span><br><span class="line">        self.step = <span class="number">0</span></span><br><span class="line">        self.total_reward = <span class="number">0</span></span><br><span class="line">        self.is_end = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interact</span><span class="params">(self, action)</span>:</span></span><br><span class="line">        <span class="keyword">assert</span> self.is_end <span class="keyword">is</span> <span class="keyword">False</span></span><br><span class="line">        new_x = self.x + DX[action]</span><br><span class="line">        new_y = self.y + DY[action]</span><br><span class="line">        new_pos_char = self.map[new_x][new_y]</span><br><span class="line">        self.step += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> new_pos_char == <span class="string">'.'</span>:</span><br><span class="line">            reward = <span class="number">0</span>  <span class="comment"># do not change position</span></span><br><span class="line">        <span class="keyword">elif</span> new_pos_char == <span class="string">' '</span>:</span><br><span class="line">            self.x = new_x</span><br><span class="line">            self.y = new_y</span><br><span class="line">            reward = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> new_pos_char == <span class="string">'o'</span>:</span><br><span class="line">            self.x = new_x</span><br><span class="line">            self.y = new_y</span><br><span class="line">            self.map[new_x][new_y] = <span class="string">' '</span>  <span class="comment"># update map</span></span><br><span class="line">            self.is_end = <span class="keyword">True</span>  <span class="comment"># end</span></span><br><span class="line">            reward = <span class="number">100</span></span><br><span class="line">        <span class="keyword">elif</span> new_pos_char == <span class="string">'x'</span>:</span><br><span class="line">            self.x = new_x</span><br><span class="line">            self.y = new_y</span><br><span class="line">            self.map[new_x][new_y] = <span class="string">' '</span>  <span class="comment"># update map</span></span><br><span class="line">            reward = <span class="number">-5</span></span><br><span class="line">        self.total_reward += reward</span><br><span class="line">        <span class="keyword">return</span> reward</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">state_num</span><span class="params">(self)</span>:</span></span><br><span class="line">        rows = len(self.map)</span><br><span class="line">        cols = len(self.map[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> rows * cols</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">present_state</span><span class="params">(self)</span>:</span></span><br><span class="line">        cols = len(self.map[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> self.x * cols + self.y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_map</span><span class="params">(self)</span>:</span></span><br><span class="line">        printed_map = copy.deepcopy(self.map)</span><br><span class="line">        printed_map[self.x][self.y] = <span class="string">'A'</span></span><br><span class="line">        print(<span class="string">'\n'</span>.join([<span class="string">''</span>.join([c <span class="keyword">for</span> c <span class="keyword">in</span> line]) <span class="keyword">for</span> line <span class="keyword">in</span> printed_map]))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_map_with_reprint</span><span class="params">(self, output_list)</span>:</span></span><br><span class="line">        printed_map = copy.deepcopy(self.map)</span><br><span class="line">        printed_map[self.x][self.y] = <span class="string">'A'</span></span><br><span class="line">        printed_list = [<span class="string">''</span>.join([c <span class="keyword">for</span> c <span class="keyword">in</span> line]) <span class="keyword">for</span> line <span class="keyword">in</span> printed_map]</span><br><span class="line">        <span class="keyword">for</span> i, line <span class="keyword">in</span> enumerate(printed_list):</span><br><span class="line">            output_list[i] = line</span><br></pre></td></tr></table></figure><p>Agent代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># qlearning.py</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> env <span class="keyword">import</span> Env</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EPSILON = <span class="number">0.1</span></span><br><span class="line">ALPHA = <span class="number">0.1</span></span><br><span class="line">GAMMA = <span class="number">0.9</span></span><br><span class="line">MAX_STEP = <span class="number">30</span></span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">epsilon_greedy</span><span class="params">(Q, state)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> (np.random.uniform() &gt; <span class="number">1</span> - EPSILON) <span class="keyword">or</span> ((Q[state, :] == <span class="number">0</span>).all()):</span><br><span class="line">        action = np.random.randint(<span class="number">0</span>, <span class="number">4</span>)  <span class="comment"># 0~3</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        action = Q[state, :].argmax()</span><br><span class="line">    <span class="keyword">return</span> action</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = Env()</span><br><span class="line">Q = np.zeros((e.state_num, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">    e = Env()</span><br><span class="line">    <span class="keyword">while</span> (e.is_end <span class="keyword">is</span> <span class="keyword">False</span>) <span class="keyword">and</span> (e.step &lt; MAX_STEP):</span><br><span class="line">        action = epsilon_greedy(Q, e.present_state)</span><br><span class="line">        state = e.present_state</span><br><span class="line">        reward = e.interact(action)</span><br><span class="line">        new_state = e.present_state</span><br><span class="line">        Q[state, action] = (<span class="number">1</span> - ALPHA) * Q[state, action] + \</span><br><span class="line">            ALPHA * (reward + GAMMA * Q[new_state, :].max())</span><br><span class="line">        e.print_map()</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">    print(<span class="string">'Episode:'</span>, i, <span class="string">'Total Step:'</span>, e.step, <span class="string">'Total Reward:'</span>, e.total_reward)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h4 id="第一次魔改代码"><a class="markdownIt-Anchor" href="#第一次魔改代码"></a> 第一次魔改代码：</h4><p>环境代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">maze = \</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">..........</span></span><br><span class="line"><span class="string">.        .</span></span><br><span class="line"><span class="string">.    o   .</span></span><br><span class="line"><span class="string">.        .</span></span><br><span class="line"><span class="string">..........</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(maze)</span></span><br><span class="line">maze = maze.strip().split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="comment"># print(maze)</span></span><br><span class="line"></span><br><span class="line">MAP = [[col <span class="keyword">for</span> col <span class="keyword">in</span> line] <span class="keyword">for</span> line <span class="keyword">in</span> maze]</span><br><span class="line"><span class="comment"># print(MAP)</span></span><br><span class="line">DX = [<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">DY = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Env</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    交互环境</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.map = copy.deepcopy(MAP)</span><br><span class="line">        self.x = <span class="number">1</span></span><br><span class="line">        self.y = <span class="number">1</span></span><br><span class="line">        self.step = <span class="number">0</span></span><br><span class="line">        self.isEnd = <span class="keyword">False</span></span><br><span class="line">        self._score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interact</span><span class="params">(self, action)</span>:</span></span><br><span class="line">        <span class="comment"># state = self.state</span></span><br><span class="line">        <span class="comment"># assert self.isEnd is True</span></span><br><span class="line"></span><br><span class="line">        newx = self.x + DX[action]</span><br><span class="line">        newy = self.y + DY[action]</span><br><span class="line">        newPos = self.map[newx][newy]</span><br><span class="line">        self.step += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> newPos == <span class="string">'.'</span>:</span><br><span class="line">            reward = <span class="number">-10</span></span><br><span class="line">        <span class="keyword">elif</span> newPos == <span class="string">' '</span>:</span><br><span class="line">            self.x = newx</span><br><span class="line">            self.y = newy</span><br><span class="line">            reward = <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> newPos == <span class="string">'o'</span>:</span><br><span class="line">            self.x = newx</span><br><span class="line">            self.y = newy</span><br><span class="line">            reward = <span class="number">100</span></span><br><span class="line">            <span class="comment"># self.map[newx][newy] = ' '如果不update会怎么样？</span></span><br><span class="line">            self.isEnd = <span class="keyword">True</span></span><br><span class="line">        self._score += reward</span><br><span class="line">        <span class="keyword">return</span> reward</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">state_num</span><span class="params">(self)</span>:</span></span><br><span class="line">        rows = len(self.map)</span><br><span class="line">        cols = len(self.map[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> rows * cols</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">present_state</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.map[<span class="number">0</span>])*self.x + self.y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printMap</span><span class="params">(self)</span>:</span></span><br><span class="line">        printed_map = copy.deepcopy(self.map)</span><br><span class="line">        printed_map[self.x][self.y] = <span class="string">'A'</span></span><br><span class="line">        print(<span class="string">'\n'</span>.join([<span class="string">''</span>.join([c <span class="keyword">for</span> c <span class="keyword">in</span> line]) <span class="keyword">for</span> line <span class="keyword">in</span> printed_map]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    e = Env()</span><br><span class="line">    e.printMap()</span><br><span class="line">    print(e.score)</span><br></pre></td></tr></table></figure><h5 id="进行了如下的修改"><a class="markdownIt-Anchor" href="#进行了如下的修改"></a> 进行了如下的修改：</h5><ul><li>碰到边界<code>'.'</code>时，将会扣分</li><li>如果没有任何事发生的话，那么奖励2分</li><li><a href="#%E4%BF%AE%E6%94%B9%E5%90%8E%E7%BB%93%E6%9E%9C">修改后结果如下</a></li></ul><p>Agent代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"><span class="keyword">from</span> env <span class="keyword">import</span> Env</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">EPSILON = <span class="number">0.2</span></span><br><span class="line">ALPHA = <span class="number">0.1</span></span><br><span class="line">GAMMA = <span class="number">0.9</span></span><br><span class="line">MAX_STEP = <span class="number">30</span></span><br><span class="line">TIMES = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">epsilonGreedy</span><span class="params">(Q, state)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> np.random.uniform() &gt; <span class="number">1</span>-EPSILON <span class="keyword">or</span> ((Q[state, :] == <span class="number">0</span>).all()):</span><br><span class="line">        action = np.random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="comment"># 0-3，随机选择一个方向探索</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        action = Q[state, :].argmax() <span class="comment"># 找到当前价值最大的决策</span></span><br><span class="line">    <span class="keyword">return</span> action</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = Env()</span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">Q = np.zeros((e.state_num, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">success = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(TIMES):</span><br><span class="line">    ne = Env()</span><br><span class="line">    <span class="keyword">while</span> (ne.isEnd == <span class="keyword">False</span>) <span class="keyword">and</span> (ne.step &lt; MAX_STEP):</span><br><span class="line">        state = ne.present_state</span><br><span class="line">        action = epsilonGreedy(Q, state)</span><br><span class="line">        print(action)</span><br><span class="line">        <span class="comment"># print(Q[ne.x*10+ne.y,:])</span></span><br><span class="line">        reward = ne.interact(action)</span><br><span class="line">        newstate = ne.present_state</span><br><span class="line">        <span class="keyword">if</span> ne.map[newstate//<span class="number">10</span>][newstate%<span class="number">10</span>] == <span class="string">'o'</span>:</span><br><span class="line">            success += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'success='</span>,success)</span><br><span class="line">        print(<span class="string">"结果为："</span>)</span><br><span class="line">        ne.printMap()</span><br><span class="line">        print(<span class="string">"再下一步的得分："</span>,Q[newstate,:])</span><br><span class="line">        Q[state, action] = (<span class="number">1</span>-ALPHA)*Q[state, action] + \</span><br><span class="line">            ALPHA*(reward + GAMMA*Q[newstate, action].max())</span><br><span class="line">        time.sleep(<span class="number">.05</span>)</span><br><span class="line">    print(<span class="string">'Episode:'</span>, i, <span class="string">'Total Step:'</span>, ne.step, <span class="string">'Total Reward:'</span>, ne.score)</span><br><span class="line">    <span class="comment"># Qp = np.reshape(Q, (5,10,4))</span></span><br><span class="line">    <span class="comment"># print(Qp) </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># [第一行,[10列,4个方向]]</span></span><br><span class="line">    <span class="comment"># [第二行,[10列,4个方向]]</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(Q)</span><br><span class="line">print(success)</span><br></pre></td></tr></table></figure><h5 id="修改后结果"><a class="markdownIt-Anchor" href="#修改后结果"></a> 修改后结果</h5><ul><li>走<code>&quot; &quot;</code>得奖励值设为+2得情况下，当EPSILON=0.1时，30次训练，几乎都在起点左右摇摆。<ul><li>原因是没碰到宝藏前，他们这样漫无目的的走是得分最高的。</li><li>处理的方法：1.修改Epsilon值，让他们有更多的机会去探索；2.增大训练的次数，一旦他们曾经到过宝藏，那么他们会往这个好的方向优化</li></ul></li><li><strong>注意</strong>，如果设置<code>&quot; &quot;</code>的奖励的话，需要慎重考虑，因为左右摇摆最高的奖励值在MAX_STEP=30的情况下是能达到60的。所以<strong>宝藏的奖励值一定要略大于MAX_SETP*EMPTY_REWARD</strong>才能达到训练的目的；同时，可能<strong>导致找不到最快寻到宝藏的可能</strong>,比如在宝藏门前来回晃悠来获得<code>&quot; &quot;</code>奖励-&gt;解决方案：可以<strong>根据当前步数来设置宝藏的分数</strong></li><li>碰到<code>'.'</code>扣分，使得Agent不倾向于撞墙，这个是个不错的修改，从Q表中也能看到明显的效果。但是一旦之后出现有陷阱的情况<code>&quot;X&quot;</code>，那么这边的惩罚值得设定需要慎重考虑</li><li></li></ul><h4 id="第二次魔改代码"><a class="markdownIt-Anchor" href="#第二次魔改代码"></a> 第二次魔改代码</h4><p>环境代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">TREASURE = <span class="string">'o'</span></span><br><span class="line">TRAP = <span class="string">'X'</span></span><br><span class="line"></span><br><span class="line">maze = \</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">..........</span></span><br><span class="line"><span class="string">. &#123;trap&#125;      .</span></span><br><span class="line"><span class="string">.    &#123;treasure&#125;   .</span></span><br><span class="line"><span class="string">.       .</span></span><br><span class="line"><span class="string">..........</span></span><br><span class="line"><span class="string">'''</span>.format(treasure=TREASURE,trap=TRAP)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(maze)</span></span><br><span class="line">maze = maze.strip().split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="comment"># print(maze)</span></span><br><span class="line"></span><br><span class="line">MAP = [[col <span class="keyword">for</span> col <span class="keyword">in</span> line] <span class="keyword">for</span> line <span class="keyword">in</span> maze]</span><br><span class="line"><span class="comment"># print(MAP)</span></span><br><span class="line">DX = [<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">DY = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Env</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    交互环境</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.map = copy.deepcopy(MAP)</span><br><span class="line">        self.x = <span class="number">1</span></span><br><span class="line">        self.y = <span class="number">1</span></span><br><span class="line">        self.step = <span class="number">0</span></span><br><span class="line">        self.isEnd = <span class="keyword">False</span></span><br><span class="line">        self._score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interact</span><span class="params">(self, action)</span>:</span></span><br><span class="line">        <span class="comment"># state = self.state</span></span><br><span class="line">        <span class="comment"># assert self.isEnd is True</span></span><br><span class="line"></span><br><span class="line">        newx = self.x + DX[action]</span><br><span class="line">        newy = self.y + DY[action]</span><br><span class="line">        newPos = self.map[newx][newy]</span><br><span class="line">        self.step += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> newPos == <span class="string">'.'</span>:</span><br><span class="line">            reward = <span class="number">-10</span></span><br><span class="line">        <span class="keyword">elif</span> newPos == <span class="string">' '</span>:</span><br><span class="line">            self.x = newx</span><br><span class="line">            self.y = newy</span><br><span class="line">            reward = <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> newPos == <span class="string">'o'</span>:</span><br><span class="line">            self.x = newx</span><br><span class="line">            self.y = newy</span><br><span class="line">            reward = <span class="number">100</span></span><br><span class="line">            <span class="comment"># self.map[newx][newy] = ' '如果不update会怎么样？</span></span><br><span class="line">            self.isEnd = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">elif</span> newPos == <span class="string">'X'</span>:</span><br><span class="line">            self.x = newx</span><br><span class="line">            self.y = newy</span><br><span class="line">            reward = <span class="number">-50</span></span><br><span class="line">            self.isEnd = <span class="keyword">True</span></span><br><span class="line">        self._score += reward</span><br><span class="line">        <span class="keyword">return</span> reward</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">state_num</span><span class="params">(self)</span>:</span></span><br><span class="line">        rows = len(self.map)</span><br><span class="line">        cols = len(self.map[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> rows * cols</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">present_state</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.map[<span class="number">0</span>])*self.x + self.y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printMap</span><span class="params">(self)</span>:</span></span><br><span class="line">        printed_map = copy.deepcopy(self.map)</span><br><span class="line">        printed_map[self.x][self.y] = <span class="string">'A'</span></span><br><span class="line">        print(<span class="string">'\n'</span>.join([<span class="string">''</span>.join([c <span class="keyword">for</span> c <span class="keyword">in</span> line]) <span class="keyword">for</span> line <span class="keyword">in</span> printed_map]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    e = Env()</span><br><span class="line">    e.printMap()</span><br><span class="line">    print(e.score)</span><br></pre></td></tr></table></figure><h5 id="进行了如下修改"><a class="markdownIt-Anchor" href="#进行了如下修改"></a> 进行了如下修改</h5><ul><li>碰到陷阱<code>'X'</code>时，将会扣较多的分</li></ul><p>Agent代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"><span class="keyword">from</span> env <span class="keyword">import</span> Env</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">EPSILON = <span class="number">0.2</span></span><br><span class="line">ALPHA = <span class="number">0.1</span></span><br><span class="line">GAMMA = <span class="number">0.9</span></span><br><span class="line">MAX_STEP = <span class="number">30</span></span><br><span class="line">TIMES = <span class="number">40</span></span><br><span class="line">TEST_TIMES = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">epsilonGreedy</span><span class="params">(Q, state)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> np.random.uniform() &gt; <span class="number">1</span>-EPSILON <span class="keyword">or</span> ((Q[state, :] == <span class="number">0</span>).all()):</span><br><span class="line">        action = np.random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="comment"># 0-3，随机选择一个方向探索</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        action = Q[state, :].argmax() <span class="comment"># 找到当前价值最大的决策</span></span><br><span class="line">    <span class="keyword">return</span> action</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = Env()</span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">Q = np.zeros((e.state_num, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用Epsilon_Greedy策略获得Q表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Qtrain</span><span class="params">()</span>:</span></span><br><span class="line">    success = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(TIMES):</span><br><span class="line">        ne = Env()</span><br><span class="line">        <span class="keyword">while</span> (ne.isEnd == <span class="keyword">False</span>) <span class="keyword">and</span> (ne.step &lt; MAX_STEP):</span><br><span class="line">            state = ne.present_state</span><br><span class="line">            action = epsilonGreedy(Q, state)</span><br><span class="line">            print(<span class="string">"当前的选择为："</span>,action)</span><br><span class="line">            <span class="comment"># print(Q[ne.x*10+ne.y,:])</span></span><br><span class="line">            reward = ne.interact(action)</span><br><span class="line">            newstate = ne.present_state</span><br><span class="line">            <span class="keyword">if</span> ne.map[newstate//<span class="number">10</span>][newstate%<span class="number">10</span>] == <span class="string">'o'</span>:</span><br><span class="line">                success += <span class="number">1</span></span><br><span class="line">                print(<span class="string">'success='</span>,success)</span><br><span class="line">            print(<span class="string">"结果为："</span>)</span><br><span class="line">            ne.printMap()</span><br><span class="line">            print(<span class="string">"再下一步的得分："</span>,Q[newstate,:],<span class="string">'\n'</span>)</span><br><span class="line">            Q[state, action] = (<span class="number">1</span>-ALPHA)*Q[state, action] + \</span><br><span class="line">                ALPHA*(reward + GAMMA*Q[newstate, action].max())</span><br><span class="line">            time.sleep(<span class="number">.05</span>)</span><br><span class="line">        print(<span class="string">'Episode:'</span>, i, <span class="string">'Total Step:'</span>, ne.step, <span class="string">'Total Reward:'</span>, ne.score)</span><br><span class="line">        print(<span class="string">'-'</span>*<span class="number">20</span>, <span class="string">'\n\n'</span>)</span><br><span class="line">        <span class="comment"># Qp = np.reshape(Q, (5,10,4))</span></span><br><span class="line">        <span class="comment"># print(Qp)</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    print(Q)</span><br><span class="line">    print(success)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用Q表走棋测试,由于Q表确定，所以其实每次的结果都是一样的</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Qtest</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">10</span>,<span class="string">"开始测试"</span>,<span class="string">'*'</span>*<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(TEST_TIMES):</span><br><span class="line">        ne = Env()</span><br><span class="line">        <span class="keyword">while</span> (ne.isEnd == <span class="keyword">False</span>) <span class="keyword">and</span> (ne.step &lt; MAX_STEP):</span><br><span class="line">            state = ne.present_state</span><br><span class="line">            action = Q[state,:].argmax()</span><br><span class="line">            print(<span class="string">"当前的选择为："</span>,action)</span><br><span class="line">            <span class="comment"># print(Q[ne.x*10+ne.y,:])</span></span><br><span class="line">            reward = ne.interact(action)</span><br><span class="line">            newstate = ne.present_state</span><br><span class="line">            print(<span class="string">"结果为："</span>)</span><br><span class="line">            ne.printMap()</span><br><span class="line">            print(<span class="string">"再下一步的得分："</span>,Q[newstate,:],<span class="string">'\n'</span>)</span><br><span class="line">            time.sleep(<span class="number">.05</span>)</span><br><span class="line">        print(<span class="string">'Episode:'</span>, i, <span class="string">'Total Step:'</span>, ne.step, <span class="string">'Total Reward:'</span>, ne.score)</span><br><span class="line">        print(<span class="string">'-'</span>*<span class="number">20</span>,<span class="string">'\n\n'</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    Qtrain()</span><br><span class="line">    Qtest()</span><br></pre></td></tr></table></figure><h5 id="修改后结果-2"><a class="markdownIt-Anchor" href="#修改后结果-2"></a> 修改后结果：</h5><ul><li>由于走空<code>&quot; &quot;</code>现象仍然存在，感觉奖励给2仍是太多</li><li>EPSILON=0.2，随机乱走的几率很高，导致开局踩到陷阱<code>X</code>的概率很大</li></ul><h5 id="暴毙结果训练中没碰到过宝藏"><a class="markdownIt-Anchor" href="#暴毙结果训练中没碰到过宝藏"></a> 暴毙结果(训练中没碰到过宝藏)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">********** 开始测试 **********</span><br><span class="line">当前的选择为： 2</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.A   o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 0.12753822  0.          1.0434062  -2.9701    ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 2</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    o   .</span><br><span class="line">.A      .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 0.21147844  2.30159071  0.         -1.99      ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    o   .</span><br><span class="line">. A     .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-0.313       0.398      -1.          1.04984339] </span><br><span class="line"></span><br><span class="line">当前的选择为： 3</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    o   .</span><br><span class="line">.A      .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 0.21147844  2.30159071  0.         -1.99      ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    o   .</span><br><span class="line">. A     .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-0.313       0.398      -1.          1.04984339] </span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">之后都是1和3的循环选择</span><br></pre></td></tr></table></figure><p>可以看到，这边上下变成了死循环。这是当所有训练中都没有踩到过宝藏的情况。</p><p>▲.使训练中更有可能碰到宝藏的方法</p><ol><li>训练的次数T足够多</li><li>如果训练次数少的话，需要合理设置EPSILON，使得Agent有更多的机会探索</li><li>MAX_STEP设置合理</li></ol><h3 id="特殊情况考虑发生概率很小"><a class="markdownIt-Anchor" href="#特殊情况考虑发生概率很小"></a> 特殊情况考虑（发生概率很小）</h3><p>▲.还有一点要说明的是：Q:有种情况是，同样都是走空得2分，为什么向上得得分是18，而向右得得分是2呢？</p><p>A：因为Dx，Dy的循序（上右下左）决定了。<strong>当四个得分都一样时如[2,2,2,2]，那么将会优先选择上</strong>，因为如果走空有奖励，所以上比右的得分会高很多。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># env.py</span></span><br><span class="line">DX = [<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">DY = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>]</span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">epsilonGreedy</span><span class="params">(Q, state)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> np.random.uniform() &gt; <span class="number">1</span>-EPSILON <span class="keyword">or</span> ((Q[state, :] == <span class="number">0</span>).all()):</span><br><span class="line">        action = np.random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="comment"># 0-3，随机选择一个方向探索</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        action = Q[state, :].argmax() <span class="comment"># 找到当前价值最大的决策</span></span><br><span class="line">        <span class="comment"># ▲argmax()当最大值相同时，取索引最小的</span></span><br><span class="line">    <span class="keyword">return</span> action</span><br></pre></td></tr></table></figure><p>即</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Test1</span></span><br><span class="line">a = np.array([</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">print(a[<span class="number">0</span>,:].argmax())<span class="comment"># 0</span></span><br><span class="line"><span class="comment"># Test2</span></span><br><span class="line">a = np.array([</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">3</span>],</span><br><span class="line">    [<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>]</span><br><span class="line">])</span><br><span class="line">print(a[<span class="number">0</span>,:].argmax())<span class="comment"># 2</span></span><br></pre></td></tr></table></figure><h3 id="测试走空奖励值"><a class="markdownIt-Anchor" href="#测试走空奖励值"></a> 测试走空–奖励值</h3><h4 id="走空无奖励值"><a class="markdownIt-Anchor" href="#走空无奖励值"></a> 走空无奖励值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">当前的选择为： 2</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.A   o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-0.501399  23.9585123  0.        -3.940399 ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">. A  o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-20.4755      41.20097133   0.          -0.267309  ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.  A o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-0.457659   66.18493075 -0.2439      0.        ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.   Ao   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 0.        94.1850263  0.         0.       ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    A   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [0. 0. 0. 0.] </span><br><span class="line"></span><br><span class="line">Episode: 4 Total Step: 5 Total Reward: 100</span><br><span class="line">--------------------</span><br></pre></td></tr></table></figure><h4 id="走空有2奖励的结果"><a class="markdownIt-Anchor" href="#走空有2奖励的结果"></a> 走空有+2奖励的结果</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">当前的选择为： 2</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.A   o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-0.41254159  6.24693379 -0.03645728 -3.940399  ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">. A  o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [-9.5        21.14440154  0.2981      0.        ] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.  A o   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 5.16800000e-01  5.26069497e+01 -3.14898100e-02  3.80000000e-01] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.   Ao   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [ 0.45506025 83.3228183   1.0434062   2.28281481] </span><br><span class="line"></span><br><span class="line">当前的选择为： 1</span><br><span class="line">结果为：</span><br><span class="line">..........</span><br><span class="line">. X      .</span><br><span class="line">.    A   .</span><br><span class="line">.       .</span><br><span class="line">..........</span><br><span class="line">再下一步的得分： [0. 0. 0. 0.] </span><br><span class="line"></span><br><span class="line">Episode: 4 Total Step: 5 Total Reward: 108</span><br><span class="line">--------------------</span><br></pre></td></tr></table></figure><h3 id="多次测试经验总结"><a class="markdownIt-Anchor" href="#多次测试经验总结"></a> 多次测试经验总结：</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;强化学习qlearning&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#强化学习qlearning&quot;&gt;&lt;/a&gt; 强化学习——QLearning&lt;/h1&gt;
&lt;p&gt;价值转移公式只有一条&lt;span class=&quot;katex&quot;&gt;&lt;span c
      
    
    </summary>
    
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
      <category term="RL" scheme="https://nymrli.top/tags/RL/"/>
    
  </entry>
  
  <entry>
    <title>机器学习——决策树</title>
    <link href="https://nymrli.top/2019/08/30/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91/"/>
    <id>https://nymrli.top/2019/08/30/机器学习——决策树/</id>
    <published>2019-08-30T13:44:35.000Z</published>
    <updated>2019-08-31T14:23:41.621Z</updated>
    
    <content type="html"><![CDATA[<h1 id="机器学习决策树"><a class="markdownIt-Anchor" href="#机器学习决策树"></a> 机器学习——决策树</h1><h2 id="决策树基础概念"><a class="markdownIt-Anchor" href="#决策树基础概念"></a> 决策树基础概念</h2><blockquote><p>决策树分为分类树和回归树两种，分类树对离散变量做决策树，回归树对连续变量做决策树。</p><p>每个<strong>内部节点（非叶子节点）<strong>表示一个属性上的测试条件，每个</strong>分支</strong>代表一个测试输出结果，每个<strong>叶节点</strong>代表一种类别</p></blockquote><p>决策树分为分类树和回归树两种，分类树对离散变量做决策树，回归树对连续变量做决策树。</p><p>决策树的构造过程就是找到这些具有决定性作用的特征，根据其决定性程度来构造一个倒立的树–决定性作用最大的那个特征作为根节点，然后递归找到各分支下子数据集中次大的决定性特征，直至子数据集中所有数据都属于同一类。</p><p>特征：</p><ul><li>有监督的学习</li><li>非参数学习算法</li><li>自顶向下递归方式构造决策树</li><li>在每一步选择中都采取在当前状态下最好/优的选择</li></ul><h2 id="决策树生成过程"><a class="markdownIt-Anchor" href="#决策树生成过程"></a> 决策树生成过程</h2><p>一棵决策树的生成过程主要分为以下3个部分:</p><ul><li><strong>特征选择</strong>：特征选择是指从训练数据中众多的特征中选择一个特征作为当前节点的分裂标准，如何选择特征有着很多不同量化评估标准标准，从而衍生出不同的决策树算法。</li><li><strong>决策树生成</strong>： 根据选择的特征评估标准，从上至下递归地生成子节点，直到数据集不可分则停止决策树停止生长。 树结构来说，递归结构是最容易理解的方式。</li><li><strong>剪枝</strong>：决策树容易过拟合，一般来需要剪枝，缩小树结构规模、缓解过拟合。剪枝技术有预剪枝和后剪枝两种。</li></ul><h2 id="基于信息论的三种决策树算法"><a class="markdownIt-Anchor" href="#基于信息论的三种决策树算法"></a> 基于信息论的三种决策树算法</h2><blockquote><p>划分数据集的最大原则是：使无序的数据变的有序。</p><p>熵降低的速度越快越好==&gt;树的高度最矮</p></blockquote><p>基于信息论的决策树算法有ID3、CART和C4.5等算法，其中C4.5和CART两种算法从ID3算法中衍生而来。</p><h3 id="id3算法"><a class="markdownIt-Anchor" href="#id3算法"></a> ID3算法</h3><ul><li>信息增益作为评估标准，分支节点选择特征X信息增益最大的</li></ul><p>可用于划分标称型数据集，<strong>没有剪枝的过程</strong>，为了去除过度数据匹配的问题，可通过裁剪合并相邻的无法产生大量信息增益的叶子节点（例如设置信息增益阀值）。使用信息增益的话，其实是有一个缺点，那就是它<strong>偏向于具有大量值的属性</strong>–就是说在训练集中，某个属性所取的不同值的个数越多，那么越有可能拿它来作为分裂属性</p><h3 id="c45算法"><a class="markdownIt-Anchor" href="#c45算法"></a> C4.5算法</h3><p>C4.5是ID3的一个改进算法，继承了ID3算法的优点。</p><ul><li><strong>C4.5算法用信息增益率来选择属性</strong>，</li><li>克服了用信息增益选择属性时偏向选择取值多的属性的不足在树构造过程中进行<strong>剪枝</strong>；</li><li>能够完成对<strong>连续属性的离散化处理</strong>；<strong>能够对不完整数据进行处理</strong>。</li></ul><h3 id="cart算法classification-and-regression-tree"><a class="markdownIt-Anchor" href="#cart算法classification-and-regression-tree"></a> CART算法（Classification And Regression Tree）</h3><ul><li>**采用的是Gini指数（选Gini指数最小的特征s）**作为分裂标准</li><li>同时它也是包含<strong>后剪枝</strong>操作</li><li>ID3和C4.5虽可尽可能挖掘数据信息，但生成的决策树分支较大。CART可以简化决策树的规模，提高生成决策树的效率</li></ul><h2 id="决策树优缺点"><a class="markdownIt-Anchor" href="#决策树优缺点"></a> 决策树优缺点</h2><p>决策树适用于数值型和标称型（离散型数据，变量的结果只在有限目标集中取值），能够读取数据集合，提取一些列数据中蕴含的规则。在分类问题中使用决策树模型有很多的优点，1.决策树<strong>计算复杂度不高</strong>、便于使用、而且高效，2.决策树<strong>可处理具有不相关特征的数据</strong>、3.可很容易地构造出易于理解的规则，而<strong>规则通常易于解释和理解</strong>。</p><p>决策树模型也有一些缺点，比如1.处理<strong>缺失数据</strong>时的困难、2.<strong>过度拟合</strong>以及3.<strong>忽略数据集中属性之间的相关性</strong>等。</p><h2 id="id3数学原理"><a class="markdownIt-Anchor" href="#id3数学原理"></a> ID3数学原理</h2><h3 id="信息熵香农熵"><a class="markdownIt-Anchor" href="#信息熵香农熵"></a> 信息熵(香农熵)：</h3><blockquote><p>一种度量不确定性的方式，是用来衡量随机变量不确定性的，熵就是信息的期望值</p></blockquote><p>如果待分类的事物可能划分在多个分类之中，则符号xi的信息定义为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">I</mi></mrow><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mo>−</mo><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{I}\left(x_{i}\right)=-\log _{2} p\left(x_{i}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">I</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord">−</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">p</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>，其中p(xi)是选择该分类的概率。</p><p>有人可能会问，信息为啥这样定义啊？答曰：前辈得出的结论。这就跟1+1等于2一样，记住并且会用即可。上述式中的对数以2为底，也可以e为底(自然对数)。</p><p>若随机事件发生的结果记为X，且待分类的事物可能划分在N类中，分别是x1，x2，……，xn，每一种取到的概率分别是P1，P2，……，Pn，那么X的熵就定义为：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">H</mi></mrow><mo>=</mo><mo>−</mo><msubsup><mo>∑</mo><mrow><mrow><mi mathvariant="normal">i</mi></mrow><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mrow><mi mathvariant="normal">p</mi></mrow><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{H}=-\sum_{\mathrm{i}=1}^{n} \mathrm{p}\left(x_{i}\right) \log _{2} p\left(x_{i}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">H</span></span><span class="mrel">=</span><span class="mord">−</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">i</span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">p</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">p</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></p><p>反映了每一个元素在该类别下的不纯度，如{1,2,3,4}跟{1,1,1,2}相比,每个元素1-4的logPi都很大,因此sum的熵就要大很多。</p><p>注：有&quot;某个类别的结果&quot;的熵（某个特征有多个值），也有&quot;某事件结果&quot;的熵（该事件有多个特征）。直观来讲，结果种类越多，熵值越大。</p><p>当熵中的概率由数据估计(特别是最大似然估计)得到时，所对应的熵称为<strong>经验熵</strong>(empirical entropy)。什么叫由数据估计？比如有10个数据，一共有两个类别，A类和B类。其中有7个数据属于A类，则该A类的概率即为十分之七。其中有3个数据属于B类，则该B类的概率即为十分之三。浅显的解释就是，这概率是我们根据数据数出来的。</p><h4 id="经验熵举例"><a class="markdownIt-Anchor" href="#经验熵举例"></a> 经验熵举例：</h4><p>我们定义<a href="#%E8%B4%B7%E6%AC%BE%E7%94%B3%E8%AF%B7%E6%A0%B7%E6%9C%AC%E6%95%B0%E6%8D%AE%E8%A1%A8">贷款申请样本数据表</a>中的数据为训练数据集D，则训练数据集D的经验熵为H(D)。|D|表示其样本容量，即样本个数。设有K个类Ck, = 1,2,3,…,K,|Ck|为属于类Ck的样本个数，因此经验熵公式就可以写为 ：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">H</mi></mrow><mo>(</mo><mrow><mi mathvariant="normal">D</mi></mrow><mo>)</mo><mo>=</mo><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>c</mi><mrow><mi>k</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>C</mi><mrow><mi>k</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathrm{H}(\mathrm{D})=-\sum_{k=1}^{K} \frac{\left|c_{k}\right|}{|D|} \log _{2} \frac{\left|C_{k}\right|}{|D|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">H</span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord mathrm">D</span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> ，即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>C</mi><mi>k</mi></msub><mo>)</mo><mo>=</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>C</mi><mrow><mi>k</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">p(C_k)=\frac{\left|C_{k}\right|}{|D|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>由样本数据出来的结果。</p><p>根据此公式计算经验熵H(D)，分析贷款申请样本数据表中的数据。最终分类结果只有两类，即放贷和不放贷。根据表中的数据统计可知，在15个数据中，9个数据的结果为放贷，6个数据的结果为不放贷。所以数据集D的经验熵H(D)为：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">H</mi></mrow><mo>(</mo><mrow><mi mathvariant="normal">D</mi></mrow><mo>)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mn>9</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>9</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>6</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>6</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>7</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{H}(\mathrm{D})=-\frac{9}{15} \log _{2} \frac{9}{15}-\frac{6}{15} \log _{2} \frac{6}{15}=0.971</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">H</span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord mathrm">D</span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">9</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">9</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">6</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">6</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">7</span><span class="mord mathrm">1</span></span></span></span></p><p>经过计算可知，数据集D的经验熵H(D)的值为0.971。</p><p>▲熵值越高，则数据混合的种类越高，其蕴含的含义是一个变量可能的变化越多（反而跟变量具体的取值没有任何关系，只和<strong>值的种类</strong>多少以及<strong>发生概率</strong>有关）</p><h3 id="条件熵"><a class="markdownIt-Anchor" href="#条件熵"></a> 条件熵</h3><p>表示在已知随机变量X的条件下随机变量Y的不确定性，其定义为X在给定条件下Y的条件概率分布的熵对X的数学期望:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msub><mi>p</mi><mrow><mi>i</mi></mrow></msub><mi>H</mi><mrow><mo fence="true">(</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>=</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(Y | X)=\sum_{i=1}^{n} p_{i} H\left(Y | X=x_{i}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>,其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><mi>X</mi><mo>=</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><mrow><mi mathvariant="normal">n</mi></mrow></mrow><annotation encoding="application/x-tex">p_{i}=P\left(X=x_{i}\right), i=1,2, \cdots, \mathrm{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="minner">⋯</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathrm">n</span></span></span></span></span></p><h4 id="经验条件熵举例"><a class="markdownIt-Anchor" href="#经验条件熵举例"></a> 经验条件熵举例：</h4><p>设特征A有n个不同的取值{a1,a2,···,an}，根据特征A的取值将D划分为n个子集{D1,D2，···,Dn}，|Di|为Di的样本个数。记子集Di中属于Ck的样本的集合为Dik，即Dik = Di ∩ Ck，|Dik|为Dik的样本个数</p><p>\begin{align*}\mathrm{H}(\mathrm{D} | \mathrm{A}) & =\sum_{i=1}^{\mathrm{n}} \frac{\left|D_{i}\right|}{|D|} \mathrm{H}\left(D_{i}\right) \\ & =-\sum_{i=1}^{n} \frac{\left|D_{i}\right|}{|D|} \sum_{k=1}^{K} \frac{\left|D_{i k}\right|}{\left|D_{i}\right|} \log _{2} \frac{\left|D_{i k}\right|}{\left|D_{i}\right|}\end{align*}</p><h3 id="信息增益"><a class="markdownIt-Anchor" href="#信息增益"></a> 信息增益</h3><p>信息增益(information gain)表示得知特征X的信息后，而使得Y的不确定性减少的程度。定义为集合D的经验熵H(D)与给定特征A条件下D的经验条件熵H(D|A)之差:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>H</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>−</mo><mi>H</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(D, A)=H(D)-H(D| A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span><span class="mord mathit">A</span><span class="mclose">)</span></span></span></span></p><p>一般地，熵H(D)与条件熵H(D|A)之差称为<strong>互信息</strong>(mutual information)。决策树学习中的信息增益等价于训练数据集中类与特征的互信息。</p><p>举例：以<a href="#%E8%B4%B7%E6%AC%BE%E7%94%B3%E8%AF%B7%E6%A0%B7%E6%9C%AC%E6%95%B0%E6%8D%AE%E8%A1%A8">贷款申请样本数据表</a>为例进行说明。看下年龄这一列的数据，也就是特征A1，一共有三个类别，分别是：青年、中年和老年。我们只看年龄是青年的数据，年龄是青年的数据一共有5个，所以年龄是青年的数据在训练数据集出现的概率是5/15，也就是1/3。同理，年龄是中年和老年的数据在训练数据集出现的概率也都是1/3。现在我们只看年龄是青年的数据的最终得到贷款的概率为2/5，因为在五个数据中，只有两个数据显示拿到了最终的贷款，同理，年龄是中年和老年的数据最终得到贷款的概率分别为3/5、4/5。所以计算年龄的信息增益，过程如下：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mrow><mi mathvariant="normal">g</mi></mrow><mrow><mo fence="true">(</mo><mrow><mi mathvariant="normal">D</mi></mrow><mo separator="true">,</mo><msub><mi>A</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>−</mo><mi>H</mi><mrow><mo fence="true">(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><msub><mi>A</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mi mathvariant="normal">n</mi></mrow></mrow></msubsup><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mrow><mi mathvariant="normal">H</mi></mrow><mrow><mo fence="true">(</mo><msub><mi>D</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>−</mo><mrow><mo fence="true">[</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mi>H</mi><mrow><mo fence="true">(</mo><msub><mrow><mi mathvariant="normal">D</mi></mrow><mrow><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mn>2</mn></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mi>H</mi><mrow><mo fence="true">(</mo><msub><mi>D</mi><mrow><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mn>3</mn></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mi>H</mi><mrow><mo fence="true">(</mo><msub><mi>D</mi><mrow><mn>3</mn></mrow></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>−</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>3</mn></mrow></msubsup><msub><mi>p</mi><mrow><mi>i</mi></mrow></msub><mo>∗</mo><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>7</mn><mn>1</mn><mo>−</mo><mrow><mo fence="true">[</mo><mfrac><mrow><mn>5</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mrow><mn>2</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>2</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>3</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>3</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mn>5</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mrow><mn>3</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>3</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>2</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mrow><mo>+</mo><mfrac><mrow><mn>5</mn></mrow><mrow><mn>1</mn><mn>5</mn></mrow></mfrac><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mrow><mn>4</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>4</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>5</mn></mrow></mfrac><msub><mi>log</mi><mrow><mn>2</mn></mrow></msub><mfrac><mrow><mn>1</mn></mrow><mrow><mn>5</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>7</mn><mn>1</mn><mo>−</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mn>8</mn><mn>8</mn><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>8</mn><mn>3</mn></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned} \mathrm{g}\left(\mathrm{D}, A_{1}\right) &amp;=H(D)-H\left(D | A_{1}\right) \\ &amp;=H(D)-\sum_{i=1}^{\mathrm{n}} \frac{\left|D_{i}\right|}{|D|} \mathrm{H}\left(D_{i}\right) \\ &amp;=H(D)-\left[\frac{\left|D_{1}\right|}{|D|}H\left(\mathrm{D}_{1}\right)+\frac{\left|D_{2}\right|}{|D|} H\left(D_{2}\right)+\frac{\left|D_{3}\right|}{|D|} H\left(D_{3}\right)\right] \\ &amp;=H(D)- \frac{\left|D_{i}\right|}{|D|} \sum_{i=1}^{3} p_{i} * \log _{2} p_{i} \\ &amp;=0.971-\left[\frac{5}{15}\left(-\frac{2}{5} \log _{2} \frac{2}{5}-\frac{3}{5} \log _{2} \frac{3}{5}\right)+\frac{5}{15}\left(-\frac{3}{5} \log _{2} \frac{3}{5}-\frac{2}{5} \log _{2} \frac{2}{5}\right)\right.\\ &amp;\left.+\frac{5}{15}\left(-\frac{4}{5} \log _{2} \frac{4}{5}-\frac{1}{5} \log _{2} \frac{1}{5}\right)\right] \\ &amp;=0.971-0.888=0.083 \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.0900099999999995em;"></span><span class="strut bottom" style="height:9.680019999999999em;vertical-align:-4.59001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-4.25001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">g</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord textstyle uncramped"><span class="mord mathrm">D</span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span><span style="top:-2.880009999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:-1.2100099999999991em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:0.45001000000000113em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:1.8200100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:3.030010000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:4.23001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-4.25001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span><span style="top:-2.880009999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">−</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">H</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span><span style="top:-1.2100099999999991em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">−</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">D</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span><span style="top:0.45001000000000113em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:1.8200100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">7</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:3.030010000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="minner textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mord">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:4.23001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">9</span><span class="mord mathrm">7</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">8</span><span class="mord mathrm">8</span><span class="mord mathrm">8</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span></span></span></p><p>其中|Di|为特征该类别的数量，Pi为该类别下为true（事件发生）的概率</p><h2 id="c45数学原理"><a class="markdownIt-Anchor" href="#c45数学原理"></a> C4.5数学原理</h2><p>以信息增益进行分类决策时，存在偏向于取值较多的特征的问题。于是有了基于<strong>信息增益比</strong>的分类决策方法C4.5。C4.5与ID3都是利用贪心算法进行求解，不同的是分类决策的依据不同。</p><p>信息增益比率度量:信息增益比率度量Gain(D，X) / 分裂信息度量SplitInformation(D，X)</p><p>SplitInformation(D，X） = -\sum_{i=1}^{n}{P_{x_i} }*log_2{P_{x_i} }</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>X</mi><mo>)</mo><mo>=</mo><mi>G</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>X</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>S</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">GainRatio(D,X) = Gain(D,X)/SplitInformation(D,X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit">a</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">G</span><span class="mord mathit">a</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">p</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></p><h2 id="cart数学原理"><a class="markdownIt-Anchor" href="#cart数学原理"></a> CART数学原理</h2><h3 id="基尼指数gini"><a class="markdownIt-Anchor" href="#基尼指数gini"></a> 基尼指数GINI</h3><p>1、是一种不等性度量，表示一个随机选中的样本在子集中被分错的可能性；<br>2、通常用来度量收入不平衡，可以用来度量任何不均匀分布；<br>3、是介于0~1之间的数，0-完全相等，1-完全不相等；<br>4、总体内包含的类别越杂乱，GINI指数就越大（跟熵的概念很相似）</p><p><strong>Gini系数</strong>的计算方式如下 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>(</mo><mi>p</mi><mo>)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>p</mi><mrow><mi>k</mi></mrow></msub><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>k</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msubsup><mi>p</mi><mrow><mi>k</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">Gini(p)=\sum_{k=1}^{K} p_{k}\left(1-p_{k}\right)=1-\sum_{k=1}^{K} p_{k}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8423309999999999em;"></span><span class="strut bottom" style="height:1.142341em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>上面式子表述的意思就是，加入特征X以后，数据不纯度减小的程度.</p><p>如果D为样本数据集，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>(</mo><mi>D</mi><mo>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>C</mi><mrow><mi>k</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">Gini(D)=1-\sum_{k=1}^{K}\left(\frac{\left|C_{k}\right|}{|D|}\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.2151079999999999em;"></span><span class="strut bottom" style="height:1.865128em;vertical-align:-0.65002em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="vlist"><span style="top:-0.7639999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>其中Ck是D中属于第k类的样本子集，K是类的个数。</p><p>如果D被特征A划分为D1、D2两部分，这个时候就是<em>统计均值</em>，样本数据集D的基尼系数：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>A</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mrow><mo fence="true">(</mo><msub><mi>D</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo fence="true">∣</mo><msub><mi>D</mi><mrow><mn>2</mn></mrow></msub><mo fence="true">∣</mo></mrow></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mrow><mo fence="true">(</mo><msub><mi>D</mi><mrow><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">Gini(D, A)=\frac{\left|D_{1}\right|}{|D|} Gini\left(D_{1}\right)+\frac{\left|D_{2}\right|}{|D|} Gini\left(D_{2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit">G</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathrm">∣</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit">G</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></p><p>[<a href="https://www.cnblogs.com/xingshansi/p/6847334.html" target="_blank" rel="noopener">统计学习方法：CART算法</a>](<a href="https://www.cnblogs.com/xingshansi/p/6847334.html" target="_blank" rel="noopener">https://www.cnblogs.com/xingshansi/p/6847334.html</a>)</p><hr><h3 id="最小二乘回归树"><a class="markdownIt-Anchor" href="#最小二乘回归树"></a> 最小二乘回归树</h3><p>一个回归树对应着输入空间（即特征空间）的一个划分以及在划分的单元上的输出值。假设已将输入空间划分为M个单元R1,R2,…Rm，并且在每个单元Rm上有一个固定的输出值Cm，于是回归树模型可表示为：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi></mrow></msubsup><msub><mi>c</mi><mrow><mi>m</mi></mrow></msub><mi>I</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>∈</mo><msub><mi>R</mi><mrow><mi>m</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)=\sum_{m=1}^{M} c_{m} I\left(x \in R_{m}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8423309999999999em;"></span><span class="strut bottom" style="height:1.142341em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></p><p>模型输出值与实际值的误差：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mrow><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo>∈</mo><msub><mi>R</mi><mrow><mi>m</mi></mrow></msub></mrow></msub><msup><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mo>−</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_{x_{i} \in R_{m}}\left(y_{i}-f\left(x_{i}\right)\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8151079999999999em;"></span><span class="strut bottom" style="height:1.2201179999999998em;vertical-align:-0.40501em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>我们希望每个单元上的Cm，可以是的这个平方误差最小化。易知，当<strong>Cm为相应单元的所有实际值的均值时，可以到最优：</strong></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>c</mi></mrow><mo>^</mo></mover><mrow><mi>m</mi></mrow></msub><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo>∈</mo><msub><mi>R</mi><mrow><mi>m</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{c}_{m}=ave\left(y_{i} | x_{i} \in R_{m}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">c</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">e</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></p><p>假设，我们选择变量 xj 为切分变量，它的取值 s 为切分点，那么就会得到两个区域：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">R</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msup><mi>x</mi><mrow><mo>(</mo><mi>j</mi><mo>)</mo></mrow></msup><mo>≤</mo><mi>s</mi><mo fence="true">}</mo></mrow><mo separator="true">,</mo><msub><mrow><mi mathvariant="normal">R</mi></mrow><mrow><mn>2</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msup><mi>x</mi><mrow><mo>(</mo><mi>j</mi><mo>)</mo></mrow></msup><mo>&gt;</mo><mi>s</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{R}_{1}(j, s)=\left\{x | x^{(j)} \leq s\right\}, \mathrm{R}_{2}(j, s)=\left\{x | x^{(j)}&gt;s\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.2380099999999998em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">R</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord mathit">x</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">≤</span><span class="mord mathit">s</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mpunct">,</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">R</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord mathit">x</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&gt;</span><span class="mord mathit">s</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></p><p>当j和s固定时，我们要找到两个区域的代表值c1，c2使各自区间上的平方差最小：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>min</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>s</mi></mrow></msub><mrow><mo fence="true">[</mo><msub><mi>min</mi><mrow><msub><mi>c</mi><mrow><mn>1</mn></mrow></msub></mrow></msub><msub><mo>∑</mo><mrow><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo>∈</mo><msub><mi>R</mi><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo></mrow></msub><msup><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>c</mi><mrow><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo>+</mo><msub><mi>min</mi><mrow><msub><mi>c</mi><mrow><mn>2</mn></mrow></msub></mrow></msub><msub><mo>∑</mo><mrow><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mo>∈</mo><msub><mi>R</mi><mrow><mn>2</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo></mrow></msub><msup><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>c</mi><mrow><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\min _{j, s}\left[\min _{c_{1}} \sum_{x_{i} \in R_{1}(j, s)}\left(y_{i}-c_{1}\right)^{2}+\min _{c_{2}} \sum_{x_{i} \in R_{2}(j, s)}\left(y_{i}-c_{2}\right)^{2}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.15em;"></span><span class="strut bottom" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∈</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span></span></p><p>前面已经知道c1，c2为区间上的平均：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>c</mi></mrow><mo>^</mo></mover><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mi>ϵ</mi><msub><mi>R</mi><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mover accent="true"><mrow><mi>c</mi></mrow><mo>^</mo></mover><mrow><mn>2</mn></mrow></msub><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mi>ϵ</mi><msub><mi>R</mi><mrow><mn>1</mn></mrow></msub><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{c}_{1}=ave\left(y_{i} | x_{i} \epsilon R_{1}(j, s)\right), \hat{c}_{2}=ave\left(y_{i} | x_{i} \epsilon R_{1}(j, s)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">c</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">e</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">ϵ</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mpunct">,</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">c</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">e</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">ϵ</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></p><p>那么对固定的 j 只需要找到最优的s，然后通过遍历所有的变量，我们可以找到最优的j，这样我们就可以得到最优对（j，s）,（特征j，特征分类值s），并s得到两个区间。</p><p>这样的回归树通常称为最小二乘回归树（least squares regression tree）。</p><p><strong>上述过程表示的算法步骤为:</strong></p><p><img src="https://cuijiahua.com/wp-content/uploads/2017/12/ml_13_9.png" alt=""></p><h2 id="处理连续数值型特征"><a class="markdownIt-Anchor" href="#处理连续数值型特征"></a> 处理连续数值型特征</h2><p>C4.5和CART既可以处理离散型属性，也可以处理连续性属性。对于离散型描述属性，处理方法与ID3相同。对于连续分布的特征，其处理方法是：</p><p>以C4.5为例子，在C4.5中，对连续属性的处理如下：</p><p>1、对特征的取值进行升序排序</p><p>2、两个特征取值之间的中点作为可能的<strong>分裂点</strong>，从分裂点将数据集分成两部分，计算每个可能的分裂点的信息增益（InforGain）。优化算法就是只计算分类属性发生改变的那些特征取值。</p><p>3、选择修正后信息增益(InforGain)最大的分裂点作为该特征的最佳分裂点</p><p>4、计算最佳分裂点的信息增益率（Gain Ratio）作为特征的Gain Ratio。注意，此处需对最佳分裂点的信息增益进行修正：减去log2(N-1)/|D|（N是连续特征的取值个数，D是训练数据数目，此修正的原因在于：当离散属性和连续属性并存时，C4.5算法倾向于选择连续特征做最佳树分裂点）</p><p>Q：为什么这边是使用的信息增益率？</p><p>A：经证明，在决定连续特征的分界点时采用增益这个指标（因为若采用增益率，splittedinfo影响分裂点信息度量准确性，若某分界点恰好将连续特征分成数目相等的两部分时其抑制作用最大），而选择属性的时候才使用增益率这个指标能选择出最佳分类特征。</p><h2 id="剪枝"><a class="markdownIt-Anchor" href="#剪枝"></a> 剪枝</h2><h3 id="预剪枝pre-pruning"><a class="markdownIt-Anchor" href="#预剪枝pre-pruning"></a> 预剪枝(Pre-pruning)</h3><blockquote><p>在构建决策树的过程时，提前停止。</p></blockquote><ul><li>根据一些原则及早的停止树增长，如树的深度达到用户所要的深度、节点中样本个数少于用户指定个数、不纯度指标下降的最大幅度小于用户指定的幅度等</li><li>采用检验技术对当前结点对应的样本集合进行检验，如果该样本集合的样本数量已小于事先指定的最小允许值，那么停止该结点的继续生长，并将该结点变为叶子结点，否则可以继续扩展该结点。</li><li>▲核心问题是如何事先指定树的最大深度，如果设置的最大深度不恰当，那么将会导致过于限制树的生长，使决策树的表达式规则趋于一般，不能更好地对新数据集进行分类和预测</li></ul><h3 id="后剪枝post-pruning"><a class="markdownIt-Anchor" href="#后剪枝post-pruning"></a> 后剪枝(Post-pruning)</h3><blockquote><p>决策树构建好后，然后才开始裁剪。</p></blockquote><ul><li>代价复杂性剪枝、最小误差剪枝、悲观误差剪枝等等</li><li>是一个边修剪边检验的过程。<ul><li>在决策树的不断剪枝操作过程中，将原样本集合或新数据集合作为测试数据，检验决策树对测试数据的预测精度，并计算出相应的错误率，如果剪掉某个子树后的决策树对测试数据的预测精度或其他测度不降低，那么剪掉该子树。</li><li>▲关键就是用独立的验证数据集对训练集生长的树进行剪枝</li></ul></li></ul><h3 id="cart剪枝"><a class="markdownIt-Anchor" href="#cart剪枝"></a> CART剪枝</h3><p>先来看看剪枝用到的准则函数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mo>(</mo><mi>T</mi><mo>)</mo><mo>=</mo><mi>C</mi><mo>(</mo><mi>T</mi><mo>)</mo><mo>+</mo><mi>α</mi><mi mathvariant="normal">∣</mi><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">C_{\alpha}(T)=C(T)+\alpha|T_{leaf}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span></span></span></span></p><p>C（T）是叶节点特性的度量，C4.3里它是熵的均值，CART决策树里它是基尼系数的概率均值，原理类似。多一个正则项，就是稀疏性约束。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{leaf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>为叶子节点个数，越多，损失越大</p><p>ID3、C4.5算法中的剪枝原理是给定α，事实上很难一次给出理想的α。CART剪枝不再给定一个α，然后选择最优决策树，而是通过设定不同的α，通过交叉验证选择最优CART树，也就是：</p><p><strong>训练集</strong>：得到不同的子树;</p><p><strong>测试集</strong>：交叉验证选择最优树.</p><p>从有限个子树<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">{</mo><msub><mi>T</mi><mrow><mn>0</mn></mrow></msub><mo separator="true">,</mo><msub><mi>T</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>T</mi><mrow><mi>n</mi></mrow></msub><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\left\{T_{0}, T_{1}, \ldots, T_{n}\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">}</span></span></span></span></span>中计算最优子树，最优子树由验证集得出的测试误差决定，哪个最小就是哪个。</p><p>这里就引出了一个问题，每次剪哪一个节点呢？如何让<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{leaf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>到达一个合适的点呢？先看分析剪枝的两个极端情况：</p><p>1）完全没剪：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi>C</mi><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><mi>α</mi><mrow><mo fence="true">∣</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">C_{\alpha}\left(T_{t}\right)=C\left(T_{t}\right)+\alpha\left|T_{t}\right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span></span></span></span></p><p>2）只剩根节点：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mo>(</mo><mi>t</mi><mo>)</mo><mo>=</mo><mi>C</mi><mo>(</mo><mi>t</mi><mo>)</mo><mo>+</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">C_{\alpha}(t)=C(t)+\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span></p><p>在α较小或者为0时，有：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>&lt;</mo><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mo>(</mo><mi>t</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{\alpha}\left(T_{t}\right)&lt;C_{\alpha}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span></p><p>在α取+∞大时，有：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>&gt;</mo><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mo>(</mo><mi>t</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{\alpha}\left(T_{t}\right)&gt;C_{\alpha}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">&gt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span></p><p>α是连续变量，因此总有临界点：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>C</mi><mrow><mi>α</mi></mrow></msub><mo>(</mo><mi>t</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{\alpha}\left(T_{t}\right)=C_{\alpha}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span></p><p>为了不混淆变量，重新定义：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>t</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mo>(</mo><mi>t</mi><mo>)</mo><mo>−</mo><mi>C</mi><mrow><mo fence="true">(</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><mrow><mrow><mo fence="true">∣</mo><msub><mi>T</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">∣</mo></mrow><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">g(t)=\frac{C(t)-C\left(T_{t}\right)}{\left|T_{t}\right|-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="minner scriptstyle cramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">∣</span></span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="minner scriptstyle uncramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">)</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p><p><strong>α大于g(t)就是该剪</strong>。简而言之：</p><blockquote><p>对于同一棵树的结点，α都是一样的，当α从0开始缓慢增大（或者从+∞慢慢减小），总会有某棵子树该剪，其他子树不该剪的情况，即α超过了某个结点的g(t)，但还没有超过其他结点的g(t)。这样随着alpha不断增大，不断地剪枝，就得到了n+1棵子树，接下来只要用独立数据集测试这n+1棵子树，试试哪棵子树的误差最小 就知道那棵是最好的方案了。</p></blockquote><h4 id="cart剪枝的算法过程"><a class="markdownIt-Anchor" href="#cart剪枝的算法过程"></a> CART剪枝的算法过程</h4><p><img src="/2019/08/30/机器学习——决策树/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91%5CCART%E5%89%AA%E6%9E%9D.png" alt="CART剪枝"></p><h2 id="代码编写注意点"><a class="markdownIt-Anchor" href="#代码编写注意点"></a> 代码编写注意点</h2><p>递归的结束条件：</p><h3 id="一到达叶节点"><a class="markdownIt-Anchor" href="#一到达叶节点"></a> 一.到达叶节点</h3><p>1.当某集合的值全是同一类时，那么该子集直接可作为叶子节点，为一个类别，此时不再下探。</p><p>2.在决策树构造过程中可能会出现这种情况：所有特征都作为分裂特征<strong>用光</strong>了，但<strong>子集还不是纯净集</strong>（集合内的元素不属于同一类别）。在这种情况下，由于没有更多信息可以使用了，一般对这些子集进行“<strong>多数表决</strong>”，即使用此子集中出现次数最多的类别作为此节点类别，然后将此节点作为叶子节点，此时不再下探</p><h3 id="二预剪枝条件"><a class="markdownIt-Anchor" href="#二预剪枝条件"></a> 二.预剪枝条件</h3><p>1.树的深度达到用户所要的深度</p><p>2.节点中样本个数少于用户指定个数</p><h2 id="附录"><a class="markdownIt-Anchor" href="#附录"></a> 附录</h2><p><img src="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_1.jpg" alt=""></p><p>借鉴：</p><ul><li><a href="https://cuijiahua.com/blog/2017/11/ml_3_decision_tree_2.html/comment-page-2/#comments" target="_blank" rel="noopener">机器学习实战教程（三）：决策树实战篇之为自己配个隐形眼镜</a></li><li><a href="https://www.cnblogs.com/sxron/p/5471078.html" target="_blank" rel="noopener">决策树算法原理及实现</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;机器学习决策树&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#机器学习决策树&quot;&gt;&lt;/a&gt; 机器学习——决策树&lt;/h1&gt;
&lt;h2 id=&quot;决策树基础概念&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#决策树基础
      
    
    </summary>
    
    
      <category term="机器学习" scheme="https://nymrli.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Sklearn——决策树</title>
    <link href="https://nymrli.top/2019/08/30/Sklearn%E2%80%94%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91/"/>
    <id>https://nymrli.top/2019/08/30/Sklearn——决策树/</id>
    <published>2019-08-30T13:43:27.000Z</published>
    <updated>2019-08-30T13:44:19.164Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sklearn决策树"><a class="markdownIt-Anchor" href="#sklearn决策树"></a> Sklearn——决策树</h1><blockquote><p>注明：转载自<a href="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_11.jpg" target="_blank" rel="noopener">Jack Gui的博客</a></p></blockquote><h2 id="1-实战背景"><a class="markdownIt-Anchor" href="#1-实战背景"></a> 1、实战背景</h2><p>进入本文的正题：眼科医生是如何判断患者需要佩戴隐形眼镜的类型的？一旦理解了决策树的工作原理，我们甚至也可以帮助人们判断需要佩戴的镜片类型。</p><p>隐形眼镜数据集是非常著名的数据集，它包含很多换着眼部状态的观察条件以及医生推荐的隐形眼镜类型。隐形眼镜类型包括硬材质(hard)、软材质(soft)以及不适合佩戴隐形眼镜(no lenses)。数据来源与UCI数据库，数据集下载地址：[lenses.txt)]([<a href="https://github.com/Jack-Cherish/Machine-Learning/blob/master/Decision%20Tree/lenses.txt" target="_blank" rel="noopener">https://github.com/Jack-Cherish/Machine-Learning/blob/master/Decision Tree/lenses.txt</a>](<a href="https://github.com/Jack-Cherish/Machine-Learning/blob/master/Decision" target="_blank" rel="noopener">https://github.com/Jack-Cherish/Machine-Learning/blob/master/Decision</a> Tree/lenses.txt))</p><table><thead><tr><th>young</th><th>myope</th><th>no</th><th>reduced</th><th>no lenses</th></tr></thead><tbody><tr><td>young</td><td>myope</td><td>no</td><td>normal</td><td>soft</td></tr><tr><td>young</td><td>myope</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>young</td><td>myope</td><td>yes</td><td>normal</td><td>hard</td></tr><tr><td>young</td><td>hyper</td><td>no</td><td>reduced</td><td>no lenses</td></tr><tr><td>young</td><td>hyper</td><td>no</td><td>normal</td><td>soft</td></tr><tr><td>young</td><td>hyper</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>young</td><td>hyper</td><td>yes</td><td>normal</td><td>hard</td></tr><tr><td>pre</td><td>myope</td><td>no</td><td>reduced</td><td>no lenses</td></tr><tr><td>pre</td><td>myope</td><td>no</td><td>normal</td><td>soft</td></tr><tr><td>pre</td><td>myope</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>pre</td><td>myope</td><td>yes</td><td>normal</td><td>hard</td></tr><tr><td>pre</td><td>hyper</td><td>no</td><td>reduced</td><td>no lenses</td></tr><tr><td>pre</td><td>hyper</td><td>no</td><td>normal</td><td>soft</td></tr><tr><td>pre</td><td>hyper</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>pre</td><td>hyper</td><td>yes</td><td>normal</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>myope</td><td>no</td><td>reduced</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>myope</td><td>no</td><td>normal</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>myope</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>myope</td><td>yes</td><td>normal</td><td>hard</td></tr><tr><td>presbyopic</td><td>hyper</td><td>no</td><td>reduced</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>hyper</td><td>no</td><td>normal</td><td>soft</td></tr><tr><td>presbyopic</td><td>hyper</td><td>yes</td><td>reduced</td><td>no lenses</td></tr><tr><td>presbyopic</td><td>hyper</td><td>yes</td><td>normal</td><td>no lenses</td></tr></tbody></table><p>一共有24组数据，数据的Labels依次是<code>age</code>、<code>prescript</code>、<code>astigmatic</code>、<code>tearRate</code>、<code>class</code>，也就是第一列是年龄，第二列是症状，第三列是是否散光，第四列是眼泪数量，第五列是最终的分类标签。数据如下图所示：</p><h2 id="2-使用sklearn构建决策树"><a class="markdownIt-Anchor" href="#2-使用sklearn构建决策树"></a> 2、使用Sklearn构建决策树</h2><p>官方英文文档地址：<a href="https://cuijiahua.com/wp-content/themes/begin/inc/go.php?url=https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" target="_blank" rel="noopener">http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html</a></p><p>sklearn.tree模块提供了决策树模型，用于解决分类问题和回归问题：</p><p><img src="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_11.jpg" alt=""></p><p>本次实战内容使用的是DecisionTreeClassifier和export_graphviz，前者用于决策树构建，后者用于决策树可视化。</p><p><strong>DecisionTreeClassifier构建决策树：</strong></p><p>让我们先看下DecisionTreeClassifier这个函数，一共有12个参数：</p><p>参数说明如下：</p><ul><li><p>**criterion：**特征选择标准，可选参数，默认是<code>gini</code>，可以设置为<code>entropy</code>。<code>gini</code>是基尼不纯度，是将来自集合的某种结果随机应用于某一数据项的预期误差率，是一种基于统计的思想。<code>entropy</code>是香农熵，也就是上篇文章讲过的内容，是一种基于信息论的思想。Sklearn把<code>gini</code>设为默认参数，应该也是做了相应的斟酌的，精度也许更高些？ID3算法使用的是<code>entropy</code>，CART算法使用的则是<code>gini</code>。</p></li><li><p>**splitter：**特征划分点选择标准，可选参数，默认是<code>best</code>，可以设置为<code>random</code>。每个结点的选择策略。<code>best</code>参数是根据算法选择最佳的切分特征，例如<code>gini</code>、<code>entropy</code>。<code>random</code>随机的在部分划分点中找局部最优的划分点。默认的&quot;best&quot;适合样本量不大的时候，而如果样本数据量非常大，此时决策树构建推荐&quot;random&quot;。</p></li><li><p>max_features：</p><p>划分时考虑的最大特征数，可选参数，默认是None。寻找最佳切分时考虑的最大特征数(n_features为总共的特征数)，有如下6种情况：</p><ul><li>如果max_features是整型的数，则考虑max_features个特征；</li><li>如果max_features是浮点型的数，则考虑int(max_features * n_features)个特征；</li><li>如果max_features设为<code>auto</code>，那么max_features = sqrt(n_features)；</li><li>如果max_features设为<code>sqrt</code>，那么max_featrues = sqrt(n_features)，跟<code>auto</code>一样；</li><li>如果max_features设为<code>log2</code>，那么max_features = log2(n_features)；</li><li>如果max_features设为<code>None</code>，那么max_features = n_features，也就是所有特征都用。</li><li>一般来说，如果样本特征数不多，比如小于50，我们用默认的&quot;None&quot;就可以了，如果特征数非常多，我们可以灵活使用刚才描述的其他取值来控制划分时考虑的最大特征数，以控制决策树的生成时间。</li></ul></li><li><p>**max_depth：**决策树最大深，可选参数，默认是<code>None</code>。这个参数是这是树的层数的。层数的概念就是，比如在贷款的例子中，决策树的层数是2层。如果这个参数设置为<code>None</code>，那么决策树在建立子树的时候不会限制子树的深度。一般来说，数据少或者特征少的时候可以不管这个值。或者如果设置了<code>min_samples_slipt</code>参数，那么直到少于<code>min_smaples_split</code>个样本为止。如果模型样本量多，特征也多的情况下，推荐限制这个最大深度，具体的取值取决于数据的分布。常用的可以取值10-100之间。</p></li><li><p>**min_samples_split：**内部节点再划分所需最小样本数，可选参数，默认是2。这个值限制了子树继续划分的条件。如果<code>min_samples_split</code>为整数，那么在切分内部结点的时候，<code>min_samples_split</code>作为最小的样本数，也就是说，如果样本已经少于<code>min_samples_split</code>个样本，则停止继续切分。如果<code>min_samples_split</code>为浮点数，那么<code>min_samples_split</code>就是一个百分比，ceil(min_samples_split * n_samples)，数是向上取整的。如果样本量不大，不需要管这个值。如果样本量数量级非常大，则推荐增大这个值。</p></li><li><p>**min_samples_leaf：**叶子节点最少样本数，可选参数，默认是1。这个值限制了叶子节点最少的样本数，如果某叶子节点数目小于样本数，则会和兄弟节点一起被剪枝。叶结点需要最少的样本数，也就是最后到叶结点，需要多少个样本才能算一个叶结点。如果设置为1，哪怕这个类别只有1个样本，决策树也会构建出来。如果<code>min_samples_leaf</code>是整数，那么<code>min_samples_leaf</code>作为最小的样本数。如果是浮点数，那么<code>min_samples_leaf</code>就是一个百分比，同上，celi(min_samples_leaf * n_samples)，数是向上取整的。如果样本量不大，不需要管这个值。如果样本量数量级非常大，则推荐增大这个值。</p></li><li><p>**min_weight_fraction_leaf：**叶子节点最小的样本权重和，可选参数，默认是0。这个值限制了叶子节点所有样本权重和的最小值，如果小于这个值，则会和兄弟节点一起被剪枝。一般来说，如果我们有较多样本有缺失值，或者分类树样本的分布类别偏差很大，就会引入样本权重，这时我们就要注意这个值了。</p></li><li><p>**max_leaf_nodes：**最大叶子节点数，可选参数，默认是<code>None</code>。通过限制最大叶子节点数，可以防止过拟合。如果加了限制，算法会建立在最大叶子节点数内最优的决策树。如果特征不多，可以不考虑这个值，但是如果特征分成多的话，可以加以限制，具体的值可以通过交叉验证得到。</p></li><li><p>**class_weight：**类别权重，可选参数，默认是<code>None</code>，也可以字典、字典列表、<code>balanced</code>。指定样本各类别的的权重，主要是为了防止训练集某些类别的样本过多，导致训练的决策树过于偏向这些类别。类别的权重可以通过<code>{class_label：weight}</code>这样的格式给出，这里可以自己指定各个样本的权重，或者用<code>balanced</code>，如果使用<code>balanced</code>，则算法会自己计算权重，样本量少的类别所对应的样本权重会高。当然，如果你的样本类别分布没有明显的偏倚，则可以不管这个参数，选择默认的<code>None</code>。</p></li><li><p>**random_state：**可选参数，默认是<code>None</code>。随机数种子。如果是证书，那么<code>random_state</code>会作为随机数生成器的随机数种子。随机数种子，如果没有设置随机数，随机出来的数与当前系统时间有关，每个时刻都是不同的。如果设置了随机数种子，那么相同随机数种子，不同时刻产生的随机数也是相同的。如果是<code>RandomState instance</code>，那么<code>random_state</code>是随机数生成器。如果为<code>None</code>，则随机数生成器使用np.random。</p></li><li><p>**min_impurity_split：**节点划分最小不纯度,可选参数，默认是1e-7。这是个阈值，这个值限制了决策树的增长，如果某节点的不纯度(基尼系数，信息增益，均方差，绝对差)小于这个阈值，则该节点不再生成子节点。即为叶子节点 。</p></li><li><p>**presort：**数据是否预排序，可选参数，默认为<code>False</code>，这个值是布尔值，默认是False不排序。一般来说，如果样本量少或者限制了一个深度很小的决策树，设置为true可以让划分点选择更加快，决策树建立的更加快。如果样本量太大的话，反而没有什么好处。问题是样本量少的时候，我速度本来就不慢。所以这个值一般懒得理它就可以了。</p></li></ul><p>除了这些参数要注意以外，其他在调参时的注意点有：</p><ul><li>当样本数量少但是样本特征非常多的时候，决策树很容易过拟合，一般来说，样本数比特征数多一些会比较容易建立健壮的模型</li><li>如果样本数量少但是样本特征非常多，在拟合决策树模型前，推荐先做维度规约，比如主成分分析（PCA），特征选择（Losso）或者独立成分分析（ICA）。这样特征的维度会大大减小。再来拟合决策树模型效果会好。</li><li>推荐多用决策树的可视化，同时先限制决策树的深度，这样可以先观察下生成的决策树里数据的初步拟合情况，然后再决定是否要增加深度。</li><li>在训练模型时，注意观察样本的类别情况（主要指分类树），如果类别分布非常不均匀，就要考虑用class_weight来限制模型过于偏向样本多的类别。</li><li>决策树的数组使用的是numpy的float32类型，如果训练数据不是这样的格式，算法会先做copy再运行。</li><li>如果输入的样本矩阵是稀疏的，推荐在拟合前调用csc_matrix稀疏化，在预测前调用csr_matrix稀疏化。</li></ul><p>sklearn.tree.DecisionTreeClassifier()提供了一些方法供我们使用，如下图所示：</p><p><a href="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_13.jpg" target="_blank" rel="noopener"><img src="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_13.jpg" alt="机器学习实战教程（三）：决策树实战篇之为自己配个隐形眼镜"></a></p><p>Code1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fr = open(<span class="string">'lenses.txt'</span>)</span><br><span class="line">    lenses = [inst.strip().split(<span class="string">'\t'</span>) <span class="keyword">for</span> inst <span class="keyword">in</span> fr.readlines()]</span><br><span class="line">    print(lenses)</span><br><span class="line">    lensesLabels = [<span class="string">'age'</span>, <span class="string">'prescript'</span>, <span class="string">'astigmatic'</span>, <span class="string">'tearRate'</span>]</span><br><span class="line">    clf = tree.DecisionTreeClassifier()</span><br><span class="line">    lenses = clf.fit(lenses, lensesLabels)</span><br></pre></td></tr></table></figure><p>▲我们可以看到程序报错了，这是为什么？因为在fit()函数不能接收string类型的数据，通过打印的信息可以看到，数据都是string类型的。在使用fit()函数之前，我们需要对数据集进行编码，这里可以使用两种方法：</p><ul><li><a href="https://cuijiahua.com/wp-content/themes/begin/inc/go.php?url=https://scikit-learn.org/dev/modules/generated/sklearn.preprocessing.LabelEncoder.html" target="_blank" rel="noopener">LabelEncoder</a> ：将字符串转换为增量值</li><li><a href="https://cuijiahua.com/wp-content/themes/begin/inc/go.php?url=https://scikit-learn.org/dev/modules/generated/sklearn.preprocessing.OneHotEncoder.html#sklearn.preprocessing.OneHotEncoder" target="_blank" rel="noopener">OneHotEncoder</a>：使用One-of-K算法将字符串转换为整数</li></ul><p>为了对<code>string</code>类型的数据序列化，需要先生成pandas数据，这样方便我们的序列化工作。这里我使用的方法是，原始数据-&gt;字典-&gt;pandas数据，编写代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'lenses.txt'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> fr: <span class="comment">#加载文件</span></span><br><span class="line">        lenses = [inst.strip().split(<span class="string">'\t'</span>) <span class="keyword">for</span> inst <span class="keyword">in</span> fr.readlines()] <span class="comment">#处理文件</span></span><br><span class="line">    lenses_target = [] <span class="comment">#提取每组数据的类别，保存在列表里</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">        lenses_target.append(each[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">    lensesLabels = [<span class="string">'age'</span>, <span class="string">'prescript'</span>, <span class="string">'astigmatic'</span>, <span class="string">'tearRate'</span>] <span class="comment">#特征标签       </span></span><br><span class="line">    lenses_list = [] <span class="comment">#保存lenses数据的临时列表</span></span><br><span class="line">    lenses_dict = &#123;&#125; <span class="comment">#保存lenses数据的字典，用于生成pandas</span></span><br><span class="line">    <span class="keyword">for</span> each_label <span class="keyword">in</span> lensesLabels: <span class="comment">#提取信息，生成字典</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">            lenses_list.append(each[lensesLabels.index(each_label)])</span><br><span class="line">        lenses_dict[each_label] = lenses_list</span><br><span class="line">        lenses_list = []</span><br><span class="line">    print(lenses_dict) <span class="comment">#打印字典信息</span></span><br><span class="line">    lenses_pd = pd.DataFrame(lenses_dict) <span class="comment">#生成pandas.DataFrame</span></span><br><span class="line">    print(lenses_pd)</span><br><span class="line">    <span class="comment"># 顺利生成pandas数据。</span></span><br></pre></td></tr></table></figure><p>接下来，将数据序列化，编写代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pydotplus</span><br><span class="line"><span class="keyword">from</span> sklearn.externals.six <span class="keyword">import</span> StringIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'lenses.txt'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> fr: <span class="comment">#加载文件</span></span><br><span class="line">        lenses = [inst.strip().split(<span class="string">'\t'</span>) <span class="keyword">for</span> inst <span class="keyword">in</span> fr.readlines()] <span class="comment">#处理文件</span></span><br><span class="line">    lenses_target = [] <span class="comment">#提取每组数据的类别，保存在列表里</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">        lenses_target.append(each[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">    lensesLabels = [<span class="string">'age'</span>, <span class="string">'prescript'</span>, <span class="string">'astigmatic'</span>, <span class="string">'tearRate'</span>] <span class="comment">#特征标签       </span></span><br><span class="line">    lenses_list = [] <span class="comment">#保存lenses数据的临时列表</span></span><br><span class="line">    lenses_dict = &#123;&#125; <span class="comment">#保存lenses数据的字典，用于生成pandas</span></span><br><span class="line">    <span class="keyword">for</span> each_label <span class="keyword">in</span> lensesLabels: <span class="comment">#提取信息，生成字典</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">            lenses_list.append(each[lensesLabels.index(each_label)])</span><br><span class="line">        lenses_dict[each_label] = lenses_list</span><br><span class="line">        lenses_list = []</span><br><span class="line">    <span class="comment"># print(lenses_dict) #打印字典信息</span></span><br><span class="line">    lenses_pd = pd.DataFrame(lenses_dict) <span class="comment"># 生成pandas.DataFrame</span></span><br><span class="line">    print(lenses_pd) <span class="comment">#打印pandas.DataFrame</span></span><br><span class="line">    le = LabelEncoder() <span class="comment">#创建LabelEncoder()对象，用于序列化            </span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> lenses_pd.columns: <span class="comment">#为每一列序列化</span></span><br><span class="line">        lenses_pd[col] = le.fit_transform(lenses_pd[col])</span><br><span class="line">    print(lenses_pd)</span><br></pre></td></tr></table></figure><p>从打印结果可以看到，我们已经将数据顺利序列化，接下来。我们就可以fit()数据，构建决策树了。</p><h2 id="3-使用graphviz可视化决策树"><a class="markdownIt-Anchor" href="#3-使用graphviz可视化决策树"></a> 3、使用Graphviz可视化决策树</h2><p>Graphviz的是AT&amp;T Labs Research开发的图形绘制工具，他可以很方便的用来绘制结构化的图形网络，支持多种格式输出，生成图片的质量和速度都不错。它的输入是一个用dot语言编写的绘图脚本，通过对输入脚本的解析，分析出其中的点，边以及子图，然后根据属性进行绘制。是使用Sklearn生成的决策树就是dot格式的，因此我们可以直接利用Graphviz将决策树可视化。</p><p>在讲解编写代码之前，我们需要安装两样东西，即pydotplus和Grphviz。</p><p><strong>（1）安装Pydotplus</strong></p><p>pydotplus可以在CMD窗口中，直接使用指令安装：<code>pip3 install pydotplus</code></p><p><strong>（2）安装Graphviz</strong></p><p>Graphviz不能使用<code>pip</code>进行安装，我们需要手动安装，下载地址：<a href="https://cuijiahua.com/wp-content/themes/begin/inc/go.php?url=https://www.graphviz.org/" target="_blank" rel="noopener">https://www.graphviz.org</a>，可能下载比较慢。</p><p>安装以后，需要设置环境变量，如将<code>D:\graphviz-2.38\release\bin</code>加入到Path中，然后运行下之后的代码看是否能正常使用。</p><p><strong>（3）编写代码</strong></p><p>Talk is Cheap, show me the code.(废话少说，放码过来)。可视化部分的代码不难，都是有套路的，直接填参数就好，详细内容可以查看官方教程：<a href="https://cuijiahua.com/wp-content/themes/begin/inc/go.php?url=https://scikit-learn.org/stable/modules/tree.html#tree" target="_blank" rel="noopener">http://scikit-learn.org/stable/modules/tree.html#tree</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder, OneHotEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.externals.six <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pydotplus</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'lenses.txt'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> fr:                                        <span class="comment">#加载文件</span></span><br><span class="line">        lenses = [inst.strip().split(<span class="string">'\t'</span>) <span class="keyword">for</span> inst <span class="keyword">in</span> fr.readlines()]        <span class="comment">#处理文件</span></span><br><span class="line">    lenses_target = []                                                        <span class="comment">#提取每组数据的类别，保存在列表里</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">        lenses_target.append(each[<span class="number">-1</span>])</span><br><span class="line">    print(lenses_target)</span><br><span class="line"></span><br><span class="line">    lensesLabels = [<span class="string">'age'</span>, <span class="string">'prescript'</span>, <span class="string">'astigmatic'</span>, <span class="string">'tearRate'</span>]            <span class="comment">#特征标签       </span></span><br><span class="line">    lenses_list = []                                                        <span class="comment">#保存lenses数据的临时列表</span></span><br><span class="line">    lenses_dict = &#123;&#125;                                                        <span class="comment">#保存lenses数据的字典，用于生成pandas</span></span><br><span class="line">    <span class="keyword">for</span> each_label <span class="keyword">in</span> lensesLabels:                                            <span class="comment">#提取信息，生成字典</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> lenses:</span><br><span class="line">            lenses_list.append(each[lensesLabels.index(each_label)])</span><br><span class="line">        lenses_dict[each_label] = lenses_list</span><br><span class="line">        lenses_list = []</span><br><span class="line">    <span class="comment"># print(lenses_dict)                                                        #打印字典信息</span></span><br><span class="line">    lenses_pd = pd.DataFrame(lenses_dict)                                    <span class="comment">#生成pandas.DataFrame</span></span><br><span class="line">    <span class="comment"># print(lenses_pd)                                                        #打印pandas.DataFrame</span></span><br><span class="line">    le = LabelEncoder()                                                        <span class="comment">#创建LabelEncoder()对象，用于序列化           </span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> lenses_pd.columns:                                            <span class="comment">#序列化</span></span><br><span class="line">        lenses_pd[col] = le.fit_transform(lenses_pd[col])</span><br><span class="line">    <span class="comment"># print(lenses_pd)                                                        #打印编码信息</span></span><br><span class="line"></span><br><span class="line">    clf = tree.DecisionTreeClassifier(max_depth = <span class="number">4</span>)                        <span class="comment">#创建DecisionTreeClassifier()类</span></span><br><span class="line">    clf = clf.fit(lenses_pd.values.tolist(), lenses_target)                    <span class="comment">#使用数据，构建决策树</span></span><br><span class="line">    dot_data = StringIO()</span><br><span class="line">    tree.export_graphviz(clf, out_file = dot_data,                            <span class="comment">#绘制决策树</span></span><br><span class="line">                        feature_names = lenses_pd.keys(),</span><br><span class="line">                        class_names = clf.classes_,</span><br><span class="line">                        filled=<span class="keyword">True</span>, rounded=<span class="keyword">True</span>,</span><br><span class="line">                        special_characters=<span class="keyword">True</span>)</span><br><span class="line">    graph = pydotplus.graph_from_dot_data(dot_data.getvalue())</span><br><span class="line">    graph.write_pdf(<span class="string">"tree.pdf"</span>)                                                <span class="comment">#保存绘制好的决策树，以PDF的形式存储。</span></span><br></pre></td></tr></table></figure><p>运行代码，在该python文件保存的相同目录下，会生成一个名为tree的PDF文件，打开文件，我们就可以看到决策树的可视化效果图了。</p><p><img src="https://cuijiahua.com/wp-content/uploads/2017/11/ml_3_19.jpg" alt=""></p><p>确定好决策树之后，我们就可以做预测了。可以根据自己的眼睛情况和年龄等特征，看一看自己适合何种材质的隐形眼镜。使用如下代码就可以看到预测结果：<code>print(clf.predict([[1,1,1,0]])) #预测</code></p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p><strong>决策树的一些优点：</strong></p><ul><li>易于理解和解释。决策树可以可视化。</li><li>几乎不需要数据预处理。其他方法经常需要数据标准化，创建虚拟变量和删除缺失值。决策树还不支持缺失值。</li><li>使用树的花费（例如预测数据）是训练数据点(data points)数量的对数。</li><li>可以同时处理数值变量和分类变量。其他方法大都适用于分析一种变量的集合。</li><li>可以处理多值输出变量问题。</li><li>使用白盒模型。如果一个情况被观察到，使用逻辑判断容易表示这种规则。相反，如果是黑盒模型（例如人工神经网络），结果会非常难解释。</li><li>即使对真实模型来说，假设无效的情况下，也可以较好的适用。</li></ul><p><strong>决策树的一些缺点：</strong></p><ul><li>决策树学习可能创建一个过于复杂的树，并不能很好的预测数据。也就是过拟合。修剪机制（现在不支持），设置一个叶子节点需要的最小样本数量，或者数的最大深度，可以避免过拟合。</li><li>决策树可能是不稳定的，因为即使非常小的变异，可能会产生一颗完全不同的树。这个问题通过decision trees with an ensemble来缓解。</li><li>概念难以学习，因为决策树没有很好的解释他们，例如，XOR, parity or multiplexer problems。</li><li>如果某些分类占优势，决策树将会创建一棵有偏差的树。因此，建议在训练之前，先抽样使样本均衡。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;sklearn决策树&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#sklearn决策树&quot;&gt;&lt;/a&gt; Sklearn——决策树&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;注明：转载自&lt;a href=&quot;https://cuijiahua.
      
    
    </summary>
    
    
      <category term="机器学习" scheme="https://nymrli.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="Pythton" scheme="https://nymrli.top/tags/Pythton/"/>
    
  </entry>
  
  <entry>
    <title>ACM-博弈论</title>
    <link href="https://nymrli.top/2019/08/30/ACM-%E5%8D%9A%E5%BC%88%E8%AE%BA/"/>
    <id>https://nymrli.top/2019/08/30/ACM-博弈论/</id>
    <published>2019-08-30T13:41:28.000Z</published>
    <updated>2019-08-30T13:42:14.194Z</updated>
    
    <content type="html"><![CDATA[<h1 id="acm-博弈论gambling"><a class="markdownIt-Anchor" href="#acm-博弈论gambling"></a> ACM-博弈论（gambling）</h1><blockquote><p>博弈论：是二人或多人在平等的对局中各自利用对方的策略变换自己的对抗策略，达到取胜目标的理论。假设，双方每步都是最优决策</p></blockquote><p>博弈论是研究互动决策的理论。博弈可以分析自己与对手的利弊关系，从而确立自己在博弈中的优势，因此有不少博弈理论，可以帮助对弈者分析局势，从而采取相应策略，最终达到取胜的目的。</p><h2 id="巴什博弈"><a class="markdownIt-Anchor" href="#巴什博弈"></a> 巴什博弈</h2><blockquote><p>只有一堆n个物品，两个人轮流从这堆物品中取物，规定每次至少取一个，最多取m个。最后取光者得胜。</p></blockquote><p>显然，如果n=m+1，1那么由于一次最多只能取m个，所以，<strong>无论先取者拿走多少个，后取者都能够一次拿走剩余的物品，后者取胜</strong>。因此我们发现了先手如何取胜的法则：除了先手取以外，之后每个双方回合时保证取走m+1个物品则能保证先手胜。</p><p>▲即如果n=(m+1)*r+s，（r为任意自然数，0&lt;s&lt;=m），那么先取者要拿走s个物品，如果后取者拿走k（&lt;=m）个，那么先取者再拿走m+1-k个，结果剩下（m+1）（r-1）个，以后保持这样的取法，那么先取者肯定获胜。总之，要保持给对手留下（m+1）的倍数，就能最后获胜。</p><p>结论</p><ul><li>编程解题的方法就是判断n是否能表示为(m+1)*r+s，找到这个m，和存在r，s</li><li>s不为0，所以当n=(m+1)*r时，后手必胜</li></ul><p>这个游戏还可以有一种变相的玩法：两个人轮流报数，每次至少报一个，最多报十个，谁能报到100者胜。</p><h3 id="例题hdu1846brave-game裸题"><a class="markdownIt-Anchor" href="#例题hdu1846brave-game裸题"></a> 例题<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1846" target="_blank" rel="noopener">HDU1846——Brave Game</a>，裸题</h3><blockquote><p>n为总价、总和，m为每次能取的大小</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">int</span> t;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;n &gt;&gt;m;</span><br><span class="line">        <span class="keyword">int</span> mod = n%(m+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (mod != <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"first"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"second"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="public-sale"><a class="markdownIt-Anchor" href="#public-sale"></a> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=2149" target="_blank" rel="noopener">Public Sale</a></h3><blockquote><p>区别在于还存在n&lt;m的情况，由于题目要求<strong>每次加价的幅度要在1～N之间，当价格大于或等于田地的成本价 M 时，主办方就把这块田地卖给这次叫价的人。</strong>，所以此时，第一次出价n+1~m都可以<strong>直接</strong>将物品买下，需要单独考虑</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n&gt;&gt;m)&#123;</span><br><span class="line">        <span class="keyword">if</span> (n&lt;m) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=n+<span class="number">1</span>;i&lt;=m;i++) </span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> mod = n%(m+<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (mod == <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"none"</span>&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//s=0，后手必胜</span></span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; mod &lt;&lt; <span class="built_in">endl</span>;   <span class="comment">//存在s，即先手的Lele能买到</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="斐波那契博弈"><a class="markdownIt-Anchor" href="#斐波那契博弈"></a> 斐波那契博弈</h2><blockquote><p>有一堆个数为n的石子，游戏双方轮流取石子，满足：<br>1）先手不能在第一次把所有的石子取完；<br>2）之后每次可以取的石子数介于<strong>1到对手刚取的石子数的2倍之间</strong>（包含1和对手刚取的石子数的2倍）。</p></blockquote><p>▲ 游戏规则动态化</p><p>这个游戏叫做Fibonacci Nim，肯定和Fibonacci数列：f[n]：1，2，3，5，8，13，21，34，55，89…有密切的关系。如果试验一番之后，可以猜测：先手胜当且仅当n不是Fibonacci数。换句话说，必败态构成Fibonacci数列。<br>就像“Wythof博弈”需要“Beatty定理”来帮忙一样，这里需要借助**“Zeckendof定理”（齐肯多夫定理）**：<u>任何正整数</u>可以表示为若干个<u>不连续</u>的Fibonacci数之和。定理的证明可以在这里看到，不过我觉得更重要的是自己动手分解一下。<br>e.g.比如，我们要分解83，注意到83被夹在55和89之间，于是把83可以写成83=55+28；然后再想办法分解28，28被夹在21和34之间，于是28=21+7；依此类推7=5+2，故；</p><p>如果n=83，我们看看这个分解有什么指导意义：假如先手取2颗，那么后手无法取5颗或更多，而5是一个Fibonacci数，如果猜测正确的话，（面临这5颗的先手实际上是整个游戏的后手）归纳得如果需要取走斐波那契数n，那么后手必胜，即那么一定是游戏的先手（此时为取5个的后手）取走这5颗石子中的最后一颗，而这个我们可以通过第二类归纳法来绕过，同样的道理，接下去先手取走接下来的后21颗中的最后一颗，再取走后55颗中的最后一颗，那么先手赢。需要注意到的是<strong>分解后不连续的若干个数单个的两倍都小于分解的最大数，即2n&lt;m</strong></p><p>▲如果n是斐波那契数，后手一定赢，如果不是，先手一定赢（先手胜当且仅当n不是斐波那契数列）。因为如果n是斐波那契数，那么先手取走数之后剩下的一定不是斐波那契数，后手必胜</p><h3 id="例题hdoj-2516"><a class="markdownIt-Anchor" href="#例题hdoj-2516"></a> 例题hdoj 2516</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">50</span>];</span><br><span class="line"><span class="comment">// feibo</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">2</span>,arr[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">50</span>;i++) arr[i]=arr[i<span class="number">-1</span>]+arr[i<span class="number">-2</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &amp;&amp; n)&#123;</span><br><span class="line">        <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">50</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i]==n) flag=<span class="number">0</span>,<span class="built_in">cout</span>&lt;&lt;<span class="string">"Second win"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">if</span> (arr[i]&gt;n) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"First win"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总结：</p><p>不需要深究博弈论数学原理，只需要知道结论，就可以写出代码。如，</p><p>巴什博弈：判断mod=n%(m+1)的结果s</p><p>斐波那契博弈：判断n是否为斐波那契数</p><h2 id="威佐夫博弈"><a class="markdownIt-Anchor" href="#威佐夫博弈"></a> 威佐夫博弈</h2><blockquote><p>有两维各若干个物品(ak, bk)，两个人轮流从<strong>某一堆或同时从两堆中取同样多</strong>的物品，规定每次至少取一个，多者不限，最后取光者得胜。</p></blockquote><p>这种情况下是颇为复杂的。我们用（ak，bk）（ak&lt;=bk，k=0，1，2，.……n）表示两堆物品的数量并称其为局势，如果甲面对（0，0），那么甲已经输了，这种局势我们称为奇异局势。前几个奇异局势是：（0，0）、（1，2）、（3，5）、（4，7）、（6，10）、（8，13）、（9，15）、（11，18）、（12，20）。<br>可以看出，a0=b0=0，ak是未在前面出现过的最小自然数，而bk=ak+k，奇异局势有如下三条性质：</p><ul><li><p>1.任何自然数都包含在一个且仅有一个奇异局势中。</p><p>由于ak是未在前面出现过的最小自然数，所以有ak&gt;ak-1，而bk=ak+k&gt;ak-1+k-1=bk-1&gt;ak-1。所以性质1。成立。</p></li><li><p>2.任意操作都可将奇异局势变为非奇异局势。<br>事实上，若只改变奇异局势（ak，bk）的某一个分量，那么另一个分量不可能在其他奇异局势中，所以必然是非奇异局势。如果使（ak，bk）的两个分量同时减少，则由于其差不变，且不可能是其他奇异局势的差，因此也是非奇异局势。</p></li><li><p>3.采用适当的方法，可以将非奇异局势变为奇异局势。</p></li></ul><p>从如上性质可知，两个人如果都采用正确操作，那么面对非奇异局势，先拿者必胜；反之，面对奇异局势，则后拿者取胜。</p><p>Betty定理:…</p><p>▲那么任给一个局势（a，b），怎样判断它是不是奇异局势呢？我们有如下公式：</p><p>ak =[k（1+V5）/2]，bk=ak+k（k=0，1，2，.……n方括号表示取整函数）奇妙的是其中出现了黄金分割数（1+V5）/2=1.618…，因此，由ak，bk组成的矩形近似为黄金矩形，由于2/（1+V5）=（V5-1）/2，可以先求出j=[a（V5-1）/2]，若a=[（1+V5）/2]，那么a=aj，bj=aj+j，若不等于，那么a=aj+1，bj+1=aj+1+j+1，若都不是，那么就不是奇异局势。然后再按照上述法则进行，一定会遇到奇异局势。===&gt; 如果(b-a)*(sqrt(5.0)+1)/2 == a的话就是奇异局势</p><h3 id="例题poj-1067裸题"><a class="markdownIt-Anchor" href="#例题poj-1067裸题"></a> 例题poj 1067，裸题</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (a&gt;b) swap(a,b);</span><br><span class="line">        <span class="keyword">int</span> c = <span class="built_in">floor</span>((b-a)*(<span class="built_in">sqrt</span>(<span class="number">5.0</span>)+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (a==c) <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span>    <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="尼姆博弈nim"><a class="markdownIt-Anchor" href="#尼姆博弈nim"></a> 尼姆博弈（Nim）</h2><blockquote><p>有n堆各若干个物品，两个人轮流从某一堆取任意多的物品，规定每次至少取一个，多者不限，最后取光者得胜。</p></blockquote><p>以n=3为例子，这种情况最有意思，它与二进制有密切关系，我们用（a，b，c）表示某种局势，首先（0，0，0）显然是奇异局势，无论谁面对奇异局势，都必然失败。第二种奇异局势是（0，n，n），只要与对手拿走一样多的物品，最后都将导致（0，0，0）。仔细分析一下，（1，2，3）也是奇异局势，无论对手如何拿，接下来都可以变为（0，n，n）的情形。</p><p>然而这并不是博弈的重点，博弈之王道乃是SG值，当sg值为0的时候，就是输，不为0就是赢；</p><p>SG值：一个点的SG值就是一个不等于它的后继点SG值的且大于等于零的最小整数。</p><ul><li>不属于它后继点SG值集的值</li></ul><p>大概的意思就是：在步骤允许的情况下，与前面一个必败点的差（也就是说这个差是规定的、能走的、其中一个步数）！<br>后继点：也就是按照题目要求的走法（比如取石子可以取的数量，方法）能够走一步达到的那个点。（sg值的理解很抽象。需要多画画）</p><p>举个栗子：比如一堆石子，我们可以取任意个，那么x个石子的石子的sg值是多少呢？可以知道，0个石子sg为0，1的时候我们可以取一个，剩下0，0的sg是0(SG(0)=0)，那么mex(0)就是1，所以1的sg为1(SG(1)=1)。即SG(1) = mex{SG(0)}=mex{0}=1</p><p>例题<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1847" target="_blank" rel="noopener">hdoj 1847</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">15</span>],sg[<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mex</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sg[x] != <span class="number">-1</span>) <span class="keyword">return</span> sg[x];</span><br><span class="line">    <span class="comment">// 记忆化搜索,如果存在直接返回</span></span><br><span class="line">    <span class="keyword">bool</span> vis[<span class="number">1005</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1005</span>;i++) vis[i] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = x - arr[i];</span><br><span class="line">        <span class="keyword">if</span> (temp&lt;<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// SG值为非负整数</span></span><br><span class="line">        sg[temp] = mex(temp);</span><br><span class="line">        <span class="comment">// 需要递归调用，分治求出小的部分的结果</span></span><br><span class="line">        vis[sg[temp]] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>;;i++)</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">            <span class="comment">// 找到最小的数，mex&#123;0,1,2&#125;=3，mex&#123;1,2,3&#125;=0，mex&#123;0,1,3&#125;=2；</span></span><br><span class="line">            sg[x]=i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> sg[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;=<span class="number">10</span>; i++)</span><br><span class="line">        arr[i] = arr[i<span class="number">-1</span>]*<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; n)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(sg,<span class="number">-1</span>,<span class="keyword">sizeof</span>(sg));</span><br><span class="line">        <span class="keyword">if</span> (mex(n)) <span class="built_in">cout</span> &lt;&lt; <span class="string">"Kiki"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"Cici"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="组合博弈博弈的精华"><a class="markdownIt-Anchor" href="#组合博弈博弈的精华"></a> 组合博弈：（博弈的精华）</h2><blockquote><p>组合博弈无疑是对sg值的熟练操作例如：有n堆石子，每次可以从第1堆石子里取1颗、2颗或3颗，可以从第2堆石子里取奇数颗，可以从第3堆及以后石子里取任意颗.……我们可以把它看作3个子游戏，第1个子游戏只有一堆石子，每次可以取1、2、3颗，很容易看出x颗石子的局面的SG值是×%4。第2个子游戏也是只有一堆石子，每次可以取奇数颗，经过简单的画图可以知道这个游戏有x颗石子时的SG值是×%2。第3个游戏有n-2堆石子，就是一个Nim游戏。对于原游戏的每个局面，把三个子游戏的SG值异或一下就得到了整个游戏的SG值，然后就可以根据这个SG值判断是否有必胜策略以及做出决策了。其实看作3个子游戏还是保守了些，干脆看作n个子游戏，其中第1、2个子游戏如上所述，第3个及以后的子游戏都是“1堆石子，每次取几颗都可以”，称为“任取石子游戏”，这个超简单的游戏有x颗石子的SG值显然就是x。</p></blockquote><p><a href="https://www.bilibili.com/video/av9114486?from=search&amp;seid=16453184189041006847" target="_blank" rel="noopener">SWPU-ACM每周算法讲堂-博弈论入门</a></p><h1 id="计算机博弈大赛"><a class="markdownIt-Anchor" href="#计算机博弈大赛"></a> 计算机博弈大赛</h1><h2 id="蒙特卡洛方法"><a class="markdownIt-Anchor" href="#蒙特卡洛方法"></a> 蒙特卡洛方法</h2><blockquote><p>由冯·诺依曼、乌拉姆等人发明，因蒙特卡洛赌场而闻名，一种基于概率的方法的统称。</p><p>一种让人感觉“我去，这也行”的方法——根据大概率逼近真实结果的方法</p></blockquote><p>拉斯维加斯（Las Vegas）方法——找老婆（必须要精确找到那一个答案，其他都不行。采样越多，越有机会找到最优解）</p><ul><li>找1W人才能准确确定</li></ul><p>蒙特卡罗（Monte Carlo）方法——民意调查（一直在找，找的是逐渐贴近于最优解的结果。当样越多，越近似最优解）</p><ul><li>找了2K人大致能确定了</li></ul><p>相关方法：</p><ul><li>蒙特卡罗算法、蒙特卡罗模拟、蒙特卡罗过程</li><li>蒙特卡罗搜索树一—AlphaGo</li></ul><p>工作原理：</p><ul><li>不断抽样（中心极限定理，n-&gt;∞）</li><li>逐渐逼近（依概率逼近）</li></ul><h2 id="蒙特卡洛树搜索-mctsmonte-carlo-tree-search"><a class="markdownIt-Anchor" href="#蒙特卡洛树搜索-mctsmonte-carlo-tree-search"></a> 蒙特卡洛树搜索 （MCTS，Monte Carlo tree search）</h2><blockquote><p>一种用于某些决策过程的启发式搜索算法，最引人注目的是在游戏中的使用</p></blockquote><h3 id="双人有限零和顺序游戏"><a class="markdownIt-Anchor" href="#双人有限零和顺序游戏"></a> 双人有限零和顺序游戏</h3><p>MCTS运行所在的框架/环境是一个游戏，它本身是一个非常抽象和宽泛的概念，因此这里我们只关注一种游戏类型：双人有限零和顺序游戏。这个名词一开始听起来会有些复杂，但是实际上非常简单，现在来让我们将它分解一下：</p><ul><li>游戏：意味着我们在一种需要交互的情境中，交互通常会涉及一个或多个角色</li><li>有限：表明在任意时间点，角色之间存在的交互方式都是有限的</li><li>双人：游戏中只有两个角色</li><li>顺序：玩家依次交替进行他们的动作</li><li>零和：参与游戏的两方有完全相反的目标，换句话说就是，游戏的任意结束状态双方的收益之和等于零</li></ul><p>我们可以很轻松的验证，围棋、国际象棋和井字棋都是双人有限零和顺序游戏：有两位玩家参与，玩家能进行的动作总是有限的，双方的游戏目标是完全相反的（所有游戏的结果之和等于0）。</p><h3 id="如何表示一个游戏"><a class="markdownIt-Anchor" href="#如何表示一个游戏"></a> 如何表示一个游戏</h3><p>从程序员的角度来看，可以用一种常见的数据结构以来表示游戏——游戏树。</p><p><img src="https://img-blog.csdnimg.cn/20181030191603540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE2MTM3NTY5,size_16,color_FFFFFF,t_70" alt=""></p><p>游戏树是一个数，其中每一个节点代表游戏的一个确定状态。从一个节点到该节点的一个子节点（如果存在）是一个移动。节点的子节点数目称为分支因子。游戏树的根节点代表游戏的初始状态。游戏树的终端节点是没有子节点的节点，至此游戏结束，无法再进行移动。终端节点的状态也就是游戏的结果（输/赢/平局）。</p><p>游戏树是一种递归的数据结构，每次选择完最佳的下一步时，会移动到下一个子节点，而这个子节点又是它子树的根节点。因此我们可以把一局游戏视为“最佳下一步”的一个问题序列，每一次都可以由一个不同根节点的游戏树表示。通常在实际应用中，我们不需要记住到当前状态的路径，因为这不是当前游戏状态的关注点。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;acm-博弈论gambling&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#acm-博弈论gambling&quot;&gt;&lt;/a&gt; ACM-博弈论（gambling）&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;博弈论：是二人或多人在平等的对局中各
      
    
    </summary>
    
    
      <category term="ACM" scheme="https://nymrli.top/tags/ACM/"/>
    
  </entry>
  
  <entry>
    <title>Linux三剑客</title>
    <link href="https://nymrli.top/2019/08/30/Linux%E4%B8%89%E5%89%91%E5%AE%A2/"/>
    <id>https://nymrli.top/2019/08/30/Linux三剑客/</id>
    <published>2019-08-30T13:37:36.000Z</published>
    <updated>2019-08-30T13:38:34.688Z</updated>
    
    <content type="html"><![CDATA[<h1 id="linux三剑客"><a class="markdownIt-Anchor" href="#linux三剑客"></a> Linux三剑客</h1><h2 id="bash命令执行顺序"><a class="markdownIt-Anchor" href="#bash命令执行顺序"></a> bash命令执行顺序</h2><ol><li>把命令行分成单个命令词</li><li>展开别名</li><li>展开大括号的声明（{}）</li><li>展开波浪符声明（~）</li><li>命令替换$0和&quot;)</li><li>再次把命令行分成命令词</li><li>展开文件通配（*、？、[abc]等等）</li><li>准备I/0重导向（&lt;、&gt;）</li><li>运行命令</li></ol><p>文件查找</p><p>非实时搜索locate</p><blockquote><p>速度快</p></blockquote><ul><li>更新updatabase</li></ul><p>实时搜索工具find</p><blockquote><p>搜索速度略慢</p><p>精确查找</p><p>只能搜索用户具备读取和执行权限的目录</p></blockquote><h2 id="sedstream-editor"><a class="markdownIt-Anchor" href="#sedstream-editor"></a> sed(Stream EDitor):</h2><blockquote><p>sed使用单引号</p></blockquote><p><code>sed -n '22,$p' test</code></p><p>指令解释:常用选项[-n]，‘地址定界[22,$],编辑命令[p]’</p><p>地址定界:</p><ul><li><p>不给地址: 全文处理</p></li><li><p>单地址</p><ul><li><code>#:</code> 指定行</li><li><code>$:</code> 最后一行</li><li><code>/pattern:</code> 正则匹配</li></ul></li><li><p>地址范围</p><ul><li><code>#,#</code>,如<code>1,20</code>即1-20行<ul><li>e.g.<code>sed -n '22,$p' test</code></li></ul></li><li><code>#,+#</code>,如<code>2,+20</code>即2-2+20 行</li><li><code>#;#</code>如<code>3;5</code>即第3和第5行</li><li><code>/pat1/,/pat2/</code></li><li><code>#,/pat1/</code></li></ul></li><li><p>步进~</p><ul><li>1~2 奇数行<ul><li><code>sed -n &quot;1~2p&quot; f1</code></li></ul></li><li>2~2 偶数行</li></ul></li><li><p>正则</p><ul><li><blockquote><p>sed ‘/regex expression/[option] text’ filename</p></blockquote></li><li><p>^匹配每一行的开头</p></li><li><p>$匹配行的结尾</p></li><li><p>匹配包含2、3、或者4的行</p><ul><li><code>sed -n '/[234]/p' employee.txt</code></li></ul></li><li><p>删除所有以#开头的行</p><ul><li><code>**sed -e 's/^#.\*// ; /^$/d' employee.txt**</code></li></ul></li><li><p>删除所有注释和空行</p><ul><li><code>sed -e 's/#.*//;/^$/ d' /etc/profile</code></li></ul></li><li><p>只删除注释行不删除空行</p><ul><li><code>sed '/^#.*/d' /etc/profile</code></li><li></li></ul></li></ul></li></ul><p>常用选项</p><ul><li><p><code>-n</code>不自动打印</p></li><li><p><code>-f</code> 指定文件中读取编辑脚本</p><ul><li><p>script.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2~2p</span><br></pre></td></tr></table></figure><p><code>sed -n -f script.txt f1</code></p></li></ul></li><li><p><code>-r</code>支持使用拓展正则表达式</p><ul><li><code>sed -r 's/(GRUB_CMDLINE_LINUX.*)&quot;$/\1 xyz&quot;/'/etc/default/grub</code></li><li><code>echo&quot;/etc/sysconfig/network/&quot; | sed -r 's/(.*\/)([^/]\/?$)/\1/'</code></li></ul></li><li><p><code>-i.bak</code>生成备份文件bak并原处编辑</p><ul><li>如果没有-i表示只是预览,不会真正执行</li></ul></li><li><p><code>-e</code>多点编辑,即多次处理文件</p></li></ul><p>编辑命令</p><ul><li><p>d删除末世空间匹配的行,并启用下一轮循环</p><ul><li><code>sed -n 'd' test</code>全删</li><li><code>sed -n '1d' test</code>只删第一行</li></ul></li><li><p>p打印当前模式空间内容,追加到默认输出后</p></li><li><p><code>a[\]test</code> 指定行追加</p></li><li><p><code>i[\]test</code> 行前插入</p></li><li><p><code>c[\]test</code> 替换行为单行或多行</p></li><li><p>= 为模式空间中的行打印行号</p><ul><li>sed -n ‘3,5{=;p}’ test</li></ul></li><li><p>! 模式空间中匹配行取反</p></li><li><p>w/path/somefile：保存模式匹配的行至指定文件<br>r/path/somefile：读取指定文件的文本至模式空间中匹配到的行后</p><ul><li><code>sed'/User/r sed.txt' .bashrc</code></li></ul></li><li><p>搜索代替</p><ul><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed &apos;s/xxx/xxx/&apos; filename</span><br><span class="line"># sed &apos;s@xxx@xxx&apos; filename</span><br><span class="line"># sed &apos;s#xxx#xxx&apos; filename</span><br></pre></td></tr></table></figure></li><li><p>替换标记：<br>g：行内全局替换<br>p：显示替换成功的行<br>W/PATH/TO/SOMEFILE：将替换成功的行保存至文件中</p></li></ul></li></ul><p>以下命令如果需要在文本中更改 需要加 -i 或者  -ri参数</p><p><strong>用sed在aaa前加#注释</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'s/^aaa/#&amp;/'</span> zimu.txt      <span class="comment"># &amp;的意思是匹配任意字符（就是说未知数，啥都行）  这条命令是 替换以aaa开头的</span></span><br></pre></td></tr></table></figure><p><strong>用sed取消bbb前面的注释</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'s/^#(bbb)/\1/'</span> zimu.txt    <span class="comment">#\1的意思 就类似于   前面的 (bbb\） \1就是复制这个位置的内容  如果有 第二个 那么久\2就是复制第二个位置的内容</span></span><br><span class="line">sed <span class="string">'s/^#bbb/bbb/'</span> zimu.txt</span><br></pre></td></tr></table></figure><p>上面那条命令等同于</p><h2 id="awk"><a class="markdownIt-Anchor" href="#awk"></a> awk</h2><blockquote><p>优良的文本处理工具，Linux及Unix环境中现有的功能最强大的数据处理引擎之一</p></blockquote><p>ifconfig获得ip_addr的命令</p><p>1.<code>ifconfig | grep inet | awk '{print $2}' | awk -F 'addr:' '{print $2}'</code></p><p>2.<code>ifconfig | grep addr:192.168.* | awk '{print$2}' | awk '{split($0,a,\&quot;:\&quot;);print(a[2])}'</code></p><p>▲.尽量使用单引号<code>''</code>,而不是<code>&quot;&quot;</code></p><p>-F分隔符</p><p>e.g.<code>echo &quot;A|B|C|D&quot; | awk -F &quot;|&quot; '{print($1)}'</code></p><p>NF列的个数</p><p><code>awk -F: '$3&lt;10{print $1 &lt;====&gt; $NF}' /etc/passwd</code></p><p>{}中的内容为要要执行的内容</p><p>NR当前行号</p><h3 id="linux单双引号区别"><a class="markdownIt-Anchor" href="#linux单双引号区别"></a> linux单双引号区别</h3><p>双引号：把双引号的内容输出出来；如果内容中有命令，变量等，会先把命令，变量解析出结果，然后再输出最终内容来。双引号内命令或变量的写法为命令或变量或$（命令或变量）</p><p>单引号：所见即所得，将单引号内的内容原样输出，阻止所有字符的转义</p><p>不加引号：不会将含有空格的字符串视为一个整体输出，如果内容中有命令，变量等，会先把命令，变量解析出结果，然后再输出最终内容来，如果字符串含有空格等特殊字符，则不能完整输出，则需改加双引号。</p><p>倒引号（反引号Esc键下方）：进行命令的替换，在倒引号内部的shell命令将会被执行，其结果输出代替用倒引号括起来的文本。</p><p><code>echo &quot;1111\n222&quot;</code>不会转移\n</p><p><code>echo -e &quot;11111\n222&quot;</code>会转义\n</p><p><code>xargs -n1</code>每行1个元素;xargs -n2 每行2个元素;</p><h2 id="grepglobally-search-a-regular-expression-and-print"><a class="markdownIt-Anchor" href="#grepglobally-search-a-regular-expression-and-print"></a> grep(Globally search a Regular Expression and Print)</h2><blockquote><p>一种强大的文本搜索工具，它能使用特定模式匹配（包括<strong>正则表达式</strong>）搜索文本，并默认输出匹配行</p></blockquote><p>常见命令<code>ps -aux | grep xxxx</code></p><p>选项与参数：</p><p>-a ：将 binary 文件以 text 文件的方式搜寻数据</p><p>-c ：计算找到 ‘搜寻字符串’ 的次数</p><p>-i ：忽略大小写的不同，所以大小写视为相同</p><p>-n ：顺便输出行号</p><p>-v ：反向选择，亦即显示出没有 ‘搜寻字符串’ 内容的那一行！</p><p>-x --line-regexp : 只显示全列符合的列。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;linux三剑客&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#linux三剑客&quot;&gt;&lt;/a&gt; Linux三剑客&lt;/h1&gt;
&lt;h2 id=&quot;bash命令执行顺序&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#b
      
    
    </summary>
    
    
      <category term="Linux" scheme="https://nymrli.top/tags/Linux/"/>
    
      <category term="运维" scheme="https://nymrli.top/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>2019_6月编程笔记</title>
    <link href="https://nymrli.top/2019/08/30/2019-6%E6%9C%88%E7%BC%96%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    <id>https://nymrli.top/2019/08/30/2019-6月编程笔记/</id>
    <published>2019-08-30T13:26:03.000Z</published>
    <updated>2019-08-30T13:29:17.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2019_6月编程笔记"><a class="markdownIt-Anchor" href="#2019_6月编程笔记"></a> 2019_6月编程笔记</h1><blockquote><p>注，不少内容比较多，已单独分出去成为独立的文章，更详细的介绍可见这些文章</p></blockquote><h2 id="硬盘格式"><a class="markdownIt-Anchor" href="#硬盘格式"></a> 硬盘格式</h2><p>fat32 单文件4G， 做引导分区</p><p>系统引导程序能读fat32</p><p>只能主引导记录，选择能找到efi程序</p><p>exfat 支持更大空间，引导识别不了，做不了系统盘</p><h2 id="python"><a class="markdownIt-Anchor" href="#python"></a> Python</h2><h3 id="all"><a class="markdownIt-Anchor" href="#all"></a> <strong>all</strong></h3><blockquote><p><code>__all__</code>是一个字符串list；</p><p>约束作用：用来定义模块中对于<code>from XXX import *</code>时要对外导出的符号，即要暴露的借口，但它只对<code>import *</code>起作用，对<code>from XXX import XXX</code>不起作用。</p></blockquote><p><code>from njupt.zhengfang import Zhengfang</code>是在<code>__init__.py</code>里用all标出后在该目录下的其他模块能直接通过<code>from njupt import Zhengfang</code>来调用。修改了导入的方式</p><h3 id="eval-和-exec"><a class="markdownIt-Anchor" href="#eval-和-exec"></a> eval 和 exec</h3><p>1.exec能执行<strong>多段Python代码</strong>，eval只能执行当行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exec(<span class="string">"""</span></span><br><span class="line"><span class="string">print('hello')</span></span><br><span class="line"><span class="string">print('world')</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line"></span><br><span class="line">eval(<span class="string">"print('hello')"</span>)</span><br></pre></td></tr></table></figure><p>2.而Python中的eval函数可以计算Python表达式，并<strong>返回结果</strong>；（exec不返回结果，print(eval(&quot;…&quot;))打印None）；</p><h3 id="osenviron"><a class="markdownIt-Anchor" href="#osenviron"></a> os.environ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用os.environ来读取和修改环境变量：</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (os.environ[<span class="string">"TEMP"</span>])</span><br><span class="line"></span><br><span class="line">mydir = <span class="string">"c:\\mydir"</span></span><br><span class="line">os.environ[<span class="string">"MYDIR"</span>] = mydir</span><br><span class="line"><span class="keyword">print</span> (os.environ[<span class="string">"MYDIR"</span>])</span><br><span class="line"></span><br><span class="line">pathV = os.environ[<span class="string">"PATH"</span>]</span><br><span class="line"><span class="keyword">print</span> (pathV)</span><br><span class="line">os.environ[<span class="string">"PATH"</span>]= mydir + <span class="string">";"</span> + os.environ[<span class="string">"PATH"</span>]</span><br><span class="line"><span class="keyword">print</span> (os.environ[<span class="string">"PATH"</span>])</span><br></pre></td></tr></table></figure><h3 id="syspath的insert和append"><a class="markdownIt-Anchor" href="#syspath的insert和append"></a> sys.path的insert和append</h3><p>python程序中使用 import XXX 时，python解析器会在当前目录、已安装和第三方模块中搜索 xxx，如果都搜索不到就会报错。</p><p>使用sys.path.append()方法可以临时添加搜索路径，方便更简洁的import其他包和模块。这种方法导入的路径会在python程序退出后失效。</p><p>1.对于模块和自己写的脚本不在同一个目录下，在脚本开头加</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys  </span><br><span class="line">sys.path.append(’引用模块的地址<span class="string">')</span></span><br></pre></td></tr></table></figure><p>2.把路径添加到系统的环境变量，或把该路径的文件夹放进已经添加到系统环境变量的路径内。环境变量的内容会自动添加到模块搜索路径中。</p><p><strong>insert</strong>：定义搜索优先顺序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.insert(<span class="number">1</span>, <span class="string">"./model"</span>)</span><br></pre></td></tr></table></figure><p><code>sys.path.insert(1, &quot;./crnn&quot;)</code>定义搜索路径的优先顺序，序号从0开始，表示最大优先级，<code>sys.path.insert()</code>加入的也是临时搜索路径，程序退出后失效。</p><h3 id="sphinx使用"><a class="markdownIt-Anchor" href="#sphinx使用"></a> sphinx使用</h3><p><code>pip install sphinx</code></p><p>1.新建docs文件夹</p><p>2.<code>sphinx-quickstart</code></p><p>3.配置</p><p>教程说明：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; Root path <span class="keyword">for</span> the documentation [.]: doc  <span class="comment"># 在当前目录下新建doc文件夹存放sphinx相关信息</span></span><br><span class="line">&gt; Separate <span class="built_in">source</span> and build directories (y/n) [n]:   <span class="comment"># 默认，直接回车</span></span><br><span class="line">&gt; Name prefix <span class="keyword">for</span> templates and static dir [_]:</span><br><span class="line">&gt; Project name: python123   <span class="comment"># 输入项目名称</span></span><br><span class="line">&gt; Author name(s): 123   <span class="comment"># 作者</span></span><br><span class="line">&gt; Project version: 1.0  <span class="comment"># 项目版本</span></span><br><span class="line">&gt; Project release [1.0]:</span><br><span class="line">&gt; Project language [en]:   <span class="comment"># 默认，回车</span></span><br><span class="line">&gt; Source file suffix [.rst]:</span><br><span class="line">&gt; Name of your master document (without suffix) [index]:</span><br><span class="line">&gt; Do you want to use the epub builder (y/n) [n]:</span><br><span class="line">&gt; autodoc: automatically insert docstrings from modules (y/n) [n]: y  <span class="comment"># 这个很重要，输入y</span></span><br><span class="line">&gt; doctest: automatically <span class="built_in">test</span> code snippets <span class="keyword">in</span> doctest blocks (y/n) [n]:</span><br><span class="line">&gt; intersphinx: link between Sphinx documentation of different projects (y/n) [n]:</span><br><span class="line">&gt; todo: write <span class="string">"todo"</span> entries that can be shown or hidden on build (y/n) [n]:</span><br><span class="line">&gt; coverage: checks <span class="keyword">for</span> documentation coverage (y/n) [n]:</span><br><span class="line">&gt; pngmath: include math, rendered as PNG images (y/n) [n]:</span><br><span class="line">&gt; mathjax: include math, rendered <span class="keyword">in</span> the browser by MathJax (y/n) [n]:</span><br><span class="line">&gt; ifconfig: conditional inclusion of content based on config values (y/n) [n]:</span><br><span class="line">&gt; viewcode: include links to the <span class="built_in">source</span> code of documented Python objects (y/n) [n]: y  <span class="comment"># 很重要，输入y，表示将源码也放到文档中，你看很多python的模块的文档，其实都是包含代码的。</span></span><br><span class="line">&gt; Create Makefile? (y/n) [y]:</span><br><span class="line">&gt; Create Windows <span class="built_in">command</span> file? (y/n) [y]:</span><br></pre></td></tr></table></figure><p>windows实测：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">(Python_web) E:\Python_web\Code\Quan&gt;sphinx-quickstart</span><br><span class="line"></span><br><span class="line">Welcome to the Sphinx 2.1.0 quickstart utility.</span><br><span class="line"></span><br><span class="line">Please enter values <span class="keyword">for</span> the following settings (just press Enter to</span><br><span class="line">accept a default value, <span class="keyword">if</span> one is given <span class="keyword">in</span> brackets).</span><br><span class="line"></span><br><span class="line">Selected root path: .</span><br><span class="line"></span><br><span class="line">You have two options <span class="keyword">for</span> placing the build directory <span class="keyword">for</span> Sphinx output.</span><br><span class="line">Either, you use a directory <span class="string">"_build"</span> within the root path, or you separate</span><br><span class="line"><span class="string">"source"</span> and <span class="string">"build"</span> directories within the root path.</span><br><span class="line">&gt; Separate <span class="built_in">source</span> and build directories (y/n) [n]: n</span><br><span class="line"></span><br><span class="line">The project name will occur <span class="keyword">in</span> several places <span class="keyword">in</span> the built documentation.</span><br><span class="line">&gt; Project name: TaobaoQuan</span><br><span class="line">&gt; Author name(s): Mrli</span><br><span class="line">&gt; Project release []: 1.0</span><br><span class="line"></span><br><span class="line">If the documents are to be written <span class="keyword">in</span> a language other than English,</span><br><span class="line">you can select a language here by its language code. Sphinx will <span class="keyword">then</span></span><br><span class="line">translate text that it generates into that language.</span><br><span class="line"></span><br><span class="line">For a list of supported codes, see</span><br><span class="line">http://sphinx-doc.org/config.html<span class="comment">#confval-language.</span></span><br><span class="line">&gt; Project language [en]: en</span><br><span class="line"></span><br><span class="line">Creating file .\conf.py.</span><br><span class="line">Creating file .\index.rst.</span><br><span class="line">Creating file .\Makefile.</span><br><span class="line">Creating file .\make.bat.</span><br><span class="line"></span><br><span class="line">Finished: An initial directory structure has been created.</span><br><span class="line"></span><br><span class="line">You should now populate your master file .\index.rst and create other documentation</span><br><span class="line"><span class="built_in">source</span> files. Use the Makefile to build the docs, like so:</span><br><span class="line">   make builder</span><br><span class="line"><span class="built_in">where</span> <span class="string">"builder"</span> is one of the supported builders, e.g. html, latex or linkcheck.</span><br></pre></td></tr></table></figure><p>编写好目录下的所有<code>.rst</code>（默认生成了模板<code>index.rst</code>）文件后<code>.\make.bat html</code>可以生成网页目录</p><h4 id="confpy默认模板"><a class="markdownIt-Anchor" href="#confpy默认模板"></a> conf.py默认模板</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Configuration file for the Sphinx documentation builder.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This file only contains a selection of the most common options. For a full</span></span><br><span class="line"><span class="comment"># list see the documentation:</span></span><br><span class="line"><span class="comment"># http://www.sphinx-doc.org/en/master/config</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Path setup --------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If extensions (or modules to document with autodoc) are in another directory,</span></span><br><span class="line"><span class="comment"># add these directories to sys.path here. If the directory is relative to the</span></span><br><span class="line"><span class="comment"># documentation root, use os.path.abspath to make it absolute, like shown here.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># import os</span></span><br><span class="line"><span class="comment"># import sys</span></span><br><span class="line"><span class="comment"># sys.path.insert(0, os.path.abspath('.'))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Project information -----------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">project = <span class="string">'TaobaoQuan'</span></span><br><span class="line">copyright = <span class="string">'2019, Mrli'</span></span><br><span class="line">author = <span class="string">'Mrli'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The full version, including alpha/beta/rc tags</span></span><br><span class="line">release = <span class="string">'1.0'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- General configuration ---------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any Sphinx extension module names here, as strings. They can be</span></span><br><span class="line"><span class="comment"># extensions coming with Sphinx (named 'sphinx.ext.*') or your custom</span></span><br><span class="line"><span class="comment"># ones.</span></span><br><span class="line">extensions = [</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any paths that contain templates here, relative to this directory.</span></span><br><span class="line">templates_path = [<span class="string">'_templates'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># List of patterns, relative to source directory, that match files and</span></span><br><span class="line"><span class="comment"># directories to ignore when looking for source files.</span></span><br><span class="line"><span class="comment"># This pattern also affects html_static_path and html_extra_path.</span></span><br><span class="line">exclude_patterns = [<span class="string">'_build'</span>, <span class="string">'Thumbs.db'</span>, <span class="string">'.DS_Store'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for HTML output -------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The theme to use for HTML and HTML Help pages.  See the documentation for</span></span><br><span class="line"><span class="comment"># a list of builtin themes.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">html_theme = <span class="string">'alabaster'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any paths that contain custom static files (such as style sheets) here,</span></span><br><span class="line"><span class="comment"># relative to this directory. They are copied after the builtin static files,</span></span><br><span class="line"><span class="comment"># so a file named "default.css" will overwrite the builtin "default.css".</span></span><br><span class="line">html_static_path = [<span class="string">'_static'</span>]</span><br></pre></td></tr></table></figure><p><img src="/2019/08/30/2019-6月编程笔记/2019-6%E6%9C%88%E7%BC%96%E7%A8%8B%E7%AC%94%E8%AE%B0%5Cdefault.png" alt="default"></p><h4 id="gaoliang模板"><a class="markdownIt-Anchor" href="#gaoliang模板"></a> Gaoliang模板</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Configuration file for the Sphinx documentation builder.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This file does only contain a selection of the most common options. For a</span></span><br><span class="line"><span class="comment"># full list see the documentation:</span></span><br><span class="line"><span class="comment"># http://www.sphinx-doc.org/en/master/config</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Path setup --------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If extensions (or modules to document with autodoc) are in another directory,</span></span><br><span class="line"><span class="comment"># add these directories to sys.path here. If the directory is relative to the</span></span><br><span class="line"><span class="comment"># documentation root, use os.path.abspath to make it absolute, like shown here.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.path.insert(0, os.path.abspath('.'))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Insert NJUPT-API' path into the system.</span></span><br><span class="line">sys.path.insert(<span class="number">0</span>, os.path.abspath(<span class="string">'..'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Project information -----------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">project = <span class="string">'...'</span></span><br><span class="line">copyright = <span class="string">'...'</span></span><br><span class="line">author = <span class="string">'...'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The short X.Y version</span></span><br><span class="line">version = <span class="string">''</span></span><br><span class="line"><span class="comment"># The full version, including alpha/beta/rc tags</span></span><br><span class="line">release = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- General configuration ---------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If your documentation needs a minimal Sphinx version, state it here.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># needs_sphinx = '1.0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any Sphinx extension module names here, as strings. They can be</span></span><br><span class="line"><span class="comment"># extensions coming with Sphinx (named 'sphinx.ext.*') or your custom</span></span><br><span class="line"><span class="comment"># ones.</span></span><br><span class="line">extensions = [</span><br><span class="line">    <span class="string">'sphinx.ext.autodoc'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">html_logo = <span class="string">"_static/logo_tiny.png"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any paths that contain templates here, relative to this directory.</span></span><br><span class="line">templates_path = [<span class="string">'_templates'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># The suffix(es) of source filenames.</span></span><br><span class="line"><span class="comment"># You can specify multiple suffix as a list of string:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># source_suffix = ['.rst', '.md']</span></span><br><span class="line">source_suffix = <span class="string">'.rst'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The master toctree document.</span></span><br><span class="line">master_doc = <span class="string">'index'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The language for content autogenerated by Sphinx. Refer to documentation</span></span><br><span class="line"><span class="comment"># for a list of supported languages.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is also used if you do content translation via gettext catalogs.</span></span><br><span class="line"><span class="comment"># Usually you set "language" from the command line for these cases.</span></span><br><span class="line">language = <span class="string">'zh_CN'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># List of patterns, relative to source directory, that match files and</span></span><br><span class="line"><span class="comment"># directories to ignore when looking for source files.</span></span><br><span class="line"><span class="comment"># This pattern also affects html_static_path and html_extra_path .</span></span><br><span class="line">exclude_patterns = [<span class="string">'_build'</span>, <span class="string">'Thumbs.db'</span>, <span class="string">'.DS_Store'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the Pygments (syntax highlighting) style to use.</span></span><br><span class="line">pygments_style = <span class="string">'sphinx'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for HTML output -------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The theme to use for HTML and HTML Help pages.  See the documentation for</span></span><br><span class="line"><span class="comment"># a list of builtin themes.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># html_theme = 'sphinx_rtd_theme'</span></span><br><span class="line"><span class="comment"># html_theme = 'alabaster'</span></span><br><span class="line"><span class="comment"># html_theme = 'flask'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Theme options are theme-specific and customize the look and feel of a theme</span></span><br><span class="line"><span class="comment"># further.  For a list of options available for each theme, see the</span></span><br><span class="line"><span class="comment"># documentation.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">html_theme_options = &#123;</span><br><span class="line">    <span class="comment"># 'show_powered_by': False,</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any paths that contain custom static files (such as style sheets) here,</span></span><br><span class="line"><span class="comment"># relative to this directory. They are copied after the builtin static files,</span></span><br><span class="line"><span class="comment"># so a file named "default.css" will overwrite the builtin "default.css".</span></span><br><span class="line">html_static_path = [<span class="string">'_static'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom sidebar templates, must be a dictionary that maps document names</span></span><br><span class="line"><span class="comment"># to template names.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The default sidebars (for documents that don't match any pattern) are</span></span><br><span class="line"><span class="comment"># defined by theme itself.  Builtin themes are using these templates by</span></span><br><span class="line"><span class="comment"># default: ``['localtoc.html', 'relations.html', 'sourcelink.html',</span></span><br><span class="line"><span class="comment"># 'searchbox.html']``.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">html_show_sourcelink = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for HTMLHelp output ---------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output file base name for HTML help builder.</span></span><br><span class="line">htmlhelp_basename = <span class="string">'NJUPT-APIdoc'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for LaTeX output ------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">latex_elements = &#123;</span><br><span class="line">    <span class="comment"># The paper size ('letterpaper' or 'a4paper').</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 'papersize': 'letterpaper',</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># The font size ('10pt', '11pt' or '12pt').</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 'pointsize': '10pt',</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Additional stuff for the LaTeX preamble.</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 'preamble': '',</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Latex figure (float) alignment</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 'figure_align': 'htbp',</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Grouping the document tree into LaTeX files. List of tuples</span></span><br><span class="line"><span class="comment"># (source start file, target name, title,</span></span><br><span class="line"><span class="comment">#  author, documentclass [howto, manual, or own class]).</span></span><br><span class="line">latex_documents = [</span><br><span class="line">    (master_doc, <span class="string">'NJUPT-API.tex'</span>, <span class="string">'NJUPT-API Documentation'</span>,</span><br><span class="line">     <span class="string">'gaoliang'</span>, <span class="string">'manual'</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for manual page output ------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># One entry per manual page. List of tuples</span></span><br><span class="line"><span class="comment"># (source start file, name, description, authors, manual section).</span></span><br><span class="line">man_pages = [</span><br><span class="line">    (master_doc, <span class="string">'njupt-api'</span>, <span class="string">'NJUPT-API Documentation'</span>,</span><br><span class="line">     [author], <span class="number">1</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Options for Texinfo output ----------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Grouping the document tree into Texinfo files. List of tuples</span></span><br><span class="line"><span class="comment"># (source start file, target name, title, author,</span></span><br><span class="line"><span class="comment">#  dir menu entry, description, category)</span></span><br><span class="line">texinfo_documents = [</span><br><span class="line">    (master_doc, <span class="string">'NJUPT-API'</span>, <span class="string">'NJUPT-API Documentation'</span>,</span><br><span class="line">     author, <span class="string">'NJUPT-API'</span>, <span class="string">'One line description of project.'</span>,</span><br><span class="line">     <span class="string">'Miscellaneous'</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -- Extension configuration -------------------------------------------------</span></span><br></pre></td></tr></table></figure><p><img src="/2019/08/30/2019-6月编程笔记/2019-6%E6%9C%88%E7%BC%96%E7%A8%8B%E7%AC%94%E8%AE%B0%5Csphinx_rtd_theme%E9%A3%8E%E6%A0%BC.png" alt="sphinx_rtd_theme风格"></p><p><a href="https://www.cnblogs.com/niejinmei/p/8918858.html" target="_blank" rel="noopener">python代码docstring生成文档之sphinx</a></p><h3 id="python-验证码识别"><a class="markdownIt-Anchor" href="#python-验证码识别"></a> Python 验证码识别</h3><p>通过pytesseract<a href="https://blog.csdn.net/weixin_42812527/article/details/81264189" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42812527/article/details/81264189</a></p><p>windows10安装使用pytesseract坑：<a href="https://blog.csdn.net/weixin_42812527/article/details/81908674" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42812527/article/details/81908674</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">captcha_url = <span class="string">'http://182.92.169.64:8088/808gps/rand.action'</span></span><br><span class="line">captcha_content = requests.get(url=captcha_url)</span><br><span class="line"><span class="comment"># 获得图片的二进制内容</span></span><br><span class="line">captcha_content = captcha_content.content</span><br><span class="line"><span class="comment"># 用BytesIO读取图片</span></span><br><span class="line">image = Image.open(BytesIO(captcha_content))</span><br><span class="line"><span class="comment"># 转化为灰度图</span></span><br><span class="line">imgry = image.convert(<span class="string">'L'</span>)</span><br><span class="line"><span class="comment"># 二值化处理</span></span><br><span class="line">table = [<span class="number">0</span> <span class="keyword">if</span> i &lt; <span class="number">140</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)]</span><br><span class="line"><span class="comment"># 使字体更加突出的显示</span></span><br><span class="line">out = imgry.point(table,<span class="string">'1'</span>)</span><br><span class="line"><span class="comment"># out.show()</span></span><br><span class="line">captcha = pytesseract.image_to_string(out)</span><br><span class="line">captcha = captcha.strip()</span><br><span class="line">captcha = captcha.upper()</span><br><span class="line"><span class="keyword">print</span> (captcha)</span><br></pre></td></tr></table></figure><h2 id="python异常"><a class="markdownIt-Anchor" href="#python异常"></a> Python异常</h2><blockquote><p>Python所有的错误都是从BaseException类派生的，常见的错误类型和继承关系</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit</span><br><span class="line"> +-- KeyboardInterrupt</span><br><span class="line"> +-- GeneratorExit</span><br><span class="line"> +-- Exception</span><br><span class="line">      +-- StopIteration</span><br><span class="line">      +-- StandardError</span><br><span class="line">      |    +-- BufferError</span><br><span class="line">      |    +-- ArithmeticError</span><br><span class="line">      |    |    +-- FloatingPointError</span><br><span class="line">      |    |    +-- OverflowError</span><br><span class="line">      |    |    +-- ZeroDivisionError</span><br><span class="line">      |    +-- AssertionError</span><br><span class="line">      |    +-- AttributeError</span><br><span class="line">      |    +-- EnvironmentError</span><br><span class="line">      |    |    +-- IOError</span><br><span class="line">      |    |    +-- OSError</span><br><span class="line">      |    |         +-- WindowsError (Windows)</span><br><span class="line">      |    |         +-- VMSError (VMS)</span><br><span class="line">      |    +-- EOFError</span><br><span class="line">      |    +-- ImportError</span><br><span class="line">      |    +-- LookupError</span><br><span class="line">      |    |    +-- IndexError</span><br><span class="line">      |    |    +-- KeyError</span><br><span class="line">      |    +-- MemoryError</span><br><span class="line">      |    +-- NameError</span><br><span class="line">      |    |    +-- UnboundLocalError</span><br><span class="line">      |    +-- ReferenceError</span><br><span class="line">      |    +-- RuntimeError</span><br><span class="line">      |    |    +-- NotImplementedError</span><br><span class="line">      |    +-- SyntaxError</span><br><span class="line">      |    |    +-- IndentationError</span><br><span class="line">      |    |         +-- TabError</span><br><span class="line">      |    +-- SystemError</span><br><span class="line">      |    +-- TypeError</span><br><span class="line">      |    +-- ValueError</span><br><span class="line">      |         +-- UnicodeError</span><br><span class="line">      |              +-- UnicodeDecodeError</span><br><span class="line">      |              +-- UnicodeEncodeError</span><br><span class="line">      |              +-- UnicodeTranslateError</span><br><span class="line">      +-- Warning</span><br><span class="line">           +-- DeprecationWarning</span><br><span class="line">           +-- PendingDeprecationWarning</span><br><span class="line">           +-- RuntimeWarning</span><br><span class="line">           +-- SyntaxWarning</span><br><span class="line">           +-- UserWarning</span><br><span class="line">           +-- FutureWarning</span><br><span class="line">   +-- ImportWarning</span><br><span class="line">   +-- UnicodeWarning</span><br><span class="line">   +-- BytesWarning</span><br></pre></td></tr></table></figure><h3 id="java异常"><a class="markdownIt-Anchor" href="#java异常"></a> java异常</h3><p><img src="https://camo.githubusercontent.com/27aa104d93ba0738be0f3d2e7d5b096c1619d12d/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392d322f457863657074696f6e2e706e67" alt=""></p><h2 id="继承-super"><a class="markdownIt-Anchor" href="#继承-super"></a> 继承、Super</h2><blockquote><p><code>super()</code> 函数是用于调用父类(超类)的一个方法，<em>只有在新式类中可以使用</em></p><p>super 是用来解决多重继承问题的，直接用类名调用父类方法在使用单继承的时候没问题，但是如果使用多继承，会涉及到查找顺序（MRO，Method Resolution Order，采用广度优先（区别于深度优先）的规则定义）、重复调用（钻石继承）等种种问题。</p><p>MRO 就是类的方法解析顺序表, 其实也就是继承父类方法时的顺序表。</p></blockquote><p><strong>语法</strong></p><p>以下是 super() 方法的语法:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 菜鸟教程</span></span><br><span class="line">super(type [, object-<span class="keyword">or</span>-type])</span><br><span class="line"><span class="comment"># 个人理解</span></span><br><span class="line">super( ThisClass [, object(self)])</span><br></pre></td></tr></table></figure><p><strong>参数</strong></p><ul><li>type – 类（type），通常是当前子类。</li><li>object-or-type – 类实例，一般是 self</li></ul><p><strong>含义</strong></p><p>用<code>self</code>这个实例对象去查找<code>ThisClass</code>类的父类拥有的属性（成员方法、数据成员）</p><p>▲. Python3.x 和 Python2.x 的一个区别是: Python 3 可以使用直接使用 <strong>super().xxx</strong> 代替 <strong>super(Class, self).xxx</strong> :</p><p>即平时写的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, *arg, **kwarg)</span>:</span></span><br><span class="line">        super(TestClass, self).__init__() <span class="comment"># 此时init里不用self</span></span><br><span class="line">        <span class="comment"># 等价于 super().__init__() , 含义是用父类的构造函数初始化某些变量</span></span><br><span class="line">        <span class="comment"># 相当于旧式类的 object.__init__(self) # 需要传参self</span></span><br><span class="line">        self.arg = arg</span><br><span class="line">        self.kwarg = kwarg</span><br></pre></td></tr></table></figure><p>完整代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">clsSuper</span><span class="params">(object)</span>:</span></span><br><span class="line">    age = <span class="number">18</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        print(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">clsSub</span><span class="params">(clsSuper)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(super().age)</span><br><span class="line">        <span class="comment"># 当只是单继承的时候可以直接使用 print(clsSuper.age)，</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    a = clsSuper(<span class="string">'cl'</span>)</span><br><span class="line">    b = clsSub()</span><br></pre></td></tr></table></figure><h3 id="特点"><a class="markdownIt-Anchor" href="#特点"></a> 特点</h3><ul><li><code>super().func()</code>是不用传参<code>self</code>的</li><li><code>super(type, obj).func()</code>函数调用的是obj实例在MRO中下一个父类的可调用func()，而不是type的父类中的func()。即调用最近的可用func()</li><li>使用<code>super()</code>不用指定父类的名称，便于修改维护；同时当继承多个类A、B的时候，用<code>super().__init__()</code>相当于调用多个类的<code>A.__ini__(self)</code>、<code>B.__ini__(self)</code></li></ul><h2 id="与java对比"><a class="markdownIt-Anchor" href="#与java对比"></a> 与java对比</h2><ol><li>Python中子类不会默认调用父类的构造函数，即下面代码。并不会要要求给传<code>name</code>。当然也可以理解为跟java一样调用了一个全空、没有任何内容的构造函数，但是在python中不需要显性写出来，原因部分是特点2（java中存在有参数的构造函数时，必须将空参数的构造函数显式写出，不然子类默认隐式调用空参数的构造函数时会报错说不存在）。</li><li>Python中的构造函数只有一个。但由于存在<code>*arg,**kwarg</code>的存在，所以只要执行类型检查执行不同的代码；即实现了多个构造函数</li><li>Python的类可以多继承，java只能单继承。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">clsSuper</span><span class="params">(object)</span>:</span></span><br><span class="line">    age = <span class="number">18</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        print(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">clsSub</span><span class="params">(clsSuper)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, age)</span>:</span></span><br><span class="line">        print(age)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    b = clsSub(<span class="number">18</span>)</span><br></pre></td></tr></table></figure><h2 id="cmder-windows-下的终端神器"><a class="markdownIt-Anchor" href="#cmder-windows-下的终端神器"></a> <a href="https://www.cnblogs.com/onlymisaky/p/8534626.html" target="_blank" rel="noopener">Cmder Windows 下的终端神器</a></h2><h2 id="视频字幕制作"><a class="markdownIt-Anchor" href="#视频字幕制作"></a> 视频字幕制作</h2><p>arctime国人自制的免费软件。自动打轴和语音识别功能积分使用注册绑定任务、签到白嫖能鸽很久。</p><p>制作完成后保存工程文件，ass，软件-&gt;导出，可以导出一份srt字母文件，可以直接上传到B站当CC字幕使用</p><p>Pr自带工具一句一句打===&gt;ps批量制作字幕图层===&gt;arctime</p><h2 id="mitmproxy手机抓包软件"><a class="markdownIt-Anchor" href="#mitmproxy手机抓包软件"></a> mitmProxy手机抓包软件</h2><h3 id="q为什么好多加密算法都要用到异或"><a class="markdownIt-Anchor" href="#q为什么好多加密算法都要用到异或"></a> Q:为什么好多加密算法都要用到异或？</h3><p>A:位操作 cpu运行非常快</p><blockquote><p>加密的源是形形色色的，其加密结果也要求是尽量差异化。在二元的位运算符中，也就只有&quot;位与&quot;、“位或”、&quot;异或&quot;三种。一个加密过程往往需要经过若干次运算，若采用&quot;位与&quot;运算，竟多次计算的话，其结果值将趋向于比特位全部是0；同样，采用&quot;位或&quot;的话，其结果值将趋向于比特位全部是1。剩下的只有采用&quot;异或&quot;运算了</p></blockquote><h2 id="测试注解的正确性"><a class="markdownIt-Anchor" href="#测试注解的正确性"></a> 测试注解的正确性</h2><p>注解仅仅起到了注释的作用，不会影响代码的执行，所以即使你类型注解写错了，程序运行的时候还是会按照正确的类型去运行。<br>Python提供了一个工具方便我们测试代码里的类型注解正确性<code>mypy</code></p><p>首先安装：<code>pip install mypy</code></p><p>使用测试：<code>mypy filename.py</code></p><p>Python3.7新特性<code>dataclass</code></p><p>写法对比</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""docstring for student"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        super(student, self).__init__()</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""docstring for ClassName"""</span></span><br><span class="line">    name: str</span><br><span class="line">    age: int</span><br></pre></td></tr></table></figure><p>功能对比</p><ul><li><p>传统的class写法的__eq__并不认为两个实例相同，即<strong>存储数据</strong>不同</p><ul><li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""docstring for student"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        super(student, self).__init__()</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">s1 = student(<span class="string">'cl'</span>, <span class="number">18</span>)</span><br><span class="line">s2 = student(<span class="string">'cl'</span>, <span class="number">18</span>)</span><br><span class="line">print(s1 == s2)</span><br><span class="line"><span class="comment"># &gt;&gt;&gt; False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据的角度来讲，这两个实例代表的是同一个Student，理应相等。所以我们可以重写内置的__eq__方法如下</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""docstring for student"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        super(student, self).__init__()</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.__class__ <span class="keyword">is</span> <span class="keyword">not</span> other.__class__:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> (self.name, self.age) == (other.name, other.age)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = student(<span class="string">'cl'</span>, <span class="number">18</span>)</span><br><span class="line">s2 = student(<span class="string">'cl'</span>, <span class="number">18</span>)</span><br><span class="line">print(s1 == s2)</span><br><span class="line"><span class="comment"># &gt;&gt;&gt; True</span></span><br></pre></td></tr></table></figure></li><li></li></ul></li></ul><blockquote><p>注意:</p><p>name和age并不是Class Attribute，也就是不能通过NewStudent.name和NewStudent.age直接访问，大家可以通过dir(NewStudent)验证一下。</p><p>name和age后面的类型指定并没有实际的效果，也就是如果我们实例化传入错误的数据类型，不会报错，比如 s3 = NewStudent(‘Mark’, ‘20’)</p></blockquote><p>更多功能</p><p>通过使用装饰器的选项，可以为用例进一步定制 data class，默认选项是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@dataclass(init=True, repr=True, eq=True, order=False, unsafe_hash=False, frozen=False)</span></span><br></pre></td></tr></table></figure><ul><li><code>init</code>决定是否生成<code>__init__</code> dunder 方法</li><li><code>repr</code>决定是否生成<code>__repr__</code> dunder方法</li><li><code>eq</code>对<code>__eq__</code> dunder 方法也是如此，它决定相等性检查的行为（your_class_instance == another_instance）</li><li><code>order</code> 实际上创建了四种 dunder 方法，它们确定所有检查<code>小于</code>，<code>and/or</code>，<code>大于</code>的行为，如果将其设置为 true，则可以对对象列表进行排序。</li></ul><p>最后两个选项确定对象是否可以被哈希化，如果你想使用你的 class 的对象作为字典键的话，这是必要的。</p><p>链接：<a href="https://www.jianshu.com/p/bea5c202cf85" target="_blank" rel="noopener">https://www.jianshu.com/p/bea5c202cf85</a></p><h2 id="协程"><a class="markdownIt-Anchor" href="#协程"></a> 协程</h2><p>不是进程，也不是线程，是用户空间调度的完成并发处理的方式。是在用户空间内部完成的。线程和进程是操作系统内完成的。</p><h2 id="github感谢贡献者"><a class="markdownIt-Anchor" href="#github感谢贡献者"></a> Github感谢贡献者</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/spencerwooo/dowww/graphs/contributors"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://opencollective.com/dowww/contributors.svg?button=false"</span> /&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="java"><a class="markdownIt-Anchor" href="#java"></a> java</h1><h2 id="equals-和"><a class="markdownIt-Anchor" href="#equals-和"></a> equals 和 ==</h2><p><strong>==</strong> : 它的作用是判断两个对象的地址是不是相等。即，判断两个对象是不是同一个对象(基本数据类型==比较的是值，引用数据类型==比较的是内存地址)。</p><p><strong>equals()</strong> : 它的作用也是判断<strong>两个对象是否相等</strong>。但它一般有两种使用情况：</p><ul><li>情况1：类没有覆盖 equals() 方法。<ul><li>即通过 equals() 比较该类的两个对象时，等价于通过“==”比较这两个对象。</li></ul></li><li>情况2：类覆盖了 equals() 方法。<ul><li><u>一般，我们都覆盖 equals() 方法来比较两个对象的内容是否相等</u>；若它们的内容相等，则返回 true (即，认为这两个对象相等)。</li></ul></li></ul><p><strong>说明：</strong></p><ul><li>String 中的 equals 方法是被重写过的，<strong>因为 object 的 equals 方法是比较的对象的内存地址(即<code>==</code>)</strong>，而 String 的 equals 方法比较的是对象的值。</li><li>当创建 String 类型的对象时，虚拟机会在常量池中查找有没有已经存在的值和要创建的值相同的对象，如果有就把它赋给当前引用。如果没有就在常量池中重新创建一个 String 对象。</li></ul><h3 id="hashcode介绍"><a class="markdownIt-Anchor" href="#hashcode介绍"></a> hashCode（）介绍</h3><p>hashCode() 的作用是获取哈希码，也称为散列码；它实际上是返回一个int整数。这个哈希码的作用是确定该对象在哈希表中的索引位置。hashCode() 定义在JDK的Object.java中，这就意味着Java中的任何类都包含有hashCode() 函数。</p><p>散列表存储的是键值对(key-value)，它的特点是：能根据“键”快速的检索出对应的“值”。这其中就利用到了散列码！（可以快速找到所需要的对象）</p><h3 id="为什么要有-hashcode"><a class="markdownIt-Anchor" href="#为什么要有-hashcode"></a> 为什么要有 hashCode</h3><p><strong>我们先以“HashSet 如何检查重复”为例子来说明为什么要有 hashCode：</strong> 当你把对象加入 HashSet 时，HashSet 会先计算对象的 hashcode 值来判断对象加入的位置，同时也会与其他已经加入的对象的 hashcode 值作比较，如果没有相符的hashcode，HashSet会假设对象没有重复出现。但是如果发现有相同 hashcode 值的对象，这时会调用 <code>equals（）</code>方法来检查 hashcode 相等的对象是否真的相同。如果两者相同，HashSet 就不会让其加入操作成功。如果不同的话，就会重新散列到其他位置。（摘自我的Java启蒙书《Head first java》第二版）。这样我们就大大减少了 equals 的次数，相应就大大提高了执行速度。</p><p>通过我们可以看出：<code>hashCode()</code> 的作用就是<strong>获取哈希码</strong>，也称为散列码；它实际上是返回一个int整数。这个<strong>哈希码的作用</strong>是确定该对象在哈希表中的索引位置。**<code>hashCode()</code>在散列表中才有用，在其它情况下没用。**在散列表中hashCode() 的作用是获取对象的散列码，进而确定该对象在散列表中的位置。</p><h3 id="hashcode与equals的相关规定"><a class="markdownIt-Anchor" href="#hashcode与equals的相关规定"></a> hashCode（）与equals（）的相关规定</h3><ol><li>如果两个对象相等，则hashcode一定也是相同的</li><li>两个对象相等,对两个对象分别调用equals方法都返回true</li><li>两个对象有相同的hashcode值，它们也不一定是相等的</li><li><strong>因此，equals 方法被覆盖过，则 hashCode 方法也必须被覆盖</strong></li><li>hashCode() 的默认行为是对堆上的对象产生独特值。如果没有重写 hashCode()，则该 class 的两个对象无论如何都不会相等（即使这两个对象指向相同的数据）==&gt;通过统一哈希值，使两个对象equals时结果返回哈希值一致便输出true</li></ol><h2 id="static静态代码块与非静态代码块-构造方法"><a class="markdownIt-Anchor" href="#static静态代码块与非静态代码块-构造方法"></a> static{}静态代码块与{}非静态代码块、构造方法</h2><blockquote><p>类的执行顺序: static{}静态代码块–&gt;{}静态代码块–&gt;构造方法</p></blockquote><p>static{}静态代码块与{}非静态代码块不同点：</p><ul><li>静态代码块只在第一次new执行一次，之后不再执行<ul><li>一般情况下,如果有些代码比如一些项目最常用的变量或对象必须在项目启动的时候就执行的时候,需要使用静态代码块,这种代码是<strong>主动执行</strong>的。</li></ul></li><li>而非静态代码块在每new一次就执行一次。 非静态代码块可在普通方法中定义(不过作用不大)；而静态代码块不行。<ul><li>如果我们想要设计不需要创建对象就可以调用类中的方法，例如：Arrays类，Character类，String类等，就需要使用静态方法</li></ul></li></ul><p>两者的区别是 静态代码块是<strong>自动执行</strong>的而静态方法是<strong>被调用才执行</strong>的.</p><p>非静态代码块与构造函数的区别是：</p><ul><li><strong>非静态代码块</strong>是给<u>所有对象进行统一初始化</u>，而<strong>构造函数是</strong>给<u>对应的对象初始化</u>因为构造函数是可以多个的，运行哪个构造函数就会建立什么样的对象，但无论建立哪个对象，都会先执行相同的构造代码块。也就是说，构造代码块中定义的是不同对象共性的初始化内容。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> classtest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">testClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">testClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">"默认构造方法！--"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//非静态代码块</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.print(<span class="string">"非静态代码块！--"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// 静态代码块,指挥执行一次</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">"静态代码块！--"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">"静态方法中的内容! --"</span>);</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.print(<span class="string">"静态方法中的代码块！--"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    testClass test = <span class="keyword">new</span> testClass();   </span><br><span class="line">       testClass.test();<span class="comment">//静态代码块！--非静态代码块！--默认构造方法！--静态方法中的内容! --静态方法中的代码块！--</span></span><br><span class="line">    System.out.println();</span><br><span class="line">    testClass test2 = <span class="keyword">new</span> testClass();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">静态代码块！--非静态代码块！--默认构造方法！--静态方法中的内容! --静态方法中的代码块！--</span></span><br><span class="line"><span class="comment">非静态代码块！--默认构造方法！--</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/wzlsunice88/article/details/80743160" target="_blank" rel="noopener">Ansible 运维自动化 ( 配置管理工具 )</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;2019_6月编程笔记&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#2019_6月编程笔记&quot;&gt;&lt;/a&gt; 2019_6月编程笔记&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;注，不少内容比较多，已单独分出去成为独立的文章，更详细的介绍可见
      
    
    </summary>
    
    
      <category term="笔记" scheme="https://nymrli.top/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Python爬虫常规流程</title>
    <link href="https://nymrli.top/2019/08/30/Python%E7%88%AC%E8%99%AB%E5%B8%B8%E8%A7%84%E6%B5%81%E7%A8%8B/"/>
    <id>https://nymrli.top/2019/08/30/Python爬虫常规流程/</id>
    <published>2019-08-30T13:07:05.000Z</published>
    <updated>2019-08-30T13:23:18.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="python爬虫常规流程"><a class="markdownIt-Anchor" href="#python爬虫常规流程"></a> Python爬虫常规流程</h1><p>以爬取<strong>有道翻译</strong>为例子。</p><h2 id="挖取可自用的api"><a class="markdownIt-Anchor" href="#挖取可自用的api"></a> 挖取可自用的API</h2><blockquote><p>web 端的有道翻译，在之前是直接可以爬的。也就是说只要获取到了他的接口，你就可以肆无忌惮的使用他的接口进行翻译而不需要支付任何费用。那么自从有道翻译推出他的API服务的时候，就对这个接口做一个反爬虫机制（如果大家都能免费使用到他的翻译接口，那他的APl服务怎么赚钱）。这个反爬虫机制在爬虫领域算是一个非常经典的技术手段。</p></blockquote><p>1.查看要爬取的内容是否是静态加载的。</p><p>比如在翻译输入框中输入<code>apple</code>，翻译输出框中会出现<code>苹果</code>，然后在``页面中右键-&gt;查看网页源代码<code>，直接</code>Ctrl+F<code>搜索是否存在</code>apple<code>或者</code>苹果`，如果没有的话，证明不是静态加载的。</p><p>2.查看内容如何加载的</p><ul><li>页面初始化get、post请求</li><li>局部刷新发送ajax请求<ul><li>如果存在局部更新内容产生变化的（Url没有发生变化，或者没有页面发生跳转、刷新的感觉），一般都是采用的AJAX更新技术，发送了POST、GET请求获得局部需要更新的数据，可以直接在Network项的XHR里面找到动态加载的文件 (可以看下Ajax技术实现了解下为什么可以在XHR中找到)</li></ul></li></ul><blockquote><p>这边的话，可以看到输入一个要翻译的内容后，页面没有产生多大的变化，因此猜想是AJAX加载的。在XHR里也找到了相应的Response文件。</p></blockquote><p>使用Chrome自带的抓包工具（<code>页面中右键-&gt;检查</code>或者按<code>F12</code>都可以打开，然后选择<code>-&gt;Network项</code>（网络监听窗口）就可以看到抓包的数据了）</p><p>然后同样在翻译输入框中输入<code>apple</code>，然后可以观察到抓包工具中出现了很多内容。为了确定<code>apple</code>的翻译<code>苹果</code>是在哪个文件中返回的，可以直接<code>Ctrl+F</code>打开搜索框后直接搜索，如图所示。</p><p><img src="/2019/08/30/Python爬虫常规流程/Python%E7%88%AC%E8%99%AB%E5%B8%B8%E8%A7%84%E6%B5%81%E7%A8%8B%5Cchrome%E6%8A%93%E5%8C%85.png" alt="chrome抓包"></p><h2 id="js加密破解"><a class="markdownIt-Anchor" href="#js加密破解"></a> JS加密破解</h2><h3 id="1使用python进行模仿js加密计算"><a class="markdownIt-Anchor" href="#1使用python进行模仿js加密计算"></a> 1.使用Python进行模仿JS加密计算</h3><h3 id="2运行js代码获得加密结果"><a class="markdownIt-Anchor" href="#2运行js代码获得加密结果"></a> 2.运行JS代码获得加密结果</h3><ul><li>使用python-js2py模块</li></ul><p>如一个参数生成的结果是这样的<code>{&quot;LoginKey&quot;:&quot;46fd82c2-3108-b2a4-3056-0eaa426f975b&quot;,&quot;data&quot;:&quot;{\&quot;User_Oid\&quot;:\&quot;账号\&quot;,\&quot;User_Password\&quot;:\&quot;密码\&quot;}&quot;}</code></p><p>找到生成<code>LoginKey</code>值的JS文件加密算法是这样的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">s4</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.floor((<span class="number">1</span> + <span class="built_in">Math</span>.random()) * <span class="number">0x10000</span>).toString(<span class="number">16</span>).substring(<span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">guid</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> s4() + s4() + <span class="string">'-'</span> + s4() + <span class="string">'-'</span> + s4() + <span class="string">'-'</span> + s4() + <span class="string">'-'</span> + s4() + s4() + s4();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后安装<code>pip install js2py</code>后</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> js2py</span><br><span class="line">LoginKey = js2py.eval_js(<span class="string">'''</span></span><br><span class="line"><span class="string">function s4() &#123;</span></span><br><span class="line"><span class="string">return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">function guid() &#123;</span></span><br><span class="line"><span class="string">return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">var a = guid()  // 在这里是需要调用的</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line"><span class="keyword">print</span> LoginKey</span><br></pre></td></tr></table></figure><p>就能获得结果了。</p><ul><li>使用pyexe、PyV8、js2py模块</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_des_psswd</span><span class="params">(data, key)</span>:</span></span><br><span class="line">    jsstr = get_js()</span><br><span class="line">    ctx = execjs.compile(jsstr) <span class="comment">#加载JS文件</span></span><br><span class="line">    <span class="keyword">return</span> (ctx.call(<span class="string">'strEnc'</span>, data, key))  <span class="comment">#调用js方法  第一个参数是JS的方法名，后面的data和key是js方法的参数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_js</span><span class="params">()</span>:</span></span><br><span class="line">    f = open(<span class="string">"./../lib/des.js"</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="comment"># 打开JS文件</span></span><br><span class="line">    line = f.readline()</span><br><span class="line">    htmlstr = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> line:</span><br><span class="line">        htmlstr = htmlstr+line</span><br><span class="line">        line = f.readline()</span><br><span class="line">    <span class="keyword">return</span> htmlstr</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(get_des_psswd(<span class="string">'123456'</span>, <span class="string">'RUY2OTdCRUFFRTg0OUQ0Q0E0ODNDRDMxN0YzOEEzREQudG9tY2F0OTQ='</span>))</span><br></pre></td></tr></table></figure><p>js2py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> js2py</span><br><span class="line">context = js2py.EvalJs()</span><br><span class="line"><span class="comment">#     - 拷贝使用到js文件的内容到本项目中</span></span><br><span class="line"><span class="comment">#     - 读取js文件的内容,使用context来执行它们</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"BigInt.js"</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    context.execute(f.read())</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"RSA.js"</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    context.execute(f.read())</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"Barrett.js"</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    context.execute(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 向context环境中添加需要数据</span></span><br><span class="line">context.t = &#123;<span class="string">'password'</span>: password&#125;</span><br><span class="line">context.n = n</span><br><span class="line"><span class="comment">#     - 执行加密密码的js字符</span></span><br><span class="line">js = <span class="string">'''</span></span><br><span class="line"><span class="string">       t.password = t.password.split("").reverse().join(""),</span></span><br><span class="line"><span class="string">       setMaxDigits(130);</span></span><br><span class="line"><span class="string">       var o = new RSAKeyPair(n.e,"",n.n)</span></span><br><span class="line"><span class="string">        , r = encryptedString(o, t.password);</span></span><br><span class="line"><span class="string">      '''</span></span><br><span class="line">context.execute(js)</span><br><span class="line"><span class="comment"># - 通过context获取加密后密码信息</span></span><br><span class="line"><span class="comment"># print(context.r)</span></span><br><span class="line">password = context.r</span><br><span class="line"><span class="comment">#   - 使用session发送登录请求</span></span><br><span class="line"><span class="comment">#     - URL: http://activity.renren.com/livecell/ajax/clog</span></span><br><span class="line"><span class="comment">#     - 请求方法: POST</span></span><br><span class="line"><span class="comment">#     - 数据:</span></span><br><span class="line"><span class="comment">#       - phoneNum: 15565280933</span></span><br><span class="line"><span class="comment">#       - password: (加密后生产的)</span></span><br><span class="line"><span class="comment">#       - c1: 0</span></span><br><span class="line"><span class="comment">#       - rKey: rkey请求获取的</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'phoneNum'</span>: <span class="string">'131....'</span>,</span><br><span class="line">    <span class="string">'password'</span>: password,</span><br><span class="line">    <span class="string">'c1'</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="string">'rKey'</span>:n[<span class="string">'rkey'</span>]</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># print(session.headers)</span></span><br><span class="line">response = session.post(<span class="string">"http://activity.renren.com/livecell/ajax/clog"</span>, data=data)</span><br><span class="line">print(response.content.decode())</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 访问登录的资源</span></span><br><span class="line">response = session.get(<span class="string">"http://activity.renren.com/home#profile"</span>)</span><br><span class="line">print(response.content.decode())</span><br><span class="line"><span class="comment"># https://blog.csdn.net/guodejie/article/details/81436556</span></span><br></pre></td></tr></table></figure><p>逐步确定JS对密码的加密逻辑 ==&gt; 定位到加密函数</p><p>两种思路</p><ul><li><p>全局搜索password字段</p></li><li><p>全局搜加密算法的名字</p><blockquote><p>加密一般都是JS加密，加密算法一般比较出名的就那么几个，比如<code>MD5，base64,aes（对称密码），rsa（非对称加密算法）</code>都是可以用来加密的，你可以全局搜这些加密算法的名字</p></blockquote></li></ul><p><a href="https://www.jianshu.com/p/055e1ddf7bb2" target="_blank" rel="noopener">https://www.jianshu.com/p/055e1ddf7bb2</a></p><h3 id="rsa加密"><a class="markdownIt-Anchor" href="#rsa加密"></a> rsa加密</h3><blockquote><p>对极大整数做<a href="https://baike.baidu.com/item/%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3/5827933" target="_blank" rel="noopener">因数分解</a>的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用RSA加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。<strong>今天只有短的RSA钥匙才可能被强力方式解破</strong>==&gt;为什么密码要大于6位。到目前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被解破的。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;python爬虫常规流程&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#python爬虫常规流程&quot;&gt;&lt;/a&gt; Python爬虫常规流程&lt;/h1&gt;
&lt;p&gt;以爬取&lt;strong&gt;有道翻译&lt;/strong&gt;为例子。&lt;/p&gt;
&lt;h2 id=&quot;挖
      
    
    </summary>
    
    
      <category term="爬虫" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Word2016配置使用MathType</title>
    <link href="https://nymrli.top/2019/08/30/Word2016%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8MathType/"/>
    <id>https://nymrli.top/2019/08/30/Word2016配置使用MathType/</id>
    <published>2019-08-30T12:58:53.000Z</published>
    <updated>2019-08-30T13:06:39.300Z</updated>
    
    <content type="html"><![CDATA[<h1 id="word-2016-使用mathtype"><a class="markdownIt-Anchor" href="#word-2016-使用mathtype"></a> Word 2016 使用MathType</h1><p>据说MathType 6.9b后就能与Word 2016兼容了，所以不用特地去找7.0以上的版本，据说更新的功能差别也不是很大。</p><h2 id="闲谈"><a class="markdownIt-Anchor" href="#闲谈"></a> 闲谈</h2><blockquote><p>这边的方法是我个人的操作过程，但是感觉应该不是这么搞得。</p></blockquote><p>安装好MathType后，打开word查看工具栏中是否有MathType工具，如果没有的话，则手动选择“插入-&gt;获得加载项-&gt;应用商店”搜索<strong>Mathtype</strong>。如果还是没有的话，然后在“选项-&gt;加载项-&gt;模板”然后指定MathType Commands 6 For Word2016.dotm的路径，之后是能在应用商城搜到Mathtype了，但是每次打开word都会弹出找不到<code>MathPage.wll</code>，而且最麻烦的是还删不掉这个路径，于是找了很多资料后，发现了“<strong>信任中心</strong>”，比较像能解决问题。只不过试了后还是不行，最后发现，自己拷贝的是64位的文件，找到了一个解决方案提醒到：<em><u>如果你复制的是64的<strong>MathPage.wll</strong>还出错换成32的就好了</u></em>。然后按照提示改了后就行了，同时需要注意的是根据路径显示需要将<strong>Mathtype</strong>安装目录中的和<code>MathPage.wll</code></p><hr><h2 id="安装过程"><a class="markdownIt-Anchor" href="#安装过程"></a> 安装过程</h2><blockquote><p>需要将安装好的mathtype目录下提取两个文件MathPage.wll和MathType Commands 6 For Word 2016.dotm复制到指定目录</p></blockquote><p>如果使用的Office是32位的话。在Mathtype安装后，安装路径（假设装在C盘的话）C:\Program Files (x86)\MathType\MathPage\32中有文件<strong>MathPage.wll</strong>；</p><p>安装路径C:\Program Files (x86)\MathType\Office Support\32中有文件 <strong>MathType Commands 6 For Word.dotm</strong>；将这两个文件复制到桌面。</p><p><strong>（当然，这里都是针对Windows 64位系统而言的，注windows10是64位操作系统。如果是Windows 32位系统，路径中就不会包含有（x86）了，请注意。）</strong></p><p>如果使用的Office是64位的话。在Mathtype安装后，安装路径（假设装在C盘的话）C:\Program Files (x86)\MathType\MathPage\64中有文件<strong>MathPage.wll</strong>；</p><p>安装路径C:\Program Files (x86)\MathType\Office Support\64中有文件 <strong>MathType Commands 6 For Word 2016.dotm</strong>；将这两个文件复制到桌面。</p><p>**如果不清楚自己的Office是32位还是64位，就按照32位的来，一般来说，向下兼容，实在不行就都试一试。▲.===&gt;我就是以为自己的是64位结果是32位被坑了很久都用不成。</p><p>或者像如下查看自己的word版本，打开word点击“账号”</p><p><img src="/2019/08/30/Word2016配置使用MathType/word%E7%89%88%E6%9C%AC.png" alt="word版本"></p><p>选择“关于word”</p><p><img src="/2019/08/30/Word2016配置使用MathType/Word2016%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8MathType%5Cbit.png" alt="bit"></p><p>对于自己安装Office 2016的用户，需要找到Office 2016的安装文件夹（假设装在C盘的话）C:\Program Files\Microsoft Office\Office16\STARTUP（<strong>对于****64位的Office用户</strong>）；或C:\Program Files (x86)\Microsoft Office\Office16\STARTUP（<strong>对于****32位的Office用户</strong>）。然后，直接将桌面上的那两个文件剪切放进去即可，重新启动Word后就会出现Mathtype插件栏。</p><p>对于Office预装的用户，想找到Office的安装路径就不那么容易了，这个时候就只能发挥一下Windows自身的搜索功能（安利Everythisng搜索）了，从前面提到的可以看出Mathtype安装文件中有两个文件需要手动移植到Office安装路劲下的一个STARTUP文件夹中，因此需要找到这个STARTUP文件夹。</p><p>在搜索框中输入STARTUP。</p><p>找到最后为**~Microsoft\Word\STARTUP**的文件夹子目录，可能会有多个。逐次添加桌面上的两个文件【如下图】到这些文件夹中，并重新启动Word进行查证。</p><p><strong>需要复制的文件</strong></p><p><img src="/2019/08/30/Word2016配置使用MathType/4.png" alt="4"></p><p><img src="/2019/08/30/Word2016配置使用MathType/3.png" alt="3"></p><p><strong>复制到的位置</strong></p><p>1.STARTUP目录，如果没有的话自己新建<code>C:\Users\10630\AppData\Local\Packages\Microsoft.LanguageExperiencePackzh-cn_8wekyb3d8bbwe\LocalCache\Roaming\Microsoft\Word\STARTUP</code></p><p><img src="/2019/08/30/Word2016配置使用MathType/mathpage.png" alt="mathpage"></p><p>2.这个路径我忘记了，但是搜索的时候发现自己复制了<code>C:\Users\10630\AppData\Roaming\Microsoft\AddIns</code></p><p><img src="/2019/08/30/Word2016配置使用MathType/2.png" alt="2"></p><p><strong>注意事项</strong>：如果在<strong>C:\Program Files\Microsoft Office\Office16\STARTUP中，含有MathType Commands 6 For Word.dot，那么就会出现无法粘贴的现象</strong>。（复制的话，word会关闭）</p><p>😄总算安好了把，配合Mathpix，感觉应该挺香的.</p><hr><h2 id="兼容模式问题"><a class="markdownIt-Anchor" href="#兼容模式问题"></a> 兼容模式问题</h2><blockquote><p>当拿到低版本打开后出现一些格式或者兼容性不对的提示，其实很简单，我们可以在保存时候，就可以设置为兼容性模式。</p></blockquote><h3 id="如何关闭兼容模式"><a class="markdownIt-Anchor" href="#如何关闭兼容模式"></a> 如何关闭&quot;兼容模式&quot;</h3><p>当自己使用的Word版本较高，打开doc的版本较低时(<code>.doc</code>)，就会进入**“兼容模式”**，这样能保证大致上的排版格式是正确的，但是图片、公式什么的信息很有可能就会丢失（公式变成了图片、图片显示不全），解决的方案是关闭兼容模式。</p><p>兼容模式，如图</p><p><img src="/2019/08/30/Word2016配置使用MathType/jr.png" alt="兼容模式"></p><h4 id="解决步骤1"><a class="markdownIt-Anchor" href="#解决步骤1"></a> 解决步骤1：</h4><p><img src="/2019/08/30/Word2016配置使用MathType/jr1.png" alt="1"></p><h4 id="解决步骤2"><a class="markdownIt-Anchor" href="#解决步骤2"></a> 解决步骤2：</h4><p><img src="/2019/08/30/Word2016配置使用MathType/jr2.png" alt="2"></p><h3 id="如何保存为兼容模式"><a class="markdownIt-Anchor" href="#如何保存为兼容模式"></a> 如何保存为&quot;<strong>兼容模式</strong>&quot;？</h3><p>实质上就是保存为<code>.doc</code>–&gt;<code>.docx</code>的变化</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;word-2016-使用mathtype&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#word-2016-使用mathtype&quot;&gt;&lt;/a&gt; Word 2016 使用MathType&lt;/h1&gt;
&lt;p&gt;据说MathType 6.9b后就能
      
    
    </summary>
    
    
      <category term="环境配置" scheme="https://nymrli.top/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    
      <category term="生活福利" scheme="https://nymrli.top/tags/%E7%94%9F%E6%B4%BB%E7%A6%8F%E5%88%A9/"/>
    
  </entry>
  
  <entry>
    <title>算法设计与分析C_概念点区分</title>
    <link href="https://nymrli.top/2019/08/22/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90C-%E6%A6%82%E5%BF%B5%E7%82%B9%E5%8C%BA%E5%88%86/"/>
    <id>https://nymrli.top/2019/08/22/算法设计与分析C-概念点区分/</id>
    <published>2019-08-22T12:39:29.000Z</published>
    <updated>2019-08-22T12:40:14.238Z</updated>
    
    <content type="html"><![CDATA[<h1 id="算法设计与分析c"><a class="markdownIt-Anchor" href="#算法设计与分析c"></a> 算法设计与分析C</h1><h2 id="算法5_分治法"><a class="markdownIt-Anchor" href="#算法5_分治法"></a> 算法5_分治法</h2><p>分治法——将一个复杂的问题分解成若干个规模较小、相互独立，但类型相同的子问题求解；然后再将各子问题的解组合成原始问题的一个完整答案，这样的问题求解策略就叫分治法。</p><p>分治法所能解决的问题一般具有以下几个特征：<br>该问题的规模缩小到一定的程度就可以容易地解决；<br>该问题可以分解为若干个规模较小的相同问题；<br>利用该问题分解出的子问题的解可以合并为该问题的解；<br>该问题所分解出的各个子问题是相互独立的，即子问题之间不包含公共的子问题。</p><p>反复应用分治手段，可以使子问题与原问题类型一致而其规模却不断缩小，最终使子问题缩小到很容易直接求出其解。这自然导致递归过程的产生。<br>由分治法产生的子问题往往是原问题的较小模式。<br>直接或间接地调用自身的算法称为：递归算法。用函数自身给出定义的函数称为：递归函数。<br>分治与递归像一对孪生兄弟，经常同时应用在算法设计之中，并由此产生许多高效算法。</p><h2 id="算法6_贪心法"><a class="markdownIt-Anchor" href="#算法6_贪心法"></a> 算法6_贪心法</h2><ul><li>可行解<br>——问题给定某些约束条件，满足约束条件的问题解，即称为可行解。</li><li>最优解<br>——问题给出目标函数衡量可行解的好坏，使目标函数取最大（或最小）值的可行解称为最优解。</li></ul><p><strong>1.最优子结构性质：</strong></p><p>一个问题的最优解包含其子问题的最优解，则称此问题具有最优子结构性质。<br>问题的最优子结构性质是该问题可用动态规划算法或贪心算法求解的关键特征。</p><p>2.<strong>贪心选择性质</strong></p><p>所谓贪心选择性质是指所求问题的整体最优解可以通过一系列局部最优的选择，即贪心选择来达到。<br>这是贪心算法可行的第一个基本要素，也是贪心算法与动态规划算法的主要区别。</p><h2 id="算法7_动态规划法"><a class="markdownIt-Anchor" href="#算法7_动态规划法"></a> 算法7_动态规划法</h2><p>（1）<strong>子问题重叠性质</strong><br>（递归算法求解问题时）每次产生的子问题并不总是新问题，有些子问题被反复计算多次，这种性质称为子问题重叠性质。</p><p>动态规划算法对每一个子问题只解一次，而后将其解保存在一个表格（通常用二维数组）中，当再次需要解此子问题时，只是简单地用常数时间查看一下结果。<br>通常不同的子问题个数随问题的大小呈多项式增长。因此用动态规划算法只需要多项式级时间，从而获得较高的解题效率。</p><p>（2）<strong>最优子结构性质</strong>——用动态规划法求解的前提。<br>当一个问题的最优解包含了其子问题的最优解时，称该问题具有最优子结构性质。</p><p>一个问题的活动过程可以分为若干个阶段，每个阶段可包含一个或多个状态，从初始阶段的初始状态出发做出每个阶段的决策，形成一个决策序列。<br>利用问题的最优子结构性质，以自底向上的方式递归地从子问题的最优解逐步构造出整个问题的最优解。</p><h3 id="用动态规划算法求解问题的步骤"><a class="markdownIt-Anchor" href="#用动态规划算法求解问题的步骤"></a> 用动态规划算法求解问题的步骤：</h3><blockquote><p>1、找出最优解的性质，并刻划其结构特征；</p><p>2、递归地定义最优解值；</p><p>3、自底向上求最优解值；</p><p>4、根据计算最优解值时得到的信息构造一个最优解（此步只在要求得到最优解时才需要做） 。</p></blockquote><p>动态规划法是一种求解最优化问题的重要算法策略。</p><p>利用最优子结构性质及所获得的递推关系式（较小子问题最优解与较大子问题最优解之间存在的数值关系）去求取最优解，可以使计算量较之穷举法急剧减少。</p><blockquote><p>共同点：<br>将待求解的问题分解成若干子问题，先求解子问题，然后再从这些子问题的解得到原问题的解。<br>不同点：<br>1、适合于用动态规划法求解的问题，分解得到的各子问题往往不是相互独立的；而分治法中子问题相互独立。</p><p>2、动态规划法用表保存已求解过的子问题的解，再次碰到同样的子问题时不必重新求解，而只需查询答案，故可获得多项式级时间复杂度，效率较高；而分治法中对于每次出现的子问题均求解，导致同样的子问题被反复求解，故产生指数增长的时间复杂度，效率较低。</p></blockquote><h3 id="备忘录方法与动态规划法比较"><a class="markdownIt-Anchor" href="#备忘录方法与动态规划法比较"></a> 备忘录方法与动态规划法比较</h3><blockquote><p>1、与动态规划法的共同点：用一个表格来保存已求解的子问题的答案，使下次需要解此子问题时，只简单地查看答案，不重新计算。</p><p>2、与动态规划法的区别：备忘录的递归方式是自顶向下，而动态规划法的递归方式是自底向上。</p></blockquote><h3 id="如何选择使用动态规划法或备忘录法"><a class="markdownIt-Anchor" href="#如何选择使用动态规划法或备忘录法"></a> <strong>如何选择使用动态规划法或备忘录法？</strong></h3><blockquote><p>★当一个问题的所有子问题都至少要解一次时，选用动态规划法较好，此时没有任何多余的计算，还可利用规则的表格存取方式，减少时间和空间需求。</p><p>★当一个问题只有部分子问题需要求解时，选用备忘录法较好，它只解那些确实需要求解的子问题。</p></blockquote><h3 id="备忘录方法与递归方法比较"><a class="markdownIt-Anchor" href="#备忘录方法与递归方法比较"></a> 备忘录方法与递归方法比较</h3><blockquote><p>1、与递归方法的共同点：递归方式均为自顶向下</p><p>2、与递归方法的区别：备忘录方法用一个表格来保存已求解的子问题的答案，使下次需要解此子问题时，只简单地查看答案，不重新计算；而递归方法在每次遇到子问题都要重新计算。</p></blockquote><blockquote><p><strong>共同点：</strong><br>都是求解最优化问题；都具有最优子结构性质。<br><strong>不同点：</strong><br>1、求解方式不同：<br>动态规划法：自底向上；<br>贪心法：自顶向下。以迭代的方式作出相继的贪心选择，每作一次贪心选择就将所求问题简化为一个规模更小的子问题。</p><p>2、对子问题的依赖不同：<br>动态规划法：依赖于各子问题的解。只有在解出相关子问题后,才能作出选择；应使各子问题最优，才能保证整体最优；<br>贪心法：不依赖于子问题的解。仅在当前状态下作出最好选择，即局部最优选择。</p></blockquote><h2 id="算法8_回溯法"><a class="markdownIt-Anchor" href="#算法8_回溯法"></a> 算法8_回溯法</h2><p>回溯法是比贪心法和动态规划法更一般的方法。<br>解为n-元组(x0,x1,…,xn-1)形式。<br>通过搜索状态空间树来求问题的可行解（满足约束条件）或最优解（使目标函数取最大或最小值）。<br>使用约束函数和限界函数来压缩需要实际生成的状态空间树的结点数。<br>通常情况下，回溯法是为了找出满足约束条件的所有可行解。</p><ul><li>显式约束：规定每个xi取值的约束条件。<br>（显式约束规定了问题的候选解集——解空间）</li><li>隐式约束：给出了判定一个候选解是否为可行解的条件。为满足问题的解而对不同分量之间施加的约束。</li><li>目标函数（代价函数）：衡量每个可行解的优劣，使目标函数取最大（或最小）值的可行解为问题的最优解。<br>状态空间树：描述问题解空间的树形结构。</li></ul><p>树中每个结点称为一个问题状态；<br>若从根到树中某个状态的路径代表一个候选解元组，则该状态为解状态；<br>若从根到某个解状态的路径代表一个可行解元组，则该解状态为答案状态；<br>如果求解的是最优化问题，还要用目标函数衡量每个答案结点，找出其中目标函数取最优值的最优答案结点。</p><blockquote><p>回溯法与穷举搜索不同：回溯法使用约束函数，剪去那些可以断定不含答案状态的子树，从而提高算法效率。回溯法适用于解一些组合数相当大的问题。<br>事实上，状态空间树并不需要事先生成，而只需在求解的过程中，随着搜索算法的进展，逐个生成状态空间树的问题状态结点。</p></blockquote><p>常用的剪枝函数：<br>用约束函数剪去已知不含答案状态（可行解）的子树；<br>用限界函数剪去得不到最优答案结点（最优解）的子树。</p><h3 id="蒙特卡洛估计"><a class="markdownIt-Anchor" href="#蒙特卡洛估计"></a> 蒙特卡洛估计</h3><p>用蒙特卡罗（Monte Carlo）方法估计回溯法处理实例时，实际生成的结点数：</p><p>在状态空间树中,从根开始随机选择一条路径(x0,x1,…,xn-1);<br>假定搜索树中这条随机选出的路径上，代表部分向量(x0,x1,…,xk-1)的结点X处不受限制的孩子数目,和其他路径上与X同层的的结点不受限制的孩子数目一样，都是mk;<br>则可以估计整个状态空间树上实际生成的结点数为: <code>m=1+m0+m0m1+m0m1m2+......</code></p><h2 id="算法9_分枝限界法"><a class="markdownIt-Anchor" href="#算法9_分枝限界法"></a> 算法9_分枝限界法</h2><p>采用广度优先产生状态空间树的结点，并使用剪枝函数的方法称为——分枝限界法。<br>分枝限界法的基本做法是：<br>以<strong>广度优先</strong>的方式搜索问题的状态空间树。每一个活结点只有一次机会成为扩展结点。<br>按照广度优先的原则，活结点一旦成为扩展结点（E结点）R后，就依次生成它的所有孩子结点。在这些孩子结点中，导致不可行解或导致非最优解的孩子结点被舍弃，其余孩子结点被一一加入活结点表中。<br>此后，R自身成为死结点，从活结点表中取下一结点成为当前扩展结点，并重复上述结点扩展过程。<br>这个过程一直持续到找到所需的解或活结点表为空时为止。</p><blockquote><p>一、<strong>分枝限界法与回溯法的共同点</strong><br>都是在问题的状态空间树上搜索问题解的算法,都通过活结点表实现。都用约束函数剪去不含答案结点的分枝,用限界函数剪去不含最优解的分枝.<br>二、<strong>分枝限界法与回溯法的区别</strong><br>（1）求解目标不同：回溯法的求解目标是找出解空间树中满足约束条件的所有可行解；而分枝限界法的求解目标则是找出满足约束条件的一个可行解，或某种意义下的最优解。</p><p>（2）搜索方式不同：回溯法以深度优先的方式搜索解空间树，而分枝限界法则以广度优先的方式搜索解空间树。</p><p>（3）对当前扩展结点的扩展方式不同：回溯法中的每个活结点可能多次成为当前扩展结点，纵深方向扩展其一个儿子，然后再回溯后扩展其他儿子；而分枝限界法中每一个活结点只有一次机会成为扩展结点，一次产生所有孩子结点，自身成为死结点，之后无需再返回该结点处。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;算法设计与分析c&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#算法设计与分析c&quot;&gt;&lt;/a&gt; 算法设计与分析C&lt;/h1&gt;
&lt;h2 id=&quot;算法5_分治法&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#算法5_
      
    
    </summary>
    
    
      <category term="ACM" scheme="https://nymrli.top/tags/ACM/"/>
    
      <category term="NJUPT" scheme="https://nymrli.top/tags/NJUPT/"/>
    
      <category term="学业" scheme="https://nymrli.top/tags/%E5%AD%A6%E4%B8%9A/"/>
    
  </entry>
  
  <entry>
    <title>通信企业管理_线上考试</title>
    <link href="https://nymrli.top/2019/08/22/%E9%80%9A%E4%BF%A1%E4%BC%81%E4%B8%9A%E7%AE%A1%E7%90%86-%E7%BA%BF%E4%B8%8A%E8%80%83%E8%AF%95/"/>
    <id>https://nymrli.top/2019/08/22/通信企业管理-线上考试/</id>
    <published>2019-08-22T12:37:49.000Z</published>
    <updated>2019-08-30T13:32:04.302Z</updated>
    
    <content type="html"><![CDATA[<h1 id="通信企业管理"><a class="markdownIt-Anchor" href="#通信企业管理"></a> 通信企业管理</h1><blockquote><p>看清题目和选项</p></blockquote><h3 id="单选题"><a class="markdownIt-Anchor" href="#单选题"></a> 单选题</h3><p>1单选(2分)</p><p>在总公司领导下设立多个分支，各分支有各自独立的产品和市场，实行独立核算，经营管理上拥有自主性和独立性。这是（ A   ）组织结构。</p><ul><li>A.事业部型</li><li>B.矩阵型</li><li>C.职能型</li><li>D.直线型</li></ul><p>2单选(2分)</p><p>按照最新版《中华人民共和国公司法》规定，股份有限公司的发起人最多不超过（    C ）。</p><ul><li>A.100人</li><li>B.50人</li><li>C.200人</li><li>D.150人</li></ul><p>3单选(2分)</p><p>工作或行动之前预先拟定具体的工作内容和步骤是管理的（  D  ）职能。</p><ul><li>A.组织职能</li><li>B.控制职能</li><li>C.领导职能</li><li>D.计划职能</li></ul><p>4单选(2分)</p><p>提出“14项管理原则”的是（C  ）。</p><ul><li>A.巴纳德</li><li>B.梅奥</li><li>C.法约尔</li><li>D.泰勒</li></ul><p>5单选(2分)</p><p>企业战略是关于企业在激烈的竞争中如何与竞争对手相抗衡、同时也是针对来自多方面的冲击、压力、威胁和困难迎击这些挑战的行动方案。这体现了企业战略的（  D  ）。</p><ul><li>A.长远性</li><li>B.协同性</li><li>C.全局性</li><li>D.抗争性</li></ul><p>6单选(2分)</p><p>在对企业总体环境分析中，人们生活方式的变化属于（ B   ）。</p><ul><li>A.经济环境</li><li>B.社会环境</li><li>C.政治环境</li><li>D.技术环境</li></ul><p>7单选(2分)</p><p>为了增强企业实力而与同行业企业进行联合的一种战略称为（ C   ）。</p><ul><li>A.复合多样化</li><li>B.纵向一体化</li><li>C.横向一体化</li><li>D.同心多样化</li></ul><p>8单选(2分)</p><p>在流程型生产过程中，物料是均匀、连续地按一定工艺顺序运动的。它的特点是工艺过程的（ A   ）。</p><ul><li>A.连续性</li><li>B.稳定性</li><li>C.离散性</li><li>D.流动性</li></ul><p>9单选(2分)</p><p>服务是一种活动，在消费之前通常无法为顾客感觉、体验和评价，这体现了服务的（  B   ）。</p><ul><li>A.劳动力密集性</li><li>B.无形性</li><li>C.异质性</li><li>D.易逝性</li></ul><p>10单选(2分)</p><p>尽管不同产品具有不同的外部质量特征，但可以用（ B ）来概括产品质量。</p><ul><li>A.安全性</li><li>B.适用性</li><li>C.经济性</li><li>D.可靠性</li></ul><p>11单选(2分)</p><p>质量管理经历的第四阶段是（  C   ）。</p><ul><li>A.统计质量控制阶段</li><li>B.质量检验阶段</li><li>C. ISO9000质量管理体系认证阶段</li><li>D.全面质量管理阶段</li></ul><p>12单选(2分)</p><p>下面（ A   ）不是朱兰三部曲中所要求的内容。</p><ul><li>A.质量检验</li><li>B.质量计划</li><li>C.质量提高</li><li>D.质量控制</li></ul><p>13单选(2分)</p><p>职业生涯规划属于 人力资源管理的（ C  ）方面的内容。</p><ul><li>A.用人</li><li>B.进人</li><li>C.育人</li><li>D.留人</li></ul><p>14单选(2分)</p><p>一般来说，我们可以从工作业绩、工作能力和工作态度3个方面来评价员工的绩效体现了绩效的（  C   ）特征。</p><ul><li>A.动态性</li><li>B.多因性</li><li>C.多维性</li><li>D.稳定性</li></ul><p>15单选(2分)</p><p>薪酬中属于间接经济性报酬的是（ D  ）。</p><ul><li>A.津贴</li><li>B.基本工资</li><li>C.奖金</li><li>D.基本社会保险</li></ul><p>16单选(2分)</p><p>企业财务管理的基本内容包括：①资金筹集管理；②成本费用管理；③投资管理；④利润（收支差额）及其分配管理；⑤物资管理；中的（ A   ）。</p><p>A.①②③④<br>B.①③④⑤<br>C.①②④⑤<br>D.①②③④⑤</p><p>17单选(2分)</p><p>以下不属于企业的筹资方式的是（ D   ）。</p><ul><li>A.买方信贷</li><li>B.发行股票</li><li>C.银行贷款</li><li>D.来自个人的闲散资金</li></ul><p>18单选(2分)</p><p>某大学生在4年学习期间，每年年初从银行贷款3000元用于支付学费，若按年利率5%计复利，第4年末需要一次性归还全部本息（  D  ）元。</p><ul><li>A.12000</li><li>B.12930.4</li><li>C.16576.9</li><li>D.13576.9</li></ul><p>19单选(2分)</p><p>为了保证产品达到规定的功能和技术要求所必需的材料消耗是（A   ）。</p><ul><li>A.有效性消耗</li><li>B.工艺性消耗</li><li>C.非工艺性消耗</li><li>D.材料消耗</li></ul><p>20单选(2分)</p><p>设备在使用或闲置过程中，由于新技术出现而引起的设备价值损失，称为（ A  ）。</p><ul><li>A.无形磨损</li><li>B.价值磨损</li><li>C.技术磨损</li><li>D.使用磨损</li></ul><p>21单选(2分)</p><p>企业在相邻两批物资进厂间隔期内，为保证生产正常进行所必需的、经济合理的储备数量是（ D  ）。</p><ul><li>A.保险储备定额</li><li>B.物资储备定额</li><li>C.季节性储备定额</li><li>D.经常储备定额</li></ul><p>22单选(2分)</p><p>快速渗透策略是推广处于生命周期（C   ）产品的企业，可以采用的市场营销策略。</p><ul><li>A.衰退期</li><li>B.成长期</li><li>C.引入期</li><li>D.成熟期</li></ul><p>23单选(2分)</p><p>以下不属于促销组合中的促销工具的是（ D ）。</p><ul><li>A.销售促进</li><li>B.公关宣传</li><li>C.广告</li><li>D.尾数定价</li></ul><p>24单选(2分)</p><p>营销人员可以通过接近和影响消费者群体中的意见领袖的方式来开展营销活动，这体现了影响消费者购买的主要因素中的（ D  ）的作用。</p><ul><li>A.经济因素</li><li>B.个人因素</li><li>C.社会文化因素</li><li>D.心理因素</li></ul><p>25单选(2分)</p><p>品种繁多，每种仅生产一件，生产重复程度低是以下哪种生产方式的特点（ B ）。</p><ul><li>A.批量生产</li><li>B.单件生产</li><li>C.大量生产</li><li>D.备货型生产</li></ul><h3 id="判断题"><a class="markdownIt-Anchor" href="#判断题"></a> 判断题</h3><p>26判断(2分)<br>个体企业是个人出资兴办的企业，具有法人资格。</p><ul><li>错</li></ul><p>27判断(2分)<br>在管理过程中，只有把人的要素作为根本，才能协调好其他要素，实现高水平的管理。</p><ul><li>对</li></ul><p>28判断(2分)<br>企业不仅是经济性组织，也是社会性组织。</p><ul><li>对</li></ul><p>29判断(2分)<br>梅奥认为，影响人们积极性的因素除了物质方面外，还有社会与心理方面。</p><ul><li>对</li></ul><p>30判断(2分)<br>企业提供的产品服务标新立异，满足顾客特殊的需求，形成竞争优势的战略是差异化战略。</p><ul><li>对</li></ul><p>31判断(2分)<br>高质量的社会物流系统属于战略制定中企业的外部资源。</p><ul><li>对</li></ul><p>32判断(2分)<br>企业价值活动中，技术开发属于基本活动。</p><ul><li>错</li></ul><p>33判断(2分)<br>企业生产系统是由输入、转化、输出、反馈四部分构成，其核心是输出。</p><ul><li>错</li></ul><p>34判断(2分)<br>辅助生产部门主要是为基本生产和辅助生产服务的单位（如仓储、后勤）。</p><ul><li>错</li></ul><p>35判断(2分)<br>对于顾客来说，服务是发生在服务设施环境中的经历，如果服务设施的设计符合消费者的需要，就可以提高服务质量。</p><ul><li>对</li></ul><p>36判断(2分)<br>ISO9000族标准是进行国际贸易时强制要求必须进行的标准认证。</p><ul><li>错</li></ul><p>37判断(2分)<br>质量体系认证中使用的基本标准是产品技术标准。</p><ul><li>错</li></ul><p>38判断(2分)<br>质量管理的目标就是提高产品质量，产品质量越高越好。</p><ul><li>错</li></ul><p>39判断(2分)<br>广义的人力资源概念是指能够推动国民经济和社会发展的具有智力劳动和体力劳动能力的人的总和，包括数量和质量两个方面。</p><ul><li>错</li></ul><p>40判断(2分)<br>工作说明书具体说明了工作的目的与任务、工作内容与特征、工作责任与权力、工作标准与要求、工作时间与地点等问题。</p><ul><li>错</li></ul><p>41判断(2分)<br>设定绩效目标时，管理者一般根据组织总体目标或上级部门的目标，围绕本部门业务重点或职责，制定本部门的工作目标计划，保证部门工作目标与组织的总体目标相一致。</p><ul><li>对</li></ul><p>42判断(2分)<br>企业的运营能力反映了企业资金周转状况，可以用成本费用净利率来衡量。</p><ul><li>错</li></ul><p>43判断(2分)<br>资本公积、盈余公积都属于企业权益资本的范畴。</p><ul><li>对</li></ul><p>44判断(2分)<br>盈亏平衡点是指技术方案的盈利和亏损在产量、单价、成本等方面的临界值。</p><ul><li>对</li></ul><p>45判断(2分)<br>在设备的自然寿命周期中，设备故障率随着使用的时间的延伸而越来越高。</p><ul><li>对</li></ul><p>46判断(2分)<br>设备更新改造时，不仅要考虑设备的自然寿命，还要考察技术寿命和经济寿命。</p><ul><li>对</li></ul><p>47判断(2分)<br>从价值形态上看，无论是有形磨损还是无形磨损都会引起设备价值的降低，因此我们要采取措施尽量减少各种类型的设备磨损。</p><ul><li>错</li></ul><p>48判断(2分)<br>关系营销就是利用亲属关系以及朋友关系来开展营销活动。</p><ul><li>错</li></ul><p>49判断(2分)<br>在目标市场中采用无差异的市场营销策略历来都不是一种明智的选择。</p><ul><li>错</li></ul><p>50判断(2分)<br>招徕定价是一种利用顾客心理因素来进行定价的策略。</p><ul><li>对</li></ul><h2 id="附"><a class="markdownIt-Anchor" href="#附"></a> 附：</h2><blockquote><p>记个正则替换，本是强哥每题copy到word里的，后来通过正则规范了下格式</p></blockquote><p>复制结果：</p><blockquote><p>\1. int[][] a=new int[2][3]，则该数组包含（ ）个数组元素。</p><p>A.2</p><p>B.3</p><p>C.6</p><p>D.不确定</p><p>正确答案是: C</p><p>\2. 已知类person是类student的父类，以下数组定义和赋值正确的是( )。</p><p>A.person p[]=new person[3]; p[1]=new student();</p><p>B.student s[]=new person[3]; s[1]=new person();</p><p>C.person p[]= new student[3];p[1]= new person();</p><p>D.student s[]=new student[3];s[1]=new person;</p><p>正确答案是: A</p></blockquote><p>查找<code>(\d.)</code>替换为<code>\n - \1</code></p><p>效果如下:</p><ul><li><ol><li>int[][] a=new int[2][3]，则该数组包含（ ）个数组元素。<br>A.2<br>B.3<br>C.6<br>D.不确定<br>正确答案是: C</li></ol></li><li><ol start="2"><li>已知类person是类student的父类，以下数组定义和赋值正确的是( )。<br>A.person p[]=new person[3]; p[1]=new student();<br>B.student s[]=new person[3]; s[1]=new person();<br>C.person p[]= new student[3];p[1]= new person();<br>D.student s[]=new student[3];s[1]=new person;<br>正确答案是: A</li></ol></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;通信企业管理&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#通信企业管理&quot;&gt;&lt;/a&gt; 通信企业管理&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;看清题目和选项&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;单选题&quot;&gt;&lt;a class
      
    
    </summary>
    
    
      <category term="NJUPT" scheme="https://nymrli.top/tags/NJUPT/"/>
    
      <category term="学业" scheme="https://nymrli.top/tags/%E5%AD%A6%E4%B8%9A/"/>
    
  </entry>
  
  <entry>
    <title>Let&#39;s Encrypt安装配置nginx的SSL证书教程</title>
    <link href="https://nymrli.top/2019/08/22/Let-s-Encrypt%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/"/>
    <id>https://nymrli.top/2019/08/22/Let-s-Encrypt安装配置SSL证书教程/</id>
    <published>2019-08-22T12:34:04.000Z</published>
    <updated>2019-08-22T12:36:34.102Z</updated>
    
    <content type="html"><![CDATA[<h1 id="lets-encrypt-安装配置nginx的ssl证书教程"><a class="markdownIt-Anchor" href="#lets-encrypt-安装配置nginx的ssl证书教程"></a> Let’s Encrypt 安装配置nginx的SSL证书教程</h1><h2 id="使用cerbot生成证书"><a class="markdownIt-Anchor" href="#使用cerbot生成证书"></a> <a href="%5Bhttps://nymrli.top/2018/12/08/%E4%BD%BF%E7%94%A8Cerbot%E7%94%B3%E8%AF%B7%E5%85%8D%E8%B4%B9%E8%AF%81%E4%B9%A6%E5%8D%87%E7%BA%A7-http%E5%88%B0https/%5D(https://nymrli.top/2018/12/08/%E4%BD%BF%E7%94%A8Cerbot%E7%94%B3%E8%AF%B7%E5%85%8D%E8%B4%B9%E8%AF%81%E4%B9%A6%E5%8D%87%E7%BA%A7-http%E5%88%B0https/)">使用cerbot生成证书</a></h2><h3 id="安装lets-encrypt"><a class="markdownIt-Anchor" href="#安装lets-encrypt"></a> 安装<a href="https://letsencrypt.org/" target="_blank" rel="noopener">Let’s Encrypt</a></h3><p>安装非常简单直接克隆就可以了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/letsencrypt/letsencrypt</span><br></pre></td></tr></table></figure><p>如果网速较慢（国外服务器应该快点）</p><p>1.可以登录https://github.com/letsencrypt/letsencrypt，下载后通过lrzsz传到云服务器上，再解压</p><p>2.修改hosts</p><p><strong>查找域名对应的ip地址，并修改hosts文件</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">linuxidc@linuxidc:~/linuxidc.com$ nslookup github.global.ssl.fastly.Net</span><br><span class="line">Server:  127.0.0.53</span><br><span class="line">Address: 127.0.0.53<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name: github.global.ssl.fastly.Net</span><br><span class="line">Address: 151.101.229.194</span><br><span class="line"></span><br><span class="line">linuxidc@linuxidc:~/linuxidc.com$ nslookup github.com</span><br><span class="line">Server:  127.0.0.53</span><br><span class="line">Address: 127.0.0.53<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name: github.com</span><br><span class="line">Address: 13.229.188.59</span><br></pre></td></tr></table></figure><p><strong>然后修改hosts文件</strong></p><p><code>sudo vim /etc/hosts</code></p><p><strong>在hosts文件末尾添加两行</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">github.com 13.229.188.59</span><br><span class="line">github.global.ssl.fastly.Net 151.101.229.194</span><br></pre></td></tr></table></figure><p><strong>刷新DNS缓存</strong></p><p><code>sudo /etc/init.d/networking restart</code></p><h3 id="使用cerbot"><a class="markdownIt-Anchor" href="#使用cerbot"></a> 使用cerbot:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> letsencrypt</span><br><span class="line"><span class="comment"># 根据自己的需求调整代码</span></span><br><span class="line">./certbot-auto certonly --standalone --email admin@example.com -d example.c</span><br></pre></td></tr></table></figure><p><strong>成功提示</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IMPORTANT NOTES:</span><br><span class="line">Congratulations! Your certificate and chain have been saved at:</span><br><span class="line">   /etc/letsencrypt/live/sast.nymrli.top/fullchain.pem</span><br><span class="line">   Your key file has been saved at:</span><br><span class="line">   /etc/letsencrypt/live/sast.nymrli.top/privkey.pem</span><br><span class="line">   Your cert will expire on 2019-02-08. To obtain a new or tweaked</span><br><span class="line">   version of this certificate in the future, simply run certbot-auto</span><br><span class="line">   again. To non-interactively renew *all* of your certificates, run</span><br><span class="line">   &quot;certbot-auto renew&quot;</span><br><span class="line"> - If you like Certbot, please consider supporting our work by:</span><br></pre></td></tr></table></figure><h3 id="配置nginx"><a class="markdownIt-Anchor" href="#配置nginx"></a> 配置<em>Nginx</em>:</h3><p>server 不再监听80端口，因为TLS要使用的是443端口，然后引入证书和key</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line"><span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line"><span class="attribute">server_name</span> <span class="number">127.0.0.1</span>;</span><br><span class="line"><span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line"><span class="attribute">client_max_body_size</span> <span class="number">75M</span>;</span><br><span class="line">    <span class="attribute">location</span> /static&#123;</span><br><span class="line">    <span class="attribute">alias</span> /home/mrli/Python_project/QQoauth_remote/static;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line"><span class="attribute">include</span> uwsgi_params;</span><br><span class="line"><span class="attribute">uwsgi_pass</span> <span class="number">127.0.0.1:81</span>;</span><br><span class="line"><span class="attribute">uwsgi_param</span> UWSGI_SCRIPT app:app;   <span class="comment"># 启动flask的文件:Flask的实例</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">ssl_certificate</span>   /etc/letsencrypt/live/test.nymrli.top/fullchain.pem; </span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/letsencrypt/live/test.nymrli.top/privkey.pem;   </span><br><span class="line">    <span class="comment">#前面生成的证书，改一下里面的域名就行，不建议更换路径</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="重启nginx"><a class="markdownIt-Anchor" href="#重启nginx"></a> 重启<em>Nginx</em>：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure><h2 id="使用acmesh"><a class="markdownIt-Anchor" href="#使用acmesh"></a> <a href="http://xn--acme-9s6fu80r.sh" target="_blank" rel="noopener">使用acme.sh</a></h2><h3 id="下载acme"><a class="markdownIt-Anchor" href="#下载acme"></a> 下载<strong>acme</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Neilpang/acme.sh.git</span><br><span class="line"><span class="built_in">cd</span> acme.sh</span><br><span class="line">./acme.sh --install</span><br></pre></td></tr></table></figure><p><strong>提示信息</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[Thu Aug 22 19:58:00 CST 2019] It is recommended to install socat first.</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] We use socat for standalone server if you use standalone mode.</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] If you don&apos;t use standalone mode, just ignore this warning.</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] Installing to /home/mrli/.acme.sh</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] Installed to /home/mrli/.acme.sh/acme.sh</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] Installing alias to &apos;/home/mrli/.bashrc&apos;</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] OK, Close and reopen your terminal to start using acme.sh</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] Installing cron job</span><br><span class="line">1 0 * * * &quot;/home/mrli/.acme.sh&quot;/acme.sh --cron --home &quot;/home/mrli/.acme.sh&quot; &gt; /dev/null</span><br><span class="line">[Thu Aug 22 19:58:00 CST 2019] Good, bash is found, so change the shebang to use bash as preferred.</span><br><span class="line">[Thu Aug 22 19:58:01 CST 2019] OK</span><br></pre></td></tr></table></figure><h3 id="生成证书"><a class="markdownIt-Anchor" href="#生成证书"></a> <strong>生成证书</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> Ali_Key=<span class="string">"xxxx"</span></span><br><span class="line"><span class="built_in">export</span> Ali_Secret=<span class="string">"yyyy"</span></span><br><span class="line">acme.sh --issue --dns dns_ali -d nymrli.top -d *.nymrli.top</span><br></pre></td></tr></table></figure><p>注：这边的Key和secret需要找到你的阿里云API密钥，<a href="https://usercenter.console.aliyun.com/#/manage/ak" target="_blank" rel="noopener">Acesskey</a></p><p>![accesskeys](C:\Users\10630\Documents\Let’s Encrypt 安装配置 SSL 证书教程\accesskeys.png)</p><p><strong>输出信息</strong>**</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[Thu Aug 22 20:01:53 CST 2019] Create account key ok.</span><br><span class="line">[Thu Aug 22 20:01:53 CST 2019] Registering account</span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] Registered</span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] ACCOUNT_THUMBPRINT=<span class="string">'YljrV0ThIsQxXtfdxksrd91g1fWvM9Btn9Dazt8OWyo'</span></span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] Creating domain key</span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] The domain key is here: /home/mrli/.acme.sh/nymrli.top/nymrli.top.key</span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] Multi domain=<span class="string">'DNS:nymrli.top,DNS:*.nymrli.top'</span></span><br><span class="line">[Thu Aug 22 20:01:55 CST 2019] Getting domain auth token <span class="keyword">for</span> each domain</span><br><span class="line">[Thu Aug 22 20:01:56 CST 2019] Getting webroot <span class="keyword">for</span> domain=<span class="string">'nymrli.top'</span></span><br><span class="line">[Thu Aug 22 20:01:56 CST 2019] Getting webroot <span class="keyword">for</span> domain=<span class="string">'*.nymrli.top'</span></span><br><span class="line">[Thu Aug 22 20:01:57 CST 2019] Adding txt value: NyNt2AxJ3OmW8s_wVn2C3CNN9_yT1o_v2o0MhmdUoTs <span class="keyword">for</span> domain:  _acme-challenge.nymrli.top</span><br><span class="line">[Thu Aug 22 20:01:59 CST 2019] The txt record is added: Success.</span><br><span class="line">[Thu Aug 22 20:01:59 CST 2019] Adding txt value: ADqtxSTlQ0DH7jHZzlP9UZB0dT9U2oVYSk_zTabYN3w <span class="keyword">for</span> domain:  _acme-challenge.nymrli.top</span><br><span class="line">[Thu Aug 22 20:02:01 CST 2019] The txt record is added: Success.</span><br><span class="line">[Thu Aug 22 20:02:01 CST 2019] Let<span class="string">'s check each dns records now. Sleep 20 seconds first.</span></span><br><span class="line"><span class="string">[Thu Aug 22 20:02:22 CST 2019] Checking nymrli.top for _acme-challenge.nymrli.top</span></span><br><span class="line"><span class="string">[Thu Aug 22 20:02:24 CST 2019] Domain nymrli.top '</span>_acme-challenge.nymrli.top<span class="string">' success.</span></span><br><span class="line"><span class="string">[Thu Aug 22 20:02:24 CST 2019] Checking nymrli.top for _acme-challenge.nymrli.top</span></span><br><span class="line"><span class="string">[Thu Aug 22 20:02:25 CST 2019] Domain nymrli.top '</span>_acme-challenge.nymrli.top<span class="string">' success.</span></span><br><span class="line"><span class="string">[Thu Aug 22 20:02:25 CST 2019] All success, let'</span>s <span class="built_in">return</span></span><br><span class="line">[Thu Aug 22 20:02:25 CST 2019] Verifying: nymrli.top</span><br><span class="line">[Thu Aug 22 20:02:28 CST 2019] Success</span><br><span class="line">[Thu Aug 22 20:02:28 CST 2019] Verifying: *.nymrli.top</span><br><span class="line">[Thu Aug 22 20:02:31 CST 2019] Success</span><br><span class="line">[Thu Aug 22 20:02:31 CST 2019] Removing DNS records.</span><br><span class="line">[Thu Aug 22 20:02:31 CST 2019] Removing txt: NyNt2AxJ3OmW8s_wVn2C3CNN9_yT1o_v2o0MhmdUoTs <span class="keyword">for</span> domain: _acme-challenge.nymrli.top</span><br><span class="line">[Thu Aug 22 20:02:34 CST 2019] Removed: Success</span><br><span class="line">[Thu Aug 22 20:02:34 CST 2019] Removing txt: ADqtxSTlQ0DH7jHZzlP9UZB0dT9U2oVYSk_zTabYN3w <span class="keyword">for</span> domain: _acme-challenge.nymrli.top</span><br><span class="line">[Thu Aug 22 20:02:38 CST 2019] Removed: Success</span><br><span class="line">[Thu Aug 22 20:02:38 CST 2019] Verify finished, start to sign.</span><br><span class="line">[Thu Aug 22 20:02:38 CST 2019] Lets finalize the order, Le_OrderFinalize: https://acme-v02.api.letsencrypt.org/acme/finalize/64001779/941369076</span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] Download cert, Le_LinkCert: https://acme-v02.api.letsencrypt.org/acme/cert/034f6880d75703381da6f5efedb159772580</span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] Cert success.</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">xxxxx</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] Your cert is <span class="keyword">in</span>  /home/mrli/.acme.sh/nymrli.top/nymrli.top.cer </span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] Your cert key is <span class="keyword">in</span>  /home/mrli/.acme.sh/nymrli.top/nymrli.top.key </span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] The intermediate CA cert is <span class="keyword">in</span>  /home/mrli/.acme.sh/nymrli.top/ca.cer </span><br><span class="line">[Thu Aug 22 20:02:40 CST 2019] And the full chain certs is there:  /home/mrli/.acme.sh/nymrli.top/fullchain.cer</span><br></pre></td></tr></table></figure><h3 id="nginx配置文件内容"><a class="markdownIt-Anchor" href="#nginx配置文件内容"></a> nginx配置文件内容</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">listen 443 ssl;</span><br><span class="line">server_name 127.0.0.1;</span><br><span class="line">charset utf-8;</span><br><span class="line">client_max_body_size 75M;</span><br><span class="line">    location /static&#123;</span><br><span class="line">    <span class="built_in">alias</span> /home/mrli/Python_project/QQoauth_remote/static;  </span><br><span class="line">&#125;</span><br><span class="line">location / &#123;</span><br><span class="line">include uwsgi_params;</span><br><span class="line">uwsgi_pass 127.0.0.1:81;</span><br><span class="line">uwsgi_param UWSGI_SCRIPT app:app;   <span class="comment"># 启动flask的文件:Flask的实例</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">ssl_certificate   /home/mrli/.acme.sh/nymrli.top/fullchain.cer; </span><br><span class="line">    ssl_certificate_key /home/mrli/.acme.sh/nymrli.top/nymrli.top.key;   </span><br><span class="line">    <span class="comment">#前面生成的证书，改一下里面的域名就行，不建议更换路径</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="阿里云免费ssl证书symantec"><a class="markdownIt-Anchor" href="#阿里云免费ssl证书symantec"></a> 阿里云免费SSL证书symantec</h2><p>从<a href="https://common-buy.aliyun.com/?spm=5176.2020520163.cas.3.4cce56a7AqzpRw&amp;commodityCode=cas#/buy" target="_blank" rel="noopener">云盾证书服务(包年)</a>中选择免费的symantec生成后，按下载，选择nginx证书</p><p><img src="/2019/08/22/Let-s-Encrypt安装配置SSL证书教程/Let-s-Encrypt%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEnginx%E7%9A%84SSL%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B%5C1.png" alt="1"></p><p>文件内容如下</p><p><img src="/2019/08/22/Let-s-Encrypt安装配置SSL证书教程/Let-s-Encrypt%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEnginx%E7%9A%84SSL%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B%5Ccer.png" alt="cer"></p><p>我们需要把这两个文件放到我们的服务器中，如果是linux系统，推荐放到<code>/etc/ssl/</code>目录下</p><p>示例：nginx节点配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">    <span class="comment">#http节点中可以添加多个server节点</span></span><br><span class="line">    server&#123;</span><br><span class="line">        <span class="comment">#监听443端口</span></span><br><span class="line">        listen 443;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">#对应的域名，把test.nymrli.top改成你们自己的域名就可以了</span></span><br><span class="line">        server_name test.nymrli.top;</span><br><span class="line">        ssl on;</span><br><span class="line">   </span><br><span class="line">        <span class="comment">#从腾讯云获取到的第一个文件的全路径</span></span><br><span class="line">        ssl_certificate /etc/ssl/1474527_www.nymrli.top.pem;</span><br><span class="line">        <span class="comment">#从腾讯云获取到的第二个文件的全路径</span></span><br><span class="line">        ssl_certificate_key /etc/ssl/1474527_www.nymrli.top.key;</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#这是我的主页访问地址，因为使用的是静态的html网页，所以直接使用location就可以完成了。</span></span><br><span class="line">        location / &#123;</span><br><span class="line">                <span class="comment">#文件夹</span></span><br><span class="line">                root /usr/<span class="built_in">local</span>/service/ROOT;</span><br><span class="line">                <span class="comment">#主页文件</span></span><br><span class="line">                index index.html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>▲.<code>crt、pem、key</code>都是证书文件</p><h3 id="问题解决"><a class="markdownIt-Anchor" href="#问题解决"></a> 问题解决:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Problem binding to port 80: Could not bind to IPv4 or IPv6.</span><br></pre></td></tr></table></figure><p>原因是 nginx 占用了80端口，输入<code>service nginx stop</code>。然后再次执行证书安装命令，即可顺利安装。安装完毕后，输入<code>service nginx start</code>，重启 nginx 服务。</p><p>2.重启nginx失败=&gt;conf配置有问题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">See &quot;systemctl status nginx.service&quot; and &quot;journalctl -xe&quot; for details.</span><br><span class="line"> failed!</span><br></pre></td></tr></table></figure><p>A:<code>.conf</code>文件的注释是#而不是//</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;lets-encrypt-安装配置nginx的ssl证书教程&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#lets-encrypt-安装配置nginx的ssl证书教程&quot;&gt;&lt;/a&gt; Let’s Encrypt 安装配置nginx的SSL
      
    
    </summary>
    
    
      <category term="环境部署" scheme="https://nymrli.top/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>时间序列概念及主要模型</title>
    <link href="https://nymrli.top/2019/07/29/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B/"/>
    <id>https://nymrli.top/2019/07/29/时间序列概念及主要模型/</id>
    <published>2019-07-29T11:05:18.000Z</published>
    <updated>2019-07-30T06:29:07.078Z</updated>
    
    <content type="html"><![CDATA[<h1 id="时间序列概念及主要模型"><a class="markdownIt-Anchor" href="#时间序列概念及主要模型"></a> 时间序列概念及主要模型</h1><p>Q:什么是时间序列分析?<br>A:时间序列是按照时间顺序，按照一定时间间隔取得的一系列观测值<br>Q:怎样做时间序列分析?<br>A:时间序列分析尝试找出序列值在过去呈现的特征模式，假定这种模式在未来能够持续，进而对未来进行预测</p><h2 id="时间序列三大特征"><a class="markdownIt-Anchor" href="#时间序列三大特征"></a> 时间序列三大特征</h2><ul><li>序列相关性：当期的序列值和前期某个或某些序列值线性相关<br>√  自相关系数（全相关系数）（ACF）：用来度量同一事件在不同时期之间的相关程度。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mrow><mi>h</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>r</mi><mo>(</mo><mi>h</mi><mo>)</mo></mrow><mrow><mi>r</mi><mo>(</mo><mn>0</mn><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\rho_{h}=\frac{r(h)}{r(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>，其中r（h）为h期协方差函数，r（0）为方差<br>√  偏自相关系数（PACF）：度量去除中间变量影响后的相关程度。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>通过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>产生关联，PACF即为去除<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t- 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的关联后两者的相关程度</li><li>趋势性：序列整体上呈现单调性，如平稳，上涨或下跌<ul><li>ARMA模型是平稳的时间序列模型，在建模前必须去除趋势性</li></ul></li><li>随机性：序列在一定程度上呈现不确定性<ul><li>模型并不能够捕捉到现实世界中的所有特征，总有一些噪声的存在，这些噪声叫做白噪声</li></ul></li></ul><h2 id="时间序列模型预测方法"><a class="markdownIt-Anchor" href="#时间序列模型预测方法"></a> 时间序列模型预测方法：</h2><p>算术平均法，移动平均法，加权移动平均法，指数平滑法，自回归法和移动平均法（ARIMA）</p><p>算数平均法：对时间序列的过去数据进行简单平均来进行预测<br>移动平均法(ARIMA)：不考虑远期的数据，仅考虑近期数据产生的影响。<br>加权移动平均法：给予近期数据较大的权重，远期数据较小的权重<br>指数平滑法：给予近期数据较大的权重，远期数据较小的权重，但是权重以指<br>数的形式适减<br>自回归法和移动平均法（ARIMA）:先对数据做了差分，之后再使用自回归滑动平均模型[^ARMA]模型。优点信息浪费最少，集趋势性，相关性和随机性于一身</p><h2 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念"></a> 基本概念</h2><p><strong>T时刻的时间序列值</strong>表示为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">X_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>,T-1时刻的序列值表述为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>或者<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>[</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">X[t-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span></span></span></span></p><p><strong>一个时间序列</strong>可以表述为：\left\{X_{t} | t=1,2,3 \dots n\right\}</p><p>滞后算子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>X</mi><mo separator="true">,</mo><mo>=</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">B X,=X_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>时间序列的差分:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}-X_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>或者<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>[</mo><mi>t</mi><mo>]</mo><mo>−</mo><mi>X</mi><mo>[</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">X[t]-X[t-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathit">t</span><span class="mclose">]</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span></span></span></span><br>一阶差分：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><mi>B</mi><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>B</mi><mo>)</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}-X_{t-1}=X_{t}-B X_{t}=(1-B) X_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><br>二阶差分：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mrow><mo fence="true">(</mo><mi mathvariant="normal">∇</mi><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi mathvariant="normal">∇</mi><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><mi mathvariant="normal">∇</mi><msub><mi>X</mi><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><mn>2</mn><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>B</mi><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\nabla\left(\nabla X_{t}\right)=\nabla X_{t}-\nabla X_{r-1}=\left(X_{t}-X_{t-1}\right)-\left(X_{t-1}-X_{t-2}\right)=X_{t}-2 X_{t-1}+X_{t-2}=(1-B)^{2} X_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathrm">∇</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">∇</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mbin">−</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><br>k步差分：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msup><mi>B</mi><mrow><mi>k</mi></mrow></msup><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msup><mi>B</mi><mrow><mi>k</mi></mrow></msup><mo fence="true">)</mo></mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}-X_{t-k}=X_{t}-B^{k} X_{t}=\left(1-B^{k}\right) X_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>思考：<br>1.三阶差分如何表达？3步差分如何表达？<br>2.为什么要进行一阶差分？二阶差分？<br>3.为什么要进行k步差分？<br>4.阶次差分与步长差分的区别？</p><h2 id="时间序列分类"><a class="markdownIt-Anchor" href="#时间序列分类"></a> 时间序列分类</h2><blockquote><p>Q:什么是序列平稳？</p><p>A:</p><p>1.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mrow><mo fence="true">(</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">E\left(X_{t}\right)=\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord mathit">μ</span></span></span></span>，对于所有t而言，序列的期望为一常数，见图一</p><p>2.\operatorname{Var}\left(X_{t}\right)=\sigma，对于所有t，序列方差为一常数，见图二</p><p>3.r(h)=\operatorname{Cov}\left(X_{t}, X_{t-l}\right)对于所有t以及h〉0，序列的协方差为是由h唯一决定的函数，即h阶的相关性只与h有关，与时刻t无关，如：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi></mrow></msub><mo fence="true">}</mo></mrow><mo separator="true">,</mo><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mn>2</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mn>3</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>n</mi><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left\{X_{n}, X_{n+1}, X_{n+2}, \ldots, X_{n}\right\},\left\{X_{1}, X_{2}, X_{3}, \ldots, X_{n+1}-n\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">}</span></span><span class="mpunct">,</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit">n</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">]</span></span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mi>h</mi><mo>+</mo><mn>5</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>h</mi><mo>+</mo><mn>6</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>h</mi><mo>+</mo><mn>7</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>5</mn></mrow></msub><mo fence="true">}</mo></mrow><mo separator="true">,</mo><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mn>6</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mn>7</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mn>8</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>6</mn><mo>−</mo><mi>h</mi></mrow></msub><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\left\{X_{h+5}, X_{h+6}, X_{h+7}, \ldots, X_{n+5}\right\},\left\{X_{6}, X_{7}, X_{8}, \ldots, X_{n+6-h}\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord mathrm">6</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mbin">+</span><span class="mord mathrm">7</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">}</span></span><span class="mpunct">,</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">6</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">7</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">8</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">6</span><span class="mbin">−</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">}</span></span></span></span></span>的相关性一致</p></blockquote><p>根据序列是否平稳，时间序列可以分为：</p><p>平稳序列：白噪声序列、AR（p）序列，MA（a）序列，ARWA（p.g）序列<br>非平稳序列：ARlMA（P.d.g）序列</p><p>平稳条件:</p><p>1.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">E\left(x_{t}\right)=\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mord mathit">μ</span></span></span></span>序列的均值应该是一个常数，而不是随时间变化的函数。下图中左图满足要求，而右图的均值是随时间而变化的。</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5C1.jpg" alt="1"></p><p>2.\operatorname{Var}\left(X_{t}\right)=\sigma,序列的方差为一个常数，而不随时间的变化</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5C2.jpg" alt="2"></p><p>3.\operatorname{Cov}(y t, y t+k)=y 0,k,序列协方差的值只与时间间隔k有关，与时间t无关</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5C3.jpg" alt="3"></p><h3 id="白噪声序列"><a class="markdownIt-Anchor" href="#白噪声序列"></a> 白噪声序列</h3><p>(高斯)白噪声模型:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="normal">e</mi></mrow><mrow><mrow><mi mathvariant="normal">t</mi></mrow></mrow></msub><mi mathvariant="normal">∣</mi><msub><mrow><mi mathvariant="normal">e</mi></mrow><mrow><mrow><mi mathvariant="normal">t</mi></mrow></mrow></msub><mo>∼</mo><mrow><mi mathvariant="normal">W</mi><mi mathvariant="normal">N</mi></mrow><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mrow><mn>2</mn></mrow></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{t}=\mathrm{e}_{\mathrm{t}} | \mathrm{e}_{\mathrm{t}} \sim \mathrm{WN}\left(0, \sigma^{2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">e</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">t</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">e</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">t</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∼</span><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mord mathrm">N</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><br>(高斯)白噪声就是一系列独立分布的正态序列：</p><ul><li>序列相关性：无</li><li>趋势性：无</li><li>随机性：是</li></ul><p>白噪声的每一个时序点都是服从正态分布的</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5CB.jpg" alt="B"></p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5C%E9%AB%98%E6%96%AF%E7%99%BD%E5%99%AA%E5%A3%B0%E6%95%A3%E7%82%B9%E5%9B%BE.jpg" alt="高斯白噪声散点图"></p><p>序列无规律可循，在均值处反复震荡<img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5C%E9%AB%98%E6%96%AF%E7%99%BD%E5%99%AA%E5%A3%B0.jpg" alt="高斯白噪声"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">clear,clc;</span><br><span class="line">N=<span class="number">0</span>:<span class="number">1000</span>;</span><br><span class="line">fs=<span class="number">1024</span>;</span><br><span class="line">t=N./fs;</span><br><span class="line">y=<span class="number">3</span>*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*t);</span><br><span class="line">x=wgn(<span class="number">1</span>,<span class="number">1001</span>,<span class="number">2</span>);<span class="comment">% wgn产生高斯白噪声</span></span><br><span class="line"><span class="built_in">i</span>=y+x;<span class="comment">% 给原有信号y叠加高斯白噪声</span></span><br><span class="line"><span class="comment">%i=awgn(y,2); % awgn在信号y中加入高斯白噪声。</span></span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>),plot(x);</span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>),plot(y);</span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>),plot(<span class="built_in">i</span>);</span><br></pre></td></tr></table></figure><hr><h3 id="自回归模型ar"><a class="markdownIt-Anchor" href="#自回归模型ar"></a> 自回归模型AR</h3><h4 id="ar"><a class="markdownIt-Anchor" href="#ar"></a> ▲AR§:</h4><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>β</mi><mrow><mi>p</mi></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="normal">e</mi></mrow><mrow><mi>t</mi></mrow></msub><mspace width="1em"></mspace><msub><mrow><mi mathvariant="normal">e</mi></mrow><mrow><mi>t</mi></mrow></msub><mo>∼</mo><mrow><mi mathvariant="normal">W</mi><mi mathvariant="normal">N</mi></mrow><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mrow><mn>2</mn></mrow></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{t} = \beta_{1}X_{t-1}+\beta_{2} X_{t-2}+\ldots+\beta_{p} X_{t-p}+\mathrm{e}_{t} \quad \mathrm{e}_{t} \sim \mathrm{WN}\left(0, \sigma^{2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">e</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mspace quad"></span><span class=""><span class="mord textstyle uncramped"><span class="mord mathrm">e</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∼</span><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mord mathrm">N</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></p><p>当前时刻的时序值可由其过去值的线性组合加上一个白噪声</p><p>建模的目的就是要搞清过去几期的历史值会影响当前值</p><p>模型特征：</p><ul><li>趋势性：无</li><li>相关性：有</li><li>随机性：有</li></ul><h4 id="ar1模型"><a class="markdownIt-Anchor" href="#ar1模型"></a> ▲AR（1）模型:</h4><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}=\beta_{1} X_{t-1}+e_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>一阶自回归模型是最简单的自回归模型</p><p>该模型在t+1时的情形:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mo>⊥</mo></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t+1}=\beta_{\perp} X_{t}+e_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mrel">⊥</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>自相关系数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mrow><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>ρ</mi><mrow><mn>2</mn></mrow></msub><mo>=</mo><msubsup><mi>β</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>ρ</mi><mrow><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mi>β</mi><mrow><mn>1</mn></mrow><mrow><mi>k</mi></mrow></msubsup><mo separator="true">,</mo><mrow><mi mathvariant="normal">k</mi></mrow><mo>≥</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\rho_{1}=\beta_{1}, \rho_{2}=\beta_{1}^{2}, \ldots, \rho_{k}=\beta_{1}^{k}, \mathrm{k} \geq 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.097216em;vertical-align:-0.24810799999999997em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.05278em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.05278em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathrm">k</span></span><span class="mrel">≥</span><span class="mord mathrm">3</span></span></span></span><br>偏自相关系数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>φ</mi><mrow><mn>1</mn><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>φ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>k</mi><mo>⩾</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\varphi_{11}=\rho_{1}, \varphi_{k k}=0, k \geqslant 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">φ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">φ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel amsrm">⩾</span><span class="mord mathrm">2</span></span></span></span></p><p>AR（1）的序列相关性：</p><ul><li>ACF星现指数下降趋势</li><li>PACF在一阶处出现峰值，之后截断</li></ul><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5CB2.jpg" alt="B2"></p><p>Q:如何识别自回归阶数</p><p>A:</p><ul><li>PACF显示出剧烈地下降，并截断在P阶，而ACF呈指数下降趋势</li><li>PACF截尾的阶数即为AR模型的阶数</li></ul><hr><h3 id="移动平均模型ma"><a class="markdownIt-Anchor" href="#移动平均模型ma"></a> 移动平均模型MA</h3><h4 id="maa"><a class="markdownIt-Anchor" href="#maa"></a> ▲MA(a):</h4><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mover accent="true"><mrow><mi>β</mi></mrow><mo>˙</mo></mover><mrow><mn>1</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>β</mi><mrow><mi>q</mi></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}=e_{t}+\dot{\beta}_{1} e_{t-1}+\beta_{2} e_{t-2}+\ldots+\beta_{q} e_{t-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9313em;"></span><span class="strut bottom" style="height:1.217408em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.05278em;">β</span></span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>˙</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub><mo>∼</mo><mi>W</mi><mi>N</mi><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mrow><mn>2</mn></mrow></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">e_{t} \sim W N\left(0, \sigma^{2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∼</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></p><p>序列当前时刻的时序值是过去q阶白噪声的线性组合</p><p>建模的目的在于：</p><ul><li>找出过去几期的白噪声影响了当前值</li><li>找出过去a期冲击效应对当前值的影响</li></ul><p>模型特征：</p><ul><li>趋势性：无</li><li>相关性：有</li><li>随机性：有</li></ul><h4 id="ma1模型"><a class="markdownIt-Anchor" href="#ma1模型"></a> ▲MA（1）模型:</h4><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}=e_{t}+\beta_{1} e_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>一阶移动平均模型是最简单的移动平均模型</p><p>该模型在t+1时的情形？<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>e</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t+1}=e_{t+1}+\beta_{1} e_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><p>​MA（1）模型是利用t时刻的冲击变量值来预测将来</p><p>自相关系数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mrow><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>γ</mi><mrow><mi>k</mi></mrow></msub></mrow><mrow><msub><mi>γ</mi><mrow><mn>0</mn></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>+</mo><msubsup><mi>β</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mfrac><mo separator="true">,</mo></mrow></mrow></mtd><mtd><mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mn>0</mn></mrow></mrow></mtd><mtd><mrow><mrow><mi>k</mi><mo>≥</mo><mn>2</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\rho_{k}=\frac{\gamma_{k}}{\gamma_{0}}=\left\{\begin{array}{cc}{\frac{\beta_{1}}{1+\beta_{1}^{2}},} &amp; {k=1} \\ {0} &amp; {k \geq 2}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6671120000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.37358em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span style="top:-0.34480000000000005em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span style="top:0.7393280000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6671120000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:0.7393280000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">≥</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><br>偏自相关系数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>φ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mrow><msub><mi>ρ</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo></mrow></mrow></mtd><mtd><mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mfrac><mrow><mo>−</mo><msubsup><mi>ρ</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>ρ</mi><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mfrac><mrow><mo>−</mo><msub><mi>φ</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>ρ</mi><mrow><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>φ</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>ρ</mi><mrow><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow><mi>k</mi><mo>≥</mo><mn>3</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\varphi_{k k}=\left\{\begin{array}{cc}{\rho_{1},} &amp; {k=1} \\ {\frac{-\rho_{1}^{2}}{1-\rho_{1}^{2}}} &amp; {k=2} \\ {\frac{-\varphi_{k-1, k-1} \rho_{1}}{1-\varphi_{k-1,1} \rho_{1}}} &amp; {k \geq 3}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.4011855em;"></span><span class="strut bottom" style="height:4.302371em;vertical-align:-1.9011855em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">φ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.4500200000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.5611855em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span></span><span style="top:-0.13474549999999974em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.37358em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span style="top:-0.34480000000000005em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.49012em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.2573142857142857em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.3531055em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">φ</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.51308em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord"><span class="mord mathit">φ</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">ρ</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.5611855em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.13474549999999974em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span><span style="top:1.3531055em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">≥</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p><hr><h3 id="自回归滑动平均模型arma"><a class="markdownIt-Anchor" href="#自回归滑动平均模型arma"></a> 自回归滑动平均模型ARMA</h3><h4 id="armapqx_tbeta_1-x_t-1ldotsbeta_p-x_t-pe_talpha_1-e_t-1alpha_2-e_t-2ldotsalpha_q-e_t-q"><a class="markdownIt-Anchor" href="#armapqx_tbeta_1-x_t-1ldotsbeta_p-x_t-pe_talpha_1-e_t-1alpha_2-e_t-2ldotsalpha_q-e_t-q"></a> ▲ARMA（p,q）:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>β</mi><mrow><mi>p</mi></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mrow><mn>1</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>α</mi><mrow><mn>2</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>α</mi><mrow><mi>q</mi></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{t}=\beta_{1} X_{t-1}+\ldots+\beta_{p} X_{t-p}+e_{t}+\alpha_{1} e_{t-1}+\alpha_{2} e_{t-2}+\ldots+\alpha_{q} e_{t-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></h4><p>ARMA（p,q）模型就是AR（p）和MA（q）模型的组合</p><p>ARMA模型是更普遍的一类模型</p><p>模型特征：</p><ul><li>趋势性：无</li><li>相关性：有</li><li>随机性：有</li></ul><h4 id="arma11"><a class="markdownIt-Anchor" href="#arma11"></a> ▲ARMA(1,1)：</h4><p>通过查看自相关函数ACF和偏自相关函数PACF识别相关性<br>ACF呈指数下降趋势<br>PACF呈现指数下降趋势</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5CB3.jpg" alt="B3"></p><p>Q:如何识别一个ARMA的阶数p和q?</p><p>A:<br>1.由于ACF与PACF均呈现指数下降，判断阶数需要靠不断尝试<br>2.在模型的不同尝试中，通过选择AIC较小的为最优模型<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>I</mi><mi>C</mi><mo>=</mo><mn>2</mn><mi>k</mi><mo>+</mo><mi>n</mi><mo>∗</mo><mi>ln</mi><mo>(</mo><mfrac><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><mrow><mi>n</mi></mrow></mfrac><mo>)</mo></mrow><annotation encoding="application/x-tex">A I C=2 k+n * \ln (\frac{R S S}{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.872331em;"></span><span class="strut bottom" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">+</span><span class="mord mathit">n</span><span class="mbin">∗</span><span class="mop">ln</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.05764em;">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>k为参教数量，RSS为残差平方和</p><h3 id="armaarma模型识别"><a class="markdownIt-Anchor" href="#armaarma模型识别"></a> AR，MA，ARMA模型识别</h3><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5Canalyse.jpg" alt="analyse"></p><hr><h3 id="arima模型"><a class="markdownIt-Anchor" href="#arima模型"></a> ARIMA模型</h3><p>ARIMA是在ARMA基础上发展而来的更加综合性的模型，体现为：<br>■ 趋势性<br>■ 序列相关性<br>■  随机性<br>ARIMA是不平稳的时间序列，不能直接用ARMA建模。ARIMA模型是在ARMA模型演变出来的，它实际上是先对数据做了差分，之后再使用ARMA模型；换句话说，ARIMA模型是先将非平稳数据变得平稳（用差分），之后再用ARMA模型处理平稳数据</p><p>ARIMA（1，1，0）的时间序列：<br>序列有很强的趋势性</p><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5Carima1.jpg" alt="arima1"></p><ul><li>ARIMA（1，1，0）的序列相关性：<br>ACF下降极其缓慢</li></ul><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5Carima2.jpg" alt="arima2"></p><ul><li>ARIMA（1，1，0）的序列图和ACF：</li></ul><p><img src="/2019/07/29/时间序列概念及主要模型/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A6%82%E5%BF%B5%E5%8F%8A%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9E%8B%5Carima3.jpg" alt="arima3"></p><p>ARIMA(p,d,q)</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mrow><mi>d</mi></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>B</mi><msup><mo>)</mo><mrow><mi>d</mi></mrow></msup><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>Y</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\nabla_{d} X_{t}=(1-B)^{d} X_{t}=Y_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">∇</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>1</mn></mrow></msub><msub><mi>Y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>β</mi><mrow><mi>p</mi></mrow></msub><msub><mi>Y</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mrow><mn>1</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>α</mi><mrow><mn>2</mn></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>α</mi><mrow><mi>q</mi></mrow></msub><msub><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{t}=\beta_{1} Y_{t-1}+...+\beta_{p} Y_{t-p}+e_{t}+\alpha_{1} e_{t-1}+\alpha_{2} e_{t-2}+\ldots+\alpha_{q} e_{t-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05278em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li><li>差分后的序列符合ARMA（p，g）</li></ul><p>符号△为差分算子，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mrow><mi>d</mi></mrow></msub><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\nabla_{d} X_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">∇</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>代表d阶差分序列</p><p>一阶差分序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>B</mi><msup><mo>)</mo><mrow><mo>∗</mo></mrow></msup><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>X</mi><mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta X_{t}=(1-B)^{*} X_{t}=X_{t}-X_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Δ</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">∗</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p><h2 id="预测的评价指标"><a class="markdownIt-Anchor" href="#预测的评价指标"></a> 预测的评价指标</h2><p>ME（误差）：Mean（Actual-Predict）<br>MAE（绝对误差）：Mean（abs（Actual-Predict））<br>MAPE（百分比误差）：Mean（abs（Actual-Predict/Actual）<br>MSE（均方误差平方和）：Mean（（Actual-Predict）2）<br>RMSE（标准差）：Sqrt（Mean（（Actual-Predict）A2））</p><p>在模型选择方法上，通常会结合客户的建议以及其他的时间序列模型方法，选择某个评价指标，进而选择使该评价指标最小的模型方法</p><p>参考:<a href="https://blog.csdn.net/weixin_41636030/article/details/89115370" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41636030/article/details/89115370</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;时间序列概念及主要模型&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#时间序列概念及主要模型&quot;&gt;&lt;/a&gt; 时间序列概念及主要模型&lt;/h1&gt;
&lt;p&gt;Q:什么是时间序列分析?&lt;br&gt;
A:时间序列是按照时间顺序，按照一定时间间隔取得的一系列
      
    
    </summary>
    
    
      <category term="数学建模" scheme="https://nymrli.top/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/"/>
    
  </entry>
  
</feed>
