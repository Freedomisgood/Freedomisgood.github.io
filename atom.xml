<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mrli&#39;s Blog</title>
  
  <subtitle>åˆ«è£…ä½œå¾ˆåŠªåŠ›ï¼Œç»“å±€ä¸ä¼šé™ªä½ æ¼”æˆã€‚</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://nymrli.top/"/>
  <updated>2022-04-02T15:56:34.396Z</updated>
  <id>https://nymrli.top/</id>
  
  <author>
    <name>Mrli</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•</title>
    <link href="https://nymrli.top/2022/03/29/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/</id>
    <published>2022-03-29T09:54:46.000Z</published>
    <updated>2022-04-02T15:56:34.396Z</updated>
    
    <content type="html"><![CDATA[<h2 id="taobao_seckill"><a class="markdownIt-Anchor" href="#taobao_seckill"></a> <strong><a href="https://github.com/jerry3747/taobao_seckill" target="_blank" rel="noopener"> taobao_seckill</a></strong></h2><blockquote><p>æ·˜å®ç§’æ€ç‰©å“ï¼šåˆ†ä¸ºseleniumç‰ˆå’Œrequestç½‘ç»œè¯·æ±‚ç‰ˆï¼Œå¾®å°çš„åŒºåˆ«åœ¨äºï¼Œapiå…ˆè¯·æ±‚çš„æ˜¯è´­ç‰©è½¦çš„ç‰©å“ä¿¡æ¯ï¼Œseleniumåˆ™æ˜¯å‹¾é€‰é€‰æ‹©æ¡†ã€‚</p><p>æµç¨‹å¤§è‡´éƒ½ç›¸åŒï¼šâ‘ keep_waitç­‰å¾…ä¸´è¿‘æŠ¢è´­æ—¶é—´-----&gt;â‘¡å°†éœ€è¦çš„ä¿¡æ¯ç¼“å­˜ä½ï¼Œä¸å†åˆ·æ–°ï¼ˆæ¯”å¦‚è¦æŠ¢è´­çš„ç‰©å“ä¿¡æ¯ã€cookiesâ€¦ï¼‰-----&gt;â‘¢è¿›è¡Œç»“ç®—(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘£æäº¤è®¢å•(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘¤æ”¯ä»˜è®¢å•(/ç‚¹å‡»æŒ‰é’®)ï¼›</p></blockquote><ul><li><p><a href="https://www.cnblogs.com/amiza/p/10175543.html" target="_blank" rel="noopener">ä½¿ç”¨browsercookieæ¥ç®¡ç†æµè§ˆå™¨cookies</a>â€”â€”ä»æµè§ˆå™¨æå–ä¿å­˜çš„cookiesçš„å·¥å…·ã€‚å®ƒæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„çˆ¬è™«å·¥å…·ï¼Œé€šè¿‡åŠ è½½ä½ æµè§ˆå™¨çš„cookiesåˆ°ä¸€ä¸ªcookiejarå¯¹è±¡é‡Œé¢ï¼Œè®©ä½ è½»æ¾ä¸‹è½½éœ€è¦ç™»å½•çš„ç½‘é¡µå†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cj = browsercookie.chrome()<span class="comment"># browsercookie.load() åœ¨ä¸çŸ¥é“æˆ–è€…ä¸å…³å¿ƒæµè§ˆå™¨æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(url, cookies=cj)</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½œä¸ºå¼€å‘è€…çš„æˆ‘ä»¬éƒ½æ˜¯å°†cookiesæ‰‹åŠ¨å†™å…¥æˆ–è€…æ˜¯ä¼ å…¥ç¨‹åºçš„ï¼Œè€Œbrowsercookieç”¨é€”ï¼Œæˆ‘æƒ³å¯ä»¥æ˜¯å°†éœ€è¦ä¼ å…¥cookiesçš„ç¨‹åºæ‰“åŒ…ç»™ä¸ä¼šæå–Cookiesçš„ç”¨æˆ·ä½¿ç”¨ã€‚ï¼ˆç±»ä¼¼é€šè¿‡seleniumç™»é™†åï¼Œæ‹¿å–cookieså†å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¿™è¾¹æ˜¯è®©/å€ŸåŠ©ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨æ¥æ‹¿å–cookiesï¼‰</p></li><li><p>ä½¿ç”¨tkinteræ­å»ºç®€å•çš„GUIï¼šç‚¹å‡»â€œå¼€å§‹â€çš„æŒ‰é’®åä¼šå°†å¯†ç æ¡†å’ŒæŠ¢è´­è®¾ç½®æ—¶é—´æ¡†çš„å†…å®¹ä¼ å…¥ï¼Œä½œä¸ºå®ä¾‹åŒ–ChromeDriverSpiderçš„å‚æ•°ï¼Œå¹¶è¿è¡Œå®ä¾‹çš„sec_killæ–¹æ³•å¼€å§‹æ‰§è¡ŒæŠ¢è´­</p></li><li><p>é…ç½®chromeDriverå¯åŠ¨é…ç½®é¡¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_chrome_options</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""é…ç½®å¯åŠ¨é¡¹"""</span></span><br><span class="line">    chrome_options = webdriver.ChromeOptions()</span><br><span class="line">    chrome_options.accept_untrusted_certs = <span class="keyword">True</span></span><br><span class="line">    chrome_options.assume_untrusted_cert_issuer = <span class="keyword">True</span></span><br><span class="line">    arguments = [<span class="string">'--no-sandbox'</span>, <span class="string">'--disable-impl-side-painting'</span>, <span class="string">'--disable-setuid-sandbox'</span>, <span class="string">'--disable-seccomp-filter-sandbox'</span>,</span><br><span class="line">    <span class="string">'--disable-breakpad'</span>, <span class="string">'--disable-client-side-phishing-detection'</span>, <span class="string">'--disable-cast'</span>,</span><br><span class="line">    <span class="string">'--disable-cast-streaming-hw-encoding'</span>, <span class="string">'--disable-cloud-import'</span>, <span class="string">'--disable-popup-blocking'</span>,</span><br><span class="line">    <span class="string">'--ignore-certificate-errors'</span>, <span class="string">'--disable-session-crashed-bubble'</span>, <span class="string">'--disable-ipv6'</span>,</span><br><span class="line">    <span class="string">'--allow-http-screen-capture'</span>, <span class="string">'--start-maximized'</span>]</span><br><span class="line">    <span class="keyword">for</span> arg <span class="keyword">in</span> arguments:</span><br><span class="line">    chrome_options.add_argument(arg)</span><br><span class="line">    chrome_options.add_argument(<span class="string">f'--user-agent=<span class="subst">&#123;choice(get_useragent_data())&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> chrome_options</span><br></pre></td></tr></table></figure></li></ul><h2 id="taobao_api"><a class="markdownIt-Anchor" href="#taobao_api"></a> <strong><a href="https://github.com/gaoxt/taobao_api" target="_blank" rel="noopener">taobao_api</a></strong></h2><blockquote><p>seleniumå’Œapiç»“åˆï¼šç™»é™†é€»è¾‘ä½¿ç”¨äº†seleniumï¼Œåˆ·æ–°è´­ç‰©è½¦å’Œä¸‹å•è°ƒç”¨äº†æ‰‹æœºæ·˜å®taobao_apiï¼Œè‡ªåŠ¨ä»˜æ¬¾ä¹Ÿä½¿ç”¨äº†seleniumï¼Œèƒ½è‡ªåŠ¨æ¨¡æ‹Ÿè§¦æ‘¸è¾“å…¥å¯†ç ä»˜æ¬¾ï¼Œæ¥å£ç­¾åsignç”Ÿæˆæ–¹æ³•å‚è€ƒget_sign_valã€‚</p></blockquote><ul><li><p>åŒæ­¥é˜¿é‡Œäº‘æ—¶é—´æœåŠ¡å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸€æ¬¡æ€§è®¾ç½®</span></span><br><span class="line">sudo sntp -sS ntp.aliyun.com</span><br><span class="line"><span class="comment">#æ°¸ä¹…è®¾ç½®</span></span><br><span class="line">sudo systemsetup -setnetworktimeserver ntp.aliyun.com</span><br><span class="line">sudo systemsetup -setusingnetworktime on</span><br></pre></td></tr></table></figure></li><li><p>å±•ç¤ºQRCode</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment"># æ‰¾åˆ°äºŒç»´ç å›¾ç‰‡çš„é“¾æ¥</span></span><br><span class="line">   img = WebDriverWait(browser, <span class="number">2</span>, <span class="number">0.1</span>).until(</span><br><span class="line">       EC.presence_of_element_located((By.XPATH, <span class="string">"//div[@id='J_QRCodeImg']/img"</span>))).get_attribute(<span class="string">'src'</span>)</span><br><span class="line">   <span class="comment"># è·å¾—å›¾ç‰‡å­—èŠ‚æµå†…å®¹</span></span><br><span class="line">   img_content = requests.get(img, timeout=<span class="number">5</span>).content</span><br><span class="line">   <span class="comment"># ä¿å­˜åˆ°æœ¬åœ°å›¾ç‰‡ä¸­</span></span><br><span class="line">   file_name = <span class="string">'taobao_qrcode.png'</span></span><br><span class="line">   fp = open(file_name, <span class="string">'wb'</span>)</span><br><span class="line">   fp.write(img_content)</span><br><span class="line">   fp.close()</span><br><span class="line"><span class="comment"># å°†å…¶è§£ç æˆé“¾æ¥ï¼Œ pyzbarä¸ºäºŒç»´ç å’Œæ¡å½¢ç åº“ ==&gt; ä¸ªäººè§‰å¾—ä¿å­˜åå¯ä»¥ç›´æ¥è½¬æˆPILçš„Imageç„¶åimg.show()</span></span><br><span class="line">   <span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">   barcode_url = <span class="string">''</span></span><br><span class="line">   barcodes = decode(Image.open(file_name))</span><br><span class="line">   <span class="keyword">for</span> barcode <span class="keyword">in</span> barcodes:</span><br><span class="line">       <span class="comment"># è§£æè·å¾—äºŒç»´ç åçš„å†…å®¹ï¼›å¦‚æœæ˜¯æ¡å½¢ç ï¼Œåˆ™è¿”å›æ¡å½¢ç æ•°</span></span><br><span class="line">       barcode_url = barcode.data.decode(<span class="string">"utf-8"</span>)</span><br><span class="line"><span class="comment"># ç”ŸæˆäºŒç»´ç å¹¶é€šè¿‡æ§åˆ¶å°æ‰“å°</span></span><br><span class="line">   qr = qrcode.QRCode()</span><br><span class="line">   qr.add_data(barcode_url)</span><br><span class="line">   qr.print_ascii(invert=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<a href="http://zbar.sourceforge.net/" target="_blank" rel="noopener">ZBar</a>æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å¥—ä»¶ï¼Œç”¨äºä»å„ç§æ¥æºï¼ˆå¦‚è§†é¢‘æµã€å›¾åƒæ–‡ä»¶å’ŒåŸå§‹å¼ºåº¦ä¼ æ„Ÿå™¨ï¼‰è¯»å–æ¡å½¢ç ï¼›<code>pyzbar</code> æ˜¯é€šè¿‡ <code>Python2</code>å’Œ<code>3</code>æ¥å£ï¼Œä½¿ç”¨ <code>ZBar</code> åº“è¯»å–ä¸€ç»´æ¡å½¢ç å’ŒQRç  ã€‚=&gt;<a href="https://blog.csdn.net/qq_37924224/article/details/109582507" target="_blank" rel="noopener">è¯»å–æ¡å½¢ç </a>ã€<a href="https://blog.csdn.net/hxj0323/article/details/112969622" target="_blank" rel="noopener">è¯»å–äºŒç»´ç </a></p></li></ul><h2 id="jd_seckill"><a class="markdownIt-Anchor" href="#jd_seckill"></a> <strong><a href="https://github.com/andyzys/jd_seckill" target="_blank" rel="noopener">jd_seckill</a></strong></h2><blockquote><ol><li>é¢„çº¦å•†å“</li><li>ç§’æ€æŠ¢è´­å•†å“: â‘ <strong>è®¿é—®</strong>å•†å“çš„æŠ¢è´­<strong>é“¾æ¥</strong>ï¼ˆç”¨äºè®¾ç½®cookieç­‰â€”&gt;â‘¡è®¿é—®æŠ¢è´­è®¢å•<strong>ç»“ç®—é¡µé¢</strong>----&gt;â‘¢<strong>æäº¤æŠ¢</strong>è´­ï¼ˆç§’æ€ï¼‰<strong>è®¢å•</strong> [_get_seckill_order_dataç”Ÿæˆæäº¤æŠ¢è´­è®¢å•æ‰€éœ€çš„è¯·æ±‚ä½“å‚æ•°ã€è·å–ç§’æ€åˆå§‹åŒ–ä¿¡æ¯ï¼ˆåŒ…æ‹¬ï¼šåœ°å€ï¼Œå‘ç¥¨ï¼Œtokenï¼‰]</li></ol></blockquote><ul><li><p>ä»UAListä¸­é€šè¿‡<code>random.choice(USER_AGENTS)</code>éšæœºUA</p></li><li><p>ä½¿ç”¨å†…ç½®configparseræ¨¡å—è§£æconfig.ini</p><ul><li>RawConfigParseræ˜¯æœ€åŸºç¡€çš„INIæ–‡ä»¶è¯»å–ç±»ï¼›ConfigParserã€SafeConfigParser<a href="https://blog.csdn.net/miner_k/article/details/77857292" target="_blank" rel="noopener">æ”¯æŒå¯¹%(value)så˜é‡çš„è§£æ</a>ï¼ŒSafeConfigParserç±»å®ç°äº†ConfigParserç›¸åŒçš„æ¥å£ï¼Œæ–°å¢å¦‚ä¸‹æ–¹æ³•ï¼šsetå­˜åœ¨ä¿å­˜çš„æ–¹æ³•</li><li>sectionä¸‹çš„option(key)å¯ä»¥ä¸å¡«valueå€¼ï¼Œå³ä¸ºç©ºã€‚</li><li>from: <a href="https://blog.csdn.net/tianzhu123/article/details/6893755" target="_blank" rel="noopener">pythonä¸­RawConfigParserç±»ã€ConfigParserç±»ã€SafeConfigParserç±»ä¸­å‡½æ•°ä»‹ç»</a>ã€</li></ul></li><li><p>å¤šè¿›ç¨‹æ± ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ProcessPoolExecutor(work_count) <span class="keyword">as</span> pool:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(work_count):</span><br><span class="line">        pool.submit(self.seckill)</span><br></pre></td></tr></table></figure></li><li><p>ç§’æ€æ—¶é—´æ¯”è¾ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buy_time = datetime.strptime(global_config.getRaw(<span class="string">'config'</span>,<span class="string">'buy_time'</span>), <span class="string">"%Y-%m-%d %H:%M:%S.%f"</span></span><br><span class="line">now_time = datetime.now</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> now_time() &gt;= buy_time:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure></li><li><p><a href="https://github.com/woxiqingxian/jd_seckill/pull/2/commits/63a41a0609912d5643bc11f3419fe7dd8e84a00a" target="_blank" rel="noopener">è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´</a>ï¼š<code>https://api.m.jd.com/client.action?functionId=queryMaterialProducts&amp;client=wh5</code></p></li></ul><h2 id="jd-assistant"><a class="markdownIt-Anchor" href="#jd-assistant"></a> <strong><a href="https://github.com/tychxn/jd-assistant" target="_blank" rel="noopener">jd-assistantâ˜…</a></strong></h2><blockquote><p>æ˜¯<a href="#jd_seckill">jd_seckill</a>çš„ä¼˜åŒ–è¿›é˜¶ç‰ˆæœ¬</p><ul><li><p>æ™®é€šå•†å“è´­ä¹°ä¸»è¦æµç¨‹ï¼š<code>(1)æ¸…ç©ºè´­ç‰©è½¦</code> --&gt; <code>(2)æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</code> --&gt; <code>(3)æäº¤è®¢å•</code></p></li><li><p>é¢„çº¦æŠ¢è´­å•†å“ç‰¹ç‚¹ï¼š</p><ol><li>éœ€è¦æå‰ç‚¹å‡»é¢„çº¦</li><li>å¤§éƒ¨åˆ†æ­¤ç±»å•†å“åœ¨é¢„çº¦åè‡ªåŠ¨åŠ å…¥è´­ç‰©è½¦ï¼Œä½†æ˜¯æ— æ³•å‹¾é€‰âœ“ï¼Œä¹Ÿæ— æ³•ï¸è¿›å…¥åˆ°ç»“ç®—é¡µé¢</li><li>åˆ°äº†æŠ¢è´­çš„æ—¶é—´ç‚¹åå°†å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œæ­¤æ—¶æ‰èƒ½å‹¾é€‰å¹¶ä¸‹å•</li></ol></li><li><p>æ™®é€šå•†å“ï¼šèƒ½åŠ å…¥è´­ç‰©è½¦ğŸ›’ï¼Œç„¶åè¿›å…¥è´­ç‰©è½¦ç»“ç®—ä¸‹å•.</p></li><li><p>æŠ¢è´­å•†å“ï¼šéœ€ææå‰é¢„çº¦ï¼Œå¼€å§‹æŠ¢è´­æ—¶æœ‰â€œç«‹å³æŠ¢è´­â€æŒ‰é’®ğŸ”˜ï¼Œç‚¹å‡»æŒ‰é’®åå•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œç„¶åç»“ç®—ä¸‹å•.</p></li></ul><p>â­ï¸æŠ¢è´­å—å¤šç§å› ç´ å½±å“ï¼š<strong>ç½‘é€Ÿã€è´¦å·è´¨é‡ã€è¿æ°”</strong>ç­‰ç­‰ï¼Œä»…ä¾›å¨±ä¹ï¼Œè®¤çœŸå°±è¾“äº†.</p></blockquote><ul><li><p>deprecatedã€check_loginè£…é¥°å™¨ï¼šä¼ å…¥äº†selfå‚æ•°ï¼Œå¹¶é€šè¿‡selfå®ä¾‹è°ƒç”¨äº†ç±»çš„å…¶ä»–æˆå‘˜æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_login</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="string">"""ç”¨æˆ·ç™»é™†æ€æ ¡éªŒè£…é¥°å™¨ã€‚è‹¥ç”¨æˆ·æœªç™»é™†ï¼Œåˆ™è°ƒç”¨æ‰«ç ç™»é™†"""</span></span><br><span class="line"><span class="meta">    @functools.wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_func</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.is_login:</span><br><span class="line">            logger.info(<span class="string">"&#123;0&#125; éœ€ç™»é™†åè°ƒç”¨ï¼Œå¼€å§‹æ‰«ç ç™»é™†"</span>.format(func.__name__))</span><br><span class="line">            self.login_by_QRcode()</span><br><span class="line">        <span class="keyword">return</span> func(self, *args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> new_func</span><br></pre></td></tr></table></figure></li><li><p>å¯†ç åŠ å¯†â€”â€”<strong><a href="https://github.com/Legrandin/pycryptodome" target="_blank" rel="noopener">pycryptodome</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_pwd</span><span class="params">(password, public_key=RSA_PUBLIC_KEY)</span>:</span></span><br><span class="line">    rsa_key = RSA.importKey(public_key)</span><br><span class="line">    encryptor = Cipher_pkcs1_v1_5.new(rsa_key)</span><br><span class="line">    cipher = b64encode(encryptor.encrypt(password.encode(<span class="string">'utf-8'</span>)))</span><br><span class="line">    <span class="keyword">return</span> cipher.decode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure></li><li><p>æä¾›JSè„šæœ¬æ–‡ä»¶æ¥è·å–å•†å“çš„ä¿¡æ¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥ä¸‹ä»£ç åœ¨è®¢å•ç»“ç®—é¡µé¢çš„å¼€å‘è€…å·¥å…·Consoleä¸­æ‰§è¡Œï¼Œç”¨äºè·å–å¿…è¦çš„å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> eid = $(<span class="string">'#eid'</span>).val();</span><br><span class="line"><span class="keyword">var</span> fp = $(<span class="string">'#fp'</span>).val();</span><br><span class="line"><span class="keyword">var</span> trackId = getTakId();</span><br><span class="line"><span class="keyword">var</span> riskControl = $(<span class="string">'#riskControl'</span>).val();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`eid = <span class="subst">$&#123;eid&#125;</span>\nfp = <span class="subst">$&#123;fp&#125;</span>\ntrack_id = <span class="subst">$&#123;trackId&#125;</span>\nrisk_control = <span class="subst">$&#123;riskControl&#125;</span>`</span>);</span><br></pre></td></tr></table></figure></li><li><p>cookieséªŒè¯-é€šè¿‡è¯»å–æœ¬åœ°ä¿å­˜çš„cookiesæ—¶è¦å…ˆéªŒè¯ä¸‹cookiesæ˜¯å¦æœ‰æ•ˆï¼šrequestsåº“çš„ä½¿ç”¨æ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_validate_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""éªŒè¯cookiesæ˜¯å¦æœ‰æ•ˆï¼ˆæ˜¯å¦ç™»é™†ï¼‰</span></span><br><span class="line"><span class="string">    é€šè¿‡è®¿é—®ç”¨æˆ·è®¢å•åˆ—è¡¨é¡µè¿›è¡Œåˆ¤æ–­ï¼šè‹¥æœªç™»å½•ï¼Œå°†ä¼šé‡å®šå‘åˆ°ç™»é™†é¡µé¢ã€‚</span></span><br><span class="line"><span class="string">    :return: cookiesæ˜¯å¦æœ‰æ•ˆ True/False</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    url = <span class="string">'https://order.jd.com/center/list.action'</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">'rid'</span>: str(int(time.time() * <span class="number">1000</span>)),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = self.sess.get(url=url, params=payload, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == requests.codes.OK:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(e)</span><br><span class="line">    <span class="comment"># åˆ›å»ºæ–°çš„session</span></span><br><span class="line">    self.sess = requests.session()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure></li><li><p>äºŒç»´ç ç™»å½•ï¼šä¸‹è½½äºŒç»´ç <code>_get_QRcode</code>â€“&gt;è¯¢é—®è·å–äºŒç»´ç æ‰«æçŠ¶æ€<code>_get_QRcode_ticket</code>â€”&gt;éªŒè¯äºŒç»´ç ä¿¡æ¯(<code>_validate_QRcode_ticket</code>)â€“&gt;è®¾ç½®<code>is_login=Trueå’Œsave_cookies</code>ï¼ˆäºŒç»´ç æœ‰æ•ˆæœŸçº¦120sï¼Œæµè§ˆå™¨å¤§çº¦2så‘é€ä¸€ä¸ªè¯·æ±‚è¯¢é—®æ‰«æçŠ¶æ€ï¼‰â€”â€”çœ‹ä»£ç æ˜¯assistantå‚è€ƒäº†2018å¹´çš„**<a href="https://github.com/adyzng/jd-autobuy" target="_blank" rel="noopener">jd-autobuy</a>**</p></li><li><p>æ‰«æäºŒç»´ç ï¼šå†™å…¥å›¾ç‰‡å’Œæ‰“å¼€å›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_image</span><span class="params">(resp, image_file)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(image_file, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># ä»ç½‘ç»œè¯·æ±‚ä¸­ä¸‹è½½å†…å®¹</span></span><br><span class="line">        <span class="keyword">for</span> chunk <span class="keyword">in</span> resp.iter_content(chunk_size=<span class="number">1024</span>):</span><br><span class="line">            f.write(chunk)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_image</span><span class="params">(image_file)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> os.name == <span class="string">"nt"</span>:</span><br><span class="line">        os.system(<span class="string">'start '</span> + image_file)  <span class="comment"># for Windows</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> os.uname()[<span class="number">0</span>] == <span class="string">"Linux"</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"deepin"</span> <span class="keyword">in</span> os.uname()[<span class="number">2</span>]:</span><br><span class="line">                os.system(<span class="string">"deepin-image-viewer "</span> + image_file)  <span class="comment"># for deepin</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                os.system(<span class="string">"eog "</span> + image_file)  <span class="comment"># for Linux</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            os.system(<span class="string">"open "</span> + image_file)  <span class="comment"># for Mac</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šåˆ¤æ–­æ“ä½œç³»ç»Ÿè¿˜å¯ä»¥å€ŸåŠ©å†…ç½®çš„platformåº“<code>platform.system().lower()</code>å¾—åˆ°[linuxã€windowsã€mac]</p></li></ul><p>â–²cookieså’ŒäºŒç»´ç ç»“åˆä½¿ç”¨ï¼š</p><ol><li>å¦‚æœç™»é™†æˆåŠŸåˆ™å§cookiesæŒä¹…åŒ–</li><li>ä½¿ç”¨äºŒç»´ç ç™»é™†å‰ï¼Œå…ˆåŠ è½½éªŒè¯ä¹‹å‰æŒä¹…åŒ–çš„cookiesæ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæœ‰æ•ˆåˆ™æ— éœ€å†æ¬¡æ‰«ç ç™»é™†(åœ¨QRCode_loginçš„èµ·å§‹ä½ç½®åˆ¤æ–­validationä¸­ä¿®æ”¹çš„is_loginæ˜¯å¦ä¸ºTrue)</li></ol><h2 id="jd-seckill-maotai"><a class="markdownIt-Anchor" href="#jd-seckill-maotai"></a> <strong><a href="https://github.com/hello8817/jd-seckill-maotai" target="_blank" rel="noopener"> jd-seckill-maotai</a></strong></h2><blockquote><ul><li><h2 id="ä¸»è¦åŠŸèƒ½"><a class="markdownIt-Anchor" href="#ä¸»è¦åŠŸèƒ½"></a> ä¸»è¦åŠŸèƒ½</h2><ul><li>ç™»é™†äº¬ä¸œå•†åŸï¼ˆ<a href="http://www.jd.com" target="_blank" rel="noopener">www.jd.com</a>ï¼‰<ul><li>ç”¨äº¬ä¸œAPPæ‰«ç ç»™å‡ºçš„äºŒç»´ç </li></ul></li><li>é¢„çº¦èŒ…å°<ul><li>å®šæ—¶è‡ªåŠ¨é¢„çº¦</li></ul></li><li>ç§’æ€é¢„çº¦åç­‰å¾…æŠ¢è´­<ul><li>å®šæ—¶å¼€å§‹è‡ªåŠ¨æŠ¢è´­</li></ul></li></ul></li></ul><p><strong>ç‰¹åˆ«å£°æ˜ï¼š</strong></p><ul><li>æœ¬ä»“åº“å‘å¸ƒçš„<code>jd_seckill_maotai</code>é¡¹ç›®ä¸­æ¶‰åŠçš„ä»»ä½•è„šæœ¬ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚</li><li>æœ¬é¡¹ç›®å†…æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç¦æ­¢ä»»ä½•å…¬ä¼—å·ã€è‡ªåª’ä½“è¿›è¡Œä»»ä½•å½¢å¼çš„è½¬è½½ã€å‘å¸ƒã€‚</li><li><code>ChinaVolvocars</code> å¯¹ä»»ä½•è„šæœ¬é—®é¢˜æ¦‚ä¸è´Ÿè´£ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç”±ä»»ä½•è„šæœ¬é”™è¯¯å¯¼è‡´çš„ä»»ä½•æŸå¤±æˆ–æŸå®³.</li><li>è¯·å‹¿å°†<code>jd_seckill_maotai</code>é¡¹ç›®çš„ä»»ä½•å†…å®¹ç”¨äºå•†ä¸šæˆ–éæ³•ç›®çš„ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚</li><li>å¦‚æœä»»ä½•å•ä½æˆ–ä¸ªäººè®¤ä¸ºè¯¥é¡¹ç›®çš„è„šæœ¬å¯èƒ½æ¶‰å«Œä¾µçŠ¯å…¶æƒåˆ©ï¼Œåˆ™åº”åŠæ—¶é€šçŸ¥å¹¶æä¾›èº«ä»½è¯æ˜ï¼Œæ‰€æœ‰æƒè¯æ˜ï¼Œæˆ‘ä»¬å°†åœ¨æ”¶åˆ°è®¤è¯æ–‡ä»¶ååˆ é™¤ç›¸å…³è„šæœ¬ã€‚</li><li>æ‚¨å¿…é¡»åœ¨ä¸‹è½½åçš„24å°æ—¶å†…ä»è®¡ç®—æœºæˆ–æ‰‹æœºä¸­å®Œå…¨åˆ é™¤ä»¥ä¸Šå†…å®¹ã€‚</li><li>æœ¬é¡¹ç›®éµå¾ª<code>GPL-3.0 License</code>åè®®ï¼Œå¦‚æœæœ¬ç‰¹åˆ«å£°æ˜ä¸<code>GPL-3.0 License</code>åè®®æœ‰å†²çªä¹‹å¤„ï¼Œä»¥æœ¬ç‰¹åˆ«å£°æ˜ä¸ºå‡†ã€‚</li><li><em><strong>æ‚¨ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em><br><em><strong>æ‚¨åœ¨æœ¬å£°æ˜æœªå‘å‡ºä¹‹æ—¶ç‚¹ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ä¸”æ­¤æ—¶è¿˜åœ¨ä½¿ç”¨ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em></li></ul></blockquote><blockquote><p>æ ¹æ®12æœˆ14æ—¥ä»¥æ¥æŠ¢èŒ…å°çš„æ—¥å¿—åˆ†æï¼Œå¤§èƒ†æ¨æ–­å†æ¥å†å‰è¿”å›Jsonæ¶ˆæ¯ä¸­<code>resultCode</code>ä¸<strong>å°ç™½ä¿¡ç”¨</strong>çš„å…³ç³»ã€‚<br>è¿™é‡Œä¸»è¦åˆ†æå‡ºç°é¢‘ç‡æœ€é«˜çš„<code>90016</code>å’Œ<code>90008</code>ã€‚</p><table><thead><tr><th>æ¡ˆä¾‹</th><th>å°ç™½ä¿¡ç”¨</th><th>90016</th><th>90008</th><th>æŠ¢åˆ°è€—æ—¶</th></tr></thead><tbody><tr><td>å¼ ä¸‰</td><td>63.8</td><td>59.63%</td><td>40.37%</td><td>æš‚æœªæŠ¢åˆ°</td></tr><tr><td>æå››</td><td>92.9</td><td>72.05%</td><td>27.94%</td><td>4å¤©</td></tr><tr><td>ç‹äº”</td><td>99.6</td><td>75.70%</td><td>24.29%</td><td>æš‚æœªæŠ¢åˆ°</td></tr><tr><td>èµµå…­</td><td>103.4</td><td>91.02%</td><td>8.9%</td><td>2å¤©</td></tr></tbody></table><p>é£æ§æ”¾è¡Œåæ‰ä¼šè¿›è¡ŒæŠ¢è´­ï¼Œè¿™æ—¶å€™ç”¨çš„åº”è¯¥æ˜¯æ°´åº“è®¡æ•°æ¨¡å‹ï¼Œå‡è®¾æ— æ³•ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰æ•°æ®çš„æƒ…å†µä¸‹æ¥å°½é‡çš„åšåˆ°æŠ¢è´­æˆåŠŸç”¨æˆ·çš„å‡åŒ€åˆ†å¸ƒï¼Œè¿™æ ·å°±å’Œæ¦‚ç‡ç›¸å…³äº†ã€‚</p><p><strong>æŠ¢è´­ç»“æœç¡®è®¤</strong></p><p>æŠ¢è´­æ˜¯å¦æˆåŠŸé€šå¸¸åœ¨ç¨‹åºå¼€å§‹çš„ä¸€åˆ†é’Ÿå†…å¯è§åˆ†æ™“ï¼<br>æœç´¢æ—¥å¿—ï¼Œå‡ºç°â€œæŠ¢è´­æˆåŠŸï¼Œè®¢å•å·xxxxx&quot;ï¼Œä»£è¡¨æˆåŠŸæŠ¢åˆ°äº†ï¼ŒåŠ¡å¿…åŠå°æ—¶å†…æ”¯ä»˜è®¢å•ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼<br>è‹¥ä¸¤åˆ†é’Ÿè¿˜æœªæŠ¢è´­æˆåŠŸï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ²¡æŠ¢åˆ°ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼</p></blockquote><ul><li><p>åœ¨ç¨‹åºå¼€å§‹è¿è¡Œåï¼Œä¼šæ£€æµ‹æœ¬åœ°æ—¶é—´ä¸äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ï¼Œè¾“å‡ºçš„å·®å€¼ä¸ºã€æœ¬åœ°æ—¶é—´-äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ã€‘ï¼Œå³-50ä¸ºæœ¬åœ°æ—¶é—´æ¯”äº¬ä¸œæœåŠ¡å™¨æ—¶é—´æ…¢50msã€‚ æœ¬ä»£ç çš„æ‰§è¡Œçš„æŠ¢è´­æ—¶é—´ä»¥æœ¬åœ°ç”µè„‘/æœåŠ¡å™¨æ—¶é—´ä¸ºå‡†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, ...)</span>:</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®</span></span><br><span class="line">self.diff_time = self.local_time() - self.jd_time()</span><br><span class="line"><span class="comment"># ....</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="comment"># æœ¬åœ°æ—¶é—´å‡å»ä¸äº¬ä¸œçš„æ—¶é—´å·®(ms)ï¼Œèƒ½å¤Ÿå°†æ—¶é—´è¯¯å·®æå‡åˆ°0.1ç§’é™„è¿‘, å…·ä½“ç²¾åº¦ä¾èµ–è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´çš„ç½‘ç»œæ—¶é—´æŸè€—</span></span><br><span class="line">    <span class="keyword">if</span> self.local_time() - self.diff_time &gt;= self.buy_time_ms:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure><p>è¡¥å……ï¼šPythonçš„æ—¶é—´æˆ³é»˜è®¤éƒ½æ˜¯ç§’çº§åˆ«çš„ï¼Œå¦‚æœè¦msçº§åˆ«çš„ï¼Œåˆ™è¦ä¹˜ä»¥1000</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡timeï¼Œä»¥å…ƒç»„ï¼ˆstruct_timeï¼‰ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># è·å¾—10ä½ç§’çº§æ—¶é—´æˆ³</span></span><br><span class="line">seconds = time.time()</span><br><span class="line"><span class="comment"># è·å¾—13ä½æ¯«ç§’çº§æ—¶é—´æˆ³==&gt;javaé»˜è®¤13ä½</span></span><br><span class="line">millis = int(round(time.time() * <span class="number">1000</span>))</span><br><span class="line"><span class="comment"># åŒæ ·ï¼Œtimeä¸‹çš„mktimeä¹Ÿéœ€è¦*1000</span></span><br><span class="line">time.mktime(self.buy_time.timetuple()) * <span class="number">1000.0</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡datetimeï¼Œä»¥datetimeç±»å®ä¾‹å¯¹è±¡ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># è·å¾—å½“å‰æ—¶é—´</span></span><br><span class="line">now = datetime.now()</span><br><span class="line">timestamp = datetime.timestamp(now)</span><br><span class="line">print(<span class="string">"æ—¶é—´æˆ³ ="</span>, timestamp)</span><br><span class="line"><span class="comment"># ä¹Ÿæ˜¯10ä½sçº§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1648622589.624272</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="jd_mask"><a class="markdownIt-Anchor" href="#jd_mask"></a> <strong><a href="https://github.com/Lasx/jd_mask" target="_blank" rel="noopener">jd_mask</a></strong></h2><blockquote><p>æ­¤toolåªå•ç‹¬æ”¯æŒ<strong>é¢„çº¦-æŠ¢è´­-æˆåŠŸåç›´æ¥æäº¤è®¢å•</strong>çš„å•†å“ï¼Œå¦‚[å£ç½©]ï¼Œåªæä¾›å­¦ä¹ å‚è€ƒç”¨é€”.</p></blockquote><p>â“‚ï¸é˜…è¯»äº†å¤šä»½äº¬ä¸œæŠ¢è´­çš„ä»£ç åï¼Œå‘ç°åŸºæœ¬éƒ½æ˜¯ä»ä¸€ä¸ªæ¨¡æ¿é‡Œä¸æ–­ä¼˜åŒ–å‘å±•å‡ºæ¥çš„ï¼Œååº”äº†å¼€æºçš„æ„ä¹‰ï¼Œä¹Ÿååº”äº†äº¬ä¸œéƒ¨åˆ†ç»†èŠ‚çš„ä¿®æ”¹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¾—åˆ°ä¸€ä¸ªå‘Šç¤ºï¼šåœ¨å®ç°ç›¸åŒåŠŸèƒ½å‰ï¼Œä¸å¦¨å¤šçœ‹çœ‹ã€å€Ÿé‰´ä¸‹ä»¥å¾€å¯è¡Œçš„ä»£ç ã€‚</p><h2 id="automatic_ticket_purchase"><a class="markdownIt-Anchor" href="#automatic_ticket_purchase"></a> <strong><a href="https://github.com/MakiNaruto/Automatic_ticket_purchase" target="_blank" rel="noopener">Automatic_ticket_purchase</a></strong></h2><p>å¤§éº¦ç½‘æŠ¢è´­æµç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[å¼€å§‹] --&gt; B(ç™»é™†)</span><br><span class="line">    B --&gt; C&#123;æ˜¯å¦åˆ©ç”¨cookiesç™»é™†&#125;</span><br><span class="line">    C --&gt; |å¦| D[é¡µé¢ç™»é™†]</span><br><span class="line">    C --&gt; |æ˜¯| E[ç™»é™†éªŒè¯]</span><br><span class="line">    D --&gt; E</span><br><span class="line">    E --&gt; G&#123;æ˜¯å¦ç™»é™†æˆåŠŸ&#125;</span><br><span class="line">    G --&gt; |æ˜¯| F[è·å–è´­ç¥¨å¿…è¦ä¿¡æ¯]</span><br><span class="line">    G --&gt; |å¦|ED</span><br><span class="line">    F --&gt; L[æ£€æµ‹æŠ¢ç¥¨ç°åœ¨è´­ç¥¨çŠ¶æ€]</span><br><span class="line">    L --&gt; M&#123;ç›®æ ‡ç¥¨å¯è¿›è¡ŒæŠ¢è´­&#125;</span><br><span class="line">    M --&gt; |å³å°†å¼€æŠ¢|L</span><br><span class="line">    M --&gt; |ç¼ºè´§ç™»è®°|ED((ç»“æŸ))</span><br><span class="line">M --&gt; |ç«‹åˆ»è´­ä¹°|N&#123;æŠ¢è´­&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è·Ÿé™æ—¶ã€å®šæ—¶ç§’æ€ä¸åŒçš„æ˜¯ï¼Œå¤§éº¦ç½‘çš„æŠ¢è´­ä¿¡æ¯æ˜¯é ä¸æ–­åˆ·æ–°çš„ï¼Œéœ€è¦é€šè¿‡ä¸æ–­æ£€æµ‹é¡µé¢å†…å®¹ï¼Œåˆ¤æ–­ç›®å‰ç¥¨çš„å¯å¦è´­ä¹°æƒ…å†µã€‚å¦‚æœåˆ·æ–°ä¸ºå¯è´­ä¹°åˆ™è¿›è¡ŒæŠ¢è´­è´­ä¹°ã€‚</p></blockquote><ul><li><p>ç‚¹å‡»è´­ä¹°æ˜¯å¯¹æŒ‡å®šæ¥å£å‘é€è¯·æ±‚ï¼Œå¹¶æ›´æ–°cookies(cookieså«Œå°‘ä¸å«Œå¤š)ï¼šstep2_click_buy_now</p></li><li><p>æäº¤è®¢å•ï¼šstep3_submit_order</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">response = self.session.post(<span class="string">'https://buy.damai.cn/multi/trans/createOrder'</span>,</span><br><span class="line">                             headers=headers,</span><br><span class="line">                             params=params,</span><br><span class="line">                             data=submit_order_info,</span><br><span class="line">                             cookies=self.login_cookies)</span><br><span class="line">buy_status = json.loads(response.text)</span><br><span class="line"><span class="keyword">if</span> buy_status.get(<span class="string">'success'</span>) <span class="keyword">is</span> <span class="keyword">True</span> <span class="keyword">and</span> buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>):</span><br><span class="line">    print(<span class="string">'-'</span> * <span class="number">10</span>, <span class="string">'æŠ¢ç¥¨æˆåŠŸ, è¯·å‰å¾€ å¤§éº¦ç½‘-&gt;æˆ‘çš„å¤§éº¦-&gt;äº¤æ˜“ä¸­å¿ƒ-&gt;è®¢å•ç®¡ç† ç¡®è®¤è®¢å•'</span>, <span class="string">'-'</span> * <span class="number">10</span>)</span><br><span class="line">    print(<span class="string">'alipayOrderId: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>))</span><br><span class="line">    print(<span class="string">'æ”¯ä»˜å®æ”¯ä»˜é“¾æ¥: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayWapCashierUrl'</span>))</span><br></pre></td></tr></table></figure></li></ul><h2 id="nikerobot"><a class="markdownIt-Anchor" href="#nikerobot"></a> <strong><a href="https://github.com/cxiaoer/NikeRobot" target="_blank" rel="noopener"> NikeRobot</a></strong></h2><ul><li><p>pdbè°ƒè¯•æ–­ç‚¹ï¼š==&gt;å®é™…ä¸ŠPycharmçš„è°ƒè¯•æ›´åŠ å¥½ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">pdb.set_trace()</span><br></pre></td></tr></table></figure></li><li><p>å°†ç±»æˆå‘˜å±æ€§è½¬æˆå­—å…¸å½¢å¼: <code>NikeLoginParam().__dict__</code></p></li><li><p>è‡ªå·±ç®¡ç†çº¿ç¨‹ï¼šåˆ›å»ºç»§æ‰¿Threadçš„æ‰§è¡Œç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œåœ¨mainä¸­è¿›è¡Œåˆ›å»ºå¤šä¸ªå®ä¾‹MyThread().start()ï¼Œå¹¶joinä½ã€‚</p></li></ul><h2 id="hpv4g"><a class="markdownIt-Anchor" href="#hpv4g"></a> <strong><a href="https://github.com/xiangmingzhe0928/hpv4g" target="_blank" rel="noopener">hpv4g</a></strong></h2><ul><li><p>æ˜¯å¦ä½¿ç”¨ä»£ç†ï¼š<code>init_ip_proxy_pool</code></p></li><li><p>å¤šçº¿ç¨‹å‚æ•°è®¾ç½®: python3.8ä¸­ThreadPoolExecutorçš„é»˜è®¤workerï¼š<code>max_workers = min(32, os.cpu_count() + 4)</code></p></li><li><p>çº¿ç¨‹æ± ï¼šThreadPoolExecutor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, FIRST_COMPLETED</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ThreadPoolExecutor(max_workers=max_workers) <span class="keyword">as</span> t:</span><br><span class="line">    fs = [t.submit(sec_kill_task, miao_miao, params[i % _params_len],</span><br><span class="line">                   <span class="keyword">None</span> <span class="keyword">if</span> <span class="keyword">not</span> _ip_proxys_len <span class="keyword">else</span> &#123;</span><br><span class="line">                       <span class="string">'http'</span>: <span class="keyword">None</span> <span class="keyword">if</span> (index := i % _ip_proxys_len) == <span class="number">0</span> <span class="keyword">else</span> ip_proxys[index]&#125;) <span class="keyword">for</span> i <span class="keyword">in</span></span><br><span class="line">          range(max_workers + <span class="number">5</span>)]</span><br><span class="line">    <span class="comment"># 120Såç»“æŸä»»åŠ¡, æœ‰ä¸€ä¸ªå®Œæˆåˆ™å®Œæˆ</span></span><br><span class="line">    wait(fs, <span class="number">120</span>, return_when=FIRST_COMPLETED)</span><br><span class="line">    <span class="keyword">global</span> KILL_FLAG</span><br><span class="line">    KILL_FLAG = <span class="keyword">True</span></span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;æœ¬è½®æœªæˆåŠŸç§’æ€åˆ°ç–«è‹—&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;'</span>)</span><br></pre></td></tr></table></figure></li><li><p>ç¼“å­˜é…ç½®â€”â€”éé»˜è®¤å‚æ•°çš„è£…é¥°å™¨ï¼šè€ƒè™‘æå‰ç¼“å­˜ç–«è‹—åˆ—è¡¨ ç§’æ€å¼€å§‹åè·³è¿‡æŸ¥è¯¢åˆ—è¡¨ç­‰æ“ä½œ ç›´æ¥è°ƒç”¨ç§’æ€æ¥å£</p></li><li><p>è·å–æœåŠ¡å™¨å½“å‰æ—¶é—´æˆ³</p></li><li><p>è®¾ç½®log</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># è®¾ç½®é…ç½®</span></span><br><span class="line">logging.basicConfig(handlers=[logging.FileHandler(filename=LOG_NAME,</span><br><span class="line">                                                  encoding=<span class="string">'utf-8'</span>, mode=<span class="string">'a+'</span>)],</span><br><span class="line">                    format=<span class="string">'%(asctime)s %(message)s'</span>,</span><br><span class="line">                    level=getattr(logging, args.log))</span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line">logging.info(<span class="string">"xxx"</span>)</span><br><span class="line">logging.debug(<span class="string">"yyy"</span>)</span><br></pre></td></tr></table></figure></li><li><p>argueparserä½¿ç”¨ï¼š</p><ul><li>actionå‚æ•°: <code>parser.add_argument('-reload_cache', action='store_true', help='åˆ·æ–°--region_codeç–«è‹—åˆ—è¡¨æœ¬åœ°ç¼“å­˜')</code>ï¼Œå‡ºç°reload_cacheå‚æ•°åˆ™ä¸ºtrueï¼Œæ‰€ä»¥é»˜è®¤ä¸ºfalse</li><li><code>parser.add_argument('--log', default='WARNING', choices=['DEBUG', 'INFO', 'WARNING', 'ERROR'],help='æ—¥å¿—çº§åˆ« é»˜è®¤WARNING')</code></li></ul></li><li><p>requestsä½¿ç”¨ï¼š</p><ul><li><p><code>raise_for_status</code>çŠ¶æ€ç éæˆåŠŸæ—¶æŠ›å‡ºå¼‚å¸¸</p></li><li><p>è‡ªå®šä¹‰<code>_get(url, params=None, error_exit=True, **kwargs)</code>æ–¹æ³•ï¼Œæ·»åŠ å‚æ•°ï¼šerror_exit:è¿”å›4XX 5XXé”™è¯¯æ—¶ æ˜¯å¦é€€å‡º</p></li><li><p>cookiesé™¤äº†æ”¾åœ¨requests.get(cookies=xxxCookieDict)ï¼Œè¿˜å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²è®¾ç½®åœ¨header[â€œ<strong>cookie</strong>â€]ä¸­ï¼ˆæ— sï¼‰ï¼Œå¦‚<code>self._headers[&quot;cookie&quot;]=&quot;k1=v1;_xxhm_=%7B%2x%7D;k3=wxapptoken:v3&quot;</code>ï¼Œé€šè¿‡<code>;</code>æ¥åˆ†å‰²</p></li><li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># disable ssl warnings</span></span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="æŠ¢è´­å‹ä»£ç æ€»ç»“"><a class="markdownIt-Anchor" href="#æŠ¢è´­å‹ä»£ç æ€»ç»“"></a> æŠ¢è´­å‹ä»£ç æ€»ç»“ï¼š</h2><ul><li><p>å®ç°ä¸»è¦åˆ†ä¸ºselenium(è‡ªåŠ¨æµ‹è¯•å·¥å…·)æ¨¡æ‹Ÿç‚¹å‡»ï¼›apiæ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</p></li><li><p>ç™»é™†ä¹‹åä¼šå¯¹cookiesè¿›è¡ŒæŒä¹…åŒ–ï¼Œä½¿ç”¨pickleçš„å¥½å¤„æ˜¯æ— æ³•æ˜æ–‡çœ‹æ‡‚ã€å¤åˆ¶</p></li><li><p>å¯ä»¥é€šè¿‡æŒä¹…åŒ–çš„cookiesæ¥ç™»é™†ï¼Œä½†ä¼šæ£€æµ‹cookiesæ˜¯å¦ä»ç„¶æœ‰æ•ˆ</p></li><li><p>å®šæ—¶æŠ¢è´­ä¼šç­‰å¾…sleepåˆ°ä¸´è¿‘æ—¶é—´(while True+sleep(time)çš„æ–¹å¼ or sleepUntil+while try)ï¼Œç„¶åå†è¿›è¡Œå¤šæ¬¡æŠ¢è´­è¯·æ±‚ï¼ˆå¦‚æœæŠ¢è´­çš„2åˆ†é’Ÿå†…æ²¡æŠ¢åˆ°ï¼Œå¤§å¤šæ²¡å¸Œæœ›äº†ï¼Œåªå¥½ç­‰å¾…ä¸‹æ¬¡ï¼‰ï¼›å¦‚æœæ˜¯<a href="#Automatic_ticket_purchase">ç­‰å¾…é¡µé¢åˆ·æ–°çš„</a>ï¼Œåˆ™ä¸æ–­è¯·æ±‚é¡µé¢ï¼Œç­‰åˆ°ç»“æœæ”¹å˜ã€‚</p><ul><li>æ³¨æ„ï¼šç­‰å¾…é—´éš”ä¸è¦è¶…è¿‡æ—¶é—´é˜ˆå€¼ï¼Œå¦‚180så‰æ£€æŸ¥ï¼Œå¦‚æœä¸ç¬¦åˆä¸èƒ½è®©å…¶ç­‰å¾…190s</li></ul></li><li><p>æ¨é€å·¥å…·ï¼šæä¾›ä¸€ä¸ªè‡ªå·±å†™çš„</p><p>config.ini</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[pusher]</span></span><br><span class="line"><span class="attr">pusher_type</span> = pushplus</span><br><span class="line"></span><br><span class="line"><span class="section">[serverchan]</span></span><br><span class="line"><span class="comment"># https://sct.ftqq.com/</span></span><br><span class="line"><span class="attr">sec_key</span> =</span><br><span class="line"></span><br><span class="line"><span class="section">[dingding]</span></span><br><span class="line"><span class="attr">access_token</span> =</span><br><span class="line"><span class="attr">secret</span> =</span><br><span class="line"></span><br><span class="line"><span class="section">[pushplus]</span></span><br><span class="line"><span class="comment"># http://www.pushplus.plus/</span></span><br><span class="line"><span class="attr">pushplus_token</span> = fedcf6b08f6f4aaeb2948b7d7010eb93</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">pusher.py</span><br><span class="line">  </span><br><span class="line">  ```python</span><br><span class="line">  import base64</span><br><span class="line">  import hashlib</span><br><span class="line">  import hmac</span><br><span class="line">  import os.path</span><br><span class="line">  import time</span><br><span class="line">  import urllib.parse</span><br><span class="line">  from datetime import date</span><br><span class="line">  from functools import reduce</span><br><span class="line">  </span><br><span class="line">  import requests</span><br><span class="line">  </span><br><span class="line">  CONFIG_INI_FILENAME = &quot;config.ini&quot;</span><br><span class="line">  REMIND_MSG = &quot;&quot;&quot;</span><br><span class="line">  [pusher]</span><br><span class="line">  pusher_type = pushplus</span><br><span class="line">  </span><br><span class="line">  [serverchan]</span><br><span class="line">  sec_key =</span><br><span class="line">  </span><br><span class="line">  [dingding]</span><br><span class="line">  access_token =</span><br><span class="line">  secret =</span><br><span class="line">  </span><br><span class="line">  [pushplus]</span><br><span class="line">  pushplus_token = </span><br><span class="line">  &quot;&quot;&quot;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class PusherException(Exception):</span><br><span class="line">      def __init__(self, message) -&gt; None:</span><br><span class="line">          super().__init__(message)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class IPushUtil:</span><br><span class="line">      def push(self, title: str = &quot;&quot;, content: str = &quot;&quot;) -&gt; bool:</span><br><span class="line">          pass</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class PushplusPush(IPushUtil):</span><br><span class="line">      def __init__(self, options: dict):</span><br><span class="line">          self.pushplus_token = options.get(&quot;pushplus_token&quot;)</span><br><span class="line">  </span><br><span class="line">      def push(self, title: str = &quot;&quot;, content: str = &quot;&quot;) -&gt; bool:</span><br><span class="line">          d = &#123;</span><br><span class="line">              &quot;token&quot;: self.pushplus_token,</span><br><span class="line">              &quot;template&quot;: &quot;markdown&quot;,</span><br><span class="line">              &quot;title&quot;: &quot;&#123;date&#125;.&#123;title&#125;&quot;.format(date=date.today(), title=title),</span><br><span class="line">              &quot;content&quot;: content</span><br><span class="line">          &#125;</span><br><span class="line">          res = requests.post(&quot;http://www.pushplus.plus/send&quot;, data=d)</span><br><span class="line">          if not (200 &lt;= res.json().get(&quot;code&quot;) &lt; 300):</span><br><span class="line">              print(res.json())</span><br><span class="line">          return 200 &lt;= res.json().get(&quot;code&quot;) &lt; 300</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class ServerChanPush(IPushUtil):</span><br><span class="line">      def __init__(self, options: dict):</span><br><span class="line">          self.sec_key = options.get(&quot;sec_key&quot;)</span><br><span class="line">  </span><br><span class="line">      def push(self, title: str = &quot;&quot;, content: str = &quot;&quot;) -&gt; bool:</span><br><span class="line">          data = &#123;</span><br><span class="line">              &apos;text&apos;: &quot;&#123;date&#125;.&#123;title&#125;&quot;.format(date=date.today(), title=title),</span><br><span class="line">              &apos;desp&apos;: content</span><br><span class="line">          &#125;</span><br><span class="line">          res = requests.post(url=&apos;https://sc.ftqq.com/&#123;&#125;.send&apos;.format(self.sec_key), data=data)</span><br><span class="line">          if not (res.json().get(&quot;errmsg&quot;) == &quot;success&quot;):</span><br><span class="line">              print(res.json())</span><br><span class="line">          return res.json().get(&quot;errmsg&quot;) == &quot;success&quot;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class DingDingPush(IPushUtil):</span><br><span class="line">      URL = &quot;https://oapi.dingtalk.com/robot/send&quot;</span><br><span class="line">  </span><br><span class="line">      def __init__(self, options: dict):</span><br><span class="line">          self.access_token = options.get(&quot;access_token&quot;)</span><br><span class="line">          self.secret = options.get(&quot;secret&quot;)</span><br><span class="line">          self.target_url = self.get_url()</span><br><span class="line">  </span><br><span class="line">      def get_url(self):</span><br><span class="line">          timestamp = round(time.time() * 1000)</span><br><span class="line">          secret_enc = bytes(self.secret, encoding=&quot;utf-8&quot;)</span><br><span class="line">          string_to_sign = &quot;&#123;&#125;\n&#123;&#125;&quot;.format(timestamp, self.secret)</span><br><span class="line">          string_to_sign_enc = bytes(string_to_sign, encoding=&quot;utf-8&quot;)</span><br><span class="line">          hmac_code = hmac.new(</span><br><span class="line">              secret_enc, string_to_sign_enc, digestmod=hashlib.sha256</span><br><span class="line">          ).digest()</span><br><span class="line">          sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class="line">          return self.URL + &quot;?access_token=&#123;access_token&#125;&amp;timestamp=&#123;timestamp&#125;&amp;sign=&#123;sign&#125;&quot;.format(</span><br><span class="line">              access_token=self.access_token, timestamp=timestamp, sign=sign)</span><br><span class="line">  </span><br><span class="line">      def push(self, title: str = &quot;&quot;, content: str = &quot;&quot;) -&gt; bool:</span><br><span class="line">          msg = self.gen_markdown_msg(title, content)</span><br><span class="line">          return self.send(msg)</span><br><span class="line">  </span><br><span class="line">      def send(self, message):</span><br><span class="line">          resp = requests.post(self.target_url, json=message)</span><br><span class="line">          return resp.json()</span><br><span class="line">  </span><br><span class="line">      @staticmethod</span><br><span class="line">      def gen_text_msg(content, at=None, at_all=False):</span><br><span class="line">          if at is None:</span><br><span class="line">              at = []</span><br><span class="line">          return &#123;</span><br><span class="line">              &quot;msgtype&quot;: &quot;text&quot;,</span><br><span class="line">              &quot;text&quot;: &#123;&quot;content&quot;: content&#125;,</span><br><span class="line">              &quot;at&quot;: &#123;&quot;atMobiles&quot;: at, &quot;isAtAll&quot;: at_all&#125;,</span><br><span class="line">          &#125;</span><br><span class="line">  </span><br><span class="line">      @staticmethod</span><br><span class="line">      def gen_markdown_msg(title, text, at=None, at_all=False):</span><br><span class="line">          def generateText():</span><br><span class="line">              res = &quot;&quot;</span><br><span class="line">              # æœ€é¡¶è¡Œæ˜¾ç¤ºæ ‡é¢˜</span><br><span class="line">              res += &quot;# &quot; + title + &quot;\n&quot;</span><br><span class="line">              # å†…å®¹</span><br><span class="line">              res += text</span><br><span class="line">              # atå¯¹è±¡</span><br><span class="line">              res += reduce(lambda x, y: x + &quot;@&quot; + y, at, &quot;&quot;)</span><br><span class="line">              return res</span><br><span class="line">  </span><br><span class="line">          return &#123;</span><br><span class="line">              &quot;msgtype&quot;: &quot;markdown&quot;,</span><br><span class="line">              &quot;markdown&quot;: &#123;</span><br><span class="line">                  &quot;title&quot;: title,</span><br><span class="line">                  &quot;text&quot;: generateText()</span><br><span class="line">              &#125;,</span><br><span class="line">              &quot;at&quot;: &#123;&quot;atMobiles&quot;: at, &quot;isAtAll&quot;: at_all&#125;,</span><br><span class="line">          &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  class Pusher:</span><br><span class="line">      def __init__(self):</span><br><span class="line">          self.pusher = self.init()</span><br><span class="line">  </span><br><span class="line">      def init(self):</span><br><span class="line">          &quot;&quot;&quot;</span><br><span class="line">          å®ä¾‹åŒ–pusher</span><br><span class="line">          :return:</span><br><span class="line">          &quot;&quot;&quot;</span><br><span class="line">          from configparser import RawConfigParser</span><br><span class="line">          cp = RawConfigParser()</span><br><span class="line">          if not os.path.exists(CONFIG_INI_FILENAME):</span><br><span class="line">              raise PusherException(f&quot;è¯·åˆ›å»ºconfig.inié…ç½®æ–‡ä»¶\npusheré…ç½®ä¿¡æ¯å¦‚ä¸‹:\n&#123;REMIND_MSG&#125;&quot;)</span><br><span class="line">          cp.read(CONFIG_INI_FILENAME, encoding=&quot;utf8&quot;)</span><br><span class="line">          pusher_type = cp.get(&quot;pusher&quot;, &quot;pusher_type&quot;).lower()</span><br><span class="line">          generator_info = dict(cp.items(pusher_type))</span><br><span class="line">          # æ£€æŸ¥pusheré…ç½®</span><br><span class="line">          if not pusher_type or not self._valid(generator_info):</span><br><span class="line">              raise PusherException(&quot;&#123;&#125;_pusheré…ç½®é”™è¯¯ï¼Œä¸èƒ½ä¸ºç©º~&quot;.format(pusher_type))</span><br><span class="line">  </span><br><span class="line">          if pusher_type == &quot;serverchan&quot;:</span><br><span class="line">              return ServerChanPush(generator_info)</span><br><span class="line">          elif pusher_type == &quot;dingding&quot;:</span><br><span class="line">              return DingDingPush(generator_info)</span><br><span class="line">          elif pusher_type == &quot;pushplus&quot;:</span><br><span class="line">            return PushplusPush(generator_info)</span><br><span class="line">          else:</span><br><span class="line">              raise PusherException(&quot;ä¸å¯çŸ¥pusherç±»å‹~&quot;)</span><br><span class="line">  </span><br><span class="line">      def _valid(self, config_dict: dict):</span><br><span class="line">          &quot;&quot;&quot;</span><br><span class="line">          åˆ¤æ–­å­—å…¸å€¼æ˜¯å¦ä¸ºç©º</span><br><span class="line">          :param dict:</span><br><span class="line">          :return:</span><br><span class="line">          &quot;&quot;&quot;</span><br><span class="line">          for v in config_dict.values():</span><br><span class="line">              if not v:</span><br><span class="line">                  return False</span><br><span class="line">          return True</span><br><span class="line">  </span><br><span class="line">      def push(self, title=&quot;&quot;, content=&quot;&quot;) -&gt; bool:</span><br><span class="line">          return self.pusher.push(title, content)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  # å¦‚æœéœ€è¦pushåŠŸèƒ½ï¼Œåˆ™é…ç½®å®Œæˆåæ‰“å¼€æ³¨é‡Šï¼Œåœ¨åˆ«çš„æ–‡ä»¶ä¸­å°†på¼•å…¥</span><br><span class="line">  # p = Pusher()</span><br></pre></td></tr></table></figure><h2 id="proxy_pool"><a class="markdownIt-Anchor" href="#proxy_pool"></a> <strong><a href="https://github.com/jhao104/proxy_pool" target="_blank" rel="noopener">proxy_pool</a></strong></h2><blockquote><p>çˆ¬è™«ä»£ç†IPæ± é¡¹ç›®,ä¸»è¦åŠŸèƒ½ä¸ºå®šæ—¶é‡‡é›†ç½‘ä¸Šå‘å¸ƒçš„å…è´¹ä»£ç†éªŒè¯å…¥åº“ï¼Œå®šæ—¶éªŒè¯å…¥åº“çš„ä»£ç†ä¿è¯ä»£ç†çš„å¯ç”¨æ€§ï¼Œæä¾›APIå’ŒCLIä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥æ‰©å±•ä»£ç†æºä»¥å¢åŠ ä»£ç†æ± IPçš„è´¨é‡å’Œæ•°é‡ã€‚</p></blockquote><ul><li><p><code>@LazyProperty</code>æ‡’åŠ è½½å±æ€§çš„è£…é¥°å™¨ï¼š åªæœ‰ç”¨åˆ°æ—¶æ‰ä¼šåŠ è½½å¹¶å°†å€¼æ³¨å…¥åˆ°<code>__dict__</code>ã€åŠ è½½ä¸€æ¬¡åå€¼å°±ä¸å†å˜åŒ–ã€ï¼›è®²è§£å¯è§ï¼š<a href="https://www.jianshu.com/p/708dc26f9b92%E2%80%94%E2%80%94%E6%8F%8F%E8%BF%B0%E7%AC%A6or%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%AE%9E%E7%8E%B0" target="_blank" rel="noopener">https://www.jianshu.com/p/708dc26f9b92â€”â€”æè¿°ç¬¦orä¿®é¥°ç¬¦å®ç°</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LazyProperty</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># åœ¨è¢«æ³¨è§£ç±»è¢«è§£é‡Šå™¨è¿è¡Œçš„æ—¶å€™å°±ä¼šåˆ›å»ºLazyPropertyå®ä¾‹ï¼Œå¹¶è¿›è¡Œåˆå§‹åŒ–init</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func)</span>:</span></span><br><span class="line">        self.func = func</span><br><span class="line">    <span class="string">"""é€šè¿‡pythonæè¿°ç¬¦æ¥å®ç°"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = self.func(instance)</span><br><span class="line">            setattr(instance, self.func.__name__, value)</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br></pre></td></tr></table></figure><p><code>__get__</code>åªæœ‰è®¿é—®ç±»å±æ€§çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™è¾¹æ˜¯é€šè¿‡setattrå°†serverHostè®¾ç½®æˆäº†ConfigHandlerçš„ç±»å±æ€§</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;taobao_seckill&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#taobao_seckill&quot;&gt;&lt;/a&gt; &lt;strong&gt;&lt;a href=&quot;https://github.com/jerry3747/taobao_seckil
      
    
    </summary>
    
    
      <category term="ä»£ç é˜…è¯»" scheme="https://nymrli.top/tags/%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Pythonè¿›é˜¶</title>
    <link href="https://nymrli.top/2022/03/27/Python%E8%BF%9B%E9%98%B6/"/>
    <id>https://nymrli.top/2022/03/27/Pythonè¿›é˜¶/</id>
    <published>2022-03-27T14:30:39.000Z</published>
    <updated>2022-04-02T15:56:33.229Z</updated>
    
    <content type="html"><![CDATA[<h2 id="xxxatrrå®¶æ—"><a class="markdownIt-Anchor" href="#xxxatrrå®¶æ—"></a> xxxatrrå®¶æ—</h2><h3 id="hasattr"><a class="markdownIt-Anchor" href="#hasattr"></a> hasattr()</h3><blockquote><p>ç”¨äºåˆ¤æ–­å¯¹è±¡æ˜¯å¦åŒ…å«å¯¹åº”çš„å±æ€§ã€‚</p></blockquote><p>hasattr è¯­æ³•ï¼š<code>hasattr(object, name)</code></p><h3 id="setattr"><a class="markdownIt-Anchor" href="#setattr"></a> setattr()</h3><blockquote><p><strong>setattr()</strong> å‡½æ•°å¯¹åº”å‡½æ•° <a href="https://www.runoob.com/python/python-func-getattr.html" target="_blank" rel="noopener">getattr()</a>ï¼Œç”¨äºè®¾ç½®å±æ€§å€¼ï¼Œè¯¥å±æ€§ä¸ä¸€å®šæ˜¯å­˜åœ¨çš„ã€‚å¦‚æœå±æ€§ä¸å­˜åœ¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å±æ€§ï¼Œå¹¶å¯¹å±æ€§è¿›è¡Œèµ‹å€¼ã€‚</p></blockquote><p>setattr() è¯­æ³•ï¼š<code>setattr(object, name, value)</code></p><h3 id="getattr"><a class="markdownIt-Anchor" href="#getattr"></a> getattr()</h3><blockquote><p><strong>getattr()</strong> å‡½æ•°ç”¨äºè¿”å›ä¸€ä¸ªå¯¹è±¡<strong>å±æ€§å€¼</strong>ã€‚</p></blockquote><p><code>getattr(object, name[, default])</code></p><ul><li>object â€“ å¯¹è±¡ã€‚</li><li>name â€“ å­—ç¬¦ä¸²ï¼Œå¯¹è±¡å±æ€§ã€‚</li><li>default â€“ é»˜è®¤è¿”å›å€¼ï¼Œå¦‚æœä¸æä¾›è¯¥å‚æ•°ï¼Œåœ¨æ²¡æœ‰å¯¹åº”å±æ€§æ—¶ï¼Œå°†è§¦å‘ <u>AttributeError</u>ã€‚</li></ul><h2 id="__get____getattr____getattribute__"><a class="markdownIt-Anchor" href="#__get____getattr____getattribute__"></a> <a href="https://www.cnblogs.com/pyhai/p/9243551.html" target="_blank" rel="noopener"><code>__get__,__getattr__,__getattribute__</code>åŠåŒºåˆ«</a></h2><h3 id="1object__getattribute__self-name"><a class="markdownIt-Anchor" href="#1object__getattribute__self-name"></a> <strong>1.<code>object.__getattribute__(self, name)</code></strong></h3><p>æ— æ¡ä»¶è¢«è°ƒç”¨ï¼Œé€šè¿‡å®ä¾‹è®¿é—®å±æ€§ã€å‡½æ•°ï¼ˆç‚¹å’Œgetattrå‡½æ•°éƒ½ä¼šè§¦å‘ï¼‰ã€‚å¦‚æœclassä¸­å®šä¹‰äº†<code>__getattribute__()</code>å’Œ<code>__getattr__()</code>ï¼Œåˆ™åªæœ‰åœ¨æ˜¾å¼è°ƒç”¨æˆ–å¼•å‘AttributeErrorå¼‚å¸¸æ‰ä¼šè°ƒç”¨<code>__getattr__()</code></p><p>æ³¨ï¼š</p><ul><li>åªè¦å®šä¹‰äº†<code>__getattribute__</code>æ–¹æ³•ï¼Œä¸ç®¡ä½ è®¿é—®ä¸€ä¸ªå­˜åœ¨çš„è¿˜æ˜¯ä¸å­˜åœ¨çš„å±æ€§ï¼Œéƒ½ç”±è¿™ä¸ªæ–¹æ³•è¿”å›ï¼Œæ¯”å¦‚è®¿é—®<code>t.a</code>ï¼Œè™½ç„¶aå­˜åœ¨ï¼Œä½†æ˜¯åªè¦å®šä¹‰äº†è¿™ä¸ªè®¿é—®ï¼Œé‚£ä¹ˆå°±ä¸æ˜¯è®¿é—®æœ€å¼€å§‹çš„aäº†</li><li>å¦‚æœ<code>__getattribute__</code>æŠ›å‡ºäº†<code>AttributeError</code>å¼‚å¸¸ï¼Œå¹¶ä¸”å®šäº†äº†<code><strong>getattr</strong></code>å‡½æ•°ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨<code><strong>getattr</strong></code>è¿™ä¸ªå‡½æ•°å¹¶è¿”å›getattrå‡½æ•°çš„è¿”å›å€¼</li><li>å±æ€§è®¿é—®çš„ä¸€ä¸ªå¤§è‡´ä¼˜å…ˆçº§æ˜¯ï¼š<code>__getattribute__</code> &gt; <code>__getattr__</code> &gt; <code>__dict__</code></li></ul><h3 id="2object__getattr__self-name"><a class="markdownIt-Anchor" href="#2object__getattr__self-name"></a> <strong>2.<code>object.__getattr__(self, name)</code></strong></h3><p>ä¸ºå†…ç½®æ–¹æ³•ï¼Œå½“ä½¿ç”¨ç‚¹å·è·å–å®ä¾‹å±æ€§æ—¶ï¼Œå¦‚æœ<u>å±æ€§ä¸å­˜åœ¨</u>(æ‰¾ä¸åˆ°attribute)çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨<code>__getattr__</code>ï¼Œè¿”å›ä¸€ä¸ªå€¼æˆ–AttributeErrorå¼‚å¸¸ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">p</span><span class="params">()</span>:</span></span><br><span class="line">    s = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span></span><br><span class="line">d = p()</span><br><span class="line">print(d.s)<span class="comment"># ==&gt; 2</span></span><br><span class="line">print(d.p)  <span class="comment"># ==&gt; hello</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå¦‚æœå±æ€§ä¸å­˜åœ¨ï¼Œåˆ™ä¸ç®¡æ˜¯å¦æœ‰<code>__getattribute__</code>ï¼Œéƒ½ä¼šè°ƒç”¨<code>__getattr__</code></p><h3 id="3object__get__self-instance-owner"><a class="markdownIt-Anchor" href="#3object__get__self-instance-owner"></a> <strong>3.<code>object.__get__(self, instance, owner)</code></strong></h3><blockquote><p>Python å†…ç½®çš„ <code>property</code> å‡½æ•°å¯ä»¥è¯´æ˜¯æœ€è‘—åçš„æè¿°å™¨ä¹‹ä¸€ï¼Œå‡ ä¹æ‰€æœ‰è®²è¿°æè¿°å™¨çš„æ–‡ç« éƒ½ä¼šæ‹¿å®ƒåšä¾‹å­ã€‚è€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°<code>__set__</code>ã€<code>__get__</code>ã€<code>__delete__</code>æ¥å®ç°è‡ªå·±çš„æè¿°å™¨ã€‚</p><ul><li>æè¿°å™¨åªå¯¹æ–°å¼ç±»èµ·ä½œç”¨ï¼›</li></ul><p>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°instanceæ˜¯å®é™…æ‹¥æœ‰è€…çš„descriptor<strong>å®ä¾‹</strong>ï¼Œå¦‚æœæ˜¯Descriptorç±»(å®šä¹‰äº†æè¿°å™¨åè®®çš„æè¿°å™¨ç±»)åˆ™ä¸º<code>None</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°owneræ˜¯å®é™…æ‰€å±çš„<strong>ç±»æœ¬èº«</strong>(æ‰€æœ‰è€…ç±»)ã€‚</p></blockquote><p>ä¸€ä¸ªç±»åªè¦å®ç°äº†<code>__get__ã€ __set__,__delete__</code>ä¸­ä»»æ„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å«å®ƒæè¿°å™¨ï¼ˆdescriptorï¼‰ï¼Œä»–æ˜¯ä¸€ä¸ªå¯ä»¥<strong>æè¿°ä¸€ä¸ªå±æ€§æ“ä½œ</strong>çš„<strong>å¯¹è±¡</strong>ã€‚å¦‚æœåªå®šä¹‰äº†<code>__get__</code>æˆ‘ä»¬å«éèµ„æ–™æè¿°å™¨ï¼ˆnon-data descriptorï¼‰ï¼Œå¦‚æœ<code>__set__ã€ __delete__</code>ï¼šä»»æ„ä¸€ä¸ªæˆ–è€…åŒæ—¶å‡ºç°ï¼Œå«èµ„æ–™æè¿°å™¨ï¼ˆdata descriptorï¼‰ã€‚</p><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼Œæ‹¥æœ‰<code>__get__</code>çš„ç±»ï¼Œåº”è¯¥**ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯å¿…é¡»ï¼‰äº§ç”Ÿä¸€ä¸ªå®ä¾‹**ï¼Œå¹¶ä¸”è¿™ä¸ªå®ä¾‹æ˜¯å¦å¤–ä¸€ä¸ªç±»çš„<strong>ç±»å±æ€§</strong>ï¼ˆæ³¨æ„ä¸€å®šæ˜¯ç±»å±æ€§ï¼Œé€šè¿‡selfçš„æ–¹å¼äº§ç”Ÿå°±ä¸å±äº<code>__get__</code>èŒƒç•´äº†ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´æ‹¥æœ‰è¿™ä¸ªæ–¹æ³•çš„ç±»ï¼Œé‚£ä¹ˆå®ƒçš„å®ä¾‹åº”è¯¥å±äºå¦å¤–ä¸€ä¸ªç±»/å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚</p><p>owneræ˜¯æ‰€æœ‰è€…çš„ç±»ï¼Œinstanceæ˜¯è®¿é—®descriptorçš„å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯é€šè¿‡å®ä¾‹è®¿é—®ï¼Œè€Œæ˜¯é€šè¿‡ç±»è®¿é—®çš„è¯ï¼Œinstanceåˆ™ä¸ºNoneã€‚ï¼ˆdescriptorçš„å®ä¾‹è‡ªå·±è®¿é—®è‡ªå·±æ˜¯ä¸ä¼šè§¦å‘<code>__get__</code>ï¼Œè€Œä¼šè§¦å‘<code>__call__</code>ï¼Œåªæœ‰descriptorä½œä¸ºå…¶å®ƒç±»çš„å±æ€§æ‰æœ‰æ„ä¹‰ã€‚ï¼‰ï¼ˆæ‰€ä»¥ä¸‹æ–‡çš„dæ˜¯ä½œä¸ºC2çš„ä¸€ä¸ªå±æ€§è¢«è°ƒç”¨ï¼‰</p><p>å°†æè¿°å™¨ä½œä¸ºä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ï¼Œå¹¶ä¸èƒ½å±•ç°å‡ºæè¿°å™¨çš„é­”åŠ›ï¼Œåªæœ‰åœ¨æè¿°å™¨ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§çš„æ—¶å€™ï¼Œæè¿°å™¨çš„é­”åŠ›æ‰èƒ½çœŸæ­£å±•ç°å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDes</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        print(instance, owner)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'TestDes:__get__'</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMain</span>:</span></span><br><span class="line">    des = TestDes()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t = TestMain()</span><br><span class="line">    <span class="comment"># desè™½ç„¶è¢«å®šä¹‰æˆç±»å˜é‡ï¼Œä½†t.desè¿˜æ˜¯è·Ÿå®ä¾‹ç›¸å…³çš„ï¼Œå¯¹å…¶å¢åˆ æ”¹éƒ½ä¼šèµ°åˆ°å…¶æè¿°å™¨å¯¹è±¡çš„__get__ã€__set__ã€__delete__ä¸­å¤„ç†</span></span><br><span class="line">    print(t.des)</span><br><span class="line">    print(TestMain.des)</span><br><span class="line"><span class="comment"># å…¶ä¸­TestDeså®šä¹‰äº†__get__æ–¹æ³•ï¼Œåœ¨TestMainä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç±»å±æ€§desï¼Œæ˜¯TestDesçš„ä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬è®¿é—®t.desæˆ–è€…TestMain.desçš„æ—¶å€™è®¿é—®çš„å°±æ˜¯è®¿é—®äº†TestDesçš„__get__æ–¹æ³•ã€‚</span></span><br></pre></td></tr></table></figure><p>â–²æè¿°å™¨å¾€å¾€ä»¥è£…é¥°å™¨çš„æ–¹å¼è¢«ä½¿ç”¨ï¼Œå¯¼è‡´äºŒè€…å¸¸è¢«æ··æ·†ã€‚æè¿°å™¨ç±»å’Œä¸å¸¦å‚æ•°çš„è£…é¥°å™¨ç±»ä¸€æ ·ï¼Œéƒ½ä¼ å…¥å‡½æ•°å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª<strong>ç±»å®ä¾‹</strong>ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œè£…é¥°å™¨ç±»è¿”å› <u>callable çš„å®ä¾‹</u>ï¼Œæè¿°å™¨åˆ™è¿”å›<u>æè¿°å™¨å®ä¾‹</u>ã€‚</p><p>Q:å¦‚æœå®ä¾‹ä¸­æœ‰å’Œæè¿°å™¨é‡åçš„å±æ€§ <code>x</code> æ€ä¹ˆåŠï¼Ÿ</p><p>A:èµ„æ–™å’Œéèµ„æ–™æè¿°å™¨çš„åŒºåˆ«åœ¨äºï¼Œç›¸å¯¹äºå®ä¾‹å­—å…¸çš„ä¼˜å…ˆçº§ä¸åŒã€‚å½“æè¿°å™¨å’Œå®ä¾‹å­—å…¸ä¸­çš„æŸä¸ªå±æ€§é‡åï¼ŒæŒ‰è®¿é—®ä¼˜å…ˆçº§ï¼Œèµ„æ–™æè¿°å™¨ &gt; åŒåå®ä¾‹å­—å…¸ä¸­çš„å±æ€§ &gt; éèµ„æ–™æè¿°å™¨ or (æ•°æ®æè¿°ç¬¦ &gt; å®ä¾‹å˜é‡ &gt; éæ•°æ®æè¿°ç¬¦)ï¼Œä¼˜å…ˆçº§å°çš„ä¼šè¢«å¤§çš„è¦†ç›–ã€‚==&gt;ç±»çš„æ–¹æ³•å®é™…å°±æ˜¯ä¸€ä¸ªä»…å®ç°äº† <code>__get__()</code> çš„éèµ„æ–™æè¿°å™¨ï¼Œæ‰€ä»¥å¦‚æœå®ä¾‹ <code>c</code> ä¸­åŒæ—¶å®šä¹‰äº†åä¸º <code>foo</code> çš„æ–¹æ³•å’Œå±æ€§ï¼Œé‚£ä¹ˆ <code>c.foo</code> è®¿é—®çš„æ˜¯å±æ€§è€Œéæ–¹æ³•ã€‚</p><p>æè¿°å™¨moreï¼š<a href="https://www.jianshu.com/p/58f1df955bda" target="_blank" rel="noopener">Python æè¿°å™¨è§£æ</a></p><p>é’ˆå¯¹æè¿°å™¨çš„è¯´æ˜ï¼š æè¿°å™¨æ˜¯è¢«<code>__getattribute__</code>è°ƒç”¨çš„ï¼Œå¦‚æœé‡å†™äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°†ä¼šé˜»æ­¢è‡ªåŠ¨è°ƒç”¨æè¿°å™¨ï¼Œèµ„æ–™æè¿°å™¨æ€»æ˜¯è¦†ç›–äº†å®ä¾‹çš„<code>__dict__</code>ï¼Œ éèµ„æ–™æè¿°å™¨å¯èƒ½è¦†ç›–å®ä¾‹çš„<code>__dict__</code>ã€‚</p><p>å°ç»“ï¼šè®¿é—®å­˜åœ¨çš„å±æ€§ï¼Œå¦‚æœæ˜¯æè¿°å™¨ï¼Œæè¿°å™¨ç”Ÿæ•ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDes</span>:</span></span><br><span class="line">    <span class="comment"># æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®é™…æ‹¥æœ‰è€…çš„å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸ºNoneï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®é™…æ‰€å±çš„ç±»ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        print(instance, owner)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'TestDes:__get__'</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMain</span>:</span></span><br><span class="line">    des = TestDes()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t = TestMain()</span><br><span class="line">    print(t.des)</span><br><span class="line">    print(TestMain.des)<span class="comment"># è°ƒç”¨æ—¶instanceè¾“å‡ºNone</span></span><br></pre></td></tr></table></figure><ul><li>éèµ„æ–™æè¿°å™¨ï¼Œä¹Ÿå°±æ˜¯åªæœ‰<code>__get__</code>ï¼Œä¸ç®¡æ˜¯ç±»è¿˜æ˜¯å®ä¾‹å»è®¿é—®ï¼Œé»˜è®¤éƒ½è·å¾—çš„æ˜¯<code>__get__</code>çš„è¿”å›å€¼ï¼Œä½†æ˜¯ï¼Œå¦‚æœä¸­é—´æœ‰ä»»ä½•ä¸€æ¬¡é‡æ–°èµ‹å€¼<code>(t.des = 1)</code>ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªå®ä¾‹è·å¾—çš„æ˜¯æ–°çš„å€¼(å¯¹è±¡)ï¼Œå·²ç»å’ŒåŸæ¥çš„æè¿°å™¨å®Œå…¨è„±ç¦»äº†å…³ç³»(æè¿°å™¨<code>__get__</code>å‡½æ•°å¤±æ•ˆ)</li><li>èµ„æ–™æè¿°å™¨ï¼Œæ¯”å¦‚æœ‰<code>__set__</code>æ–¹æ³•ï¼ŒåæœŸé€šè¿‡å®ä¾‹å¯¹æè¿°å™¨è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆè®¿é—®çš„æ˜¯<code>__set__</code>ï¼Œå¹¶ä¸”æ°¸è¿œå…³è”èµ·æ¥==&gt;é’ˆå¯¹ä¸Šè¿°é—®é¢˜çš„ä¿®å¤ã€‚ä½†æ˜¯å¦‚æœé€šè¿‡ä¿®æ”¹ç±»å±æ€§çš„æ–¹å¼å¤åˆ¶(TestMain.des = 1)ï¼Œé‚£ä¹ˆä¹Ÿä¼šè¢«é‡æ–°è·å–æ–°çš„å€¼(å¯¹è±¡)ï¼Œå³<code>__set__</code>å‡½æ•°å¤±æ•ˆã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>å¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡é€šè¿‡å®ä¾‹è®¿é—®å±æ€§ï¼Œéƒ½ä¼šç»è¿‡<code>__getattribute__</code>å‡½æ•°ã€‚è€Œå½“å±æ€§ä¸å­˜åœ¨æ—¶ï¼Œä»ç„¶éœ€è¦è®¿é—®<code>__getattribute__</code>ï¼Œä¸è¿‡æ¥ç€è¦è®¿é—®<code>__getattr__</code>ï¼Œå°±å¥½åƒæ˜¯ä¸€ä¸ªå¼‚å¸¸å¤„ç†å‡½æ•°ã€‚</li><li>æ¯æ¬¡è®¿é—®descriptorï¼ˆå³å®ç°äº†<code>__get__</code>çš„ç±»ï¼‰ï¼Œéƒ½ä¼šå…ˆç»è¿‡<code>__get__</code>å‡½æ•°ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨ç±»è®¿é—®ä¸å­˜åœ¨çš„å˜é‡æ˜¯ï¼Œä¸ä¼šç»è¿‡<code>__getattr__</code>å‡½æ•°ã€‚è€Œdescriptorä¸å­˜åœ¨æ­¤é—®é¢˜ï¼Œåªæ˜¯æŠŠinstanceæ ‡è¯†ä¸ºnoneè€Œå·²ã€‚</li></ul><p>è‡³äºä¸‰è€…åŒºåˆ«ï¼Œé¦–å…ˆå…³æ³¨ï¼ša.xæ—¶å‘ç”Ÿäº†ä»€ä¹ˆ?=&gt;å±æ€§çš„lookupé¡ºåºå¦‚ä¸‹:</p><ul><li>å¦‚æœé‡è½½äº†<code>__getattribute__</code>,åˆ™è°ƒç”¨.</li><li><code>a.__dict__</code>, å®ä¾‹ä¸­æ˜¯ä¸å…è®¸æœ‰descriptorçš„,æ‰€ä»¥ä¸ä¼šé‡åˆ°descriptor</li><li><code>A.__dict__</code>, ä¹Ÿå³<code>a.__class__.__dict__</code>.å¦‚æœé‡åˆ°äº†descriptor,ä¼˜å…ˆè°ƒç”¨descriptor.</li><li>æ²¿ç€ç»§æ‰¿é“¾æœç´¢çˆ¶ç±».æœç´¢<code>a.__class__.__bases__</code>ä¸­çš„æ‰€æœ‰<code>__dict__</code>. å¦‚æœæœ‰å¤šé‡ç»§æ‰¿ä¸”æ˜¯è±å½¢ç»§æ‰¿çš„æƒ…å†µ,æŒ‰MRO(Method Resolution Order)é¡ºåºæœç´¢.</li></ul><p>å‚è€ƒï¼š</p><ul><li><a href="https://www.cnblogs.com/andy1031/p/10923834.html" target="_blank" rel="noopener">pythonçš„__get__æ–¹æ³•çœ‹è¿™ä¸€ç¯‡å°±è¶³å¤Ÿäº†</a></li><li>moreï¼š<a href="https://www.cnblogs.com/Meanwey/p/9898222.html" target="_blank" rel="noopener">Pythonè¿›é˜¶-----æè¿°ç¬¦(<strong>get</strong>(),<strong>set</strong>(),<strong>delete</strong>())</a></li></ul><h2 id="__dict__"><a class="markdownIt-Anchor" href="#__dict__"></a> <code>__dict__</code></h2><blockquote><p>Pythonä¸­å¤§å¤šä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œè€Œå¯¹è±¡çš„<strong>å±æ€§</strong>åˆ™æ˜¯å­˜åœ¨<code>__dict__</code>å±æ€§ä¸­</p></blockquote><ul><li>ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨**ç±»<code>__dict__</code>**é‡Œçš„</li><li><strong>å¯¹è±¡</strong>çš„<code>__dict__</code>ä¸­å­˜å‚¨äº†ä¸€äº›self.xxxçš„ä¸€äº›ä¸œè¥¿</li></ul><p>æ³¨æ„</p><ul><li>å†…ç½®çš„æ•°æ®ç±»å‹æ²¡æœ‰<code>__dict__</code>å±æ€§ï¼Œå¦‚listã€dictã€int</li><li>æ¯ä¸ªç±»æœ‰è‡ªå·±çš„<code>__dict__</code>å±æ€§ï¼Œå°±ç®—å­˜ç€ç»§æ‰¿å…³ç³»ï¼Œçˆ¶ç±»çš„<code>__dict__</code> å¹¶ä¸ä¼šå½±å“å­ç±»çš„<code>__dict__</code></li><li>å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„<code>__dict__</code>å±æ€§ï¼Œ <a href="http://xn--self-p07f497c.xxx" target="_blank" rel="noopener">å­˜å‚¨self.xxx</a> ä¿¡æ¯ï¼Œçˆ¶å­ç±»å¯¹è±¡å…¬ç”¨<code>__dict__</code></li><li>å¯¹è±¡çš„<code>__dict__</code>ä¼˜å…ˆäºç±»çš„<code>__dict__</code>è°ƒç”¨ï¼Œå¦‚<code>self.__dict__['a']=1</code>ï¼Œè€Œ<code>Class.__dict__['a']=&quot;func&quot;</code>ï¼Œåˆ™c.aè¾“å‡ºçš„æ˜¯1ï¼Œè€Œä¸æ˜¯func</li></ul><h2 id="å¯å˜å‚æ•°ä¸unpack"><a class="markdownIt-Anchor" href="#å¯å˜å‚æ•°ä¸unpack"></a> å¯å˜å‚æ•°ä¸unpack</h2><ol><li><p>å‡½æ•°çš„å¯å˜å‚æ•°</p><p>å½“å‡½æ•°çš„å‚æ•°å‰é¢æœ‰ä¸€ä¸ªæ˜Ÿå·<code>*</code>çš„æ—¶å€™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯å˜çš„ä½ç½®å‚æ•°ï¼Œä¸¤ä¸ªæ˜Ÿå·<code>**</code>è¡¨ç¤ºæ˜¯å¯å˜çš„å…³é”®å­—å‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">saySomething</span><span class="params">(word, *args, **kwargs)</span>:</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"><span class="comment"># wordä¼šè¢«èµ‹å€¼æˆhello word, </span></span><br><span class="line"><span class="comment"># mrliå’Œmrduè¢«æ‰“åŒ…è¿›argsæ•°ç»„ä¸­</span></span><br><span class="line"><span class="comment"># size=15; color=whiteä¼šè¢«ä½œä¸ºkvä¼ åˆ°kwargsçš„å­—å…¸ä¸­</span></span><br><span class="line">saySomething(<span class="string">"hello word"</span>, <span class="string">"mrli"</span>, <span class="string">"mrdu"</span>, size=<span class="number">15</span>, color=<span class="string">"white"</span>)</span><br></pre></td></tr></table></figure></li><li><p>unpackå‚æ•°</p><p>æ˜Ÿå·<code>*</code>æŠŠåºåˆ—/é›†åˆè§£åŒ…ï¼ˆunpackï¼‰æˆä½ç½®å‚æ•°ï¼Œä¸¤ä¸ªæ˜Ÿå·<code>**</code>æŠŠå­—å…¸è§£åŒ…æˆå…³é”®å­—å‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">txtOptions = &#123;</span><br><span class="line"><span class="string">"fontSize"</span>: <span class="number">15</span>,</span><br><span class="line"><span class="string">"color"</span>: <span class="string">"white"</span></span><br><span class="line">&#125;</span><br><span class="line">addtional_text = (<span class="string">"mrli"</span>, <span class="string">"mrdu"</span>)</span><br><span class="line"><span class="comment"># unpackçš„å½¢å¼ä¼ å‚æ•°</span></span><br><span class="line">saySomething(<span class="string">"hello word"</span>, *addtional_text, **txtOptions)</span><br><span class="line"><span class="comment"># ä¸¤å¥è¯æ˜¯ç­‰ä»·çš„</span></span><br><span class="line">saySomething(<span class="string">"hello word"</span>, <span class="string">"mrli"</span>, <span class="string">"mrdu"</span>, size=<span class="number">15</span>, color=<span class="string">"white"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹“å±•-æˆ‘ä»¬ç»å¸¸åœ¨å¼€æºåº“çš„docä¸­çœ‹åˆ°æŸä¸ªå‡½æ•°èƒ½æ¥æ”¶xxxå‚æ•°ï¼Œä½†æ˜¯ç‚¹è¿›å»ä¸€çœ‹ï¼Œæœ€åº•å±‚çš„å‚æ•°ä¼ çš„æ˜¯**kwargsã€‚æŒ‰é“ç†æˆ‘ä»¬æ˜¯ä»€ä¹ˆå‚æ•°éƒ½å¯ä»¥ä¼ çš„ï¼Œå¤§ä¸äº†å‡½æ•°ä¸è§£æè¿™äº›æ— ç”¨å‚æ•°ç½¢äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå½“æˆ‘ä»¬ä¼ APIä¸­æ²¡æœ‰å†™åˆ°çš„å‚æ•°æ—¶ä¼šæŠ¥é”™ã€‚ ==&gt; è¿™ä¸ªæ˜¯ç”±äºkwargsèƒ½ä¼ é€’çš„å‚æ•°å—é™äºæœ€åº•å±‚çš„å‚æ•°éœ€æ±‚ï¼Œä»¥requests.getä¸ºä¾‹</span></span><br><span class="line"><span class="comment"># requests.py</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(url, params=None, **kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> request(<span class="string">'get'</span>, url, params=params, **kwargs)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">request</span><span class="params">(method, url, **kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> session.request(method=method, url=url, **kwargs)</span><br><span class="line"><span class="comment"># getä¸­èƒ½ä¼ çš„**å…³é”®å­—å‚æ•°**å®é™…ä¸Šåªèƒ½æ˜¯è¿™äº›å…³é”®å­—å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">request</span><span class="params">(self, method, url,</span></span></span><br><span class="line"><span class="function"><span class="params">            params=None, data=None, headers=None, cookies=None, files=None,</span></span></span><br><span class="line"><span class="function"><span class="params">            auth=None, timeout=None, allow_redirects=True, proxies=None,</span></span></span><br><span class="line"><span class="function"><span class="params">            hooks=None, stream=None, verify=None, cert=None, json=None)</span>:</span></span><br><span class="line"><span class="comment"># Pythonä¹Ÿæ˜¯é€šè¿‡è¿™ä¸¤ä¸ªç‰¹æ€§ä»è€Œå®ç°äº†**é‡å†™overrided**</span></span><br></pre></td></tr></table></figure><ul><li>è‡³äºæ˜Ÿå·(<code>*</code>)è¿˜æœ‰ä¸€ä¸ªç”¨é€”æ˜¯æ¥æ˜ç¡®å†™æ˜ä½ç½®å‚æ•°çš„æˆªæ–­ä½ç½®ï¼Œ<code>*</code>åçš„å‚æ•°ä¹Ÿä¸èƒ½å†ä»¥ä½ç½®å‚æ•°çš„å½¢å¼ç»™å‡ºï¼Œå¿…é¡»ä»¥å…³é”®å­—å‚æ•°çš„å½¢å¼ç»™å‡ºâ€”â€”è§<a href="https://blog.csdn.net/weixin_40796925/article/details/107654347" target="_blank" rel="noopener">Python3 å‡½æ•°å‚æ•°åˆ—è¡¨å•ç‹¬ä¸€ä¸ªæ˜Ÿå· * çš„ä½œç”¨</a></li></ul></li></ol><p>ç±»æ¯”Goä¸­çš„<code>...</code>è¯­æ³•</p><h2 id="è£…é¥°å™¨"><a class="markdownIt-Anchor" href="#è£…é¥°å™¨"></a> è£…é¥°å™¨</h2><blockquote><p>è£…é¥°å™¨(Decorators)æ˜¯ Python çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œé€šè¿‡ä»–ä»¬å¯ä»¥åœ¨ä¸ç”¨æ›´æ”¹åŸå‡½æ•°çš„ä»£ç å‰æä¸‹ï¼Œä¿®æ”¹ã€æ‹“å±•å…¶ä»–å‡½æ•°çš„åŠŸèƒ½çš„å‡½æ•°ï¼Œä»–ä»¬æœ‰åŠ©äºè®©æˆ‘ä»¬çš„ä»£ç æ›´ç®€æ´ã€‚==&gt;åˆ‡é¢ç¼–ç¨‹çš„æ–¹å¼</p></blockquote><p><strong>é—­åŒ…</strong></p><blockquote><p>PythonæŸ¥æ‰¾å˜é‡ä¼šä¸€å±‚å±‚åœ°å‘å¤–å±‚æŸ¥æ‰¾ï¼Œç›´åˆ°globalå…¨å±€ä¹Ÿæ²¡æœ‰æ—¶raise <code>NameError: name 'xxx' is not defined</code></p></blockquote><p>åœ¨è£…é¥°å™¨ä¸­è¿ç”¨åˆ°äº†é—­åŒ…çš„æ€æƒ³ã€‚é—­åŒ…ï¼Œä¸€å¥è¯è¯´å°±æ˜¯ï¼Œåœ¨å‡½æ•°ä¸­å†åµŒå¥—ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å¼•ç”¨<strong>å¤–éƒ¨å‡½æ•°</strong>çš„å˜é‡ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé—­åŒ…äº†ã€‚(ä»è€Œä½¿å¾—å†…éƒ¨å‡½æ•°å’Œå¯¹å…¶å‘¨å›´çŠ¶æ€ï¼ˆ<strong>lexical environmentï¼Œè¯æ³•ç¯å¢ƒ</strong>ï¼‰çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·)</p><p>æ‰§è¡Œé—­åŒ…åï¼Œé—­åŒ…å®ä¾‹å°†ä¼šç»´æŒäº†ä¸€ä¸ªè¯æ³•ç¯å¢ƒï¼Œå…¶ä¸­åŒ…å«å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œä½¿å¾—åŸæœ¬å°±åº”è¯¥å¤±æ•ˆçš„å±€éƒ¨å˜é‡ä»ç„¶å­˜æ´»ã€‚</p><p><strong>é—­åŒ…çš„åº”ç”¨</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeAdder</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> add5 = makeAdder(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">var</span> add10 = makeAdder(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(add5(<span class="number">2</span>));  <span class="comment">// 7</span></span><br><span class="line"><span class="built_in">console</span>.log(add10(<span class="number">2</span>)); <span class="comment">// 12</span></span><br></pre></td></tr></table></figure><p>ä»æœ¬è´¨ä¸Šè®²ï¼Œ<code>makeAdder</code> æ˜¯ä¸€ä¸ªå‡½æ•°å·¥å‚ â€” ä»–åˆ›å»ºäº†å°†æŒ‡å®šçš„å€¼å’Œå®ƒçš„å‚æ•°ç›¸åŠ æ±‚å’Œçš„å‡½æ•°ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°å·¥å‚åˆ›å»ºäº†ä¸¤ä¸ªæ–°å‡½æ•° â€” ä¸€ä¸ªå°†å…¶å‚æ•°å’Œ 5 æ±‚å’Œï¼Œå¦ä¸€ä¸ªå’Œ 10 æ±‚å’Œã€‚</p><p><code>add5</code> å’Œ <code>add10</code> éƒ½æ˜¯é—­åŒ…ã€‚å®ƒä»¬å…±äº«ç›¸åŒçš„å‡½æ•°å®šä¹‰ï¼Œä½†æ˜¯ä¿å­˜äº†ä¸åŒçš„è¯æ³•ç¯å¢ƒã€‚åœ¨ <code>add5</code> çš„ç¯å¢ƒä¸­ï¼Œ<code>x</code> ä¸º 5ã€‚è€Œåœ¨ <code>add10</code> ä¸­ï¼Œ<code>x</code> åˆ™ä¸º 10ã€‚</p><p>moreï¼š <a href="https://www.bilibili.com/video/BV1ZJ411y7Te?from=search&amp;seid=15415737541054747822&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener">5å¥å£è¯€ç†è§£è®°å¿†Pythoné—­åŒ…å’Œè£…é¥°å™¨</a></p><p>[<strong>è£…é¥°å™¨ç±»å‹</strong>](<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p05_define_decorator_with_user_adjustable_attributes.html" target="_blank" rel="noopener">9.5 å¯è‡ªå®šä¹‰å±æ€§çš„è£…é¥°å™¨ â€” python3-cookbook 3.0.0 æ–‡æ¡£</a>)</p><p>é—­åŒ…å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å°†å‡½æ•°ä¸å…¶æ‰€æ“ä½œçš„æŸäº›æ•°æ®ï¼ˆç¯å¢ƒï¼‰å…³è”èµ·æ¥ã€‚<strong>å¤–éƒ¨å‡½æ•°ç›¸å½“äºç»™å†…éƒ¨å‡½æ•°æä¾›äº†ä¸€ä¸ªé¢å¤–æ•°æ®çš„æ‰§è¡Œç¯å¢ƒ</strong>ï¼Œä½¿å¾—å†…éƒ¨å‡½æ•°ï¼ˆè¢«è£…é¥°å‡½æ•°ï¼‰æ‹¥æœ‰äº†è·å¾—å¤–å±‚å‡½æ•°çš„æ•°æ®oræ‰§è¡Œäº†å¤–å±‚å‡½æ•°ã€‚æ ¹æ®å‚æ•°[æˆ–æ˜¯å«ç¯å¢ƒä¸åŒ]ï¼Œå¯ä»¥åˆ†æˆå¦‚ä¸‹å‡ ç§è£…é¥°å™¨ï¼š</p><ul><li><p>æ— å‚æ•°</p><ul><li><p>å¸¸è§çš„æœ‰è¾“å‡ºæ—¥å¿—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_log</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">"do before"</span>)</span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">        print(<span class="string">"do after"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@do_log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say</span><span class="params">(word)</span>:</span></span><br><span class="line">    print(word)</span><br><span class="line">say(<span class="string">"hello world"</span>)</span><br><span class="line"><span class="comment"># ç­‰ä»·äºä¸‹é¢ä¸¤å±€</span></span><br><span class="line"><span class="comment"># say = do_log(say)</span></span><br><span class="line"><span class="comment"># say("hello world") ===&gt; do_log(say)("hello world")</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå¯ä»¥ç±»æ¯”JS</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(word);</span><br><span class="line">&#125;</span><br><span class="line">play = <span class="function"><span class="keyword">function</span>(<span class="params">w</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"æˆ‘è¦å¼€å§‹ç¬‘å•¦"</span>);</span><br><span class="line">    say(w);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"æˆ‘ä¸ç¬‘äº†"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// playç›¸å½“äºè£…é¥°äº†ä¸€å±‚say, åŒæ¯”ä¸Šé¢çš„do_logä¹Ÿæ˜¯ã€‚åœ¨ä¹‹åçš„æ‰§è¡Œä¸­playå’Œdo_logæ‰æ˜¯çœŸæ­£çš„æ‰§è¡Œå‡½æ•°, åªä¸è¿‡Pythonè¯­æ³•ç³–@ï¼Œè®©do_logåˆèµ‹å€¼ç»™äº†say, æ‰€ä»¥æˆ‘ä»¬åˆå¯ä»¥ç›´æ¥ä½¿ç”¨sayï¼Œä»è€Œå¢åŠ äº†å‡½æ•°åŸæœ¬çš„åŠŸèƒ½</span></span><br></pre></td></tr></table></figure></li><li><p>@è¯­æ³•ç³–ï¼šå®ƒæ”¾åœ¨å‡½æ•°å¼€å§‹å®šä¹‰çš„åœ°æ–¹ï¼Œè¿™æ ·å°±å¯ä»¥çœç•¥æœ€åä¸€æ­¥å†æ¬¡èµ‹å€¼çš„æ“ä½œ</p></li></ul></li><li><p>é»˜è®¤å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createLogger</span><span class="params">()</span>:</span></span><br><span class="line">    logger = logging.getLogger(<span class="string">"decorate"</span>)</span><br><span class="line">    formatter = logging.Formatter(<span class="string">'%(asctime)s-%(name)s-%(levelname)s-%(message)s'</span>)</span><br><span class="line">    sh = logging.StreamHandler()</span><br><span class="line">    sh.setLevel(logging.DEBUG)</span><br><span class="line">    sh.setFormatter(formatter)</span><br><span class="line">    logger.addHandler(sh)</span><br><span class="line">    <span class="keyword">return</span> logger</span><br><span class="line">logger = createLogger()</span><br><span class="line">logger.warning(<span class="string">"hello"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_by_level</span><span class="params">(level)</span>:</span></span><br><span class="line">    <span class="comment"># åˆ›å»ºæ–°ç¯å¢ƒï¼šå¤šæä¾›äº†ä¸€ä¸ªlevelå˜é‡</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_log</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">        @wraps(func)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">            getattr(logger, level)(<span class="string">"do before"</span>)</span><br><span class="line">            func(*args, **kwargs)</span><br><span class="line">            getattr(logger, level)(<span class="string">"do after"</span>)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> do_log</span><br><span class="line"></span><br><span class="line"><span class="meta">@log_by_level("warning")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say</span><span class="params">(word)</span>:</span></span><br><span class="line">    print(word)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">do_log = log_by_level(<span class="string">"warning"</span>) <span class="comment"># ä½œç”¨æ˜¯æä¾›äº†ä¸€ä¸ªlevel=warningçš„ç¯å¢ƒ</span></span><br><span class="line">say = do_log(say)</span><br><span class="line">say(<span class="string">"hello"</span>)</span><br></pre></td></tr></table></figure></li><li><p>å¯è‡ªå®šä¹‰å±æ€§çš„è£…é¥°å™¨ï¼š</p><blockquote><p>å…è®¸ç”¨æˆ·æä¾›å‚æ•°åœ¨<strong>è¿è¡Œæ—¶</strong>æ§åˆ¶è£…é¥°å™¨è¡Œä¸ºã€‚æ¯”å¦‚å‰ç«¯è®¾ç½®ä¸€ä¸ªå•é€‰ï¼Œå¯ä»¥æ§åˆ¶æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œæ­¤æ—¶åˆ™éœ€è¦åœ¨è¿è¡Œæ—¶ä¿®æ”¹è£…é¥°å™¨è¡Œä¸º</p></blockquote></li><li><p>å¯é€‰å‚æ•°</p><blockquote><p>æ—¢å¯ä»¥ä¸ä¼ å‚æ•°ç»™å®ƒï¼Œæ¯”å¦‚ <code>@decorator</code> ï¼Œ ä¹Ÿå¯ä»¥ä¼ é€’å¯é€‰å‚æ•°ç»™å®ƒï¼Œæ¯”å¦‚ <code>@decorator(x,y,z)</code> ã€‚</p></blockquote><p>å®ç°è§ï¼š<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p06_define_decorator_that_takes_optional_argument.html" target="_blank" rel="noopener">9.6 å¸¦å¯é€‰å‚æ•°çš„è£…é¥°å™¨ â€” python3-cookbook 3.0.0 æ–‡æ¡£</a></p></li><li><p>ç±»è£…é¥°å™¨ï¼š</p><blockquote><p>ä½¿ç”¨ä¸€ä¸ªè£…é¥°å™¨å»åŒ…è£…å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„<strong>å®ä¾‹</strong></p></blockquote><p>ç±»è£…é¥°å™¨ä¸»è¦ä¾é ç±»çš„<code>__call__</code>æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassDecorator</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(func)</span>:</span></span><br><span class="line">        self.func = func</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"enter"</span>)</span><br><span class="line">        self.func()</span><br><span class="line">        print(<span class="string">"end"</span>)</span><br><span class="line"><span class="meta">@ClassDecorator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'bar'</span>)</span><br><span class="line"><span class="comment"># bar = ClassDecorator(bar)</span></span><br><span class="line"><span class="comment"># bar() ==&gt; ClassDecorator(bar)()  è°ƒç”¨å®ä¾‹==&gt;å³è§¦å‘__call__æ–¹æ³•</span></span><br></pre></td></tr></table></figure></li><li><p>ç±»ä¸­è£…é¥°å™¨:</p><blockquote><p>åœ¨ç±»ä¸­å®šä¹‰è£…é¥°å™¨ï¼Œå¹¶å°†å…¶ä½œç”¨åœ¨å…¶ä»–å‡½æ•°æˆ–æ–¹æ³•ä¸Š</p></blockquote><p>è·Ÿæ— å‚æ•°çš„è£…é¥°å™¨ä¸€æ ·å†™æ³•ï¼Œåªä¸è¿‡å®šä¹‰åœ¨ç±»ä¸­ï¼›å¹¶ä¸”åœ¨ä½¿ç”¨çš„æ—¶å€™æ˜¯ä»¥<code>@Decorator.decortae</code>çš„å½¢å¼</p></li><li><p>ç±»æ–¹æ³•ã€é™æ€æ–¹æ³•è£…é¥°å™¨ï¼šè·Ÿæ— å‚æ•°çš„è£…é¥°å™¨ä¸€æ ·å†™æ³•ï¼Œä½†æ˜¯éœ€è¦åœ¨@staticmethodã€@classmethodä¹‹å‰æ ‡æ³¨</p></li></ul><p>â–²<strong>æ³¨æ„ï¼š</strong></p><ul><li><p>è£…é¥°å™¨åªä¼šåœ¨<strong>å‡½æ•°å®šä¹‰</strong>æ—¶è¢«è°ƒç”¨ä¸€æ¬¡</p></li><li><p>å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œåœ¨è£…é¥°å™¨ä»£ç ä¸­æ€»æœ‰ä¸€è¡Œ<code>@wraps(func)</code>çš„ä»£ç ï¼Œå…¶ç›®çš„ï¼šæ˜¯ä½ å†™äº†ä¸€ä¸ªè£…é¥°å™¨ä½œç”¨åœ¨æŸä¸ªå‡½æ•°ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°çš„é‡è¦çš„å…ƒä¿¡æ¯æ¯”å¦‚åå­—ã€æ–‡æ¡£å­—ç¬¦ä¸²ã€æ³¨è§£å’Œå‚æ•°ç­¾åéƒ½ä¸¢å¤±äº†----&gt;ä»»ä½•æ—¶å€™ä½ å®šä¹‰è£…é¥°å™¨çš„æ—¶å€™ï¼Œéƒ½åº”è¯¥ä½¿ç”¨functoolsåº“ä¸­çš„@wrapsè£…é¥°å™¨æ¥æ³¨è§£åº•å±‚åŒ…è£…å‡½æ•°</p></li><li><p>è£…é¥°å™¨çš„æ‰§è¡Œæ˜¯ä¾æ¬¡çš„ï¼Œç¦»å‡½æ•°ç­¾åè¶Šè¿‘ï¼Œåˆ™è¶Šå…ˆè¢«å®šä¹‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@a</span></span><br><span class="line"><span class="meta">@b</span></span><br><span class="line"><span class="meta">@c</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span> <span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># ç­‰ä»·äº f = a(b(c(f)))</span></span><br></pre></td></tr></table></figure></li></ul><p>æ€»ç»“ï¼š</p><p>ç†è§£è£…é¥°å™¨åº”è¯¥ä»â‘ <code>@</code>è¯­æ³•ç³–åˆ°åº•åšäº†ä»€ä¹ˆï¼›â‘¡é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼›â‘¢è£…é¥°å™¨å¦‚ä½•ç­‰ä»·è¡¨ç¤ºï¼›æ¥ç†è§£</p><h2 id="æ‡’åŠ è½½å±æ€§"><a class="markdownIt-Anchor" href="#æ‡’åŠ è½½å±æ€§"></a> <a href="https://www.jianshu.com/p/708dc26f9b92" target="_blank" rel="noopener">æ‡’åŠ è½½å±æ€§</a></h2><p><strong>æè¿°ç¬¦+<a href="#%E8%A3%85%E9%A5%B0%E5%99%A8">ç±»è£…é¥°å™¨</a>å®ç°</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LazyProperty</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func)</span>:</span></span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–funcä¸ºserverHostå‡½æ•°</span></span><br><span class="line">        self.func = func</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = self.func(instance)</span><br><span class="line">            <span class="comment"># ä¼šå°†ç»“æœå€¼é€šè¿‡setattræ–¹æ³•å­˜å…¥åˆ°instanceå®ä¾‹çš„__dict__ä¸­</span></span><br><span class="line">            setattr(instance, self.func.__name__, value)</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># è¿”å›ä¸€ä¸ªLazyPropertyå®ä¾‹ </span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br><span class="line"></span><br><span class="line">setting = namedtuple(<span class="string">"setting"</span>, [<span class="string">"HOST"</span>])</span><br><span class="line">setting.HOST = <span class="string">"g"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ä¸€</span></span><br><span class="line">a = ConfigHandler()</span><br><span class="line">print(a.__dict__)</span><br><span class="line"><span class="comment"># 1. æ³¨è§£å…ˆæ˜¯åˆ›å»ºäº†LazyProperty(serverHost)çš„å®ä¾‹</span></span><br><span class="line"><span class="comment"># 2. å†æ˜¯è¯­æ³•ç³–è¿›è¡Œäº†èµ‹å€¼serverHost = LazyProperty(serverHost)</span></span><br><span class="line"><span class="comment"># 3. å½“ç¬¬ä¸€æ¬¡è¿›è¡Œè°ƒç”¨çš„æ—¶å€™, instance = configHandler**å®ä¾‹**, self.func(instanceå®ä¾‹) == è°ƒç”¨serverHost(instanceå®ä¾‹)ä»è€Œè·å¾—äº†çœŸæ­£å€¼valueã€‚è€Œä¹‹åçš„ setattrå¤„å°†selfå®ä¾‹çš„__dict__ä¸­æ·»åŠ äº†serverHost-valueï¼Œå†æ¬¡è®¿é—®self.serverHostæ—¶, å·²ç»ä¸å†æ˜¯å‡½æ•°, è€Œæ˜¯valueå€¼(serverHostä¸å†ä»ConfigHandler.__dict__ä¸­å–, è€Œæ˜¯å®ä¾‹a.__dict__ä¸­å–)</span></span><br><span class="line">print(a.serverHost)</span><br><span class="line">print(<span class="string">"say"</span>)</span><br><span class="line">print(a.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•äºŒ</span></span><br><span class="line"><span class="comment"># å¦‚æœå…ˆæ‰§è¡Œç±»çš„__dict__èƒ½çœ‹åˆ°ç±»çš„serverHostæ˜¯ä¸€ä¸ª**æè¿°å™¨å¯¹è±¡å®ä¾‹**=&gt; 'serverHost': &lt;__main__.LazyProperty object at 0x0000020A1AEB7FD0&gt;</span></span><br><span class="line">print(ConfigHandler.__dict__)</span><br><span class="line"><span class="comment"># é€šè¿‡__dir__èƒ½è§åˆ°serverHostä¸ºå®ä¾‹çš„ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line">print(a.__dir__())</span><br><span class="line"><span class="comment"># æ­¤æ—¶a.__dict__ä¸ºç©º</span></span><br><span class="line">print(a.serverHost)</span><br><span class="line"><span class="comment"># ç­‰åˆ°è°ƒç”¨è¿‡a.serverHoståå¯ä»¥å‘ç°a.__dict__ä¸­å¤šäº†serverHost</span></span><br><span class="line">print(a.__dict__)</span><br><span class="line"><span class="comment"># ç”±äºå®ä¾‹__dict__ä¼šä¼˜å…ˆäºç±»çš„__dict__ä½¿ç”¨ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›äº†valueå€¼</span></span><br></pre></td></tr></table></figure><p>é‡ç‚¹ï¼š</p><ol><li>è·Ÿ[<code>print(t.des)</code>](#3.<code>object.__get__(self, instance, owner)</code>)ä¼šè§¦å‘t.desæŒ‡å‘çš„descriptorå®ä¾‹çš„<code>__get__</code>ä¸€æ ·ï¼Œé€šè¿‡ç±»<code>__dict__[&quot;serverHost&quot;]</code>ï¼Œå…¶ä¹Ÿæ˜¯ä¸ªæè¿°å™¨å®ä¾‹ï¼Œå› æ­¤ä¹Ÿä¼šè§¦å‘LazyProperty objectçš„<code>__get__</code></li><li>å®ä¾‹<a href="#%60__dict__%60"><code>__dict__</code></a>ä¼šä¼˜å…ˆäºç±»çš„<code>__dict__</code>ä½¿ç”¨ï¼Œå¦‚æœå®ä¾‹<code>__dict__</code>æ‰¾ä¸åˆ°ï¼Œä¼šå¾€ä¸Šç±»<code>__dict__</code>æ‰¾</li></ol><p><strong>ä¿®é¥°ç¬¦(æ–¹æ³•è£…é¥°å™¨)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lazy_property</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="comment"># åˆ›å»ºprotectedå±æ€§</span></span><br><span class="line">    attr_name = <span class="string">"_lazy_"</span> + func.__name__</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_lazy_property</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># print("done")</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self, attr_name):</span><br><span class="line">            <span class="comment"># print("set")</span></span><br><span class="line">            setattr(self, attr_name, func(self))</span><br><span class="line">        <span class="keyword">return</span> getattr(self, attr_name)</span><br><span class="line">    <span class="keyword">return</span> _lazy_property</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, radius)</span>:</span></span><br><span class="line">        self.radius = radius</span><br><span class="line"></span><br><span class="line"><span class="meta">    @lazy_property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">3.14</span> * self.radius ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“è§£æCircleç±»ã€å®šä¹‰areaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå°†Circle.area = @propertyä¿®é¥°çš„_lazy_propertyå‡½æ•°</span></span><br><span class="line">c = Circle(<span class="number">4</span>)</span><br><span class="line">print(<span class="string">'before calculate area'</span>)</span><br><span class="line">print(c.__dict__)</span><br><span class="line"><span class="comment"># å½“è°ƒç”¨c.areaæ—¶ï¼Œä¼šè¾“å‡ºdone, æ­¤æ—¶ä¼šæ‰§è¡Œ_lazy_propertyå†…çš„å…·ä½“å‡½æ•°, æ­¤æ¬¡ä¼šè¿›è¡Œsetattr</span></span><br><span class="line">print(c.area)</span><br><span class="line"><span class="comment"># æ­¤æ¬¡ä¸ä¼šè°ƒç”¨setattr</span></span><br><span class="line">print(c.area)</span><br><span class="line">print(<span class="string">'after calculate area'</span>)</span><br><span class="line">print(c.__dict__)</span><br><span class="line">c.radius = <span class="number">5</span></span><br></pre></td></tr></table></figure><p>å€Ÿé‰´ï¼š<a href="https://www.jianshu.com/p/708dc26f9b92" target="_blank" rel="noopener">Pythonä¸­çš„lazy property</a></p><h2 id="__new__"><a class="markdownIt-Anchor" href="#__new__"></a> <code>__new__</code></h2><blockquote><p><code>__new__()</code> æ˜¯ä¸€ç§è´Ÿè´£<strong>åˆ›å»ºç±»å®ä¾‹</strong>çš„é™æ€æ–¹æ³•ï¼Œå®ƒæ— éœ€ä½¿ç”¨ staticmethod è£…é¥°å™¨ä¿®é¥°ï¼Œä¸”è¯¥æ–¹æ³•ä¼šä¼˜å…ˆ <code>__init__()</code> åˆå§‹åŒ–æ–¹æ³•è¢«è°ƒç”¨ã€‚</p></blockquote><p><code>__new__()</code>é€šå¸¸ä¼šè¿”å›è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šè¿”å›å…¶ä»–ç±»çš„å®ä¾‹ï¼Œå…¶<code>super().__new__(cls)</code>ä¸­ä¼šè°ƒç”¨<code>__init__</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å†™å­ç±»çš„<code>__new__</code>æ·»åŠ ä¸€äº›é€»è¾‘æ¥æ§åˆ¶å®ä¾‹çš„äº§ç”Ÿï¼Œç„¶åé€šè¿‡<code>super().__new__(cls)</code>æ¥ç”Ÿæˆä¸€ä¸ªinstanceå¹¶è¿”å›ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demoClass</span>:</span></span><br><span class="line">    instances_created = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># __new__(): &lt;class '__main__.demoClass'&gt; ('abc',) &#123;&#125;</span></span><br><span class="line">        print(<span class="string">"__new__():"</span>, cls, args, kwargs)</span><br><span class="line">        <span class="comment"># 1. é€šè¿‡çˆ¶ç±»__new__ç”Ÿæˆä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">        <span class="comment"># åœ¨super().__new__(cls)ä¸­ä¼šè°ƒç”¨__init__å¹¶ç”Ÿæˆå®ä¾‹</span></span><br><span class="line">        instance = super().__new__(cls)</span><br><span class="line">        <span class="comment"># 2. è‡ªå·±é‡å†™è¦å®ç°çš„é€»è¾‘</span></span><br><span class="line">        instance.number = cls.instances_created</span><br><span class="line">        cls.instances_created += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 3. å°†çˆ¶ç±»ç”Ÿæˆçš„å®ä¾‹è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, attribute)</span>:</span></span><br><span class="line">        <span class="comment"># __init__(): &lt;__main__.demoClass object at 0x00000185A6466EB0&gt; abc</span></span><br><span class="line">        print(<span class="string">"__init__():"</span>, self, attribute)</span><br><span class="line">        self.attribute = attribute</span><br><span class="line"></span><br><span class="line">test1 = demoClass(<span class="string">"abc"</span>)</span><br><span class="line">test2 = demoClass(<span class="string">"xyz"</span>)</span><br><span class="line">print(test1.number, test1.instances_created)</span><br><span class="line">print(test2.number, test2.instances_created)</span><br></pre></td></tr></table></figure><p>Q:ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨<code>__new__()</code>å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œåœ¨<code>__init__()</code>ä¸å¤Ÿç”¨çš„æ—¶å€™ã€‚</p><p><code>__new__()</code>é€šå¸¸ä¼šè¿”å›è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šè¿”å›å…¶ä»–ç±»çš„å®ä¾‹ï¼Œå¦‚æœå‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼Œåˆ™ä¼šè·³è¿‡å¯¹ <code>__init__()</code>æ–¹æ³•çš„è°ƒç”¨ã€‚è€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚éœ€è¦ä¿®æ”¹<strong>ä¸å¯å˜ç±»å®ä¾‹</strong>ï¼ˆ<a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> çš„æŸäº›å†…ç½®ç±»å‹ï¼‰çš„åˆ›å»ºè¡Œä¸ºï¼‰ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ä¼šäº‹åŠåŠŸå€ã€‚æ¯”å¦‚ï¼š<a href="http://c.biancheng.net/view/5484.html%EF%BC%8C%E5%AF%B9" target="_blank" rel="noopener">http://c.biancheng.net/view/5484.htmlï¼Œå¯¹</a> Python ä¸å¯å˜çš„å†…ç½®ç±»å‹ï¼ˆå¦‚ intã€strã€float ç­‰ï¼‰è¿›è¡Œäº†å­ç±»åŒ–ï¼Œè¿™æ˜¯å› ä¸ºä¸€æ—¦åˆ›å»ºäº†è¿™æ ·ä¸å¯å˜çš„å¯¹è±¡å®ä¾‹ï¼Œå°±æ— æ³•åœ¨<code>__init__()</code>æ–¹æ³•ä¸­å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>æ³¨ï¼šç”±äº <code>__new__()</code> ä¸é™äºè¿”å›åŒä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è¢«æ»¥ç”¨ï¼Œä¸è´Ÿè´£ä»»åœ°ä½¿ç”¨è¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¯¹ä»£ç æœ‰å®³ï¼Œæ‰€ä»¥è¦è°¨æ…ä½¿ç”¨ã€‚</p><h2 id="metaclasså…ƒç±»"><a class="markdownIt-Anchor" href="#metaclasså…ƒç±»"></a> <a href="http://c.biancheng.net/view/2293.html" target="_blank" rel="noopener">MetaClasså…ƒç±»</a></h2><blockquote><p>æ‰¿æ¥ä¸Šæ–‡<code>__new__</code>ï¼ŒPythonä¸­å¤§é‡ä½¿ç”¨<code>__new__()</code>æ–¹æ³•ä¸”åˆç†çš„ï¼Œå°±æ˜¯ MetaClass å…ƒç±»ã€‚</p><p>MetaClasså…ƒç±»ï¼Œæœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œä½†å’Œæ™®é€šç±»çš„ç”¨æ³•ä¸åŒï¼Œå®ƒå¯ä»¥å¯¹<strong>ç±»å†…éƒ¨çš„å®šä¹‰</strong>ï¼ˆåŒ…æ‹¬ç±»å±æ€§å’Œç±»æ–¹æ³•ï¼‰è¿›è¡Œ<strong>åŠ¨æ€çš„ä¿®æ”¹</strong>ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œä½¿ç”¨å…ƒç±»çš„ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å®ç°åœ¨åˆ›å»ºç±»æ—¶ï¼Œèƒ½å¤ŸåŠ¨æ€åœ°æ”¹å˜ç±»ä¸­å®šä¹‰çš„å±æ€§æˆ–è€…æ–¹æ³•ã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ ¹æ®å®é™…åœºæ™¯çš„éœ€è¦ï¼Œæˆ‘ä»¬è¦ä¸ºå¤šä¸ªç±»æ·»åŠ ä¸€ä¸ª name å±æ€§å’Œä¸€ä¸ª say() æ–¹æ³•ã€‚æ˜¾ç„¶æœ‰å¤šç§æ–¹æ³•å¯ä»¥å®ç°ï¼Œä½†å…¶ä¸­ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨ MetaClass å…ƒç±»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®šä¹‰ä¸€ä¸ªå…ƒç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FirstMetaClass</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="comment"># clsä»£è¡¨åŠ¨æ€ä¿®æ”¹çš„ç±»</span></span><br><span class="line">    <span class="comment"># nameä»£è¡¨åŠ¨æ€ä¿®æ”¹çš„ç±»å</span></span><br><span class="line">    <span class="comment"># basesä»£è¡¨è¢«åŠ¨æ€ä¿®æ”¹çš„ç±»çš„æ‰€æœ‰çˆ¶ç±»</span></span><br><span class="line">    <span class="comment"># atträ»£è¡¨è¢«åŠ¨æ€ä¿®æ”¹çš„ç±»çš„æ‰€æœ‰å±æ€§ã€æ–¹æ³•ç»„æˆçš„å­—å…¸</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, attrs)</span>:</span></span><br><span class="line">        <span class="comment"># åŠ¨æ€ä¸ºè¯¥ç±»æ·»åŠ ä¸€ä¸ªnameå±æ€§</span></span><br><span class="line">        attrs[<span class="string">'name'</span>] = <span class="string">"Cè¯­è¨€ä¸­æ–‡ç½‘"</span></span><br><span class="line">        attrs[<span class="string">'say'</span>] = <span class="keyword">lambda</span> self: print(<span class="string">"è°ƒç”¨ say() å®ä¾‹æ–¹æ³•"</span>)</span><br><span class="line">        <span class="keyword">return</span> super().__new__(cls,name,bases,attrs)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#å®šä¹‰ç±»æ—¶ï¼ŒæŒ‡å®šå…ƒç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CLanguage</span><span class="params">(object,metaclass=FirstMetaClass)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">clangs = CLanguage()</span><br><span class="line">print(clangs.name)</span><br><span class="line">clangs.say()</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆ›å»ºç±»æ—¶ï¼Œé€šè¿‡åœ¨æ ‡æ³¨çˆ¶ç±»çš„åŒæ—¶æŒ‡å®šå…ƒç±»ï¼ˆæ ¼å¼ä¸º<code>metaclass=å…ƒç±»å</code>ï¼‰ï¼Œåˆ™å½“ <a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> è§£é‡Šå™¨åœ¨åˆ›å»ºè¿™è¯¥ç±»æ—¶ï¼ŒFirstMetaClass å…ƒç±»ä¸­çš„<code>__new__</code>æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œä»è€Œå®ç°åŠ¨æ€ä¿®æ”¹ç±»å±æ€§æˆ–è€…ç±»æ–¹æ³•çš„ç›®çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMeta3</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, attrs)</span>:</span></span><br><span class="line">        print(cls)    <span class="comment"># å½“å‰ç±» </span></span><br><span class="line">        print(<span class="string">"name"</span>, name)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„ç±»å‹</span></span><br><span class="line">        print(<span class="string">"bases"</span>, bases)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„çˆ¶ç±»</span></span><br><span class="line">        print(<span class="string">"attrs"</span>, attrs)<span class="comment"># å¦‚æœæ˜¯é€šè¿‡metaclassè§¦å‘çš„ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨metaclassçš„ç±»çš„å±æ€§</span></span><br><span class="line">        <span class="keyword">return</span> type.__new__(cls, name, bases, attrs)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pa3</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># python3ä¸­å¯ä»¥ç›´æ¥é€šè¿‡metaclasså…³é”®å­—å‚æ•°æ¥æŒ‡å®šç±»çš„å…ƒç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Eg3</span><span class="params">(Pa3, metaclass=TestMeta3)</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self)</span>:</span></span><br><span class="line">        kkk = []</span><br><span class="line">        kkk.append(self.__skiless__)</span><br><span class="line">        <span class="keyword">return</span> kkk</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">acc2</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'a2'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è¾“å‡º</span></span><br><span class="line"><span class="string">&lt;class '__main__.TestMeta3'&gt;</span></span><br><span class="line"><span class="string">name Eg3</span></span><br><span class="line"><span class="string">bases (&lt;class '__main__.Pa3'&gt;,)</span></span><br><span class="line"><span class="string">attrs &#123;'__module__': '__main__', '__qualname__': 'Eg3', 'get': &lt;classmethod object at 0x00000263511C6FA0&gt;, 'acc2': &lt;function Eg3.acc2 at 0x00000263511C5310&gt;&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œå‘ç°ç«Ÿç„¶æœ‰è¾“å‡ºã€‚å› ä¸ºå®šä¹‰çš„æ—¶å€™ï¼Œpythonè§£é‡Šå™¨ä¼šåœ¨å½“å‰ç±»ä¸­æŸ¥æ‰¾metaclass[3]ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±<strong>ä½¿ç”¨è¯¥metaclassåˆ›å»ºEg3ç±»</strong>ã€‚æ‰€ä»¥æ‰“å°å‡ºæ¥çš„nameã€basesã€attrséƒ½å’ŒEg3æœ‰å…³ã€‚</p><p><strong>å…ƒç±»å’Œçˆ¶ç±»çš„åŒºåˆ«ï¼š</strong></p><p>åœ¨å®šä¹‰å­ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šâ‘ æ˜¯ä¼ éœ€è¦ç»§æ‰¿çš„çˆ¶ç±»ï¼›â‘¡è‡ªå®šä¹‰çš„å…ƒç±»ã€‚</p><ul><li>çˆ¶ç±»æ˜¯å­ç±»çš„æ¨¡æ¿ï¼Œå­ç±»çš„åŠŸèƒ½æ˜¯è·Ÿçˆ¶ç±»ç´§è€¦åˆçš„ï¼Œå­ç±»å’Œçˆ¶ç±»ä¸€èˆ¬æ˜¯ä¸€ä¸€å¯¹åº”çš„</li><li>å…ƒç±»æ˜¯å­ç±»çš„ä¿®é¥°å™¨ï¼Œå¯ä»¥ä¸ºè¯¥å­ç±»å’Œå…¶ä»–å­ç±»éƒ½æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸åœ¨ç»§æ‰¿å…³ç³»ä¸­(<code>Class.__mro__</code>æŸ¥çœ‹)ï¼Œå­ç±»å’Œå…ƒç±»æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚å…ƒç±»å¹¶ä¸æ˜¯ç‰¹åœ°ä¸ºæŸä¸ªå­ç±»æœåŠ¡çš„</li></ul><p><strong>with_metaclass</strong></p><blockquote><p>ç”±äºpython2å’Œpython3ä¸­å…ƒç±»ä½¿ç”¨æ–¹æ³•çš„ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ç§å…¼å®¹çš„æ–¹å¼[1]ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withMetaclass</span><span class="params">(meta, *bases)</span>:</span></span><br><span class="line">    <span class="string">"""Create a base class with a metaclass."""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># This requires a bit of explanation: the basic idea is to make a dummy</span></span><br><span class="line">    <span class="comment"># metaclass for one level of class instantiation that replaces itself with</span></span><br><span class="line">    <span class="comment"># the actual metaclass.</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MetaClass</span><span class="params">(meta)</span>:</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, this_bases, d)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> meta(name, bases, d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> type.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)</span><br></pre></td></tr></table></figure><p><code>with_metaclass</code>è¿”å›çš„ä¸´æ—¶ç±»ä¸­ï¼Œæœ¬èº«æ— ä»»ä½•å±æ€§ï¼Œä½†åŒ…å«äº†å…ƒç±»å’ŒåŸºç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¹¶åœ¨<strong>ä¸‹ä¸€æ­¥å®šä¹‰ç±»æ—¶</strong>å°†æ‰€æœ‰ä¿¡æ¯è§£åŒ…å‡ºæ¥[1]ã€‚</p><p>è§ï¼š<a href="https://zhuanlan.zhihu.com/p/354828950" target="_blank" rel="noopener">Python å…ƒç±»åŠwith_metaclass</a></p><h2 id="__type__"><a class="markdownIt-Anchor" href="#__type__"></a> <a href="http://c.biancheng.net/view/2292.html" target="_blank" rel="noopener"><code>__type__</code>åŠ¨æ€åˆ›å»ºç±»</a></h2><ul><li>type() å‡½æ•°å±äº <a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a> å†…ç½®å‡½æ•°ï¼Œé€šå¸¸ç”¨æ¥æŸ¥çœ‹æŸä¸ªå˜é‡çš„å…·ä½“ç±»å‹ã€‚<ul><li><code>type(obj)</code></li></ul></li><li>å…¶å®ï¼Œtype() å‡½æ•°è¿˜æœ‰ä¸€ä¸ªæ›´é«˜çº§çš„ç”¨æ³•ï¼Œå³<strong>åˆ›å»º</strong>ä¸€ä¸ªè‡ªå®šä¹‰<strong>ç±»å‹</strong>ï¼ˆä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªç±»ï¼‰ã€‚<ul><li><code>type(name, bases, dict)</code>ï¼šå…¶ä¸­ name è¡¨ç¤ºç±»çš„åç§°ï¼›bases è¡¨ç¤ºä¸€ä¸ªå…ƒç»„ï¼Œå…¶ä¸­å­˜å‚¨çš„æ˜¯è¯¥ç±»çš„çˆ¶ç±»ï¼›dict è¡¨ç¤ºä¸€ä¸ªå­—å…¸ï¼Œç”¨äºè¡¨ç¤ºç±»å†…å®šä¹‰çš„å±æ€§æˆ–è€…æ–¹æ³•ã€‚</li></ul></li></ul><p>å®é™…ä¸Š<code>type(name, bases, dict)</code>æ˜¯è°ƒç”¨äº†typeç±»çš„<code>type.__init__(cls, what, bases=None, dict=None)</code>æ–¹æ³•ï¼Œåˆ›å»ºäº†ä¸€ä¸ªtypeçš„å®ä¾‹ï¼ˆç±»ç±»å‹å°±æ˜¯ä¸€ä¸ªtypeå®ä¾‹ï¼‰ï¼Œç±»å‹æ˜¯<code>&lt;class 'type'&gt;</code></p><ul><li>æ­¤å¤–typeè¿˜æœ‰<code>__new__(*args, **kwargs)</code>ï¼Œå…¶ä½œç”¨æ˜¯<code>Create and return a new object.</code>ï¼Œå¯ä»¥å†™æˆ<code>type.__new__(ClassTpye, name, base, dicts)</code>ï¼Œä½†ClassTypeå¿…é¡»æ˜¯typeçš„å­ç±»ã€‚ä¼šè¿”å›ä¸€ä¸ªClassTypeçš„<strong>instance</strong>ï¼Œæ­¤ç±»ä¸ºClassTpyeçš„å®ä¾‹ï¼Œselfå±æ€§æœ‰dictsä¸­çš„å€¼</li></ul><p>æ­¤å¤–è¡¥å……ä¸€ä¸‹: <strong>&lt;class â€˜typeâ€™&gt;æ˜¯æ‰€æœ‰ç±»å‹çš„ç±»å‹ã€‚&lt;class â€˜objectâ€™&gt;ä¹Ÿæ˜¯æ‰€æœ‰å¯¹è±¡çš„è¶…ç±»ï¼ˆé™¤äº†å®ƒè‡ªå·±ï¼ŒåŒ…æ‹¬typeï¼‰</strong></p><h2 id="é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»"><a class="markdownIt-Anchor" href="#é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»"></a> é€šè¿‡å…ƒç±»åˆ›å»ºå•ä¾‹ç±»</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„è¿™è¾¹ç»§æ‰¿äº†type, æ‰€ä»¥ä¸‹é¢çš„__call__æ˜¯é‡å†™typeçš„__call__ï¼Œå³åˆ›å»ºå®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Singleton Metaclass</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    _inst = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> cls._inst:</span><br><span class="line">            cls._inst[cls] = super(Singleton, cls).__call__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._inst[cls]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withMetaclass</span><span class="params">(meta, *bases)</span>:</span></span><br><span class="line">    <span class="string">"""Create a base class with a metaclass."""</span></span><br><span class="line">    <span class="comment"># è¿™éœ€è¦ä¸€ç‚¹è§£é‡Šï¼šåŸºæœ¬æ€æƒ³æ˜¯ä¸ºä¸€ä¸ªçº§åˆ«çš„ç±»å®ä¾‹åŒ–åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå…ƒç±»ï¼Œç”¨å®é™…çš„å…ƒç±»æ›¿æ¢å®ƒè‡ªå·±ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># KeyPoint1. ç»§æ‰¿metaç±»</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MetaClass</span><span class="params">(meta)</span>:</span></span><br><span class="line">        <span class="comment"># å®é™…ä¸Šä¸‹é¢çš„__new__ä¸å½±å“</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, this_bases, d)</span>:</span></span><br><span class="line">            <span class="comment"># clsä¸ºwithMetaclass; nameä¸ºä½¿ç”¨è€…çš„ç±»å‹; this_basesä¸ºä½¿ç”¨è€…çš„çˆ¶ç±»ä»¬; dä¸ºä½¿ç”¨è€…çš„å±æ€§</span></span><br><span class="line">            <span class="keyword">return</span> meta(name, bases, d)</span><br><span class="line">    <span class="comment"># KeyPoint2. type.__new__åˆ›å»ºä¸€ä¸ªåç§°å«temporary_classï¼Œç±»å‹ä¸ºMetaClassçš„ç±»</span></span><br><span class="line">    <span class="comment"># â–²æ³¨æ„type.__new__ä¸­çš„ç±»ç±»å‹å¿…é¡»æ˜¯typeçš„å­ç±»</span></span><br><span class="line">    <span class="keyword">return</span> type.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"__init__"</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br><span class="line"><span class="comment"># res=withMetaclass(Singleton)çš„ç±»å‹ä¸º&lt;class 'util.six.withMetaclass.&lt;locals&gt;.MetaClass'&gt;</span></span><br><span class="line"><span class="comment"># å°†å…¶ä¼ ç»™ConfigHandlerä½œä¸ºçˆ¶ç±»ï¼Œåœ¨å®šä¹‰ ConfigHandler æ—¶ä¼šè§¦å‘MetaClass.__new__, äºæ˜¯è°ƒç”¨meta(name, bases, d)ï¼Œæ­¤å¤„çš„metaä¸ºSingletonï¼Œè€Œnameä¸ºConfigHandlerç±», basesä¸ºç©º, dä¸ºConfigHandlerçš„å±æ€§å’Œæ–¹æ³•ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(type(ConfigHandler)) ==&gt;  &lt;class 'util.singleton.Singleton'&gt;</span></span><br><span class="line"><span class="comment"># å› æ­¤ c = ConfigHandler() ==&gt; Singletonçš„__call__æ–¹æ³•ï¼Œ</span></span><br><span class="line">å½“c = ConfigHandler()æ—¶ä¼šå› ä¸ºtype.__new__(MetaClass, <span class="string">'temporary_class'</span>, (), &#123;&#125;)å»æ‰¾MetaClassçš„__call__è¿›è¡Œè°ƒç”¨ï¼ŒMetaClassæ²¡æœ‰__call__åˆ™æ‰¾åˆ°äº†å…¶çˆ¶ç±»meta(Singleton)çš„__call__</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ˜¯å…ƒç±»çš„å¯¹è±¡ï¼Œå³æˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªç±»æ—¶ï¼Œè°ƒç”¨å…¶å…ƒç±»çš„<code>__call__(cls, *args, **kwargs)</code>æ–¹æ³•è¿›è¡Œåˆ›å»ºå¯¹è±¡ã€‚</p><h2 id="__call__"><a class="markdownIt-Anchor" href="#__call__"></a> <code>__call__</code></h2><blockquote><p>ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„å®ä¾‹æ–¹æ³•ï¼Œå³<code>__call__()</code>ã€‚è¯¥æ–¹æ³•çš„åŠŸèƒ½ç±»ä¼¼äºåœ¨ç±»ä¸­é‡è½½ () è¿ç®—ç¬¦ï¼Œä½¿å¾—ç±»å®ä¾‹å¯¹è±¡å¯ä»¥åƒè°ƒç”¨æ™®é€šå‡½æ•°é‚£æ ·ï¼Œä»¥â€œ<strong>å¯¹è±¡å()</strong>â€çš„å½¢å¼ä½¿ç”¨ã€‚</p></blockquote><p>å®é™…ä¸Šï¼Œå¦‚æœä¸é‡å†™<code>__call__</code>çš„è¯ï¼Œ<code>Class.__call__(*args, **kwargs)</code>è¿˜æ‰¿æ‹…ç€äº§ç”Ÿç±»å®ä¾‹çš„åŠŸèƒ½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤ç»§æ‰¿çš„æ˜¯object, è€Œä¸æ˜¯type</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        print(<span class="string">"init"</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">"call"</span>)</span><br><span class="line"><span class="comment"># å½“æ²¡æœ‰é‡å†™__call__æ—¶</span></span><br><span class="line">res = Meta.__call__(<span class="string">"asd"</span>)</span><br><span class="line">print(res, type(res))</span><br><span class="line">res = Meta(<span class="string">"asd"</span>)</span><br><span class="line">print(res, type(res))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000014FB5115EE0&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000014FB5115A90&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">ä¸Šè¿°ä¸¤ç§éƒ½èƒ½åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># å½“é‡å†™__call__ä»¥å, __call__()è¿”å›å®ä¾‹çš„æ•ˆæœå°±å¤±æ•ˆäº†</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">call</span></span><br><span class="line"><span class="string">None &lt;class 'NoneType'&gt;</span></span><br><span class="line"><span class="string">init</span></span><br><span class="line"><span class="string">&lt;__main__.Meta object at 0x0000016CC2745EE0&gt; &lt;class '__main__.Meta'&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># å½“ç»§æ‰¿typeæ—¶ï¼Œæ‰€æœ‰éƒ½å¤±æ•ˆäº†ï¼Œæ²¡åŠæ³•å†ä»¥__call__å’ŒMeta()æ¥åˆ›å»ºå®ä¾‹äº†</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   res = Meta("asd")</span></span><br><span class="line"><span class="string">TypeError: type.__new__() takes exactly 3 arguments (1 given)</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>Q:æˆ‘ä»¬åœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™<code>f = Foo(1, y=2)</code>ï¼Œå¯ä»¥å‘ç°åœ¨<code>__init__()</code>ä¸­å¹¶æ²¡æœ‰è¿”å›å®ä¾‹ï¼Œä½†è°ƒç”¨<code>Foo(1, y=2)</code><strong>ç¡®å®</strong>è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”ï¼Œ<code>__init__</code>é¢„æœŸä¸€ä¸ª<code>self</code>å‚æ•°ï¼Œä½†æ˜¯å½“æˆ‘ä»¬è°ƒç”¨<code>Foo(1, y=2)</code>æ—¶è¿™é‡Œå¹¶æ²¡æœ‰è¿™ä¸ªå‚æ•°ã€‚é‚£ä¹ˆç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><p>A:æ„é€ é¡ºåºâ€”â€”<a href="https://www.jianshu.com/p/f63ad9d550f1" target="_blank" rel="noopener">ç†è§£pythonçš„ç±»å®ä¾‹åŒ–</a></p><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼ŒPythonä¸­çš„<strong>ç±»ä¹Ÿæ˜¯å¯¹è±¡</strong>ï¼ç±»ã€å‡½æ•°ã€æ–¹æ³•ä»¥åŠå®ä¾‹éƒ½æ˜¯å¯¹è±¡â€”â€”typeçš„å¯¹è±¡ï¼Œå¹¶ä¸”æ— è®ºä½•æ—¶ä½ å°†ä¸€å¯¹æ‹¬å·æ”¾åœ¨å®ƒä»¬çš„åå­—åé¢æ—¶ï¼Œå°±ä¼šè°ƒç”¨å®ƒä»¬çš„<code>__call__</code>æ–¹æ³•ã€‚æ‰€ä»¥<code>Foo(1, y=2)</code>æ˜¯ç­‰ä»·äº<code>Foo.__call__(1, y=2)</code>çš„ã€‚<code>__call__</code>æ–¹æ³•æ˜¯å®šä¹‰åœ¨<code>Foo</code>çš„ç±»ä¸­çš„ã€‚<code>Foo</code>çš„ç±»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Foo.__class__</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">type</span>'&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥<code>Foo</code>æ˜¯ç±»å‹<code>type</code>çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨typeç±»çš„<code>__call__(self, *args, **kwargs)</code>è¿”å›ä¸€ä¸ª<code>Foo</code>ç±»çš„å¯¹è±¡ã€‚è®©æˆ‘ä»¬çœ‹ä¸‹<code>type</code>ä¸­çš„<code>__call__</code>æ–¹æ³•æ˜¯ä»€ä¹ˆæ ·çš„ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å½“çš„å¤æ‚ï¼Œä½†æ˜¯æˆ‘ä»¬å°è¯•å°½é‡ç®€åŒ–å®ƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™è¾¹çš„obj_typeè·Ÿclsä¸€æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(obj_type, *args, **kwargs)</span>:</span></span><br><span class="line">    <span class="comment"># é€šè¿‡__new__åˆ›å»ºä¸€ä¸ªç©ºçš„ç±»å®ä¾‹ï¼Œå¦‚æœobj_typeæ²¡æœ‰__new__åˆ™ä½¿ç”¨type.__new__</span></span><br><span class="line">    obj = obj_type.__new__(*args, **kwargs)</span><br><span class="line">    <span class="comment"># è¿›è¡Œç±»å‹æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">if</span> obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> issubclass(obj, obj_type):</span><br><span class="line">        <span class="comment"># å¯¹ç±»è¿›è¡Œ__init__åˆå§‹åŒ–</span></span><br><span class="line">        obj.__init__(*args, **kwargs)</span><br><span class="line">    <span class="comment"># è¿”å›ç±»å®ä¾‹</span></span><br><span class="line">    <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure><p>å¯è§<code>__new__</code>æ–¹æ³•ä¸ºå¯¹è±¡åˆ†é…äº†å†…å­˜ç©ºé—´ï¼Œæ„å»ºå®ƒä¸ºä¸€ä¸ªâ€œç©º&quot;å¯¹è±¡ç„¶å<code>__init__</code>æ–¹æ³•è¢«è°ƒç”¨æ¥åˆå§‹åŒ–å®ƒã€‚</p><p>æ€»çš„æ¥è¯´ï¼š</p><ol><li><code>Foo(*args, **kwargs)</code>ç­‰ä»·äº<code>Foo.__call__(*args, **kwargs)</code></li><li>æ—¢ç„¶<code>Foo</code>æ˜¯ä¸€ä¸ª<code>type</code>çš„å®ä¾‹ï¼Œ<code>Foo.__call__(*args, **kwargs)</code>å®é™…è°ƒç”¨çš„æ˜¯<code>type.__call__(Foo, *args, **kwargs)</code></li><li><code>type.__call__(Foo, *args, **kwargs)</code>è°ƒç”¨<code>obj_type.__new__(*args, **kwargs)</code>ä¹Ÿå°±æ˜¯<code>type.__new__(Foo, *args, **kwargs)</code>ï¼Œç„¶åè¿”å›ä¸€ä¸ªå¯¹è±¡å®ä¾‹objã€‚</li><li><code>obj</code>éšåé€šè¿‡è°ƒç”¨<code>obj.__init__(*args, **kwargs)</code>è¢«åˆå§‹åŒ–ã€‚</li><li><code>obj</code>è¢«<code>type.__call__</code>ä¸­è¿”å›ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­£æ˜¯å› ä¸ºéƒ½ç”¨åˆ°äº†åŸå‹typeä¸­çš„<code>__call__</code>ï¼Œå¦‚æœç±»å¯¹<code>__call__</code>è¿›è¡Œäº†<strong>å®šä¹‰</strong>(æ³¨æ„ä¸æ˜¯é‡å†™ï¼Œ<code>print(dir(Class))</code>æ—¶èƒ½çœ‹åˆ°<code>__call__</code>å¹¶ä¸åœ¨å…¶ä¸­)ï¼Œæ¯”å¦‚ <code>Foo</code> å®šä¹‰äº†ä¸€ä¸ª <code>__call__</code>æ–¹æ³•ï¼Œ<code>Foo.__call__(*args, **kwargs)</code>ä¸å†ç­‰äº<code>Foo(*args, **kwargs)</code> ï¼Œå› ä¸ºå…¶<code>Foo.__call__</code>å®šä¹‰ä¸­æ˜ç¡®æŒ‡å‡ºéœ€è¦ä¸€ä¸ªselfå˜é‡===&gt; å®é™…ä¸Šä¸ç®¡æ˜¯ä¸æ˜¯å®šä¹‰äº†<code>__call__</code>ï¼Œè¿›è¡Œ<code>Foo(*args, **kwargs)</code>åˆ›å»ºå®ä¾‹æ—¶éƒ½è¿›è¡Œäº†<code>type.__call__</code>çš„é€»è¾‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class A(type):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print(&quot;init&quot;)</span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        print(&quot;end&quot;)</span><br><span class="line">    def __call__(self, *args, **kwargs):</span><br><span class="line">        print(&quot;A call&quot;)</span><br><span class="line">        return self</span><br><span class="line">class Meta(A):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">res = type.__new__(Meta, &quot;instance&quot;, (), &#123;&#125;)</span><br><span class="line"># å½“Aæœ‰__call__æ—¶ï¼Œres.__call__()å’Œres()éƒ½ä¼šæ‰§è¡Œ__call__é‡Œçš„é€»è¾‘</span><br><span class="line">print(res, type(res))</span><br><span class="line">print(res.__call__())</span><br><span class="line">print(type(res()))</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">&lt;class &apos;__main__.instance&apos;&gt; &lt;class &apos;__main__.Meta&apos;&gt;</span><br><span class="line">&lt;class &apos;__main__.instance&apos;&gt;</span><br><span class="line">&lt;class &apos;__main__.Meta&apos;&gt;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># å½“æ²¡æœ‰__call__æ—¶ï¼Œå°†ä¼šè°ƒç”¨type.__call__åˆ›å»ºä¸€ä¸ªå®ä¾‹</span><br><span class="line">&lt;class &apos;__main__.instance&apos;&gt; &lt;class &apos;__main__.Meta&apos;&gt;</span><br><span class="line">&lt;__main__.instance object at 0x0000027186E65B20&gt;</span><br><span class="line">&lt;class &apos;__main__.instance&apos;&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;xxxatrrå®¶æ—&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#xxxatrrå®¶æ—&quot;&gt;&lt;/a&gt; xxxatrrå®¶æ—&lt;/h2&gt;
&lt;h3 id=&quot;hasattr&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#h
      
    
    </summary>
    
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>JSé€†å‘-webpackæ‰“åŒ…ç½‘ç«™å®æˆ˜</title>
    <link href="https://nymrli.top/2022/03/23/JS%E9%80%86%E5%90%91-webpack%E6%89%93%E5%8C%85%E7%BD%91%E7%AB%99%E5%AE%9E%E6%88%98/"/>
    <id>https://nymrli.top/2022/03/23/JSé€†å‘-webpackæ‰“åŒ…ç½‘ç«™å®æˆ˜/</id>
    <published>2022-03-23T08:21:50.000Z</published>
    <updated>2022-04-03T09:25:42.237Z</updated>
    
    <content type="html"><![CDATA[<h1 id="webpacké€†å‘"><a class="markdownIt-Anchor" href="#webpacké€†å‘"></a> Webpacké€†å‘</h1><p><a href="https://so.csdn.net/so/search?q=webpack&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">webpack</a>æ‰“åŒ…æ˜¯å‰ç«¯jsæ¨¡å—åŒ–å‹ç¼©æ‰“åŒ…å¸¸ç”¨çš„æ‰‹æ®µï¼Œç‰¹å¾æ˜æ˜¾ï¼Œæ¯”å¦‚ä¸‹æ–¹çš„å½¢å¼çš„ä»£ç å°±æ˜¯webpack<strong>åˆ†å‘å™¨</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ†å‘å™¨</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">xx</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ..call(**.exports, ***, ***.exports, xx)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>åˆæˆ–è€…æ›´ç›´è§‚çš„è¡¨ç°n[â€œxxxâ€]è¿™ç§ï¼Œä½ å¯ä»¥å¤§æ¦‚çŸ¥é“äº†è¿™æ˜¯è°ƒç”¨äº†webpackæ‰“åŒ…çš„jsæ¨¡å—ä»£ç ã€‚</p><p><strong>webpackæ‰“åŒ…åJSä¾èµ–æ¨¡å—ä»£ç çš„å›ºå®šç»“æ„</strong>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">this</span>[<span class="string">"webpackJsonpzsgk-pc"</span>] = <span class="keyword">this</span>[<span class="string">"webpackJsonpzsgk-pc"</span>] || []).push([[<span class="number">15</span>], [<span class="function"><span class="keyword">function</span>(<span class="params">e, t, n</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    e.exports = n(<span class="number">693</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‚æ•°å›ºå®šä¸ºe, t, n</span></span><br><span class="line">, <span class="function"><span class="keyword">function</span>(<span class="params">e, t, n</span>) </span>&#123;</span><br><span class="line">    e.exports = n(<span class="number">697</span>)()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯´ä¸ªé€†å‘webpackçš„é€šç”¨æ–¹æ³•ï¼š</p><ol><li><p>å…ˆå»æ‰¾åŠ å¯†ç½‘ç«™çš„<strong>åŠ å¯†å…¥å£</strong>ã€‚è¿™åº”è¯¥æ˜¯åŠ å¯†ç½‘ç«™éƒ½å¿…é¡»è¦åšçš„==&gt; ç›´æ¥æ ¹æ®å‚æ•°åæœç´¢å‚æ•°</p></li><li><p>æ‰¾åˆ°<strong>åˆ†å‘å™¨çš„ä½ç½®</strong>ï¼Œæˆ–è€…è¯´æ˜¯åŠ è½½å™¨ï¼Œn[â€œxxxâ€]è¿™ç§çš„nå°±æ˜¯åˆ†å‘å™¨ï¼Œå°±æ¯”å¦‚ä¸‹æ–¹ä¸­çš„exportsçš„ä½ç½®ï¼Œæœ€åæ‰§è¡Œäº†då‡½æ•°==&gt;ä¸€èˆ¬æ˜¯runtimexxx.jsä¸­(æä¾›ç¯å¢ƒ)ï¼›ä¸€èˆ¬ä»¥<code>! function(e) {</code>çš„å½¢å¼å‡ºç°</p><p><img src="/2022/03/23/JSé€†å‘-webpackæ‰“åŒ…ç½‘ç«™å®æˆ˜/%E5%88%86%E5%8F%91%E5%99%A8.jpg" alt="åˆ†å‘å™¨"></p></li><li><p>å¯»æ‰¾åˆ†å‘ç¼–å·ã€åŠ å¯†ä½¿ç”¨æ¨¡å—ï¼ˆç”¨åˆ°äº†å“ªäº›æ¨¡å—å°±å¯¼å…¥å“ªäº›æ¨¡å—ï¼‰==&gt;ä¸€èˆ¬åœ¨chunk-lib.jsï¼Œä»¥<code>(window.webpackJsonp = window.webpackJsonp || []).push([</code>çš„å½¢å¼å‡ºç°</p></li><li><p>å°†å‡½æ•°å…¥å£çš„åœ°æ–¹è¿”å›å…¨å±€å˜é‡ï¼Œæœ€ç»ˆè¿”å›: <code>var sign; var window = global;!function(){... sign = d}</code>ï¼Œ èµ‹å€¼ä¸ºåˆ†å‘å™¨è¿”å›çš„d</p></li><li><p>ä½¿ç”¨è‡ªå®šä¹‰çš„signä»£æ›¿webpackä»£ç ä¸­çš„nè¿›è¡ŒåŠ å¯†</p></li></ol><p>from: <a href="https://blog.csdn.https" target="_blank" rel="noopener">https://blog.csdn.https</a>ğŸ˜•/blog.csdn.net/weixin_41586984/article/details/116268341net/weixin_41586984/article/details/116268341</p><h2 id="è°ƒè¯•æŠ€å·§"><a class="markdownIt-Anchor" href="#è°ƒè¯•æŠ€å·§"></a> è°ƒè¯•æŠ€å·§</h2><h3 id="å®šä½è¯·æ±‚å‚æ•°"><a class="markdownIt-Anchor" href="#å®šä½è¯·æ±‚å‚æ•°"></a> å®šä½è¯·æ±‚å‚æ•°</h3><ol><li><p>æ‰“å¼€å¼€å‘è€…å·¥å…·åï¼ŒF5åˆ·æ–°å<code>Ctrl + Shift + F</code>æœç´¢å‚æ•°åï¼Œå¦‚signdataï¼Œä¼šæ˜¾ç¤ºå¤šä¸ªJSæ–‡ä»¶ï¼Œé€‰æ‹©åä»”ç»†æŸ¥çœ‹(ç‚¹å‡»å·¦ä¸‹è§’<code>{}</code>ç¾è§‚æ ¼å¼åŒ–æŒ‰é’®)ã€‚</p><p>moreï¼š å¦‚æœæ–‡ä»¶å¤ªå¤šï¼Œåˆ™ç›´æ¥é€šè¿‡è¯·æ±‚çš„é“¾æ¥å»æ‰¾ï¼Œæ¯”å¦‚<code>user/login</code></p></li><li><p>Networkæ‰¾åˆ°æ–°å‘å‡ºçš„xhræ¡ç›®åï¼ŒæŸ¥çœ‹Initiatoré‡Œçš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œå¦‚Loginï¼›</p></li></ol><p>æ³¨ï¼š å¦‚æœåŠ å¯†å‚æ•°åç§°æ¯”è¾ƒç®€å•å¦‚sï¼Œæ¯”è¾ƒéš¾å®šä½çš„è¯ï¼Œå¯ä»¥å€ŸåŠ©è¯·æ±‚çš„å…¶ä»–å‚æ•°æ¥æŸ¥æ‰¾ï¼Œæ¯”å¦‚verificationCode</p><h3 id="è°ƒè¯•å·¥å…·"><a class="markdownIt-Anchor" href="#è°ƒè¯•å·¥å…·"></a> è°ƒè¯•å·¥å…·</h3><ul><li>æ–­ç‚¹è°ƒè¯•breakpoints</li><li>XHRæ–­ç‚¹ï¼š XHR/fetch breakpoints</li></ul><h2 id="é™„å½•-jsè®°å½•"><a class="markdownIt-Anchor" href="#é™„å½•-jsè®°å½•"></a> é™„å½•-Jsè®°å½•</h2><ul><li><p>æ—¶é—´æˆ³: <code>(new Date).getTime()</code></p></li><li><p><code>var a = (f1(), f2(), f3())</code>åï¼Œf1ã€f2ã€f3å‡½æ•°éƒ½ä¼šæ‰§è¡Œï¼Œè€Œaæœ€åçš„ç»“æœä¸ºf3çš„è¿”å›å€¼</p></li><li><p>javascript:void(0):  <strong>void</strong> æ˜¯ JavaScript ä¸­éå¸¸é‡è¦çš„å…³é”®å­—ï¼Œè¯¥æ“ä½œç¬¦æŒ‡å®šè¦è®¡ç®—ä¸€ä¸ªè¡¨è¾¾å¼ä½†æ˜¯ä¸è¿”å›å€¼ã€‚</p></li><li><p><code>TypeError: window.btoa is not a function</code></p><p>btoa-atob æ¨¡å—æ²¡æœ‰è¾“å‡ºä¸€ä¸ªç¼–ç¨‹æ¥å£ï¼Œå®ƒåªæä¾›å‘½ä»¤è¡Œå·¥å…·ã€‚</p><p>å¦‚æœä½ éœ€è¦è½¬æ¢ä¸ºBase64ï¼Œä½ å¯ä»¥ç”¨Bufferæ¥å®Œæˆã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Buffer.from(<span class="string">'Hello World!'</span>).toString(<span class="string">'base64'</span>));</span><br></pre></td></tr></table></figure><p>ç›¸åçš„ï¼Œå‡è®¾ä½ è¦è§£ç çš„å†…å®¹æ˜¯ä¸€ä¸ªbase64ç¼–ç è¿‡çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Buffer.from(b64Encoded, <span class="string">'base64'</span>).toString());</span><br></pre></td></tr></table></figure></li></ul><h1 id="åšé¢˜è®°å½•"><a class="markdownIt-Anchor" href="#åšé¢˜è®°å½•"></a> åšé¢˜è®°å½•</h1><h2 id="nstré¢˜å‹"><a class="markdownIt-Anchor" href="#nstré¢˜å‹"></a> n[â€œstrâ€]é¢˜å‹ï¼š</h2><h3 id="å¤©å®‰è´¢é™©"><a class="markdownIt-Anchor" href="#å¤©å®‰è´¢é™©"></a> å¤©å®‰è´¢é™©</h3><blockquote><p><code>var m = this.newEncrypt(JSON.stringify(h));</code></p></blockquote><ul><li><p>éœ€è¦å¯¹this.privaKeyçš„å€¼ç»†åŒ–ä¸‹ï¼Œä¼ å…¥æ‹¿åˆ°å›ºå®šçš„str</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//           , p = t("NFKh")          , s = t("cg2h")</span></span><br><span class="line">l.prototype.newEncrypt = <span class="function"><span class="keyword">function</span>(<span class="params">l</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> n = p.enc.Utf8.parse(<span class="keyword">this</span>.privaKey)</span><br><span class="line">                  , t = p.enc.Utf8.parse(<span class="keyword">this</span>.privaKey)</span><br><span class="line">                  , e = p.enc.Utf8.parse(l)</span><br><span class="line">                  , a = p.AES.encrypt(e, n, &#123;</span><br><span class="line">                    iv: t,</span><br><span class="line">                    mode: p.mode.CBC,</span><br><span class="line">                    padding: p.pad.Pkcs7</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span> p.enc.Base64.stringify(a.ciphertext)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="è´¢æ–°ç½‘"><a class="markdownIt-Anchor" href="#è´¢æ–°ç½‘"></a> è´¢æ–°ç½‘</h3><blockquote><p><code>password: this.encode(this.encrypt(this.form.password)),</code></p></blockquote><ul><li><code>c = a(&quot;3452&quot;)</code>ã€<code>n = a.n(c)</code>ï¼Œçœ‹åˆ°éœ€è¦ä¾èµ–3452åç«‹é©¬Ctrl+shift+Få…¨å±€æœ3452ï¼Œç„¶åæŠŠæ•´ä¸ªwebpackæ¨¡å—æ‰’ä¸‹æ¥</li></ul><h3 id="ä¸­è¿œæµ·è¿"><a class="markdownIt-Anchor" href="#ä¸­è¿œæµ·è¿"></a> ä¸­è¿œæµ·è¿</h3><ul><li>n(â€œMuMZâ€)ä¸­åˆæœ‰<code>r = n(&quot;XBrZ&quot;);</code>ï¼Œåœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œmoduleéœ€è¦æ”¾ä¸¤ä¸ª</li></ul><h3 id="å¤©ç¿¼äº‘"><a class="markdownIt-Anchor" href="#å¤©ç¿¼äº‘"></a> å¤©ç¿¼äº‘ï¼š</h3><blockquote><p><code>var t = encodeURIComponent(c[&quot;c&quot;].Des.encrypt(this.form.email, this.form.pwd)),</code></p></blockquote><p>webpackå®ç°</p><p><code>c = (mycode(&quot;ac6a&quot;), mycode(&quot;b3ae&quot;))</code></p><ul><li>åˆ†å‘å™¨å’Œac6aæ¨¡å—åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ã€è€Œac6aæ¨¡å—ä¾èµ–æ¨¡å—åœ¨å¦ä¸€ä¸ªæ–‡ä»¶å†…ï¼›</li><li>åˆ†å‘å™¨()({})ï¼Œæ— æ„Ÿå¹å·</li><li>åˆ†å‘å™¨()({})å¤§æ‹¬å·ä¸­è‡ªå¸¦è¾ƒå¤šä¾èµ–æ¨¡å—</li></ul><p>è‡ªå·±å®ç°ï¼šç›´æ¥æ‰’ä¸‹æ¥encryptåŠ å¯†çš„JSå†…å®¹</p><h3 id="çœ‹å‡†ç½‘"><a class="markdownIt-Anchor" href="#çœ‹å‡†ç½‘"></a> çœ‹å‡†ç½‘</h3><ul><li>åˆ†å‘å™¨n(â€œxxxâ€)å®šä½åè·Ÿä¸€èˆ¬çš„å›ºå®šæ ¼å¼è¿”å›aã€nã€rä¸åŒï¼Œå†™çš„æ˜¯ä¸ªå‡½æ•°==&gt;è¿˜æ˜¯å¯ä»¥æ ¹æ®obj.Funcæ¥èµ‹å€¼<code>mycode = obj;</code></li><li><a href="https://www.bilibili.com/video/BV1bb4y127bc?spm_id_from=333.999.0.0" target="_blank" rel="noopener">JSé€†å‘å®æˆ˜åˆ†æâ€“çœ‹å‡†ç½‘webpackåŠ è§£å¯†åˆ†æ</a>â€”â€”Pythonä¸­ä½¿ç”¨execjsç¤ºèŒƒ</li></ul><h3 id="ä¼åç‰‡"><a class="markdownIt-Anchor" href="#ä¼åç‰‡"></a> <a href="https://www.qimingpian.cn/finosda/project/pinvestment" target="_blank" rel="noopener">ä¼åç‰‡</a></h3><blockquote><ul><li><code>u = i(&quot;x4Ab&quot;)</code></li><li><code>return e.encrypt_data &amp;&amp; (e.data = Object(u.a)(e.encrypt_data)),</code></li></ul></blockquote><ul><li><p>x4Abæ¨¡å—ä¾èµ–aqBwï¼ŒaqBwåˆä¾èµ–YuTiã€yLpjï¼Œå› æ­¤ä¾èµ–é¡¹ä¸­æ”¾&quot;x4Ab&quot;ã€â€œaqBwâ€ã€â€œYuTiâ€ã€&quot;yLpj&quot;å‡½æ•°å®šä¹‰</p></li><li><p>æ¨¡æ‹Ÿè§£æå‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> data &amp;&amp; (<span class="built_in">Object</span>(u.a)(data))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="nnumé¢˜å‹"><a class="markdownIt-Anchor" href="#nnumé¢˜å‹"></a> n[num]é¢˜å‹ï¼š</h2><h3 id="å¤§éº¦"><a class="markdownIt-Anchor" href="#å¤§éº¦"></a> å¤§éº¦</h3><ul><li>åˆ é™¤åˆ†å‘å™¨å¤šä½™ä»£ç </li><li><code>var navigator = {}</code></li></ul><h3 id="æŒä¸Šé«˜è€ƒ"><a class="markdownIt-Anchor" href="#æŒä¸Šé«˜è€ƒ"></a> <a href="https://www.gaokao.cn/school/263/provinceline" target="_blank" rel="noopener">æŒä¸Šé«˜è€ƒ</a>ï¼š</h3><ol><li>åˆ†å‘å™¨åœ¨htmlæ–‡ä»¶å†…</li><li><code>o = (u=a(42), a.n(u))</code>ï¼Œä½¿ç”¨åˆ°äº†<code>a.n(u)</code>å³ç‚¹nå‡½æ•°</li><li>ä¾èµ–å‡½æ•°çš„ç»™å‡ºæ˜¯ä»¥æ•°ç»„çš„å½¢å¼ï¼Œè€Œä¸æ˜¯å­—å…¸çš„å½¢å¼</li><li>æ¨¡å—ä¸­ä¾èµ–æ›´å¤šæ¨¡å—==&gt;å¼•å…¥æ•´ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œä½†æ˜¯è·Ÿ&quot;xxx&quot;æ¨¡å¼ä¸åŒçš„æ˜¯ï¼Œç”±äºæ²¡æœ‰ç”¨å­—å…¸<code>{&quot;xxx&quot;: function()}</code>çš„å½¢å¼ï¼Œå› æ­¤ç›´æ¥requireä¹Ÿæ²¡ç”¨<code>TypeError: Cannot read property '42' of undefined</code>ï¼Œè€Œæ˜¯å°†ä¾èµ–æ¨¡å—æ•°ç»„ä½œä¸ºå‚æ•°å†™å…¥åˆ°åˆ†å‘å™¨ä¾èµ–å‡½æ•°ä¸­<code>!function(e){}([...])</code>å³æ–¹æ‹¬å·ä¸­ï¼Œä»è€Œæ‰èƒ½æ‰¾åˆ°42å‡½æ•°</li></ol><h3 id="é…·æˆ‘"><a class="markdownIt-Anchor" href="#é…·æˆ‘"></a> <a href="https://www.bilibili.com/video/BV1gq4y1D781?from=search&amp;seid=7720105602891609746&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener">é…·æˆ‘</a></h3><blockquote><p><code>t.data.reqId = n,</code></p></blockquote><ul><li><p>ç›´æ¥é€šè¿‡n(109)å®šä½å¯èƒ½ä¸é‚£ä¹ˆå‡†ç¡®(åŒå‡»åå®šä½çš„å‡½æ•°)ï¼Œå¯ä»¥è¯•ç€ç›´æ¥åœ¨åˆ†å‘å™¨ä½ç½®è¿›è¡Œæ–­ç‚¹ï¼Œç„¶åconsoleè¾“å‡ºe[â€œ109â€]</p></li><li><p>åªè¦åˆ†å‘å™¨å®šä¹‰éƒ¨åˆ†(å…¶ä»–çš„åˆ äº†ï¼Œå› ä¸ºåªç”¨äº†<code>l=n(109)ã€c=n.n(l)</code>)+ä¾èµ–æ¨¡å—ä¸­å®šä¹‰109å‡½æ•°(æ•´ä¸ªfunctionè€Œä¸æ˜¯t.exports)ï¼Œä»¥åŠè§‚å¯Ÿå…¶ä¸­è¿˜ä¾èµ–ä»€ä¹ˆå¦‚n(202)ã€n(203)å°±è¡¥å……æ‹¿ä»€ä¹ˆ</p><ul><li>n.n(l)æ˜¯ä¼ å…¥ä»€ä¹ˆå°±è¿”å›ä»€ä¹ˆ:<a href="https://www.bilibili.com/video/BV1gq4y1D781?from=search&amp;seid=7720105602891609746&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1gq4y1D781?from=search&amp;seid=7720105602891609746&amp;spm_id_from=333.337.0.0</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœä¸åˆ åˆ†å‘å™¨ä¸­å…¶ä»–éƒ¨åˆ†</span></span><br><span class="line">l = mycode(<span class="number">109</span>)</span><br><span class="line">c = mycode.n(l)<span class="comment">// ==&gt;å¾—åˆ°l</span></span><br><span class="line"><span class="keyword">var</span> r = c()();</span><br><span class="line"><span class="built_in">console</span>.log(r)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºåªç”¨åˆ°äº†n.n(l)ï¼Œæ‰€ä»¥å¯ä»¥åˆ åˆ†å‘å™¨å¤§ä»£ç ä¸­å…¶ä»–éƒ¨åˆ†, åœ¨ä½¿ç”¨æ—¶ç›´æ¥è®©c=l</span></span><br><span class="line">l = mycode(<span class="number">109</span>)</span><br><span class="line">c = l();</span><br><span class="line"><span class="built_in">console</span>.log(c)<span class="comment">// ç­‰ä»·äº r = l(); console(r)</span></span><br></pre></td></tr></table></figure></li></ul><p>æ–‡ç« : <a href="https://blog.csdn.net/weixin_43189702/article/details/119860838" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43189702/article/details/119860838</a></p><h2 id="æ³¨æ„"><a class="markdownIt-Anchor" href="#æ³¨æ„"></a> æ³¨æ„ï¼š</h2><ul><li><p>requireæ¨¡å—å†…å®¹å¯ä»¥æ”¾åœ¨é€†å‘JSæ–‡ä»¶é‡Œä¸€èµ·ï¼Œè€Œä¸æ˜¯ä¸€å®šå¾—åˆ›å»ºæ–°çš„JSæ–‡ä»¶å¯¼å…¥</p></li><li><p>å…ˆç™»å½•ç„¶åæ‰¾åˆ°åŠ å¯†å¤„åŠ æ–­ç‚¹ï¼Œè¿™ä¸ªæ–­ç‚¹ä¼šåœ¨å‘èµ·ç™»å½•è¯·æ±‚æ—¶æ‰è§¦å‘ï¼›å¾€ä¸Šæ‰¾åˆ†å‘å™¨ï¼ŒåŠ ä¸Šæ–­ç‚¹ï¼Œåˆ†å‘å™¨ä½ç½®çš„æ–­ç‚¹æ˜¯åœ¨é¡µé¢åˆ·æ–°æ—¶è§¦å‘ï¼Œå› æ­¤è¦è§¦å‘è¿™ä¸ªæ–­ç‚¹éœ€è¦åˆ·æ–°é¡µé¢</p></li><li><p>æ‰¾åŠ å¯†å‡½æ•°<code>c[&quot;c&quot;].Des.encrypt(this.form.email, this.form.pwd)</code>çš„æ—¶å€™ï¼Œæ‰¾å®Œæ•´çš„å‡½æ•°å¦‚c[â€œcâ€].Des.encryptï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰¾c</p></li><li><p>n(42), æˆ–è€…n(â€œxxxâ€)ï¼Œå¯ä»¥ç›´æ¥æœxxxï¼Œä¹Ÿå¯ä»¥åœ¨consoleé‡Œé¢è¾“å‡ºåæ‰¾åˆ°å¯¹åº”çš„FunctionLocationæ¥å¿«é€Ÿå®šä½</p></li><li><p>å¦‚æœä¾èµ–æ¨¡å—æ˜¯å­—å…¸çš„å½¢å¼ï¼Œåˆ™åˆ†å‘å™¨ä¾èµ–ä¸­å†™å­—å…¸ï¼Œå¦‚<code>!function(e){..}({ 32:function(){...}})</code>ï¼ˆä¸€èˆ¬æƒ…å†µ<code>n(32)ã€n(&quot;ABCD&quot;)</code>ï¼‰ï¼Œ å¦‚æœä¸æ˜¯åˆ™éœ€è¦ä¼ å‡½æ•°æ•°ç»„ï¼Œå¦‚<code>n(42)</code>ï¼Œæ­¤å¤„42è¡¨ç¤ºçš„æ˜¯ç¬¬42ä¸ªå‡½æ•°ï¼Œè§æŒä¸Šé«˜è€ƒã€‚</p></li><li><p><code>var mycode;</code>åèµ‹å€¼çš„ä½ç½®ç›´æ¥åœ¨åˆ†å‘å™¨çš„ä¸‹æ–¹å³å¯ï¼Œä¸ç”¨åœ¨æœ€åé¢</p></li><li><p>æç¤ºç¼ºå°‘<code>window</code>æ—¶ï¼Œå®šä¹‰å…¨å±€å˜é‡<code>var window = global;</code>ï¼Œï¼ˆJSé€†å‘æ–‡ä»¶ã€ä¾èµ–æ–‡ä»¶ï¼‰</p><ul><li><p>windowè¡¨ç¤º<strong>æµè§ˆå™¨</strong>æ‰“å¼€çš„çª—å£ï¼Œåœ¨å®¢æˆ·ç«¯JavaScriptä¸­windowå¯¹è±¡æ˜¯å…¨å±€çš„å¯¹è±¡ï¼Œæ‰€æœ‰ JavaScript å…¨å±€å¯¹è±¡ã€å‡½æ•°ä»¥åŠå˜é‡å‡è‡ªåŠ¨æˆä¸º window å¯¹è±¡çš„æˆå‘˜ã€‚ä½†åœ¨nodejsä¸­ç›´æ¥è°ƒç”¨windowæ˜¯ä¸å­˜åœ¨çš„ï¼Œè€Œä»£æ›¿çš„æ˜¯globalï¼Œæ‰€ä»¥è¦ç”¨nodejsè¿è¡Œæ—¶ï¼Œå¾—ç”¨<code>var window = global;</code></p></li><li><p><code>var navigator = this</code>ç­‰ä»·äº<code>var navigator = {}</code>ï¼Œå› ä¸ºåœ¨NodeJSæ–‡ä»¶ä¸­è¿è¡Œè¾“å‡ºthisåå¯ä»¥å‘ç°<code>this={}</code>ï¼Œè€Œåœ¨æµè§ˆå™¨ä¸­thisé»˜è®¤ä¸ºwindowï¼ˆå‡½æ•°æˆ–ç±»ä½œç”¨åŸŸå†…ä¸ºå‡½æ•°æˆ–è€…ç±»å®ä¾‹ï¼‰</p></li><li><p>fromï¼š<a href="https://blog.csdn.net/mystric594/article/details/72519788" target="_blank" rel="noopener">JSä¸­documentå’Œwindowçš„åŒºåˆ«</a></p></li></ul></li></ul><p><strong>å¿ƒå¾—</strong></p><p>â‘ æ‰€æœ‰webpackæ‰“åŒ…çš„çš„jséƒ½è¦å…ˆçœ‹æ‡‚æ‰“åŒ…å<strong>ä»£ç è¿è¡Œ</strong>çš„é¡ºåºï¼Œæ‰¾åˆ°åŠ å¯†å¤„ï¼›â‘¡æ‰¾åˆ°webpackå¯¹è±¡ï¼Œä¸€èˆ¬æ˜¯ n(æ•°å­—) è°ƒç”¨â‘¢ç¡®å®šåˆ†å‘å™¨ã€‚â‘£æ‰¾ä¾èµ–æ¨¡å—ï¼Œæœ‰æ—¶å€™å„åŒ…çš„ä¾èµ–å…³ç³»å¤ªå¤šï¼Œå¯ä»¥ç›´æ¥æŠŠæ–‡ä»¶çˆ¬ä¸‹æ¥å¼•å…¥ï¼Œå¦‚æœå„ä¸ªåŒ…çš„ä¾èµ–å…³ç³»ä¸å¤šï¼Œå°±å¯ä»¥åªæŠŠè°ƒç”¨åˆ°çš„å‡½æ•°æ‰¾å‡ºæ¥æ”¾åˆ°ä¾èµ–ä¸­ã€‚â‘¤æœ€åå‰©ä¸‹çš„å°±æ˜¯æ‰¾åˆ°ä½ è¦çš„ä»£ç ï¼Œæ…¢æ…¢å¤ç°è°ƒç”¨åŠ å¯†/è§£å¯†å‡½æ•°å°±å¥½äº†ã€‚</p><h2 id="åšé¢˜æ¡ˆä¾‹å­¦ä¹ è§†é¢‘"><a class="markdownIt-Anchor" href="#åšé¢˜æ¡ˆä¾‹å­¦ä¹ è§†é¢‘"></a> åšé¢˜æ¡ˆä¾‹å­¦ä¹ è§†é¢‘</h2><ul><li>webpackå¸ˆæ‰¿ï¼š<a href="https://space.bilibili.com/453818250/video?tid=0&amp;page=1&amp;keyword=&amp;order=pubdate" target="_blank" rel="noopener">çˆ¬å–webpackæµç¨‹-è§†é¢‘</a>â€”â€”å¤§å¤šéƒ½æ˜¯n(â€œXvmdâ€)</li><li>è€Œå¦‚æœnä¸­è°ƒç”¨çš„ä¸æ˜¯å­—å…¸çš„å½¢å¼ï¼Œè€Œæ˜¯åˆ—è¡¨çš„å½¢å¼ï¼Œåˆ™çœ‹<a href="https://www.cnblogs.com/Eeyhan/p/15562632.html" target="_blank" rel="noopener">jsé€†å‘å®‰å…¨æŒ‡å—ï¼ˆ3ï¼‰-- webpackè§£åŒ…æŒ‡å—</a>ã€<a href="https://www.bilibili.com/video/BV1gq4y1D781?from=search&amp;seid=7720105602891609746&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener">ä½¿ç”¨ webpack çš„ js åŠ å¯†å‚æ•°çš„åˆ†æâ€”â€”é…·æˆ‘</a></li></ul><h2 id="è¿›é˜¶èµ„æ–™"><a class="markdownIt-Anchor" href="#è¿›é˜¶èµ„æ–™"></a> è¿›é˜¶èµ„æ–™</h2><ul><li><a href="https://www.cnblogs.com/borntodie/p/15042669.html" target="_blank" rel="noopener">9-çˆ¬è™«é«˜çº§å®æˆ˜ã€jsé€†å‘ã€‘ </a></li><li><a href="https://blog.csdn.net/Qiled/article/details/109610726" target="_blank" rel="noopener">JSé€†å‘å­¦ä¹ ç¬”è®° - æŒç»­æ›´æ–°ä¸­</a></li><li>webpackè¡¥å……ä¾èµ–é¡¹åšæ³•ï¼š<ul><li><a href="https://www.jianshu.com/p/5c42730a4e84" target="_blank" rel="noopener">https://www.jianshu.com/p/5c42730a4e84</a></li><li><a href="https://zhuanlan.zhihu.com/p/79706247" target="_blank" rel="noopener">webpack4ä¹‹ã€Šæ¨¡å—è¿è¡Œæœºåˆ¶åŸç†ã€‹</a></li></ul></li><li>JSé€†å‘è§†é¢‘<ul><li><a href="https://www.bilibili.com/video/BV1wp4y1z7L6?p=42" target="_blank" rel="noopener">çˆ¬è™«å·¥ç¨‹å¸ˆè¿›é˜¶å¿…ä¼šä¹‹JSé€†å‘(åçˆ¬)</a></li><li><a href="https://www.bilibili.com/video/BV1XR4y147fQ?p=85" target="_blank" rel="noopener">é‡åˆ°ç½‘ç«™åŠ å¯†çˆ¬ä¸äº†ï¼Ÿï¼Ÿè¿™å‡ ä¸ªè§†é¢‘æ•™ä½ å¦‚ä½•å­¦ä¼šçˆ¬è™«é«˜é˜¶å†…å®¹jsé€†å‘ï¼Œå…¥ç‹±å¿…å­¦ï¼</a></li></ul></li></ul><h2 id="æŒä¸Šé«˜è€ƒè§£å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æŒä¸Šé«˜è€ƒè§£å¯†è¿‡ç¨‹"></a> æŒä¸Šé«˜è€ƒè§£å¯†è¿‡ç¨‹</h2><h3 id="è§£æå“åº”datatext"><a class="markdownIt-Anchor" href="#è§£æå“åº”datatext"></a> è§£æå“åº”data.text</h3><blockquote><p>ç›¸åº”çš„data.textæ˜¯åŠ å¯†çš„ï¼Œé¡µé¢é€šè¿‡JSè§£å¯†åæ¸²æŸ“</p></blockquote><ol><li><p>ç¡®å®šåŠ å¯†ä½ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="literal">null</span> != l &amp;&amp; <span class="literal">null</span> !== (a = l.data) &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== a &amp;&amp; a.text &amp;&amp; (l.data = (n = (e = &#123;</span><br><span class="line">            iv: u.uri,</span><br><span class="line">            text: l.data.text,</span><br><span class="line">            SIGN: h</span><br><span class="line">        &#125;).iv,</span><br></pre></td></tr></table></figure></li><li><p>ç¡®å®šåˆ†å‘å™¨ä½ç½®ï¼Œåœ¨htmlå†…</p><p>é€šè¿‡æ‰“æ–­<code>o = (u=a(42), a.n(u))// ç­‰ä»·äº o = a(42)</code></p></li><li><p>ç¡®å®šä¾èµ–æ¨¡å—ï¼šç»™<code>return e[a].call(c.exports, c, c.exports, r),</code>æ‰“æ–­ç‚¹åconsoleè¾“å‡º<code>e[&quot;42&quot;]</code>æŸ¥çœ‹a(42)ä½ç½®ï¼š</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">e, t, n</span>) </span>&#123;</span><br><span class="line">    e.exports = (e = n(<span class="number">21</span>),</span><br><span class="line">    n(<span class="number">201</span>),</span><br><span class="line">    n(<span class="number">825</span>),</span><br><span class="line">    ...</span><br><span class="line">    n(<span class="number">847</span>),</span><br><span class="line">    e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°éœ€è¦ä¾èµ–å¤šä¸ªï¼Œå› æ­¤ç›´æ¥æŠŠæ•´ä¸ªæ–‡ä»¶å¼•å…¥</p><ol start="4"><li>æ‰£è§£å¯†å‡½æ•°ï¼šæ³¨æ„<code>return</code>è¡¨è¾¾å¼åæ˜¯é€—å·çš„æƒ…å†µï¼šä¼šä»å·¦åˆ°å³æ‰§è¡Œæ‰§è¡Œï¼Œå¹¶è¿”å›æœ€åä¸€ä¸ªã€‚æ³¨æ„ï¼šJSå‡½æ•°å¹¶<strong>ä¸èƒ½è¿”å›å¤šä¸ªè¿”å›å€¼</strong></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">then((<span class="function"><span class="keyword">function</span>(<span class="params">l</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> e, a, t, b, n;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span> != l &amp;&amp; <span class="literal">null</span> !== (a = l.data) &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== a &amp;&amp; a.text &amp;&amp; (l.data = (n = (e = &#123;</span><br><span class="line">            iv: u.uri,</span><br><span class="line">            text: l.data.text,</span><br><span class="line">            SIGN: h</span><br><span class="line">        &#125;).iv,</span><br><span class="line">        a = e.text,</span><br><span class="line">        e = e.SIGN,</span><br><span class="line">        e = o.a.PBKDF2(e, <span class="string">"secret"</span>, &#123;</span><br><span class="line">            keySize: <span class="number">8</span>,</span><br><span class="line">            iterations: <span class="number">1e3</span>,</span><br><span class="line">            hasher: o.a.algo.SHA256</span><br><span class="line">        &#125;).toString(),</span><br><span class="line">        n = o.a.PBKDF2(n, <span class="string">"secret"</span>, &#123;</span><br><span class="line">            keySize: <span class="number">4</span>,</span><br><span class="line">            iterations: <span class="number">1e3</span>,</span><br><span class="line">            hasher: o.a.algo.SHA256</span><br><span class="line">        &#125;).toString(),</span><br><span class="line">        a = o.a.lib.CipherParams.create(&#123;</span><br><span class="line">            ciphertext: o.a.enc.Hex.parse(a)</span><br><span class="line">        &#125;),</span><br><span class="line">        n = o.a.AES.decrypt(a, o.a.enc.Hex.parse(e), &#123;</span><br><span class="line">            iv: o.a.enc.Hex.parse(n)</span><br><span class="line">        &#125;),</span><br><span class="line"><span class="comment">// data.textè§£æç»“æœ</span></span><br><span class="line">        <span class="built_in">JSON</span>.parse(n.toString(o.a.enc.Utf8)))),</span><br><span class="line">    v &amp;&amp; (t = r,</span><br><span class="line">        b = l,</span><br><span class="line">        <span class="literal">null</span> !== (n = <span class="built_in">window</span>.apiConfig) &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== n &amp;&amp; <span class="literal">null</span> !== (n = n.filterCacheList) &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== n &amp;&amp; n.length ? <span class="built_in">window</span>.apiConfig.filterCacheList.forEach((<span class="function"><span class="keyword">function</span>(<span class="params">l</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">RegExp</span>(l).test(t) || d.set(t, b)</span><br><span class="line">        &#125;)) : d.set(t, b)),</span><br><span class="line">    l</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éš¾ç‚¹ï¼š</p><ul><li><p>è·Ÿ&quot;xxx&quot;æ¨¡å¼ä¸åŒçš„æ˜¯ï¼Œç”±äºæ²¡æœ‰ç”¨å­—å…¸<code>{&quot;xxx&quot;: function()}</code>çš„å½¢å¼ï¼Œå› æ­¤ç›´æ¥requireä¹Ÿæ²¡ç”¨<code>TypeError: Cannot read property '42' of undefined</code>ï¼Œè€Œæ˜¯å°†ä¾èµ–æ¨¡å—å‡½æ•°æ•°ç»„ä½œä¸ºå‚æ•°å†™å…¥åˆ°åˆ†å‘å™¨ä¾èµ–å‡½æ•°ä¸­<code>!function(e){}([...])</code>å³æ–¹æ‹¬å·ä¸­ï¼Œä»è€Œæ‰èƒ½æ‰¾åˆ°42å‡½æ•°</p><ul><li><p>æŒ‘é€‰pushåç¬¬äºŒä¸ª<code>[]</code>ä¸­çš„å‡½æ•°æ•°ç»„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">this</span>[<span class="string">"webpackJsonpzsgk-pc"</span>] = <span class="keyword">this</span>[<span class="string">"webpackJsonpzsgk-pc"</span>] || []).push([[<span class="number">15</span>], [<span class="function"><span class="keyword">function</span>(<span class="params">e, t, n</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    e.exports = n(<span class="number">693</span>)</span><br><span class="line">&#125;,</span><br><span class="line">  ...</span><br><span class="line">  &#125;</span><br><span class="line">]]);<span class="comment">// ç¬¬ä¸€ä¸ª]</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç†è§£äº†a.nçš„å«ä¹‰åï¼Œå¯ä»¥ç›´æ¥æŠŠ<code>o = (u=a(42), a.n(u))</code>è½¬åŒ–ä¸º<code>o=a(42)</code></p></li></ul><h3 id="è·å¾—åŠ å¯†å‚æ•°signsafe"><a class="markdownIt-Anchor" href="#è·å¾—åŠ å¯†å‚æ•°signsafe"></a> è·å¾—åŠ å¯†å‚æ•°signsafe</h3><blockquote><p>å¤§è‡´æµç¨‹è·Ÿdata.textå·®ä¸å¤šï¼Œä½†æ˜¯<code>p = c()(g)</code>æ‰§è¡Œæ—¶ï¼Œä¼šæŠ¥é”™</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Md5.prototype.update = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">if</span> (!<span class="keyword">this</span>.finalized) &#123;</span><br><span class="line">&gt;         <span class="keyword">var</span> t, n = <span class="keyword">typeof</span> e;</span><br><span class="line">&gt;         <span class="keyword">if</span> (<span class="string">"string"</span> != n) &#123;</span><br><span class="line">&gt;             <span class="keyword">if</span> (<span class="string">"object"</span> != n)</span><br><span class="line">&gt;                 <span class="keyword">throw</span> ERROR;</span><br><span class="line">&gt;             <span class="keyword">if</span> (<span class="literal">null</span> === e)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>æ ¹æ®ä¸€æ­¥æ­¥è°ƒè¯•ä¹‹åå‘ç°ï¼Œè¿˜æ˜¯<code>c = (u=a(291),a.n(u))</code>ç›´æ¥æ›¿æ¢å‡ºçš„é—®é¢˜</p></blockquote><ol><li><p>Ctrl + shift + Få®šä½å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">g = <span class="keyword">void</span> <span class="number">0</span>,</span><br><span class="line">    g = (t = &#123;</span><br><span class="line">    SIGN: h,</span><br><span class="line">    str: f.replace(<span class="regexp">/^\/|https?:\/\/\/?/</span>, <span class="string">""</span>)</span><br><span class="line">&#125;).SIGN,</span><br><span class="line">    t = t.str,</span><br><span class="line">    g = o.a.HmacSHA1(o.a.enc.Utf8.parse(t), g),</span><br><span class="line">    g = o.a.enc.Base64.stringify(g).toString(),</span><br><span class="line">    p = c()(g),</span><br><span class="line">    u.signsafe = p,</span><br></pre></td></tr></table></figure></li><li><p>å¾€ä¸Šæ‰¾cå’Œo.a: <code>o = (u = a(42),a.n(u))</code>, <code>c = (u = a(291),a.n(u))</code></p></li><li><p>æ‰¾åˆ°åˆ†å‘å™¨æ‰£å‡º==&gt;è¿™æ¬¡ä¸èƒ½åˆ é™¤åˆ†å‘å™¨ä¸­å¤šä½™çš„å‡½æ•°ï¼Œæ¯”å¦‚r.aã€r.dã€r.nå› ä¸ºåé¢å¾—ç”¨</p></li><li><p>å°†ä¾èµ–æ¨¡å—è·Ÿdata.textä¸€æ ·ï¼Œæ”¾å…¥åˆ†å‘å™¨ä¾èµ–æ¨¡å—ä¸­</p></li><li><p>æ‰£åŠ å¯†å‡½æ•°</p><blockquote><p>ç½‘é¡µä¸Šæ˜¯returnåå¤šæ®µå†…å®¹ï¼Œä»¥åŠgå˜é‡ä¸æ–­è¢«ä¿®æ”¹ï¼Œå› æ­¤é€šè¿‡ä¸€æ­¥æ­¥è°ƒè¯•ç¡®å®šå…¥å‚ï¼Œä»¥åŠåˆ†è§£returnæŠ½ç¦»å‡ºçœŸæ­£çš„åŠ å¯†å‚æ•°signsafe</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">h = <span class="string">"D23ABC@#56"</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;</span><br><span class="line"></span><br><span class="line">o.a = mycode(<span class="number">42</span>)</span><br><span class="line"><span class="comment">// â–²</span></span><br><span class="line">c = (u = mycode(<span class="number">291</span>), mycode.n(u))</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹urlè¿›è¡ŒåŠ å¯†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    g = (t = &#123;</span><br><span class="line">            SIGN: h,</span><br><span class="line">            str: f.replace(<span class="regexp">/^\/|https?:\/\/\/?/</span>, <span class="string">""</span>)</span><br><span class="line">        &#125;).SIGN,</span><br><span class="line">        t = t.str;</span><br><span class="line">    <span class="comment">// console.log(t, g);</span></span><br><span class="line">    g = o.a.HmacSHA1(o.a.enc.Utf8.parse(t), g);</span><br><span class="line">    <span class="comment">// console.log(g)</span></span><br><span class="line">    g = o.a.enc.Base64.stringify(g).toString();</span><br><span class="line">    <span class="comment">// console.log(g)</span></span><br><span class="line">    p = c()(g);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = encrypt(<span class="string">"https://api.eol.cn/web/api/counter?cid=1&amp;did=263"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(res)</span><br></pre></td></tr></table></figure></li></ol><p>å¯ä»¥çœ‹åˆ°o.aå’Œcçš„èµ‹å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè™½ç„¶è¯´å¤§å¤šæ•°æƒ…å†µx = a.n(u)ç­‰ä»·äºx=uï¼Œä½†éš¾å…æœ‰æ—¶ä¼šæœ‰ä¸ä¸€æ ·ï¼Œå› æ­¤è°¨æ…æœŸé—´ï¼Œè¿˜æ˜¯è¿˜åŸåˆ°åº•æœ€å¥½ã€‚</p><h4 id="pythonè°ƒç”¨"><a class="markdownIt-Anchor" href="#pythonè°ƒç”¨"></a> Pythonè°ƒç”¨</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_signsafe_by_javascript</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="comment"># ä¸¤ä¸ª JavaScript è„šæœ¬ï¼Œä¸¤ç§æ–¹æ³•å‡å¯</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'gk_signsafe.js'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        exec_js = f.read()</span><br><span class="line">    signsafe = execjs.compile(exec_js).call(<span class="string">'encrypt'</span>, url)</span><br><span class="line">    <span class="keyword">return</span> signsafe</span><br><span class="line">signsafe = get_encrypted_password_by_javascript(<span class="string">"https://api.eol.cn/web/api/counter?cid=1&amp;did=263"</span>)</span><br><span class="line">print(signsafe)</span><br></pre></td></tr></table></figure><h2 id="rsaçš„åŠ å¯†æ­¥éª¤"><a class="markdownIt-Anchor" href="#rsaçš„åŠ å¯†æ­¥éª¤"></a> RSAçš„åŠ å¯†æ­¥éª¤</h2><ol><li>è·å–å…¬é’¥</li><li>å®ä¾‹åŒ–  ===&gt; æ‰£å‡ºç½‘ç«™RSAå®ä¾‹åŒ–å¯¹è±¡çš„ä»£ç </li><li>è®¾ç½®å…¬é’¥</li><li>å¯¹æ–‡æœ¬è¿›è¡ŒåŠ å¯† ==&gt; æ‰£å‡ºå¤ç°RSAåŠ å¯†çš„é€»è¾‘ä»£ç </li></ol><p>æ³¨ï¼š <code>var window=global</code>ã€<code>var navigator={}</code></p><ul><li><p><a href="https://www.bilibili.com/video/BV1jB4y1K7uw?spm_id_from=333.999.0.0" target="_blank" rel="noopener">Bç«™RSA</a>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// window.JSEncrypt is not a constructor åœ¨æŠ å‡ºæ¥çš„JS Encryptä»£ç ä¸­åŠ ä¸Š</span></span><br><span class="line"><span class="built_in">window</span>.JSEncrpt = ze</span><br><span class="line"><span class="comment">// ç½‘é¡µä¸­ä½var n = new JSEncrypt ==&gt; JSEncrypt is not defined</span></span><br><span class="line"><span class="keyword">var</span> n = <span class="keyword">new</span> <span class="built_in">window</span>.JSEncrypt;</span><br><span class="line">n.setPublicKey...</span><br><span class="line"><span class="keyword">var</span> a = n.encrypt(t.data.hash + password);</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br></pre></td></tr></table></figure></li><li><p><a href="https://www.bilibili.com/video/BV1Qh411B77h?spm_id_from=333.999.0.0" target="_blank" rel="noopener">ç½‘æ˜“äº‘çˆ¬è¯„è®º</a>ï¼špythoné€šè¿‡execjsæ¥è°ƒç”¨JSä»£ç ï¼Œä»£ç ä¸­ç”¨åˆ°äº†<code>CryptoJS</code>åº“ï¼Œ éœ€è¦<code>os.environ[&quot;NODE_PATH&quot;]=&quot;F:/..../node_modules&quot;</code>æŠŠåº“å¯¼å…¥</p></li><li><p><a href="https://www.bilibili.com/video/BV1eQ4y1Q7RE?spm_id_from=333.999.0.0" target="_blank" rel="noopener">JSé€†å‘å®æˆ˜åˆ†æâ€“æŸé“ç½‘åˆ†æ</a>ï¼šdocumentè¿”å›ç±»å‹ï¼Œinitiatoræ˜¯ä¸€æ¡æ¡æ–‡æœ¬(Other)ï¼Œå› ä¸ºå…¶æ²¡æœ‰ç”¨ajax(XHR)ï¼Œè€Œæ˜¯é€šè¿‡åŸç”Ÿçš„ç½‘é¡µè¡¨å•æäº¤</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">loginForm.password.value = encryptByDES(loginForm.password.value), loginForm.publickey.value);</span><br><span class="line">loginForm.submit();</span><br></pre></td></tr></table></figure><ul><li><p>ç›´æ¥requireå¯¼å…¥CryptoJSæ¨¡å—</p></li><li><p>orç›´æ¥æ‰£encryptByDESçš„åŠ å¯†å‡½æ•°==&gt;å‡ºç°<code>cannot read property 'createEncryptor' of undefined</code></p></li><li><p>MD5åŠ å¯†ï¼š</p><ul><li><p>JS: <code>const crypto = require(&quot;CryptoJS&quot;); crypto.MD5('å¾…åŠ å¯†å­—ç¬¦ä¸²').toString()</code></p></li><li><p>Python: <a href="https://blog.csdn.net/weixin_44799217/article/details/112486097" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44799217/article/details/112486097</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³•ä¸€ï¼šåˆ›å»ºmd5å¯¹è±¡</span></span><br><span class="line">hl = hashlib.md5()</span><br><span class="line"><span class="comment"># Tips</span></span><br><span class="line"><span class="comment"># æ­¤å¤„å¿…é¡»å£°æ˜encodeï¼Œè‹¥å†™æ³•ä¸ºhl.update(str) æŠ¥é”™ä¸ºï¼š Unicode-objects must be encoded before hashing</span></span><br><span class="line">hl.update(str.encode(encoding=<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³•äºŒï¼š</span></span><br><span class="line">str_md5 = hashlib.md5(str.encode(encoding=<span class="string">'utf-8'</span>)).hexdigest()</span><br></pre></td></tr></table></figure></li></ul></li><li><p>base64ç¼–ç </p><ul><li><p>JS: <code>CryptoJS.enc.Base64.parse(&quot;å¾…è§£å¯†å­—ç¬¦ä¸²&quot;).toString(CryptoJS.enc.Utf8)</code></p></li><li><p>Python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²</span></span><br><span class="line">encode_str = base64.encodebytes(test_str.encode(<span class="string">'utf8'</span>))  <span class="comment"># b'aGVsbG8gd29ybGQh\n'</span></span><br><span class="line">print(encode_str.decode())  <span class="comment"># é»˜è®¤ä»¥utf8è§£ç ï¼Œç»“æœ aGVsbG8gd29ybGQh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¾ç‰‡</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"D:\\redis.png"</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encode_img = base64.b64encode(f.read())</span><br><span class="line">    file_ext = os.path.splitext(<span class="string">"D:\\redis.png"</span>)[<span class="number">1</span>]</span><br><span class="line">    print(<span class="string">'data:image/&#123;&#125;;base64,&#123;&#125;'</span>.format(file_ext[<span class="number">1</span>:], encode_img.decode()))</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><h2 id="åŠ å¯†-æ‘˜è¦ç®—æ³•ç»“æœç‰¹å¾"><a class="markdownIt-Anchor" href="#åŠ å¯†-æ‘˜è¦ç®—æ³•ç»“æœç‰¹å¾"></a> åŠ å¯†ã€æ‘˜è¦ç®—æ³•ç»“æœç‰¹å¾</h2><h3 id="urlencode"><a class="markdownIt-Anchor" href="#urlencode"></a> urlencode</h3><blockquote><p>urlencodeæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯å°†å­—ç¬¦ä¸²ä»¥<a href="https://baike.baidu.com/item/URL%E7%BC%96%E7%A0%81/3703727" target="_blank" rel="noopener">URLç¼–ç </a>ï¼Œç”¨äºç¼–ç å¤„ç†ã€‚</p><p>URLç¼–ç (URL encoding)ï¼Œä¹Ÿç§°ä½œ<strong>ç™¾åˆ†å·ç¼–ç </strong>(Percent-encoding)ï¼Œ æ˜¯ç‰¹å®šä¸Šä¸‹æ–‡çš„<a href="https://baike.baidu.com/item/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E5%AE%9A%E4%BD%8D%E7%AC%A6/4438100" target="_blank" rel="noopener">ç»Ÿä¸€èµ„æºå®šä½ç¬¦</a> (URL)çš„ç¼–ç æœºåˆ¶ã€‚</p></blockquote><h3 id="base64ç‰¹å¾"><a class="markdownIt-Anchor" href="#base64ç‰¹å¾"></a> Base64ç‰¹å¾</h3><blockquote><p>æœ€å¸¸è§çš„ç”¨äºä¼ è¾“8Bit<a href="https://baike.baidu.com/item/%E5%AD%97%E8%8A%82%E7%A0%81/9953683" target="_blank" rel="noopener">å­—èŠ‚ç </a>çš„<strong>ç¼–ç æ–¹å¼</strong>ä¹‹ä¸€</p></blockquote><ul><li>ç›¸åŒå†…å®¹ï¼Œç»“æœæ˜¯ç›¸åŒçš„</li><li>a-zA-Z,0-9,+/å…±64ä¸ªå­—ç¬¦è¿›è¡Œç¼–ç ï¼›æ¯3ä¸ªå­—èŠ‚ç¼–ç æˆ4ä¸ªå­—èŠ‚ï¼Œä¸è¶³çš„åœ¨<strong>ç»“å°¾</strong>æœ‰æ— æ„ä¹‰çš„**=**æ¥å¡«è¡¥<ul><li>ä¸€èˆ¬æƒ…å†µä¸‹ç»“å°¾éƒ½ä¼šæœ‰1ä¸ªæˆ–è€…2ä¸ªç­‰å·ï¼Œæ˜æ–‡é•¿åº¦æ˜¯3çš„å€æ•°æ—¶æ²¡æœ‰=ï¼›</li></ul></li><li>å†…å®¹è¶Šé•¿ï¼Œç»“æœè¶Šé•¿</li></ul><p>æ³¨ï¼šè·Ÿä¸‹é¢çš„ç®—æ³•åŒºåˆ†ä¸€ä¸‹ï¼Œbase64æ˜¯ç¼–ç æ–¹å¼ï¼Œå¹¶ä¸èƒ½ç®—åŠ å¯†ç®—æ³•ã€‚åº”ç”¨åœºæ™¯è¿˜æœ‰ä¼ è¾“å›¾ç‰‡:<code>data:image/jpg;base64,/9j/4QMZRXhpZgAASUk...</code></p><h3 id="md5ç‰¹å¾"><a class="markdownIt-Anchor" href="#md5ç‰¹å¾"></a> md5ç‰¹å¾</h3><blockquote><p><strong>æ¶ˆæ¯æ‘˜è¦ç®—æ³•</strong></p></blockquote><ul><li>ç¡®å®šå”¯ä¸€æ€§ï¼šç›¸åŒå†…å®¹ï¼Œç»“æœæ˜¯ç›¸åŒçš„ï¼›ä½†ä¸€èˆ¬ä¼šæœ‰æ—¶é—´æˆ³ç­‰å‚æ•°ï¼Œæ‰€ä»¥å¯¼è‡´äº†æ¯æ¬¡ä¸åŒ</li><li>ä¸å¯é€†æ€§ï¼šæœ‰æŸçš„åŠ å¯†è¿‡ç¨‹ï¼Œç†è®ºä¸Šæ— æ³•è§£å¯†ï¼ˆé€†å‘æ¨å‡ºï¼‰ï¼Œé™¤éæš´åŠ›ç ´è§£ã€‚å®‰å…¨ï¼Œè¿™ä¹Ÿæ˜¯å…¶æˆä¸ºæ ¡éªŒæ˜¯å¦è¢«ä¿®æ”¹çš„æœ€å…³é”®çš„æ€§è´¨</li><li>ç¢°æ’æ€§ï¼šåŸå§‹æ•°æ®ä¸å…¶MD5å€¼å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæœ‰å¯èƒ½å¤šä¸ªåŸå§‹æ•°æ®è®¡ç®—å‡ºæ¥çš„MD5å€¼æ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ç¢°æ’ã€‚</li><li>ä¸€èˆ¬MD5å€¼æ˜¯32ä½ï¼Œç”±æ•°å­—â€œ0-9â€å’Œå­—æ¯â€œa-fâ€æ‰€ç»„æˆçš„å­—ç¬¦ä¸²ï¼›å­—æ¯å¯ä»¥æ˜¯å…¨å¤§å†™æˆ–è€…å…¨å°å†™<ul><li>å¯†æ–‡ä¸€èˆ¬ä¸º 16 ä½æˆ–è€… 32 ä½ï¼Œå…¶ä¸­ 16 ä½æ˜¯å–çš„ 32 ä½ç¬¬ 9~25 ä½çš„å€¼ï¼›</li></ul></li><li>é•¿åº¦ï¼š32ä¸ª<strong>åå…­è¿›åˆ¶</strong>å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸² (128ä½)</li></ul><h3 id="rsaç‰¹å¾"><a class="markdownIt-Anchor" href="#rsaç‰¹å¾"></a> RSAç‰¹å¾</h3><ul><li>ç›¸åŒå†…å®¹ï¼Œç»“æœä¹Ÿæ˜¯ä¸åŒçš„</li><li>æ˜æ–‡é•¿åº¦éœ€è¦å°äºå¯†é’¥é•¿åº¦ï¼Œè€Œå¯†æ–‡é•¿åº¦åˆ™ç­‰äºå¯†é’¥é•¿åº¦ã€‚ä¸€èˆ¬ä¸º1024ã€2048ã€3072ã€4096æˆ–512ï¼ˆä½äº1024çš„å®‰å…¨ä¸å»ºè®®ï¼‰</li><li>é€šè¿‡å…¬é’¥åŠ å¯†ç»“æœï¼Œå¿…é¡»ç§é’¥è§£å¯†ã€‚ åŒæ ·ç§é’¥åŠ å¯†ç»“æœï¼Œå…¬é’¥å¯ä»¥è§£å¯†</li></ul><p>æ³¨ï¼šRSAåŠ è§£å¯†ä¸­å¿…é¡»è€ƒè™‘åˆ°çš„å¯†é’¥é•¿åº¦ã€æ˜æ–‡é•¿åº¦å’Œå¯†æ–‡é•¿åº¦é—®é¢˜ï¼›</p><p>â–².ä¸€èˆ¬ä¼šä½¿ç”¨ JSEncrypt åº“ï¼Œä¼šæœ‰ new ä¸€ä¸ªå®ä¾‹å¯¹è±¡çš„æ“ä½œï¼›</p><h3 id="sha-ç³»åˆ—"><a class="markdownIt-Anchor" href="#sha-ç³»åˆ—"></a> SHA ç³»åˆ—</h3><blockquote><p>SHA æ˜¯æ¯” MD5 æ›´å®‰å…¨ä¸€ç‚¹çš„æ‘˜è¦ç®—æ³•ï¼ŒSHA é€šå¸¸æŒ‡ SHA å®¶æ—ç®—æ³•ï¼Œ</p></blockquote><p><strong>sha1</strong></p><blockquote><p>å­—æ¯ï¼ˆa-fï¼‰å’Œæ•°å­—ï¼ˆ0-9ï¼‰æ··åˆ</p><p>å¯†æ–‡ç‰¹å¾è·ŸMD5å·®ä¸å¤šï¼Œåªä¸è¿‡æ•°å­—æ˜¯40ä½ï¼Œbitä½æ•°ï¼ˆ160ï¼‰==&gt;4ä½<strong>åå…­è¿›åˆ¶</strong>è¡¨ç¤ºä¸€ä¸ªæ•°</p></blockquote><p><strong>Sha256</strong></p><blockquote><p>å­—æ¯ï¼ˆa-fï¼‰å’Œæ•°å­—ï¼ˆ0-9ï¼‰æ··åˆ</p><p>å¯¹äºä»»æ„é•¿åº¦çš„æ¶ˆæ¯ï¼ŒSHA256éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª256ä½çš„å“ˆå¸Œå€¼ï¼Œå³64ä½åå…­è¿›åˆ¶æ•°ï¼Œç§°ä½œæ¶ˆæ¯æ‘˜è¦ã€‚</p></blockquote><p><strong>HMAC</strong></p><blockquote><p>åœ¨md5å’Œsha1åŠ å¯†çš„åŸºç¡€ä¸Šå¼•å…¥äº†ç§˜é’¥ï¼Œè€Œç§˜é’¥åˆåªæœ‰ä¼ è¾“åŒæ–¹æ‰çŸ¥é“ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ˜¯ç ´è§£ä¸äº†çš„ï¼Œå¸¸ç”¨äºæ¥å£ç­¾åéªŒè¯</p></blockquote><h3 id="aes-des-3des-rc4-rabbit-ç­‰"><a class="markdownIt-Anchor" href="#aes-des-3des-rc4-rabbit-ç­‰"></a> AESã€DESã€3DESã€RC4ã€Rabbit ç­‰</h3><p>AESã€DESã€3DESã€RC4ã€Rabbit ç­‰åŠ å¯†ç®—æ³•çš„å¯†æ–‡é€šå¸¸æ²¡æœ‰å›ºå®šçš„é•¿åº¦ï¼Œä»–ä»¬é€šå¸¸ä½¿ç”¨<code>crypto-js</code>åº“æ¥å®ç°</p><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/7052978567390429215" target="_blank" rel="noopener">https://juejin.cn/post/7052978567390429215</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;webpacké€†å‘&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#webpacké€†å‘&quot;&gt;&lt;/a&gt; Webpacké€†å‘&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://so.csdn.net/so/search?q=webpack&amp;am
      
    
    </summary>
    
    
      <category term="çˆ¬è™«" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>2022å¹´3æœˆ19~20æ—¥-çˆ¬è™«é¡¹ç›®è®°å½•</title>
    <link href="https://nymrli.top/2022/03/19/2022%E5%B9%B43%E6%9C%8819%E6%97%A5-20%E6%97%A5%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2022/03/19/2022å¹´3æœˆ19æ—¥-20æ—¥çˆ¬è™«é¡¹ç›®è®°å½•/</id>
    <published>2022-03-19T11:06:06.000Z</published>
    <updated>2022-04-03T09:25:24.549Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2022å¹´3æœˆ20æ—¥å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“"><a class="markdownIt-Anchor" href="#2022å¹´3æœˆ20æ—¥å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“"></a> 2022å¹´3æœˆ20æ—¥â€”â€”å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“</h1><h2 id="æ–‡ä»¶å­˜å‚¨"><a class="markdownIt-Anchor" href="#æ–‡ä»¶å­˜å‚¨"></a> æ–‡ä»¶å­˜å‚¨</h2><ol><li>æ–‡ä»¶å¤¹ä¸å…è®¸å‡ºç°<code>/\:*?|&lt;&gt;&quot;</code></li><li>aæ ‡ç­¾ä¸­hrefä¸èƒ½æœ‰, å› ä¸ºé€šè¿‡etree.tostringä¼šè¢«è½¬ä¹‰æˆ%5C===&gt;è¿›è¡Œäº†str.replace(&quot;\&quot;, â€œ/â€)</li><li>windowsä¸‹è·¯å¾„åˆ†éš”ç¬¦æ˜¯<code>\\</code>, æ‰€ä»¥save_pathä¸­ä¼šæœ‰<code>\\</code>, å› æ­¤ä½¿ç”¨<code>save_path.replace(&quot;\\&quot;, &quot;/&quot;)</code>å¯ä»¥è§£å†³</li><li>å¤šçº§åˆ›å»ºæ–‡ä»¶å¤¹<code>os.makedirs()</code>ã€å•å±‚åˆ›å»º<code>os.mkdir()</code><br>5æ–‡ä»¶åç§°é—®é¢˜: ä¹±ç å¤ªé•¿æŠ¥é”™, å°†å…¶å–aæ ‡ç­¾ä¸­å†…å®¹è§£å†³</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¹±ç å¤ªé•¿æŠ¥é”™</span></span><br><span class="line">s = <span class="string">".\\attaches\\11963218-2021å¹´09æœˆ22æ—¥åèƒ½èƒ½æºäº¤é€šäº§ä¸šæ§è‚¡æœ‰é™å…¬å¸é›†å›¢ç‰©èµ„ä¾›åº”ä¸­å¿ƒï¼ˆç”˜è‚ƒåŒºåŸŸï¼‰07æœˆä»½é›†ä¸­ç‰©èµ„ä¾›åº”--å…«é›¶ä¸‰ç”µå‚é˜€é—¨è¯¢ä»·é‡‡è´­ï¼ˆåŒ…093ï¼‰è¯¢ä»·ä¹¦è¯¢ä»·å…¬å‘Š\\ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½07ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½--ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½093ï¿½ï¿½ï¿½.wps"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(s, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">b"ggg"</span>)</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®åº“è¡¨"><a class="markdownIt-Anchor" href="#æ•°æ®åº“è¡¨"></a> æ•°æ®åº“è¡¨</h2><p><strong>varcharèƒ½å­˜å¤šå°‘æ±‰å­—ã€æ•°å­—ï¼Ÿ</strong></p><p>å…·ä½“è¿˜æ˜¯è¦çœ‹ç‰ˆæœ¬çš„ï¼Œä¸€ä¸ªå­—ç¬¦å ç”¨3ä¸ªå­—èŠ‚  ï¼Œä¸€ä¸ªæ±‰å­—ï¼ˆåŒ…æ‹¬æ•°å­—ï¼‰å ç”¨3ä¸ªå­—èŠ‚=ä¸€ä¸ªå­—ç¬¦</p><ul><li><strong>4.0ç‰ˆæœ¬ä»¥ä¸‹</strong>ï¼Œvarchar(100)ï¼ŒæŒ‡çš„æ˜¯<strong>100å­—èŠ‚</strong>ï¼Œå¦‚æœå­˜æ”¾UTF8æ±‰å­—æ—¶ï¼Œåªèƒ½å­˜33ä¸ªï¼ˆæ¯ä¸ªæ±‰å­—3å­—èŠ‚ï¼‰</li><li><strong>5.0ç‰ˆæœ¬ä»¥ä¸Š</strong>**ï¼Œvarchar(100)ï¼ŒæŒ‡çš„æ˜¯<strong>100å­—ç¬¦</strong>ï¼Œâ­ï¸æ— è®ºå­˜æ”¾çš„æ˜¯æ•°å­—ã€å­—æ¯è¿˜æ˜¯UTF8æ±‰å­—ï¼ˆæ¯ä¸ªæ±‰å­—3å­—èŠ‚ï¼‰ï¼Œéƒ½å¯ä»¥å­˜æ”¾100ä¸ªã€‚</li><li><strong>UTF8ç¼–ç ä¸­ä¸€ä¸ªæ±‰å­—ï¼ˆåŒ…æ‹¬æ•°å­—ï¼‰å ç”¨3ä¸ªå­—èŠ‚</strong></li><li><em>GBKç¼–ç ä¸­ä¸€ä¸ªæ±‰å­—ï¼ˆåŒ…æ‹¬æ•°å­—ï¼‰å ç”¨2ä¸ªå­—èŠ‚</em>*</li></ul><p><strong>varcharçš„æœ€å¤§é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ</strong></p><p>mysqlçš„vacharå­—æ®µçš„ç±»å‹è™½ç„¶æœ€å¤§é•¿åº¦æ˜¯65535ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯èƒ½å­˜è¿™ä¹ˆå¤šæ•°æ®ï¼Œæœ€å¤§å¯ä»¥åˆ°65533ï¼Œå…¶ä¸­éœ€è¦1åˆ°2ä¸ªå­—èŠ‚æ¥å­˜å‚¨æ•°æ®é•¿åº¦ï¼ˆå¦‚æœåˆ—å£°æ˜çš„é•¿åº¦è¶…è¿‡255ï¼Œåˆ™ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥å­˜å‚¨é•¿åº¦ï¼Œå¦åˆ™1ä¸ªï¼‰å­—èŠ‚ï¼Œå½“ä¸å…è®¸éç©ºå­—æ®µçš„æ—¶å€™ï¼ˆå› ä¸ºè¦ç”¨ä¸€ä¸ªå­—èŠ‚æ¥å­˜å‚¨ä¸å¯ä¸ºç©ºçš„æ ‡è¯†ï¼‰ï¼Œå½“å…è®¸éç©ºå­—æ®µçš„æ—¶å€™åªèƒ½åˆ°65532(çœä¸‹äº†å­˜å‚¨éç©ºçš„é‚£ä¸ªå­—èŠ‚)ã€‚</p><h3 id="mysqlå­—æ®µç±»å‹å­˜å‚¨éœ€è¦å¤šå°‘å­—èŠ‚"><a class="markdownIt-Anchor" href="#mysqlå­—æ®µç±»å‹å­˜å‚¨éœ€è¦å¤šå°‘å­—èŠ‚"></a> mysqlå­—æ®µç±»å‹å­˜å‚¨éœ€è¦å¤šå°‘å­—èŠ‚ï¼Ÿ</h3><p><strong>æ•°å­—ç±»å‹</strong></p><table><thead><tr><th style="text-align:left">åˆ—ç±»å‹</th><th style="text-align:left">éœ€è¦çš„å­˜å‚¨é‡</th></tr></thead><tbody><tr><td style="text-align:left">TINYINT</td><td style="text-align:left">1 å­—èŠ‚</td></tr><tr><td style="text-align:left">SMALLINT</td><td style="text-align:left">2 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">MEDIUMINT</td><td style="text-align:left">3 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">INT</td><td style="text-align:left">4 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">INTEGER</td><td style="text-align:left">4 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">BIGINT</td><td style="text-align:left">8 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">FLOAT(X)</td><td style="text-align:left">4 å¦‚æœ X &lt; = 24 æˆ– 8 å¦‚æœ 25 &lt; = X &lt; = 53</td></tr><tr><td style="text-align:left">FLOAT</td><td style="text-align:left">4 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">DOUBLE</td><td style="text-align:left">8 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">DOUBLE PRECISION</td><td style="text-align:left">8 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">REAL</td><td style="text-align:left">8 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">DECIMAL(M,D)</td><td style="text-align:left">Må­—èŠ‚(D+2 , å¦‚æœM &lt; D)</td></tr><tr><td style="text-align:left">NUMERIC(M,D)</td><td style="text-align:left">Må­—èŠ‚(D+2 , å¦‚æœM &lt; D)</td></tr></tbody></table><p><strong>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</strong></p><table><thead><tr><th style="text-align:left">åˆ—ç±»å‹</th><th style="text-align:left">éœ€è¦çš„å­˜å‚¨é‡</th></tr></thead><tbody><tr><td style="text-align:left">DATE</td><td style="text-align:left">3 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">DATETIME</td><td style="text-align:left">8 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">TIMESTAMP</td><td style="text-align:left">4 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">TIME</td><td style="text-align:left">3 ä¸ªå­—èŠ‚</td></tr><tr><td style="text-align:left">YEAR</td><td style="text-align:left">1 å­—èŠ‚</td></tr></tbody></table><p><strong>ä¸²ç±»å‹</strong></p><table><thead><tr><th style="text-align:left">åˆ—ç±»å‹</th><th style="text-align:left">éœ€è¦çš„å­˜å‚¨é‡</th></tr></thead><tbody><tr><td style="text-align:left">CHAR(M)</td><td style="text-align:left">Må­—èŠ‚ï¼Œ1 &lt;= M &lt;= 255</td></tr><tr><td style="text-align:left">VARCHAR(M)</td><td style="text-align:left">L+1 å­—èŠ‚, åœ¨æ­¤L &lt;= Må’Œ1 &lt;= M &lt;= 255</td></tr><tr><td style="text-align:left">TINYBLOB, TINYTEXT</td><td style="text-align:left">L+1 å­—èŠ‚, åœ¨æ­¤L&lt; 2 ^ 8</td></tr><tr><td style="text-align:left">BLOB, TEXT</td><td style="text-align:left">L+2 å­—èŠ‚, åœ¨æ­¤L&lt; 2 ^ 16</td></tr><tr><td style="text-align:left">MEDIUMBLOB, MEDIUMTEXT</td><td style="text-align:left">L+3 å­—èŠ‚, åœ¨æ­¤L&lt; 2 ^ 24</td></tr><tr><td style="text-align:left">LONGBLOB, LONGTEXT</td><td style="text-align:left">L+4 å­—èŠ‚, åœ¨æ­¤L&lt; 2 ^ 32</td></tr><tr><td style="text-align:left">ENUM(â€˜value1â€™,â€˜value2â€™,â€¦)</td><td style="text-align:left">1 æˆ– 2 ä¸ªå­—èŠ‚, å–å†³äºæšä¸¾å€¼çš„æ•°ç›®(æœ€å¤§å€¼65535ï¼‰</td></tr><tr><td style="text-align:left">SET(â€˜value1â€™,â€˜value2â€™,â€¦)</td><td style="text-align:left">1ï¼Œ2ï¼Œ3ï¼Œ4æˆ–8ä¸ªå­—èŠ‚, å–å†³äºé›†åˆæˆå‘˜çš„æ•°é‡(æœ€å¤š64ä¸ªæˆå‘˜ï¼‰</td></tr></tbody></table><h3 id="mysqlä¸­ç±»å‹åé¢çš„æ•°å­—å«ä¹‰"><a class="markdownIt-Anchor" href="#mysqlä¸­ç±»å‹åé¢çš„æ•°å­—å«ä¹‰"></a> <a href="https://www.itdaan.com/blog/2019/04/08/7762d501e9d5c7cc0316743eaaab6b54.html" target="_blank" rel="noopener">MySQLä¸­ç±»å‹åé¢çš„æ•°å­—å«ä¹‰</a></h3><p>å½¢å¼ï¼šç±»å‹(m)</p><ol><li>æ•´æ•°å‹çš„<strong>æ•°å€¼ç±»å‹</strong>å·²ç»<strong>é™åˆ¶äº†å–å€¼èŒƒå›´</strong>ï¼Œæœ‰ç¬¦å·æ•´å‹å’Œæ— ç¬¦å·æ•´å‹éƒ½æœ‰ï¼Œè€ŒMå€¼å¹¶ä¸ä»£è¡¨å¯ä»¥å­˜å‚¨çš„æ•°å€¼å­—ç¬¦é•¿åº¦ï¼Œå®ƒä»£è¡¨çš„æ˜¯<strong>æ•°æ®åœ¨æ˜¾ç¤ºæ—¶æ˜¾ç¤ºçš„æœ€å°é•¿åº¦</strong>ï¼Œå½“å­˜å‚¨çš„å­—ç¬¦é•¿åº¦è¶…è¿‡Må€¼æ—¶ï¼Œæ²¡æœ‰ä»»ä½•çš„å½±å“ï¼Œåªè¦ä¸è¶…è¿‡æ•°å€¼ç±»å‹é™åˆ¶çš„èŒƒå›´ã€‚å½“å­˜å‚¨çš„å­—ç¬¦é•¿åº¦å°äºMå€¼æ—¶ï¼Œ<u>åªæœ‰åœ¨è®¾ç½®äº†zerofillç”¨0æ¥å¡«å……ï¼Œæ‰èƒ½å¤Ÿçœ‹åˆ°æ•ˆæœï¼Œæ¢å¥è¯å°±æ˜¯è¯´ï¼Œæ²¡æœ‰zerofillï¼ŒMå€¼å°±æ˜¯æ— ç”¨çš„</u>ã€‚</li><li>å­—ç¬¦å‹å¦‚varchar(50) å¯ä»¥å‚¨å­˜50ä¸ªå­—ç¬¦ï¼Œè¡¨ç¤ºçš„æ˜¯å¯å˜ä¸å®šé•¿çš„ã€‚</li></ol><h3 id="mysqlé»˜è®¤å­—ç¬¦é›†"><a class="markdownIt-Anchor" href="#mysqlé»˜è®¤å­—ç¬¦é›†"></a> mySQLé»˜è®¤å­—ç¬¦é›†</h3><blockquote><p>MySQLå¯¹äºå­—ç¬¦é›†çš„æŒ‡å®šå¯ä»¥ç»†åŒ–åˆ°ä¸€ä¸ªæ•°æ®åº“ï¼Œä¸€å¼ è¡¨ï¼Œä¸€åˆ—ï¼Œåº”è¯¥ç”¨ä»€ä¹ˆå­—ç¬¦é›†ã€‚ ä½†æ˜¯ï¼Œä¼ ç»Ÿçš„ç¨‹åºåœ¨åˆ›å»ºæ•°æ®åº“å’Œæ•°æ®è¡¨æ—¶å¹¶æ²¡æœ‰ä½¿ç”¨é‚£ä¹ˆå¤æ‚çš„é…ç½®ï¼Œå®ƒä»¬ç”¨çš„æ˜¯é»˜è®¤çš„é…ç½®ï¼Œé‚£ä¹ˆï¼Œé»˜è®¤çš„é…ç½®ä»ä½•è€Œæ¥å‘¢ï¼Ÿ</p></blockquote><ol><li>ç¼–è¯‘MySQL æ—¶ï¼ŒæŒ‡å®šäº†ä¸€ä¸ªé»˜è®¤çš„å­—ç¬¦é›†ï¼Œè¿™ä¸ªå­—ç¬¦é›†æ˜¯ latin1ï¼›</li><li>å®‰è£…MySQL æ—¶ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ (my.ini) ä¸­æŒ‡å®šä¸€ä¸ªé»˜è®¤çš„çš„å­—ç¬¦é›†ï¼Œå¦‚æœæ²¡æŒ‡å®šï¼Œè¿™ä¸ªå€¼ç»§æ‰¿è‡ªç¼–è¯‘æ—¶æŒ‡å®šçš„ï¼›</li><li>å¯åŠ¨mysqld æ—¶ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šä¸€ä¸ªé»˜è®¤çš„çš„å­—ç¬¦é›†ï¼Œå¦‚æœæ²¡æŒ‡å®šï¼Œè¿™ä¸ªå€¼ç»§æ‰¿è‡ªé…ç½®æ–‡ä»¶ä¸­çš„é…ç½®,æ­¤æ—¶ character_set_server è¢«è®¾å®šä¸ºè¿™ä¸ªé»˜è®¤çš„å­—ç¬¦é›†ï¼›</li><li>å½“åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“æ—¶ï¼Œé™¤éæ˜ç¡®æŒ‡å®šï¼Œè¿™ä¸ªæ•°æ®åº“çš„å­—ç¬¦é›†è¢«ç¼ºçœè®¾å®šä¸ºcharacter_set_serverï¼›</li><li>å½“é€‰å®šäº†ä¸€ä¸ªæ•°æ®åº“æ—¶ï¼Œcharacter_set_databaseè¢«è®¾å®šä¸ºè¿™ä¸ªæ•°æ®åº“é»˜è®¤çš„å­—ç¬¦é›†ï¼›</li><li>åœ¨è¿™ä¸ªæ•°æ®åº“é‡Œåˆ›å»ºä¸€å¼ è¡¨æ—¶ï¼Œè¡¨é»˜è®¤çš„å­—ç¬¦é›†è¢«è®¾å®šä¸º character_set_databaseï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ•°æ®åº“é»˜è®¤çš„å­—ç¬¦é›†ï¼›</li><li>å½“åœ¨è¡¨å†…è®¾ç½®ä¸€æ æ—¶ï¼Œé™¤éæ˜ç¡®æŒ‡å®šï¼Œå¦åˆ™æ­¤æ ç¼ºçœçš„å­—ç¬¦é›†å°±æ˜¯è¡¨é»˜è®¤çš„å­—ç¬¦é›†ï¼›</li></ol><h3 id="æœ€ç»ˆcreatesqlæ–‡ä»¶"><a class="markdownIt-Anchor" href="#æœ€ç»ˆcreatesqlæ–‡ä»¶"></a> æœ€ç»ˆcreate.sqlæ–‡ä»¶</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">NAMES</span> utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">EXISTS</span>  <span class="string">`huaneng`</span> ;</span><br><span class="line"><span class="keyword">use</span> <span class="string">`huaneng`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for quotation_inone</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`quotation_inone`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`quotation_inone`</span>  (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`title`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_general_ci <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`date`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_general_ci <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`content`</span> LONGTEXT <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">   <span class="string">`proclamation_url`</span> <span class="built_in">VARCHAR</span>(<span class="number">512</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> (<span class="string">`proclamation_url`</span>),</span><br><span class="line"></span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) <span class="keyword">ENGINE</span> = <span class="keyword">InnoDB</span> AUTO_INCREMENT = <span class="number">1</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> = utf8mb4 <span class="keyword">COLLATE</span> = utf8mb4_general_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h1 id="2022å¹´3æœˆ20æ—¥-æŠ¤å£«é¢˜ç›®ä¸‹è½½å­˜word"><a class="markdownIt-Anchor" href="#2022å¹´3æœˆ20æ—¥-æŠ¤å£«é¢˜ç›®ä¸‹è½½å­˜word"></a> 2022å¹´3æœˆ20æ—¥-æŠ¤å£«é¢˜ç›®ä¸‹è½½å­˜Word</h1><h3 id="ç´¢å¼•æŠ¥é”™"><a class="markdownIt-Anchor" href="#ç´¢å¼•æŠ¥é”™"></a> ç´¢å¼•æŠ¥é”™</h3><ul><li>MySQL æ·»åŠ ç´¢å¼•æŠ¥é”™ï¼š<code>BLOB/TEXT column used in key specification without a key length</code><ol><li>å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªåç§°ä¸ºplatformçš„å­—æ®µï¼Œç±»å‹ä¸º text æ·»åŠ uniqueå”¯ä¸€æ€§çº¦æŸå’Œç´¢å¼•çº¦æŸæ—¶ï¼Œä¼šæŠ¥é”™ã€‚ åŸå› ï¼šMySQLåªèƒ½å°†BLOB/TEXTç±»å‹å­—æ®µè®¾ç½®ç´¢å¼•æ•°æ®çš„å‰Nä¸ªå­—ç¬¦ï¼Œå› æ­¤ï¼Œåªéœ€è¦é€šè¿‡sqlåœ¨å¢åŠ ç´¢å¼•æ—¶æŒ‡å®šå¯¹åº”å­—æ®µçš„é•¿åº¦å³å¯ï¼Œå¦‚ï¼š<br><code>ALTER TABLE hello_world ADD INDEX key1(platform(250), platform2(250), type);</code>, å…¶ä¸­ï¼Œplatform å’Œ platform2 å°±æ˜¯ text ç±»å‹çš„æ•°æ®<ul><li>more: <a href="https://www.cnblogs.com/wqbin/p/11903878.html" target="_blank" rel="noopener">https://www.cnblogs.com/wqbin/p/11903878.html</a></li></ul></li><li>æ ¹æœ¬åŸå› ï¼š é”™è¯¯å‘ç”Ÿçš„åŸå› æ˜¯å› ä¸ºMySQLåªèƒ½å°†BLOB/TEXTç±»å‹å­—æ®µè®¾ç½®ç´¢å¼•ä¸ºBLOB/TEXTæ•°æ®çš„å‰Nä¸ªå­—ç¬¦ï¼Œå› æ­¤é”™è¯¯å¸¸å¸¸å‘ç”Ÿåœ¨å­—æ®µè¢«å®šä¹‰ä¸ºTEXT/BLOBç±»å‹æˆ–è€…å’ŒTEXT/BLOBåŒè´¨çš„æ•°æ®ç±»å‹ï¼Œå¦‚TINYTEXT,MEDIUMTEXT,LONGTEXT ,TINYBLOB,MEDIUMBLOB å’ŒLONGBLOBï¼Œå¹¶ä¸”å½“å‰æ“ä½œæ˜¯å°†è¿™ä¸ªå­—æ®µè®¾ç½®æˆä¸»é”®æˆ–è€…æ˜¯ç´¢å¼•çš„æ“ä½œã€‚åœ¨æœªæŒ‡å®šTEXT/BLOBâ€˜é”®é•¿â€™çš„æƒ…å†µä¸‹ï¼Œå­—æ®µæ˜¯å˜åŠ¨çš„å¹¶ä¸”æ˜¯åŠ¨æ€çš„å¤§å°æ‰€ä»¥MySQLä¸èƒ½å¤Ÿä¿è¯å­—æ®µçš„å”¯ä¸€æ€§ã€‚å› æ­¤å½“ä½¿ç”¨TEXT/BLOBç±»å‹å­—æ®µåšä¸ºç´¢å¼•æ—¶ï¼ŒNçš„å€¼å¿…é¡»æä¾›å‡ºæ¥æ‰å¯ä»¥è®©MySQLå†³å®šé”®é•¿ï¼Œä½†æ˜¯MySQLä¸æ”¯æŒåœ¨TEXT/BLOBé™åˆ¶ï¼ŒTEXT(88)æ˜¯ä¸è¡Œçš„ã€‚<ul><li>è§£å†³æ–¹æ¡ˆæ˜¯<strong>å°†uniqueé™åˆ¶å’Œç´¢å¼•ä»TEXT/BLOBå­—æ®µä¸­ç§»é™¤</strong>ï¼Œæˆ–è€…æ˜¯<strong>è®¾ç½®å¦ä¸€ä¸ªå­—æ®µä¸ºä¸»é”®</strong>ï¼Œå¦‚æœä½ ä¸æ„¿æ„è¿™æ ·åšå¹¶ä¸”æƒ³åœ¨TEXT/BLOBä¸ŠåŠ é™åˆ¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥å°è¯•å°†è¿™ä¸ªå­—æ®µæ›´æ”¹ä¸ºVARCHARç±»å‹ï¼ŒåŒæ—¶ç»™ä»–ä¸€ä¸ªé™åˆ¶é•¿åº¦ï¼Œé»˜è®¤VARCHARæœ€å¤šå¯ä»¥é™å®šåœ¨255ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”é™åˆ¶è¦åœ¨å£°æ˜ç±»å‹çš„å³è¾¹æŒ‡æ˜ï¼Œå¦‚VARCHAR(200)å°†ä¼šé™åˆ¶ä»…ä»…200ä¸ªå­—ç¬¦.(æ³¨: ä½†æ˜¯mysqlä¸æ”¯æŒå¯¹TEXT/BLOBé•¿åº¦çš„é™åˆ¶ã€‚)</li><li><a href="https://blog.csdn.net/u012069924/article/details/28858337" target="_blank" rel="noopener">https://blog.csdn.net/u012069924/article/details/28858337</a><br>â–². åœ¨ varchar å­—æ®µä¸Šå»ºç«‹ç´¢å¼•æ—¶ï¼Œå¿…é¡»æŒ‡å®šç´¢å¼•é•¿åº¦ï¼Œæ²¡å¿…è¦å¯¹å…¨å­—æ®µå»ºç«‹ç´¢å¼•ï¼Œæ ¹æ® å®é™…æ–‡æœ¬åŒºåˆ†åº¦å†³å®šç´¢å¼•é•¿åº¦å³å¯ã€‚Java å¼€å‘æ‰‹å†Œ 33/44 è¯´æ˜ï¼šç´¢å¼•çš„é•¿åº¦ä¸åŒºåˆ†åº¦æ˜¯ä¸€å¯¹çŸ›ç›¾ä½“ï¼Œä¸€èˆ¬å¯¹å­—ç¬¦ä¸²ç±»å‹æ•°æ®ï¼Œé•¿åº¦ä¸º 20 çš„ç´¢å¼•ï¼ŒåŒºåˆ†åº¦ä¼šé«˜è¾¾ 90%ä»¥ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ count(distinct left(åˆ—å, ç´¢å¼•é•¿åº¦))/count(*)çš„åŒºåˆ†åº¦æ¥ç¡®å®šã€‚</li></ul></li></ol></li></ul><h3 id="æ•°æ®åº“æ’å…¥æ•°æ®"><a class="markdownIt-Anchor" href="#æ•°æ®åº“æ’å…¥æ•°æ®"></a> æ•°æ®åº“æ’å…¥æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- \\è¡¨ç¤ºä¸€ä¸ª\</span></span><br><span class="line"><span class="keyword">use</span> xian_nurse;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`question`</span> (<span class="string">`path`</span>) <span class="keyword">VALUES</span> (<span class="string">'ä¹¦ç±\\C-ã€Šä¼ æŸ“ç—…æŠ¤ç†å­¦ä¹ æŒ‡å¯¼ä¸ä¹ é¢˜é›†ã€‹-é€‰æ‹©é¢˜'</span>), (<span class="string">'ä¹¦ç±\\C-ã€Šä¼ æŸ“ç—…æŠ¤ç†æŠ€æœ¯å­¦ä¹ æŒ‡å¯¼ä¸ä¹ é¢˜é›†ã€‹-é€‰æ‹©é¢˜'</span>), (<span class="string">'ä¹¦ç±\\C-ã€Šä¼ æŸ“ç—…æŠ¤ç†æŠ€æœ¯å­¦ä¹ æŒ‡å¯¼ä¸ä¹ é¢˜é›†ã€‹-é¢˜å¹²é¢˜'</span>), (<span class="string">'ä¹¦ç±\\C-ã€ŠæˆäººæŠ¤ç†å­¦å­¦ä¹ æŒ‡å¯¼ä¸ä¹ é¢˜é›†-äººæ°‘å«ç”Ÿå‡ºç‰ˆç¤¾ã€‹-é€‰æ‹©é¢˜'</span>), (<span class="string">'ä¹¦ç±\\C-ã€ŠæˆäººæŠ¤ç†å­¦å­¦ä¹ æŒ‡å¯¼ä¸ä¹ é¢˜é›†-äººæ°‘å«ç”Ÿå‡ºç‰ˆç¤¾ã€‹-é¢˜å¹²é¢˜'</span>), (<span class="string">'ä¹¦ç±\\E -ã€Šå„¿ç§‘æŠ¤ç†å­¦å®è·µä¸å­¦ä¹ æŒ‡å¯¼ï¼ˆåä¸‰äº”ï¼‰ã€‹â€”é€‰æ‹©é¢˜'</span>), (<span class="string">'ä¹¦ç±\\E -ã€Šå„¿ç§‘æŠ¤ç†å­¦å®è·µä¸å­¦ä¹ æŒ‡å¯¼ï¼ˆåä¸‰äº”ï¼‰ã€‹â€”é¢˜å¹²é¢˜'</span>);</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œword"><a class="markdownIt-Anchor" href="#æ“ä½œword"></a> æ“ä½œword</h2><blockquote><p>ä½¿ç”¨<code>python-docx</code>: <code>python -m pip install python-docx</code>ï¼Œ <a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://python-docx.readthedocs.io/en/latest/</a></p></blockquote><ol><li>æ·»åŠ 1-9çº§æ ‡é¢˜</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°çš„docxæ–‡ä»¶</span></span><br><span class="line">document = Document()</span><br><span class="line">document.add_heading(<span class="string">'1çº§æ ‡é¢˜'</span>, <span class="number">1</span>)  <span class="comment"># æ·»åŠ 1çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'2çº§æ ‡é¢˜'</span>, <span class="number">2</span>)  <span class="comment"># æ·»åŠ 2çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'3çº§æ ‡é¢˜'</span>, <span class="number">3</span>)  <span class="comment"># æ·»åŠ 3çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'4çº§æ ‡é¢˜'</span>, <span class="number">4</span>)  <span class="comment"># æ·»åŠ 4çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'5çº§æ ‡é¢˜'</span>, <span class="number">5</span>)  <span class="comment"># æ·»åŠ 5çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'6çº§æ ‡é¢˜'</span>, <span class="number">6</span>)  <span class="comment"># æ·»åŠ 6çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'7çº§æ ‡é¢˜'</span>, <span class="number">7</span>)  <span class="comment"># æ·»åŠ 7çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'8çº§æ ‡é¢˜'</span>, <span class="number">8</span>)  <span class="comment"># æ·»åŠ 8çº§æ ‡é¢˜</span></span><br><span class="line">document.add_heading(<span class="string">'9çº§æ ‡é¢˜'</span>, <span class="number">9</span>)  <span class="comment"># æ·»åŠ 9çº§æ ‡é¢˜</span></span><br><span class="line">document.save(<span class="string">'&#123;&#125;.docx'</span>.format(datetime.now().strftime(<span class="string">'%Y%m%d%H%M%S'</span>)))</span><br></pre></td></tr></table></figure><ol start="2"><li>æ·»åŠ æ®µè½</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°çš„docxæ–‡ä»¶</span></span><br><span class="line">document = Document()</span><br><span class="line">paragraph = <span class="string">"""è¿™æ˜¯ä¸€ä¸ªæ®µè½</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">paragraph2 = <span class="string">"""è¿™æ˜¯ä¸€ä¸ªæ–°çš„æ®µè½"""</span></span><br><span class="line">paragraph3 = <span class="string">"""è¿™æ˜¯ä¸€ä¸ªæ–°çš„æ®µè½ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">document.add_paragraph(paragraph)</span><br><span class="line">document.add_paragraph(paragraph2)</span><br><span class="line">document.add_paragraph(paragraph3)</span><br><span class="line">document.save(<span class="string">'&#123;&#125;.docx'</span>.format(datetime.now().strftime(<span class="string">'%Y%m%d%H%M%S'</span>)))</span><br></pre></td></tr></table></figure><ol start="3"><li>è®¾ç½®å­—ä½“å¤§å°å’Œæ ·å¼</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°çš„docxæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> Pt</span><br><span class="line"></span><br><span class="line">document = Document()</span><br><span class="line">document.add_paragraph(<span class="string">"è¿™æ˜¯ä¸€ä¸ªæ®µè½"</span>)  <span class="comment"># æ·»åŠ æ®µè½</span></span><br><span class="line">paragraph = document.add_paragraph(<span class="string">"è¿™æ˜¯ä¸€ä¸ªæ®µè½,"</span>)  <span class="comment"># æ·»åŠ æ®µè½</span></span><br><span class="line">run = paragraph.add_run(<span class="string">'è®¾ç½®äº†å­—ä½“çš„æ®µè½'</span>)  <span class="comment"># åœ¨åŒä¸€æ®µæ·»åŠ å†…å®¹, å³ä¸ºäº†æ“ä½œæ®µè½æˆ–å•è¯çš„å­å­—ç¬¦ä¸². æ¦‚å¿µä¸Šè®²ï¼Œæ‚¨éœ€è¦ä¸ºæ®µè½/æ–‡æœ¬çš„runæ¯ä¸ªéƒ¨åˆ†åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Append a run to this paragraph containing *text* and having character</span></span><br><span class="line"><span class="string">style identified by style ID *style*. *text* can contain tab</span></span><br><span class="line"><span class="string">(``\\t``) characters, which are converted to the appropriate XML form</span></span><br><span class="line"><span class="string">for a tab. *text* can also include newline (``\\n``) or carriage</span></span><br><span class="line"><span class="string">return (``\\r``) characters, each of which is converted to a line</span></span><br><span class="line"><span class="string">break.</span></span><br><span class="line"><span class="string">å¤§æ¦‚æ„æ€å°±æ˜¯è¿½åŠ ä¸€ä¸ªæ®µè½, åŒ…å«text, ä¸”è®¾ç½®äº†æ ¼å¼, æˆ‘æ„Ÿè§‰æ˜¯è¿™æ ·</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">run.font.name = <span class="string">u'å®‹ä½“'</span>  <span class="comment"># è®¾ç½®å­—ä½“</span></span><br><span class="line">run.font.size = Pt(<span class="number">20</span>)  <span class="comment"># è®¾ç½®å­—å·</span></span><br><span class="line"><span class="comment"># run.font.color.rgb = RGBColor(255, 0, 0)# è®¾ç½®çº¢è‰²</span></span><br><span class="line">run.font.underline = <span class="keyword">True</span><span class="comment"># è®¾ç½®ä¸‹åˆ’çº¿</span></span><br><span class="line"></span><br><span class="line">run1 = paragraph.add_run(<span class="string">'\tç²—ä½“'</span>)</span><br><span class="line">run1.bold = <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">run2 = paragraph.add_run(<span class="string">'\tæ–œä½“'</span>)</span><br><span class="line">run2.italic = <span class="keyword">True</span></span><br><span class="line"> <span class="comment">#å›¾ç‰‡å±…ä¸­è®¾ç½®</span></span><br><span class="line">paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Doc = Document() </span><br><span class="line">Doc.styles[<span class="string">'Normal'</span>].font.name = <span class="string">u'å®‹ä½“'</span></span><br><span class="line">Doc.styles[<span class="string">'Normal'</span>]._element.rPr.rFonts.set(qn(<span class="string">'w:eastAsia'</span>), <span class="string">u'å®‹ä½“'</span>)</span><br><span class="line">Doc.styles[<span class="string">'Normal'</span>].font.size = Pt(<span class="number">10.5</span>)</span><br><span class="line">Doc.styles[<span class="string">'Normal'</span>].font.color.rgb = RGBColor(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">Head = Doc.add_heading(<span class="string">""</span>,level=<span class="number">1</span>)<span class="comment"># è¿™é‡Œä¸å¡«æ ‡é¢˜å†…å®¹</span></span><br><span class="line">run  = Head.add_run(<span class="string">"åˆšæ¥csdnï¼Œè¿™å°±æ˜¯åšå®¢ä¹ˆï¼ŒIäº†"</span>)</span><br><span class="line">run.font.name=<span class="string">u'Cambria'</span></span><br><span class="line">run.font.color.rgb = RGBColor(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">run._element.rPr.rFonts.set(qn(<span class="string">'w:eastAsia'</span>), <span class="string">u'Cambria'</span>)</span><br><span class="line">Doc.add_paragraph(<span class="string">"Python "</span>)</span><br><span class="line">Doc.add_paragraph(<span class="string">"Python å¯¹wordè¿›è¡Œæ“ä½œ"</span>)</span><br><span class="line">Doc.save(<span class="string">"Python_word.docx"</span>)</span><br></pre></td></tr></table></figure><p>from : <a href="https://www.pythonheidong.com/blog/article/692569/99875f167810b45f17e8/" target="_blank" rel="noopener">https://www.pythonheidong.com/blog/article/692569/99875f167810b45f17e8/</a></p><ol start="4"><li>æœ‰åº(æ— åº)åˆ—è¡¨å’Œå¼•ç”¨</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¢åŠ å¼•ç”¨</span></span><br><span class="line">document.add_paragraph(<span class="string">'123'</span>, style=<span class="string">'Intense Quote'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ æœ‰åºåˆ—è¡¨</span></span><br><span class="line">document.add_paragraph(<span class="string">u'æœ‰åºåˆ—è¡¨å…ƒç´ 1'</span>, style=<span class="string">'List Number'</span>)</span><br><span class="line">document.add_paragraph(<span class="string">u'æœ‰åºåˆ—åˆ«å…ƒç´ 2'</span>, style=<span class="string">'List Number'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ æ— åºåˆ—è¡¨</span></span><br><span class="line">document.add_paragraph(<span class="string">u'æ— åºåˆ—è¡¨å…ƒç´ 1'</span>, style=<span class="string">'List Bullet'</span>)</span><br><span class="line">document.add_paragraph(<span class="string">u'æ— åºåˆ—è¡¨å…ƒç´ 2'</span>, style=<span class="string">'List Bullet'</span>)</span><br></pre></td></tr></table></figure><ol start="5"><li>è¡¨æ ¼å’Œåˆ†é¡µ</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¢åŠ å›¾ç‰‡ï¼ˆæ­¤å¤„ä½¿ç”¨ç›¸å¯¹ä½ç½®ï¼‰</span></span><br><span class="line"><span class="comment"># document.add_picture('jdb.jpg', width=Inches(1.25))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ è¡¨æ ¼</span></span><br><span class="line">table = document.add_table(rows=<span class="number">3</span>, cols=<span class="number">3</span>)  <span class="comment"># 3è¡Œ3åˆ—</span></span><br><span class="line">hdr_cells1 = table.rows[<span class="number">0</span>].cells  <span class="comment"># ç¬¬ä¸€è¡Œ</span></span><br><span class="line">hdr_cells1[<span class="number">0</span>].text = <span class="string">"ç¬¬ä¸€è¡Œ,ç¬¬ä¸€åˆ—"</span></span><br><span class="line">hdr_cells1[<span class="number">1</span>].text = <span class="string">"ç¬¬ä¸€è¡Œ,ç¬¬äºŒåˆ—"</span></span><br><span class="line">hdr_cells1[<span class="number">2</span>].text = <span class="string">"ç¬¬ä¸€è¡Œ,ç¬¬ä¸‰åˆ—"</span></span><br><span class="line"></span><br><span class="line">hdr_cells2 = table.rows[<span class="number">1</span>].cells  <span class="comment"># ç¬¬äºŒè¡Œ</span></span><br><span class="line">hdr_cells2[<span class="number">0</span>].text = <span class="string">"ç¬¬äºŒè¡Œ,ç¬¬ä¸€åˆ—"</span></span><br><span class="line">hdr_cells2[<span class="number">1</span>].text = <span class="string">"ç¬¬äºŒè¡Œ,ç¬¬äºŒåˆ—"</span></span><br><span class="line">hdr_cells2[<span class="number">2</span>].text = <span class="string">"ç¬¬äºŒè¡Œ,ç¬¬ä¸‰åˆ—"</span></span><br><span class="line"></span><br><span class="line">hdr_cells3 = table.rows[<span class="number">2</span>].cells  <span class="comment"># ç¬¬ä¸‰è¡Œ</span></span><br><span class="line">hdr_cells3[<span class="number">0</span>].text = <span class="string">"ç¬¬ä¸‰è¡Œ,ç¬¬ä¸€åˆ—"</span></span><br><span class="line">hdr_cells3[<span class="number">1</span>].text = <span class="string">"ç¬¬ä¸‰è¡Œ,ç¬¬äºŒåˆ—"</span></span><br><span class="line">hdr_cells3[<span class="number">2</span>].text = <span class="string">"ç¬¬ä¸‰è¡Œ,ç¬¬ä¸‰åˆ—"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ åˆ†é¡µ</span></span><br><span class="line">document.add_page_break()</span><br></pre></td></tr></table></figure><h3 id="æå–æ–‡å­—"><a class="markdownIt-Anchor" href="#æå–æ–‡å­—"></a> æå–æ–‡å­—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line">path = <span class="string">'/media/bobo/è‡ªåŠ¨åŒ–åŠå…¬/wordOperation/wordDemo/test2.docx'</span></span><br><span class="line"></span><br><span class="line">doc = Document(path)</span><br><span class="line">print(doc.paragraphs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºçš„æ˜¯åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ä¸€å…±æœ‰4ä»½å†…å®¹</span></span><br><span class="line"><span class="comment"># [&lt;docx.text.paragraph.Paragraph object at 0x7fca95f0aba8&gt;,</span></span><br><span class="line"><span class="comment"># &lt;docx.text.paragraph.Paragraph object at 0x7fca95f0abe0&gt;,</span></span><br><span class="line"><span class="comment"># &lt;docx.text.paragraph.Paragraph object at 0x7fca95f0ab70&gt;, </span></span><br><span class="line"><span class="comment">#&lt;docx.text.paragraph.Paragraph object at 0x7fca95f0ac50&gt;,]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> paragraph <span class="keyword">in</span> doc.paragraphs:</span><br><span class="line">print(paragraph.text)</span><br></pre></td></tr></table></figure><p>from :</p><ul><li><a href="https://www.cnblogs.com/rainbow-tan/p/14981998.html" target="_blank" rel="noopener">https://www.cnblogs.com/rainbow-tan/p/14981998.html</a></li><li><a href="https://www.cnblogs.com/wenshi-jj/p/15388808.html" target="_blank" rel="noopener">https://www.cnblogs.com/wenshi-jj/p/15388808.html</a></li><li><a href="https://www.cnblogs.com/rencm/p/6285304.html" target="_blank" rel="noopener">https://www.cnblogs.com/rencm/p/6285304.html</a></li><li><a href="https://blog.csdn.net/weixin_44576802/article/details/86552550%E2%80%94%E2%80%94%E9%A2%9C%E8%89%B2" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44576802/article/details/86552550â€”â€”é¢œè‰²</a></li><li>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wenshi-jj/p/15388808.html%E2%80%94%E2%80%94%E9%A1%B5%E8%BE%B9%E8%B7%9D%E3%80%81%E9%A1%B5%E7%9C%89%E5%92%8C%E9%A1%B5%E8%84%9A%E3%80%81%E5%88%86%E6%A0%8F" target="_blank" rel="noopener">https://www.cnblogs.com/wenshi-jj/p/15388808.htmlâ€”â€”é¡µè¾¹è·ã€é¡µçœ‰å’Œé¡µè„šã€åˆ†æ </a></li></ul><h1 id="å…±åŒç‚¹å¤„ç†"><a class="markdownIt-Anchor" href="#å…±åŒç‚¹å¤„ç†"></a> å…±åŒç‚¹å¤„ç†</h1><h2 id="æ–‡ä»¶ä¿å­˜"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ä¿å­˜"></a> æ–‡ä»¶ä¿å­˜</h2><blockquote><p>ç”±äºæ–‡ä»¶å¤¹ã€æ–‡ä»¶åä¸å…è®¸æœ‰<code>/\:*?|&lt;&gt;&quot;</code>ï¼Œå› æ­¤éœ€è¦ä¿å­˜æ—¶å¦‚æœå‡ºç°è¿™äº›å­—ç¬¦å¾—ç‰¹åˆ«å¤„ç†ã€‚</p></blockquote><ol><li>é¡¹ç›®ä¸€ï¼š<code>xxxxé˜»å¢å‰‚\åæ¸—é€é˜»å¢å‰‚\25KGè¯¢ä»·ä¹¦è¯¢ä»·å…¬å‘Š\zxc.doc</code> ==&gt; <code>xxxé˜»å¢å‰‚ã€åæ¸—é€é˜»å¢å‰‚ã€25KGè¯¢ä»·ä¹¦è¯¢ä»·å…¬å‘Š\zxc.doc</code>ï¼Œå­˜å‚¨åœ¨<code>attaches\xxxé˜»å¢å‰‚ã€åæ¸—é€é˜»å¢å‰‚ã€25KGè¯¢ä»·ä¹¦è¯¢ä»·å…¬å‘Š\zxc.doc</code></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@staticmethod</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">format_name</span><span class="params">(name: str)</span> -&gt; [bool, str]:</span></span><br><span class="line">       <span class="string">"""</span></span><br><span class="line"><span class="string">       æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åè§„èŒƒåŒ–</span></span><br><span class="line"><span class="string">       :param name:</span></span><br><span class="line"><span class="string">       :return:</span></span><br><span class="line"><span class="string">       """</span></span><br><span class="line">   invalid_char = [<span class="string">"/"</span>, <span class="string">"\\"</span>, <span class="string">":"</span>, <span class="string">"*"</span>, <span class="string">"?"</span>, <span class="string">"|"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"\""</span>]</span><br><span class="line">       rename = name</span><br><span class="line">       valid = <span class="keyword">True</span></span><br><span class="line">       <span class="keyword">for</span> ch <span class="keyword">in</span> invalid_char:</span><br><span class="line">           <span class="keyword">if</span> ch <span class="keyword">in</span> rename:</span><br><span class="line">               <span class="keyword">if</span> ch == <span class="string">"?"</span>:</span><br><span class="line">                   rename = rename.replace(<span class="string">"?"</span>, <span class="string">"ï¼Ÿ"</span>)</span><br><span class="line">               <span class="keyword">elif</span> ch == <span class="string">"&lt;"</span>:</span><br><span class="line">                   rename = rename.replace(<span class="string">"&lt;"</span>, <span class="string">"["</span>)</span><br><span class="line">               <span class="keyword">elif</span> ch == <span class="string">"&gt;"</span>:</span><br><span class="line">                   rename = rename.replace(<span class="string">"&gt;"</span>, <span class="string">"]"</span>)</span><br><span class="line">               <span class="keyword">else</span>:</span><br><span class="line">                   rename = rename.replace(ch, <span class="string">"ã€"</span>)</span><br><span class="line">               valid = <span class="keyword">False</span></span><br><span class="line">       <span class="keyword">return</span> valid, rename</span><br></pre></td></tr></table></figure><ol start="2"><li>é¡¹ç›®äºŒï¼š<code>'.\\docx/ä¸“ç§‘é¢˜åº“\\å„¿ç§‘\\[ä¹¦ç±]\\S-ã€Šå®ç”¨ä¸´åºŠæŠ¤ç†ä¸‰åŸº-&quot;åº”çŸ¥åº”ä¼š&quot;ã€‹â€”åè¯è§£é‡Šã€ç®€ç­”(è§„02ï¼‰\\something.docx'</code>===&gt;<code>'.\\docx/ä¸“ç§‘é¢˜åº“\\å„¿ç§‘\\[ä¹¦ç±]\\S-ã€Šå®ç”¨ä¸´åºŠæŠ¤ç†ä¸‰åŸº-'åº”çŸ¥åº”ä¼š'ã€‹â€”åè¯è§£é‡Šã€ç®€ç­”(è§„02ï¼‰\\something.docx'</code></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_file_path</span><span class="params">(path: str)</span> -&gt; [bool, str]:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åè§„èŒƒåŒ–</span></span><br><span class="line"><span class="string">    :param name:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    invalid_char = [<span class="string">"/"</span>, <span class="string">"\\"</span>, <span class="string">":"</span>, <span class="string">"*"</span>, <span class="string">"?"</span>, <span class="string">"|"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"\""</span>]</span><br><span class="line">    rename = path</span><br><span class="line">    valid = <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> invalid_char:</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> rename:</span><br><span class="line">            <span class="keyword">if</span> ch == <span class="string">"?"</span>:</span><br><span class="line">                rename = rename.replace(<span class="string">"?"</span>, <span class="string">"ï¼Ÿ"</span>)</span><br><span class="line">            <span class="keyword">elif</span> ch == <span class="string">"&lt;"</span>:</span><br><span class="line">                rename = rename.replace(<span class="string">"&lt;"</span>, <span class="string">"["</span>)</span><br><span class="line">            <span class="keyword">elif</span> ch == <span class="string">"&gt;"</span>:</span><br><span class="line">                rename = rename.replace(<span class="string">"&gt;"</span>, <span class="string">"]"</span>)</span><br><span class="line">            <span class="keyword">elif</span> ch == <span class="string">'"'</span>:</span><br><span class="line">                rename = rename.replace(<span class="string">"\""</span>, <span class="string">"\'"</span>)</span><br><span class="line">            <span class="keyword">elif</span> ch == <span class="string">"\\"</span> <span class="keyword">or</span> ch == <span class="string">"/"</span>:</span><br><span class="line">                <span class="comment"># æ³¨æ„è·Ÿ ä¸Šä¸€ä¸ªçš„åŒºåˆ«ï¼Œ ç”±äºä¸Šä¸€ä¸ªé¡¹ç›®ä¸­çš„/å’Œ\éƒ½æ˜¯åˆ†éš”ç¬¦ï¼Œè€Œä¸æ˜¯çœŸå®çš„åˆ†éš”ç›®å½•ï¼Œå› æ­¤éœ€è¦æ›¿æ¢ï¼Œä½†æœ¬é¡¹ç›®æ˜¯çœŸå®è·¯å¾„åˆ†éš”ç¬¦ï¼Œæ‰€ä»¥ä¸éœ€è¦è½¬æ¢</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rename = rename.replace(ch, <span class="string">"ã€"</span>)</span><br><span class="line">            valid = <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">return</span> valid, rename</span><br></pre></td></tr></table></figure><h1 id="é™„å½•"><a class="markdownIt-Anchor" href="#é™„å½•"></a> é™„å½•</h1><h3 id="lxmlåº“çš„ä½¿ç”¨"><a class="markdownIt-Anchor" href="#lxmlåº“çš„ä½¿ç”¨"></a> lxmlåº“çš„ä½¿ç”¨</h3><ul><li><p>æå–Elementä¸­æœ€è¿‘æ ‡ç­¾ä¸­çš„æ–‡æœ¬(ä¸åŒ…å«æ ‡ç­¾æœ¬èº«): <code>ele.xpath('//*[@id=&quot;xxx&quot;]/text()')</code></p></li><li><p>æå–Elementä¸­æ‰€æœ‰æ ‡ç­¾(æ ‡ç­¾åµŒå¥—)ä¸­çš„æ–‡æœ¬(ä¸åŒ…å«æ ‡ç­¾æœ¬èº«): <code>ele.xpath('//*[@id=&quot;xxx&quot;]/string(.)')</code></p><ul><li>æ³¨ï¼šè·Ÿ<code>//text()</code>åŒºåˆ«åœ¨äºï¼Œ<code>string(.)</code>çš„ç»“æœä¸ºåˆå¹¶åçš„strï¼Œ<code>//text()</code>ä¸ºæœªåˆå¹¶çš„list</li></ul></li><li><p>æå–Elementä¸­æ‰€æœ‰å†…å®¹(æ ‡ç­¾æœ¬èº«): <code>etree.tostring(ele, method=&quot;html&quot;)</code></p></li><li><p>ä¿®æ”¹ElementæŸä¸€å±æ€§:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">appendixs = html_content.xpath(<span class="string">'/html/body/div[4]/div/div[4]/div/div/div[1]/div[4]/p/a'</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> appendixs:</span><br><span class="line">    href = a.xpath(<span class="string">"@href"</span>)[<span class="number">0</span>]</span><br><span class="line">    save_path = self.download_file(ReUtil.extra_announcement_id(detail_article_url), href, title)</span><br><span class="line">    <span class="comment"># htmlä¸­ä¼šå¯¹\è¿›è¡Œè½¬ä¹‰</span></span><br><span class="line">    a.attrib[<span class="string">"href"</span>] = save_path</span><br></pre></td></tr></table></figure><p>æ³¨: ä¿®æ”¹å­elementçš„æŸå±æ€§åï¼ŒrootèŠ‚ç‚¹tostringçš„ç»“æœä¸­elementä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚(rootæŠ±æœ‰elementçš„å¼•ç”¨)</p></li><li><p>Elementçš„XMLæ ‡è®°åé€šè¿‡å¯¹è±¡çš„å±æ€§è®¿é—®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = &apos;&lt;a href=&quot;http://baidu.com&quot;&gt;hh&lt;span&gt;gg&lt;/span&gt;&lt;/a&gt;&apos;</span><br><span class="line">res = &#123;_Element: 1&#125; &lt;Element html at 0x1de3a6b9800&gt;</span><br><span class="line">     attrib = &#123;_Attrib: 0&#125; &#123;&#125;</span><br><span class="line">     base = &#123;NoneType&#125; None</span><br><span class="line">     nsmap = &#123;dict: 0&#125; &#123;&#125;</span><br><span class="line">     prefix = &#123;NoneType&#125; None</span><br><span class="line">     sourceline = &#123;int&#125; 1</span><br><span class="line">     tag = &#123;str&#125; &apos;html&apos;</span><br><span class="line">     tail = &#123;NoneType&#125; None</span><br><span class="line">     text = &#123;NoneType&#125; None</span><br></pre></td></tr></table></figure></li><li><p>Elementè¢«ç»„ç»‡åœ¨XMLæ ‘ç»“æ„ä¸­ã€‚å¢åŠ å­Elementå¹¶æŒ‡å®šå®ƒä»¬çš„çˆ¶Elementï¼Œä½¿ç”¨appendæ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³•ä¸€</span></span><br><span class="line">root = etree.Element(<span class="string">"root"</span>)</span><br><span class="line">root.append(etree.Element(<span class="string">"child1"</span>))</span><br><span class="line"><span class="comment"># æ³•äºŒ</span></span><br><span class="line">childNode = etree.SubElement(root, <span class="string">"child"</span>)</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤Elementä¸‹æŸä¸€èŠ‚ç‚¹å†…å®¹ï¼Œä¸æ·»åŠ ç›¸åŒï¼Œä¹Ÿæœ‰å®ä¾‹æ–¹æ³•å’Œå·¥å‚æ–¹æ³•ä¸¤ç§</p><ul><li><p><code>parentnode.remove(node)</code></p></li><li><p><code>etree.strip_elements(html, 'element_name', with_tag=True/False)</code></p></li></ul></li></ul><h3 id="timeitæ¨¡å—ä½¿ç”¨"><a class="markdownIt-Anchor" href="#timeitæ¨¡å—ä½¿ç”¨"></a> <code>timeit</code>æ¨¡å—ä½¿ç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spider = HuaNengSpider(ifend=<span class="string">"in"</span>)</span><br><span class="line"><span class="comment"># è®°å¾—setupå¯¼å…¥ </span></span><br><span class="line">run_time = timeit.timeit(<span class="string">"spider.run_parallelly()"</span>, <span class="string">"from __main__ import spider"</span>, number=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºçš„å•ä½ä¸ºs </span></span><br><span class="line">print(<span class="string">"è€—æ—¶: &#123;&#125;s"</span>.format(run_time))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run_time = timeit.timeit(<span class="string">'HuaNengSpider(ifend="notin", is_in_one=True).run_with_concurrent()'</span>,</span><br><span class="line">                         <span class="string">"from __main__ import HuaNengSpider"</span>, number=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="pythonä¸­æ“ä½œsqlalchemysqlalchemyä¸­æ–‡æŠ€æœ¯æ–‡æ¡£"><a class="markdownIt-Anchor" href="#pythonä¸­æ“ä½œsqlalchemysqlalchemyä¸­æ–‡æŠ€æœ¯æ–‡æ¡£"></a> Pythonä¸­æ“ä½œSQLAlchemy,SQLAlchemyä¸­æ–‡æŠ€æœ¯æ–‡æ¡£</h3><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/0ad18fdd7eed%E3%80%81" target="_blank" rel="noopener">https://www.jianshu.com/p/0ad18fdd7eedã€</a><a href="https://www.cnblogs.com/yc-c/p/9627968.html" target="_blank" rel="noopener">python3 SQLAlchemyæ¨¡å—ä½¿ç”¨</a></p><h3 id="argumentparserä½¿ç”¨"><a class="markdownIt-Anchor" href="#argumentparserä½¿ç”¨"></a> <code>ArgumentParser</code>ä½¿ç”¨</h3><ul><li><p><code>parser.add_argument(&quot;-o&quot;, &quot;--is_in_one&quot;, action=&quot;store_true&quot;, help=&quot;æ•°æ®å­˜æ”¾åœ¨ä¸€å¼ è¡¨ä¸­&quot;)</code>, å…¶ä¸­actionçš„<code>store_true</code>è¡¨ç¤ºï¼Œå¦‚æœå‡ºç°â€“is_in_one(action)åˆ™è®¾ç½®æœªtrue, æ‰€ä»¥é»˜è®¤ä¸ºFalse</p><ul><li>å‚æ•°è®¾ç½®ä¸ºTrueã€Falseçš„æœ€å¥½ä¸ä½¿ç”¨choiceå‚æ•°ï¼šå› ä¸º</li><li><code>parser.add_argument(&quot;-o&quot;, &quot;--is_in_one&quot;, choices=[True, False], help=&quot;æ•°æ®å­˜æ”¾åœ¨ä¸€å¼ è¡¨ä¸­&quot;)</code>, choiceä¸­ä¸ºTrueã€Falseæ—¶ï¼Œ å¯ä»¥é€‰æ‹©ä¸å¡«ï¼Œæ­¤æ—¶is_in_oneä¸ºNoneï¼Œ å¦‚æœå¿…é¡»è¦è¿™ä¸¤ä¸ªåˆ™é€‰ä¸€ä¸ªåˆ™åŠ ä¸Š<code>required=True</code>é€‰é¡¹</li><li>åŠ ä¸Šrequiredæ•ˆæœ===&gt;<code>çˆ¬è™«è„šæœ¬: error: argument -o/--is_in_one: invalid choice: 'q' (choose from True, False)</code>ï¼Œ ä½†æ˜¯å¦‚æœè¾“å…¥TrueåŒæ ·ä¼šæŠ¥é”™: çˆ¬è™«è„šæœ¬: error: argument -o/â€“is_in_one: invalid choice: â€˜Trueâ€™ (choose from True, False)</li></ul><p>æ‰€ä»¥åªæœ‰<code>choices=[&quot;True&quot;, &quot;False&quot;]</code>æ‰èƒ½ç”Ÿæ•ˆï¼Œ å¥½åœ¨çš„æ˜¯Pythonä¸­å¯¹trueåˆ¤æ–­æ¯”è¾ƒå®½å®¹ï¼Œä¸‹é¢ä¸‰ç§éƒ½å¯ä»¥ï¼Œå› æ­¤ä½¿å¾—choiceä¼ strç±»å‹çš„Trueä¹Ÿå¯ä»¥æˆåŠŸåˆ¤å®šï¼Œå³èƒ½å®ç°ç›¸åŒæ•ˆæœï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨äº›æ­§ä¹‰çš„ï¼Œå¾—è°¨æ…ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">"true"</span></span><br><span class="line">b = <span class="keyword">True</span></span><br><span class="line">c = <span class="string">"True"</span></span><br><span class="line"><span class="keyword">if</span> a:</span><br><span class="line">    print(<span class="string">"a yes"</span>)</span><br><span class="line"><span class="keyword">if</span> b:</span><br><span class="line">    print(<span class="string">"b yes"</span>)</span><br><span class="line"><span class="keyword">if</span> c:</span><br><span class="line">    print(<span class="string">"c yes"</span>)</span><br></pre></td></tr></table></figure></li></ul><h3 id="å…¶ä»–sqlæ–‡ä»¶"><a class="markdownIt-Anchor" href="#å…¶ä»–sqlæ–‡ä»¶"></a> å…¶ä»–SQLæ–‡ä»¶</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`auto_bilibili`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`userid`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'åˆ›å»ºçš„ä»»åŠ¡å'</span>,</span><br><span class="line">  <span class="string">`sessdata`</span> longtext <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`bili_jct`</span> longtext <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`dedeuserid`</span> longtext <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`taskIntervalTime`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'10'</span> <span class="keyword">COMMENT</span> <span class="string">'ä»»åŠ¡ä¹‹é—´çš„æ‰§è¡Œé—´éš”'</span>,</span><br><span class="line">  <span class="string">`numberOfCoins`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'5'</span> <span class="keyword">COMMENT</span> <span class="string">'æ¯æ—¥æŠ•å¸æ•°é‡'</span>,</span><br><span class="line">  <span class="string">`reserveCoins`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'50'</span> <span class="keyword">COMMENT</span> <span class="string">'é¢„ç•™çš„ç¡¬å¸æ•°'</span>,</span><br><span class="line">  <span class="string">`selectLike`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'æŠ•å¸æ—¶æ˜¯å¦ç‚¹èµï¼Œé»˜è®¤ 0, 0ï¼šå¦ 1ï¼šæ˜¯'</span>,</span><br><span class="line">  <span class="string">`monthEndAutoCharge`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'true'</span> <span class="keyword">COMMENT</span> <span class="string">'å¹´åº¦å¤§ä¼šå‘˜æœˆåº•æ˜¯å¦ç”¨ B å¸åˆ¸ç»™è‡ªå·±å……ç”µï¼Œé»˜è®¤ trueï¼Œå³å……ç”µå¯¹è±¡æ˜¯ä½ æœ¬äººã€‚'</span>,</span><br><span class="line">  <span class="string">`giveGift`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'true'</span> <span class="keyword">COMMENT</span> <span class="string">'ç›´æ’­é€å‡ºå³å°†è¿‡æœŸçš„ç¤¼ç‰©ï¼Œé»˜è®¤å¼€å¯'</span>,</span><br><span class="line">  <span class="string">`upLive`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'ç›´æ’­é€å‡ºå³å°†è¿‡æœŸçš„ç¤¼ç‰©ï¼ŒæŒ‡å®š up ä¸»ï¼Œä¸º 0 æ—¶åˆ™éšéšæœºé€‰å–ä¸€ä¸ª up ä¸»'</span>,</span><br><span class="line">  <span class="string">`chargeForLove`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'ç»™æŒ‡å®š up ä¸»å……ç”µï¼Œå€¼ä¸º 0 æˆ–è€…å……ç”µå¯¹è±¡çš„ uidï¼Œé»˜è®¤ä¸º 0ï¼Œå³ç»™è‡ªå·±å……ç”µ'</span>,</span><br><span class="line">  <span class="string">`devicePlatform`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'ios'</span> <span class="keyword">COMMENT</span> <span class="string">'æ‰‹æœºç«¯æ¼«ç”»ç­¾åˆ°æ—¶çš„å¹³å°ï¼Œå»ºè®®é€‰æ‹©ä½ è®¾å¤‡çš„å¹³å° ï¼Œé»˜è®¤ ios'</span>,</span><br><span class="line">  <span class="string">`coinAddPriority`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'1'</span> <span class="keyword">COMMENT</span> <span class="string">'0ï¼šä¼˜å…ˆç»™çƒ­æ¦œè§†é¢‘æŠ•å¸ï¼Œ1ï¼šä¼˜å…ˆç»™å…³æ³¨çš„ up æŠ•å¸'</span>,</span><br><span class="line">  <span class="string">`userAgent`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 Edg/86.0.622.69'</span> <span class="keyword">COMMENT</span> <span class="string">'æµè§ˆå™¨ UA'</span>,</span><br><span class="line">  <span class="string">`skipDailyTask`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'false'</span> <span class="keyword">COMMENT</span> <span class="string">'æ˜¯å¦è·³è¿‡æ¯æ—¥ä»»åŠ¡'</span>,</span><br><span class="line">  <span class="string">`webhook`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'æ¨é€åœ°å€'</span>,</span><br><span class="line">  <span class="string">`enddate`</span> datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`match_enable`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'false'</span> <span class="keyword">COMMENT</span> <span class="string">'é¢„æµ‹æ˜¯å¦å¼€å¯'</span>,</span><br><span class="line">  <span class="string">`match_predictNumberOfCoins`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'10'</span> <span class="keyword">COMMENT</span> <span class="string">'å•æ¬¡é¢„æµ‹æŠ•æ³¨ç¡¬å¸'</span>,</span><br><span class="line">  <span class="string">`match_minimumNumberOfCoins`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'200'</span> <span class="keyword">COMMENT</span> <span class="string">'é¢„æµ‹ä¿ç•™ç¡¬å¸'</span>,</span><br><span class="line">  <span class="string">`match_showHandModel`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'false'</span> <span class="keyword">COMMENT</span> <span class="string">'æŠ¼æ³¨å½¢å¼'</span>,</span><br><span class="line">  <span class="string">`other`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`userid`</span> (<span class="string">`userid`</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">7</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 ROW_FORMAT=DYNAMIC</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;2022å¹´3æœˆ20æ—¥å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#2022å¹´3æœˆ20æ—¥å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“&quot;&gt;&lt;/a&gt; 2022å¹´3æœˆ20æ—¥â€”â€”å…¬å‘Šå­˜ç½‘ç«™é¡µé¢åˆ°æ•°æ®åº“&lt;/h1&gt;
&lt;h2 id=&quot;æ–‡ä»¶å­˜å‚¨&quot;&gt;&lt;a
      
    
    </summary>
    
    
      <category term="çˆ¬è™«" scheme="https://nymrli.top/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring</title>
    <link href="https://nymrli.top/2022/02/27/%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring/"/>
    <id>https://nymrli.top/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/</id>
    <published>2022-02-27T05:52:08.000Z</published>
    <updated>2022-02-27T05:54:23.566Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>From : <a href="https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6</a></p></blockquote><h2 id="åˆ›å»ºbeançš„æ–¹å¼"><a class="markdownIt-Anchor" href="#åˆ›å»ºbeançš„æ–¹å¼"></a> åˆ›å»ºbeançš„æ–¹å¼ï¼š</h2><h3 id="å£°æ˜å¼"><a class="markdownIt-Anchor" href="#å£°æ˜å¼"></a> å£°æ˜å¼</h3><h4 id="beanbean"><a class="markdownIt-Anchor" href="#beanbean"></a> <code>&lt;bean&gt;&lt;/bean&gt;</code></h4><ul><li><p><code>&lt;bean&gt;&lt;/bean&gt;</code>ï¼š é€šè¿‡xmlæ¥é…ç½®bean</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/aop/spring-aop-3.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"p1"</span> <span class="attr">class</span>=<span class="string">"top.nymrli.tryboot.po.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å¼ ä¸‰"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testPerson()</span><br><span class="line">    &#123;</span><br><span class="line"> ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");</span><br><span class="line"></span><br><span class="line">        User user = annotationConfigApplicationContext.getBean("p1", User.class);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="bean"><a class="markdownIt-Anchor" href="#bean"></a> <code>@Bean</code></h4><ul><li><p><code>@Bean</code>: é€šè¿‡æ³¨è§£æ¥æ ‡æ³¨SpringBeanå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"name"</span>, <span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">        ctx.register(Config.class);</span><br><span class="line">        <span class="comment">// æˆ–è€… AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext(Config.class);</span></span><br><span class="line"></span><br><span class="line">        ctx.refresh();</span><br><span class="line"></span><br><span class="line">        User user = ctx.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext(Config.class);</code>ä¸<code>ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</code>ä¸€æ ·ï¼Œéƒ½æ˜¯æŒ‡å®šbeançš„é…ç½®è·¯å¾„åè§£æï¼Œè·å¾—beançš„é…ç½®ã€‚</p></li></ul><h4 id="component"><a class="markdownIt-Anchor" href="#component"></a> <code>@Component</code></h4><ul><li><p><code>@Component</code>: é€šè¿‡æ ‡æ³¨æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶SpringBeanå¯¹è±¡ï¼Œå¦‚ä¸‹çš„Userã€‚ ==&gt; ç­‰ä»·äº<code>ctx.registerBean(User.class)</code>ï¼ŒregisterBeanæ–¹æ³•çš„å®ç°æœ€ç»ˆä¹Ÿæ˜¯è°ƒç”¨äº†registerBeanDefinition</p><p>è€ŒConfigä¸æ˜¯ä¸€ä¸ªbeanï¼Œä»–çš„ä½œç”¨è·ŸapplicationContext.xmlä¸€æ ·ï¼Œä»–æ˜¯å­˜æ”¾beanå®šä¹‰è·¯å¾„çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæ˜¯é€šè¿‡ComponentScanè®©Springèƒ½å¤Ÿæ‰¾åˆ°top.nymrli.tryboot.poä¸‹çš„æ‰€æœ‰Beanå¹¶è§£ææˆSpringBean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span>(<span class="string">"top.nymrli.tryboot.po"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span><span class="comment">// ==&gt; beanNameä¸ºuser, ç±»åå°å†™</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line"></span><br><span class="line">    User user = ctx.getBean(User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šè‡ªåŠ¨è°ƒç”¨Userçš„æ— å‚æ„é€ æ–¹å¼æ¥åˆ›å»ºJavaBeanï¼Œ å› æ­¤å¾—åˆ°çš„Useræ˜¯<code>User(name=null, age=0)</code></p></li></ul><p>â–².ä¸Šè¿°ä¸‰ç§åˆ›å»ºæ–¹å¼æœ¬è´¨ä¸Šéƒ½æ˜¯åˆ›å»ºäº†BeanDefinitionï¼Œåªä¸è¿‡Springè¿›è¡Œäº†å°è£…ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥æ¯”è¾ƒç®€å•ç›´è§‚</p><h4 id="import"><a class="markdownIt-Anchor" href="#import"></a> @Import</h4><blockquote><p>spring4.2ä¹‹å<code>@Import</code>æ³¨è§£å¯ä»¥å®ä¾‹åŒ–æ™®é€šç±»çš„beanå®ä¾‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Import</span>(Role.class)<span class="comment">// @Import(&#123;Role.class, User.class&#125;)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Role role;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(role);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Springåœ¨åˆ›å»ºMyConfigçš„æ—¶å€™ï¼Œä¼šæ ¹æ®@Importå°†Roleä¹Ÿå®ä¾‹åŒ–æˆä¸€ä¸ªBean</p><h3 id="ç¼–ç¨‹å¼"><a class="markdownIt-Anchor" href="#ç¼–ç¨‹å¼"></a> ç¼–ç¨‹å¼</h3><h4 id="beandefinition"><a class="markdownIt-Anchor" href="#beandefinition"></a> BeanDefinition</h4><blockquote><p>é€šè¿‡åˆ›å»ºå¹¶é…ç½® BeanDefinition æ¥åˆ›å»ºä¸€ä¸ªBean</p><p>Q: ä»€ä¹ˆæ˜¯BeanDefinition?</p><p>A: BeanDefinitionè¡¨ç¤ºBeançš„å®šä¹‰ä¿¡æ¯ï¼Œ Springä¼šæ ¹æ®BeanDefinitionæ¥åˆ›å»ºBeanå¯¹è±¡ã€‚BeanDefinitionæœ‰å¾ˆå¤šçš„å±æ€§ç”¨æ¥æè¿°Beanï¼Œ BeanDefinitionæ˜¯Springä¸­éå¸¸æ ¸å¿ƒçš„æ¦‚å¿µã€‚</p><ul><li>beanClass: è¡¨ç¤ºBeanå¯¹è±¡çš„ç±»ç±»å‹ï¼Œ Springåœ¨åˆ›å»ºBeançš„è¿‡ç¨‹ä¸­æ ¹æ®æ­¤å±æ€§æ¥åˆ¤æ–­å®ä¾‹åŒ–å¯¹è±¡å…·ä½“çš„ç±»ç±»å‹</li><li>scopeï¼šä½œç”¨åŸŸï¼Œ[singletonã€prototype]ï¼Œå•ä¾‹æˆ–è€…åŸå‹bean</li><li>isLazyï¼šæ˜¯å¦éœ€è¦æ‡’åŠ è½½ï¼ŒåŸå‹Beançš„æ‡’åŠ è½½ä¸å¥æ•ˆã€‚æ‡’åŠ è½½çš„å•ä¾‹beanï¼Œä¼šåœ¨ç¬¬ä¸€æ¬¡getBeançš„æ—¶å€™ç”Ÿæˆè¯¥beanï¼Œéæ‡’åŠ è½½çš„å•ä¾‹beanï¼Œåˆ™ä¼šåœ¨Spring.å¯åŠ¨è¿‡ç¨‹ä¸­ç›´æ¥ç”Ÿæˆå¥½ã€‚</li><li>dependsOnï¼šè¡¨ç¤ºä¸€ä¸ªbeanåœ¨åˆ›å»ºä¹‹å‰æ‰€ä¾é¢—çš„å…¶ä»–beanï¼Œåœ¨ä¸€ä¸ªbeanåˆ›å»ºä¹‹å‰ï¼Œå®ƒæ‰€ä¾èµ–çš„è¿™äº›beanå¾—å…ˆå…¨éƒ¨åˆ›å»ºå¥½ã€‚</li><li>primaryï¼šè¡¨ç¤ºä¸€ä¸ªbeanæ˜¯ä¸»beanï¼Œåœ¨Springä¸­ä¸€ä¸ªç±»å‹å¯ä»¥æœ‰å¤šä¸ªbeanå¯¹è±¡ï¼Œåœ¨è¿›è¡Œä¾èµ–æ³¨å…¥æ—¶ï¼Œå¦‚æœæ ¹æ®ç±»å‹æ‰¾åˆ°äº†å¤šä¸ªbÂ©anï¼Œæ­¤æ—¶ä¼šåˆ¤æ–­è¿™äº›beanä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªä¸»beanï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥å°†è¿™ä¸ªbeanæ³¨å…¥ç»™å±æ€§ã€‚</li><li>initMethodNameï¼š è¡¨ç¤ºä¸€ä¸ªbeançš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸€ä¸ªbeançš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ­¥éª¤å«åˆå§‹åŒ–ï¼ŒSpringä¼šåœ¨è¿™ä¸ªæ­¥éª¤ä¸­å»è°ƒç”¨beançš„åˆå§‹åŒ–æ–¹æ³•ã€‚åˆå§‹åŒ–é€»è¾‘ç”±ç¨‹åºå‘˜è‡ªå·±æ§åˆ¶ï¼Œä½¿å¾—ç¨‹åºå‘˜å¯ä»¥è‡ªå®šä¹‰é€»è¾‘å¯¹beanè¿›è¡ŒåŠ å·¥ã€‚</li></ul><p>é€šè¿‡<code>&lt;bean&gt;&lt;/bean&gt;</code>ã€<code>@Bean</code>ã€<code>@Component</code>æ ‡æ³¨çš„ç±»éƒ½ä¼šè§£æä¸ºBeanDefinitionï¼Œä¾›Springåˆ›å»ºï¼ˆå®ä¾‹åŒ–ï¼‰å…·ä½“çš„Beanã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line">    AbstractBeanDefinition bd = BeanDefinitionBuilder.genericBeanDefinition().getBeanDefinition();</span><br><span class="line">    bd.setBeanClass(User.class);</span><br><span class="line">    <span class="comment">// å°†BeanDefinitionæ³¨å†Œåˆ°ä¸Šä¸‹æ–‡ä¸­</span></span><br><span class="line">    ctx.registerBeanDefinition(<span class="string">"user"</span>, bd);</span><br><span class="line">    <span class="comment">// è·å¾—Beanå¯¹è±¡</span></span><br><span class="line">    User user = (User)ctx.getBean(<span class="string">"user"</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="factorybean"><a class="markdownIt-Anchor" href="#factorybean"></a> FactoryBean</h4><blockquote><p>FactoryBeanæ˜¯Spring.æ‰€æä¾›çš„ä¸€ç§è¾ƒçµæ´»çš„åˆ›å»ºBeançš„æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡å®ç°FactoryBeanï¼šæ¥å£ä¸­çš„getObject()æ–¹æ³•æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æœ€ç»ˆçš„Beanå¯¹è±¡ã€‚</p></blockquote><p>FactoryBeanæ¥å£ä¸­çš„æ–¹æ³•</p><ul><li>Object getObject()ï¼šè¿”å›çš„æ˜¯Beanå¯¹è±¡</li><li>boolean isSingleton()ï¼šè¿”å›çš„æ˜¯å¦æ˜¯å•ä¾‹Beanå¯¹è±¡</li><li>Class getObjectType()ï¼šè¿”å›çš„æ˜¯Beanå¯¹è±¡çš„ç±»å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"zhouyu"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZhouyuFactoryBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"cl"</span>, <span class="number">18</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> User.class;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œå®é™…ä¸Šå¯¹åº”äº†ä¸¤ä¸ªBeanå¯¹è±¡ï¼š<br>1ã€beanNameä¸º&quot;zhouyuâ€™ï¼Œbeanå¯¹è±¡ä¸ºgetObjectæ–¹æ³•æ‰€è¿”å›çš„Userå¯¹è±¡ã€‚=&gt;<code>applicationcontext.getBean(nameï¼š&quot;zhouyu&quot;ï¼ŒZhouyuFactory.class);</code><br>2ã€beanNameä¸º&quot;&amp;zhouyuâ€™ï¼Œbeanå¯¹è±¡ä¸ºZhouyuFactoryBeanç±»çš„å®ä¾‹å¯¹è±¡ã€‚=&gt;<code>applicationcontext.getBean(nameï¼š&quot;&amp;zhouyu&quot;ï¼ŒZhouyuFactoryBean.class);</code></p><p>ä¸BeanFactoryçš„åŒºåˆ«ï¼š</p><ul><li>FactoryBeanå¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªBeanï¼ŒåŒæ—¶å®ƒç›¸å½“äºä¸€ä¸ªå°å‹å·¥å‚ï¼Œå¯ä»¥ç”Ÿäº§å‡º<strong>å¦å¤–</strong>çš„Beanã€‚==ã€‹æŒ‡å®šç±»å‹çš„Beanå¯¹è±¡<ul><li>FactoryBeanæœºåˆ¶è¢«å¹¿æ³›çš„åº”ç”¨åœ¨Springå†…éƒ¨å’ŒSpring-ä¸ç¬¬ä¸‰æ–¹æ¡†æ¶æˆ–ç»„ä»¶çš„æ•´åˆè¿‡ç¨‹ä¸­ã€‚</li></ul></li><li>BeanFactoryæ˜¯ä¸€ä¸ªSpringå®¹å™¨ï¼Œæ˜¯ä¸€ä¸ªå¤§å‹å·¥å‚ï¼Œå®ƒå¯ä»¥ç”Ÿäº§å‡º<strong>å„ç§å„æ ·</strong>çš„Beano</li></ul><h4 id="supplier"><a class="markdownIt-Anchor" href="#supplier"></a> Supplier</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext ctx = <span class="keyword">new</span> AnnotationConfigApplicationContext(Config.class);</span><br><span class="line">        ctx.registerBean(User.class, <span class="keyword">new</span> Supplier&lt;User&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> User <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                User userx = <span class="keyword">new</span> User();</span><br><span class="line">                userx.setAge(<span class="number">222</span>);</span><br><span class="line">                userx.setName(<span class="string">"supplier"</span>);</span><br><span class="line">                <span class="keyword">return</span> userx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        User user = (User)ctx.getBean(<span class="string">"user"</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="beanfactory"><a class="markdownIt-Anchor" href="#beanfactory"></a> BeanFactory</h2><p>BeanFactoryæ˜¯ä¸€ç§â€œSpringå®¹å™¨â€ï¼Œ BeanFactoryç¿»è¯‘è¿‡æ¥å°±æ˜¯Beanå·¥å‚ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºBeanã€è·å–Beanã€‚</p><p>æ¦‚å¿µåŒºåˆ†ï¼š</p><ul><li>BeanFactoryå°†åˆ©ç”¨BeanDefinitionï¼šæ¥ç”ŸæˆBeanå¯¹è±¡</li><li>BeanDefinitionç›¸å½“äºBeanFactoryçš„åŸææ–™</li><li>Beanå¯¹è±¡å°±ç›¸å½“äºBeanFactoryï¼‰æ‰€ç”Ÿäº§å‡ºæ¥çš„äº§å“</li></ul><p>BeanFactoryçš„æ ¸å¿ƒå­æ¥å£å’Œå®ç°ç±»ï¼š</p><ul><li>ListableBeanFactory</li><li>ConfigurableBeanFactory</li><li>AutowireCapableBeanFactory</li><li>AbstractBeanFactory</li><li>DefaultListableBeanFactory</li></ul><p>Â·Â·Â·</p><h2 id="beanç”Ÿå‘½å‘¨æœŸ"><a class="markdownIt-Anchor" href="#beanç”Ÿå‘½å‘¨æœŸ"></a> Beanç”Ÿå‘½å‘¨æœŸ</h2><blockquote><p>Beanç”Ÿå‘½å‘¨æœŸæè¿°çš„æ˜¯Springä¸­ä¸€ä¸ªBeanåˆ›å»ºè¿‡ç¨‹å’Œé”€æ¯è¿‡ç¨‹ä¸­æ‰€ç»å†çš„æ­¥éª¤ï¼Œå…¶ä¸­Beanåˆ›å»ºè¿‡ç¨‹æ˜¯é‡ç‚¹ã€‚ç¨‹åºå‘˜å¯ä»¥åˆ©ç”¨Beanç”Ÿå‘½å‘¨æœŸæœºåˆ¶å¯¹Beanè¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</p></blockquote><ul><li>Beanå®šä¹‰ï¼šé€šè¿‡xmlæˆ–è€…ç¼–å†™ç±»çš„å½¢å¼æ¥åˆ›å»ºBeanDefinition</li><li>æ„é€ æ–¹æ³•æ¨æ–­ï¼šä»beançš„å¤šä¸ªæ„é€ æ–¹æ³•ä¸­é€‰å‡ºä¸€ä¸ªæ„é€ æ–¹æ³•</li><li>å®ä¾‹åŒ–ï¼šé€šè¿‡æ„é€ æ–¹æ³•åå°„è·å¾—å¯¹è±¡ï¼Œåœ¨Springä¸­å¯ä»¥é€šè¿‡BeanPostProcessoræœºåˆ¶å¯¹å®ä¾‹åŒ–è¿›è¡Œå¹²é¢„</li><li>å±æ€§å¡«å……(è‡ªåŠ¨æ³¨å…¥ã€ä¾èµ–æ³¨å…¥)ï¼šç»™å±æ€§è¿›è¡Œè‡ªåŠ¨å¡«å……ï¼Œæ¯”å¦‚@Valueï¼Œ@AutoWired</li><li>åˆå§‹åŒ–ï¼šåœ¨ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¡«å……ä¹‹åï¼ŒSpringæä¾›äº†åˆå§‹åŒ–æœºåˆ¶ï¼Œè®©ç¨‹åºå‘˜å¯ä»¥å¯¹å…¶ä»–å±æ€§è¿›è¡Œèµ‹å€¼ã€æ ¡éªŒç­‰è‡ªå®šä¹‰åŠ å·¥(åˆ©ç”¨InitializingBeanæ¥å£)</li><li>åˆå§‹åŒ–åï¼šAopã€ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚å¸¸è¯´çš„Aopæœºåˆ¶å°±æ˜¯åœ¨è¿™ä¸ªæ­¥éª¤ä¸­é€šè¿‡BeanPostProcessoræœºåˆ¶å®ç°çš„ï¼Œè¿™æ­¥ä¹‹åè·å¾—çš„å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„Beanå¯¹è±¡</li></ul><p>åˆ›å»ºè¿‡ç¨‹ï¼š</p><p><img src="/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/E:%5Chexo%5Csource_posts%5C%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring%5Cbean%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B.jpg" alt="beanåˆ›å»ºè¿‡ç¨‹"></p><p>ç”Ÿå‘½å‘¨æœŸå›¾ï¼š</p><p><img src="/2022/02/27/æ·±å…¥å­¦ä¹ ä½¿ç”¨Spring/E:%5Chexo%5Csource_posts%5C%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8Spring%5Cbean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-1.jpg" alt="beanç”Ÿå‘½å‘¨æœŸ-1"></p><h2 id="å±æ€§å¡«å……æ³¨è§£autowired-resource-value"><a class="markdownIt-Anchor" href="#å±æ€§å¡«å……æ³¨è§£autowired-resource-value"></a> å±æ€§å¡«å……æ³¨è§£ï¼š@Autowiredã€@Resourceã€@Value</h2><h3 id="autowired"><a class="markdownIt-Anchor" href="#autowired"></a> @Autowired.</h3><p>è¡¨ç¤ºæŸä¸ªå±æ€§æ˜¯å¦éœ€è¦è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå¯ä»¥å†™åœ¨å±æ€§å’Œæ–¹æ³•ä¸Šã€‚æ³¨è§£ä¸­çš„requiredå±æ€§é»˜è®¤ä¸ºtureï¼Œè¡¨ç¤ºå¦‚æœæ²¡æœ‰å¯¹è±¡å¯ä»¥æ³¨å…¥ç»™å±æ€§åˆ™æŠ›å¼‚å¸¸ã€‚</p><ul><li><p>@Autowiredï¼šåŠ åœ¨æŸä¸ª<strong>å±æ€§</strong>ä¸Šï¼ŒSpringåœ¨è¿›è¡ŒBeançš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­ï¼Œåœ¨<strong>å±æ€§å¡«å……</strong>è¿™ä¸€æ­¥ä¼šåŸºäºå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œå¯¹è¯¥å¯¹è±¡ä¸­åŠ äº†@Autowiredçš„å±æ€§è‡ªåŠ¨ç»™å±æ€§èµ‹å€¼ã€‚å…·ä½“å®ç°ä¸ºï¼š Springä¼šå…ˆæ ¹æ®å±æ€§çš„ç±»å‹å»Springå®¹å™¨ä¸­æ‰¾å‡ºè¯¥ç±»å‹æ‰€æœ‰çš„Beanå¯¹è±¡ï¼Œå¦‚æœæ‰¾å‡ºæ¥å¤šä¸ªï¼Œåˆ™å†æ ¹æ®å±æ€§çš„åå­—ä»å¤šä¸ªä¸­å†ç¡®å®šä¸€ä¸ªã€‚å¦‚æœrequiredå±æ€§ä¸ºtrueï¼Œå¹¶ä¸”æ ¹æ®å±æ€§ä¿¡æ¯æ‰¾ä¸åˆ°å¯¹è±¡ï¼Œåˆ™ç›´æ¥æŠ›å¼‚å¸¸ã€‚</p></li><li><p>å½“@Autowiredæ³¨è§£å†™åœ¨<strong>æŸä¸ªæ–¹æ³•</strong>ä¸Šæ—¶ï¼ŒSpringåœ¨B eanç”Ÿå‘½å‘¨æœŸçš„å±æ€§å¡«å……é˜¶æ®µï¼Œä¼šæ ¹æ®æ–¹æ³•çš„å‚æ•°ç±»å‹ã€å‚æ•°åå­—ä»Springå®¹å™¨æ‰¾åˆ°å¯¹è±¡å½“åšæ–¹æ³•å…¥å‚ï¼Œè‡ªåŠ¨åå°„è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p></li><li><p>@AutowiredåŠ åœ¨<strong>æ„é€ æ–¹æ³•</strong>ä¸Šæ—¶ï¼ŒSpringä¼šåœ¨<strong>æ¨æ–­æ„é€ æ–¹æ³•é˜¶æ®µ</strong>ï¼Œ<u>é€‰æ‹©è¯¥æ„é€ æ–¹æ³•æ¥è¿›è¡Œå®ä¾‹åŒ–</u>ï¼Œåœ¨åå°„è°ƒç”¨æ„é€ æ–¹æ³•ä¹‹å‰ï¼Œä¼šå…ˆæ ¹æ®æ„é€ æ–¹æ³•å‚æ•°ç±»å‹ã€å‚æ•°åä»Springå®¹å™¨ä¸­æ‰¾åˆ°Beanå¯¹è±¡ï¼Œå½“åšæ„é€ æ–¹æ³•å…¥å‚ã€‚</p></li></ul><h3 id="resource"><a class="markdownIt-Anchor" href="#resource"></a> @Resource</h3><p>@Resourceæ³¨è§£ä¸@Autowiredç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨æ¥è¿›è¡Œä¾èµ–æ³¨å…¥çš„ï¼Œ@Resourceæ˜¯<strong>Javaå±‚é¢</strong>æ‰€æä¾›çš„æ³¨è§£ï¼Œ@Autowired.æ˜¯<strong>Spring</strong>æ‰€æä¾›çš„æ³¨è§£ï¼Œå®ƒä»¬ä¾èµ–æ³¨å…¥çš„åº•å±‚å®ç°é€»è¾‘ä¹Ÿä¸åŒã€‚</p><p>@Resourceï¼šæ³¨è§£ä¸­æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œé’ˆå¯¹na meå±æ€§æ˜¯å¦æœ‰å€¼ï¼Œ@Resourceçš„ä¾èµ–æ³¨å…¥åº•å±‚æµç¨‹æ˜¯ä¸åŒçš„ã€‚</p><ul><li>@Reousrceï¼šå¦‚æœnameå±æ€§æœ‰å€¼ï¼Œé‚£ä¹ˆSpringä¼šç›´æ¥æ ¹æ®æ‰€æŒ‡å®šçš„nameå€¼å»Springå®¹å™¨æ‰¾Beanå¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™æˆåŠŸï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æŠ¥é”™ã€‚</li><li>å¦‚æœ@Resourceä¸­çš„nameå±æ€§æ²¡æœ‰å€¼ï¼Œåˆ™ï¼š<ol><li>å…ˆåˆ¤æ–­è¯¥å±æ€§åå­—åœ¨Springå®¹å™¨ä¸­æ˜¯å¦å­˜åœ¨Beanå¯¹è±¡ã€‚</li><li>å¦‚æœå­˜åœ¨ï¼Œåˆ™æˆåŠŸæ‰¾åˆ°Beanå¯¹è±¡è¿›è¡Œæ³¨å…¥ã€‚</li><li>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ ¹æ®å±æ€§ç±»å‹å»Springå®¹å™¨æ‰¾Beanå¯¹è±¡ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ™è¿›è¡Œæ³¨å…¥ã€‚</li></ol></li></ul><h3 id="value"><a class="markdownIt-Anchor" href="#value"></a> @Value</h3><p>@Valueæ³¨è§£å’Œ@Resourceã€@Autowiredç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨æ¥å¯¹å±æ€§è¿›è¡Œä¾èµ–æ³¨å…¥çš„ï¼Œåªä¸è¿‡@Valueæ˜¯ç”¨æ¥ä»<strong>Properties.æ–‡ä»¶ä¸­</strong>æ¥è·å–<strong>å€¼</strong>çš„ï¼Œå¹¶ä¸”@Valueå¯ä»¥è§£æSpELï¼ˆSpringè¡¨è¾¾å¼ï¼‰ã€‚</p><ul><li><p><code>@Value(&quot;yuzhou&quot;)</code>: ç›´æ¥å°†å­—ç¬¦ä¸²â€œzhouyuâ€èµ‹å€¼ç»™å±æ€§ï¼Œå¦‚æœå±æ€§ç±»å‹ä¸æ˜¯Stringï¼Œæˆ–æ— æ³•è¿›è¡Œç±»å‹è½¬åŒ–ï¼Œåˆ™æŠ¥é”™ã€‚</p></li><li><p><code>@Value(${&quot;yuzhou&quot;})</code>ï¼š å°†ä¼šæŠŠ<code>${}</code>ä¸­çš„å­—ç¬¦ä¸²å½“åškeyï¼Œä»Propertiesæ–‡ä»¶ä¸­æ‰¾å‡ºå¯¹åº”çš„valueèµ‹å€¼ç»™å±æ€§ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠŠ<code>${zhouyu}</code>å½“åšæ™®é€šå­—ç¬¦ä¸²æ³¨å…¥ç»™å±æ€§ã€‚</p></li><li><p><code>@Value(#{&quot;yuzhou&quot;})</code>:ä¼šå°†<code>#{}</code>ä¸­çš„å­—ç¬¦ä¸²å½“åšSpringè¡¨è¾¾å¼è¿›è¡Œè§£æï¼ŒSpringä¼šæŠŠ&quot;zhouyu&quot;å½“åšbeanNameï¼Œå¹¶ä»Springå®¹å™¨ä¸­æ‰¾å¯¹åº”beanï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿›è¡Œå±æ€§æ³¨å…¥ï¼Œæ²¡æ‰¾åˆ°åˆ™æŠ¥é”™ã€‚</p></li><li></li></ul><h2 id="applicationcontext"><a class="markdownIt-Anchor" href="#applicationcontext"></a> ApplicationContext</h2><p>ApplicationContextæ˜¯æ¯”BeanFactoryæ›´åŠ å¼ºå¤§çš„Springå®¹å™¨ï¼Œå®ƒæ—¢å¯ä»¥åˆ›å»ºbeanã€è·å–beanï¼Œè¿˜æ”¯æŒå›½é™…åŒ–ã€äº‹ä»¶å¹¿æ’­ã€è·å–èµ„æºç­‰BeanFactor yä¸å…·å¤‡çš„åŠŸèƒ½ã€‚</p><p>Application Contextï¼Œæ‰€ç»§æ‰¿çš„æ¥å£</p><ul><li>EnvironmentCapableï¼šæ‹¥æœ‰è·å–ç¯å¢ƒå˜é‡çš„èƒ½åŠ›ï¼šæ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡å’ŒJvmç¯å¢ƒå˜é‡</li><li>ListableBeanFactoryï¼šæ‹¥æœ‰äº†è·å–æ‰€æœ‰beanNamesã€åˆ¤æ–­æŸä¸ªbean Nameæ˜¯å¦å­˜åœ¨peanDefinitionå¯¹è±¡ã€ç»Ÿè®¡Be anDefinitionä¸ªæ•°ã€è·å–æŸä¸ªç±»å‹å¯¹åº”çš„æ‰€æœ‰beanNamesç­‰åŠŸèƒ½ã€‚</li><li>HierarchicalBeanFactoryï¼šæ‹¥æœ‰äº†è·å–çˆ¶BeanFactoryã€ã€‚åˆ¤æ–­æŸä¸ªnameæ˜¯å¦å­˜åœ¨beanå¯¹è±¡çš„åŠŸèƒ½ã€‚</li><li>MessageSourceï¼šæ‹¥æœ‰äº†å›½é™…åŒ–åŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥åˆ©ç”¨Messa geSourceå¯¹è±¡è·å–æŸä¸ªå›½é™…åŒ–èµ„æºï¼ˆæ¯”å¦‚ä¸åŒå›½å®¶è¯­è¨€æ‰€å¯¹åº”çš„å­—ç¬¦ï¼‰</li><li>ApplicationEventPublisherï¼š æ‹¥æœ‰äº†äº‹ä»¶å‘å¸ƒåŠŸèƒ½ï¼Œå¯ä»¥å‘å¸ƒäº‹ä»¶ï¼Œè¿™æ˜¯Application Contextç›¸å¯¹äºBeanFactoryæ¯”è¾ƒçªå‡ºã€å¸¸ç”¨çš„åŠŸèƒ½ã€‚</li><li>ResourcePatternResolver: æ‹¥æœ‰äº†åŠ è½½å¹¶è·å–èµ„æºçš„åŠŸèƒ½ï¼Œè¿™é‡Œçš„èµ„æºå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œå›¾ç‰‡ç­‰æŸä¸ªURLèµ„æºéƒ½å¯ä»¥ã€‚</li></ul><h3 id="è·å¾—beançš„æ–¹å¼"><a class="markdownIt-Anchor" href="#è·å¾—beançš„æ–¹å¼"></a> è·å¾—beançš„æ–¹å¼ï¼š</h3><blockquote><p><em>getBean() API</em></p></blockquote><ul><li><p>æŒ‰åç§°è·å–Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object lion = context.getBean(<span class="string">"lion"</span>);</span><br><span class="line"> </span><br><span class="line">assertEquals(Lion.class, lion.getClass());</span><br></pre></td></tr></table></figure><p>æ ¹æ®beanåç§°è·å–beanï¼Œå¦‚æœåœ¨spring icoå®¹å™¨ä¸­å­˜åœ¨å’Œbeanï¼Œåˆ™è¿”å›<em>Object</em> ç±»çš„å®ä¾‹ã€‚å¦åˆ™ï¼ŒæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸NoSuchBeanDefinitionExceptionã€‚</p><p>â–²: ä¸»è¦çš„ç¼ºç‚¹æ˜¯ï¼Œåœ¨è·å–beanä¹‹åï¼Œæˆ‘ä»¬<strong>å¿…é¡»å°†å®ƒæŒ‡å®šè½¬æ¢ä¸ºæ‰€éœ€çš„ç±»å‹</strong>ã€‚å¦‚æœè¿”å›çš„beançš„ç±»å‹ä¸æˆ‘ä»¬æœŸæœ›çš„ä¸åŒï¼Œåˆ™å¯èƒ½ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚</p></li><li><p>é€šè¿‡åç§°å’Œç±»å‹è·å–Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Lion lion = context.getBean(<span class="string">"lion"</span>, Lion.class);</span><br><span class="line"><span class="comment">// ä¸æŒ‰åç§°è·å–Beanç›¸æ¯”ï¼Œæ­¤æ–¹æ³•æ›´å®‰å…¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç¼–è¯‘é˜¶æ®µå°±å‘ç°é”™è¯¯è€Œä¸æ˜¯åœ¨è¿è¡Œé˜¶æ®µã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assertThrows(BeanNotOfRequiredTypeException.class, () -&gt; </span><br><span class="line">    context.getBean(<span class="string">"lion"</span>, Tiger.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰ç±»å‹è·å–Bean</p></li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// right</span></span><br><span class="line">Lion lion = context.getBean(Lion.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„: åœ¨ä¸‹é¢çš„æƒ…å†µä¸‹ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„å¯èƒ½å­˜åœ¨çš„æ­§ä¹‰ï¼š</span></span><br><span class="line">assertThrows(NoUniqueBeanDefinitionException.class, () -&gt; </span><br><span class="line">    context.getBean(Animal.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº<em>Lion</em>å’Œ<em>Tigeréƒ½</em>å®ç°äº†<em>Animal</em>æ¥å£ï¼Œå› æ­¤ä»…æŒ‡å®šç±»å‹ä¸è¶³ä»¥æ˜ç¡®ç¡®å®šç»“æœã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª*<code>NoUniqueBeanDefinitionException</code>*ã€‚å³åœ¨<strong>åŒä¸€ä¸ªIOC å®¹å™¨ä¸­ï¼Œå¦‚æœ<u>æœ‰ç›¸åŒç±»å‹çš„å¤šä¸ªbean</u>ï¼Œåˆ™ä¸èƒ½é€šè¿‡ç±»å‹è·å–bean</strong>ã€‚</p><ul><li>æŒ‰åç§°å’Œæ„é€ å‡½æ•°å‚æ•°å¯¹Beanè¿›è¡Œç­›é€‰</li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tiger tiger = (Tiger) context.getBean(<span class="string">"tiger"</span>, <span class="string">"Siberian"</span>);</span><br><span class="line">Tiger secondTiger = (Tiger) context.getBean(<span class="string">"tiger"</span>, <span class="string">"Striped"</span>);</span><br><span class="line"> </span><br><span class="line">assertEquals(<span class="string">"Siberian"</span>, tiger.getName());</span><br><span class="line">assertEquals(<span class="string">"Striped"</span>, secondTiger.getName());</span><br></pre></td></tr></table></figure><ul><li><p>æŒ‰ç±»å‹å’Œæ„é€ å‡½æ•°å‚æ•°å¯¹Beanè¿›è¡Œç­›é€‰</p><blockquote><p>â–²: è¿™ä¸ªæ–¹æ³•æœ‰ç‚¹ä¸åŒï¼Œå› ä¸ºå®ƒ<strong>åªé€‚ç”¨äºå…·æœ‰åŸå‹ä½œç”¨åŸŸ</strong>çš„beanã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tiger tiger = context.getBean(Tiger.class, <span class="string">"Shere Khan"</span>);</span><br><span class="line">assertEquals(<span class="string">"Shere Khan"</span>, tiger.getName());</span><br></pre></td></tr></table></figure></li></ul><h2 id="beanpostprocessoræœºåˆ¶"><a class="markdownIt-Anchor" href="#beanpostprocessoræœºåˆ¶"></a> BeanPostProcessoræœºåˆ¶</h2><p>BeanPostProcessoræ˜¯Springæ‰€æä¾›çš„ä¸€ç§æ‰©å±•æœºåˆ¶ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æœºåˆ¶å¯¹Beanè¿›è¡Œå®šåˆ¶åŒ–åŠ å·¥ï¼Œåœ¨Springåº•å±‚æºç å®ç°ä¸­ï¼Œä¹Ÿå¹¿æ³›çš„ç”¨åˆ°äº†è¯¥æœºåˆ¶ï¼ŒBeanPostProcessoré€šå¸¸ä¹Ÿå«åš<strong>Beanåç½®å¤„ç†å™¨</strong>ã€‚</p><p>BeanPostProcessoråœ¨Springä¸­æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£ï¼Œåœ¨Springä¸­è¿˜å­˜åœ¨ä¸€äº›æ¥å£ç»§æ‰¿äº†BeanPostProcessorï¼Œè¿™äº›å­æ¥å£æ˜¯åœ¨BeanPostProcessorçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›å…¶ä»–çš„åŠŸèƒ½ã€‚</p><p>BeanPostProcessoriä¸­çš„æ–¹æ³•</p><ul><li>postProcessBeforelnitialization()ï¼šåˆå§‹åŒ–å‰æ–¹æ³•ï¼Œè¡¨ç¤ºå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¯¹Beanåœ¨åˆå§‹åŒ–å‰è¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</li><li>postProcessAfterInitialization()ï¼šåˆå§‹åŒ–åæ–¹æ³•ï¼Œè¡¨ç¤ºå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¯¹Beanåœ¨åˆå§‹åŒ–åè¿›è¡Œè‡ªå®šä¹‰åŠ å·¥ã€‚</li></ul><h3 id="instantiationawarebeanpostprocessor"><a class="markdownIt-Anchor" href="#instantiationawarebeanpostprocessor"></a> InstantiationAwareBeanPostProcessor</h3><blockquote><p>BeanPostProcessorçš„ä¸€ä¸ªå­æ¥å£</p></blockquote><ul><li>postProcessBeforelnstantiation()ï¼šå®ä¾‹åŒ–å‰</li><li>postProcessAfterInstantiation()ï¼šå®ä¾‹åŒ–å</li><li>postProcessProperties()ï¼šå±æ€§æ³¨å…¥å</li></ul><h2 id="aopæ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#aopæ˜¯ä»€ä¹ˆ"></a> AOPæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>AOPå°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ˜¯ä¸€ç§éå¸¸é€‚åˆåœ¨<strong>æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç çš„å‰æ</strong>ä¸‹ï¼Œå¯¹<u>æŸä¸ªæˆ–æŸäº›ä¸šåŠ¡å¢åŠ ç»Ÿä¸€çš„åŠŸèƒ½</u>ï¼ˆæ¨ªå‘å¢åŠ åŠŸèƒ½ï¼‰ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€æƒé™æ§åˆ¶ã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œèƒ½å¾ˆå¥½çš„ä½¿å¾—ä»£ç è§£è€¦ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><ul><li></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;From : &lt;a href=&quot;https://www.bilibili.com/video/BV1fr4y1Y7UH?p=6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/vid
      
    
    </summary>
    
    
      <category term="Spring" scheme="https://nymrli.top/tags/Spring/"/>
    
      <category term="Web" scheme="https://nymrli.top/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…</title>
    <link href="https://nymrli.top/2022/02/26/%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D/"/>
    <id>https://nymrli.top/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/</id>
    <published>2022-02-26T07:24:46.000Z</published>
    <updated>2022-03-09T13:33:00.468Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åœ°å›¾åŒ¹é…"><a class="markdownIt-Anchor" href="#åœ°å›¾åŒ¹é…"></a> åœ°å›¾åŒ¹é…</h1><p>æ¦‚å¿µï¼š</p><blockquote><ul><li>åœ°å›¾åŒ¹é…ï¼ˆMap-Matchingï¼‰æ˜¯å°†è¿è¥è½¦è¾†çš„æœ‰åºçš„GPSä½ç½®å…³è”åˆ°ç”µå­åœ°å›¾çš„è·¯ç½‘ä¸Šï¼Œå°†GPSåæ ‡ä¸‹é‡‡æ ·åºåˆ—è½¬æ¢ä¸ºæ•°å­—è·¯ç½‘åæ ‡åºåˆ—çš„è¿‡ç¨‹ï¼›æœ¬è´¨ä¸Šæ˜¯å¹³é¢çº¿æ®µåºåˆ—çš„æ¨¡å¼åŒ¹é…é—®é¢˜ï¼ˆ Altç­‰ï¼Œ2003ï¼‰</li><li>åœ°å›¾åŒ¹é…æ˜¯ä¸€ç§å°†åŸå§‹GPSä½ç½®æ˜ å°„åˆ°è·¯ç½‘ä¸Šçš„è·¯æ®µçš„è¿‡ç¨‹ï¼Œä»¥åˆ›å»ºå¯¹è½¦è¾†æ‰€èµ°è·¯çº¿çš„ä¼°ç®—ã€‚</li></ul></blockquote><p>ä¸¤ä¸ªä¸»è¦çš„åœ°å›¾åŒ¹é…ç”¨ä¾‹</p><ul><li>ä¹˜è½¦ç»“æŸæ—¶ï¼Œè®¡ç®—é©¾é©¶å‘˜è¡Œè¿›çš„è·ç¦»ï¼Œä»¥è®¡ç®—ç¥¨ä»·ã€‚â€”â€”è·¯çº¿å›¾åŒ¹é…(EORMM)</li><li><strong>å®æ—¶</strong> ï¼Œä¸ºETAå›¢é˜Ÿæä¾›å‡†ç¡®çš„ä½ç½®å¹¶åšå‡º<strong>è°ƒåº¦</strong>å†³ç­–ï¼Œå¹¶åœ¨rideråº”ç”¨ç¨‹åºä¸Š<strong>æ˜¾ç¤º</strong>é©¾é©¶å‘˜çš„æ±½è½¦ã€‚â€”â€”å®æ—¶åœ°å›¾åŒ¹é…(RTMM)</li></ul><p>ä¸åŒç‚¹åœ¨äºï¼Œ<em>å®æ—¶åœ°å›¾åŒ¹é…</em>çš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¿…é¡»ä½å»¶æ—¶ï¼Œå› æ­¤ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<em>è·¯çº¿å›¾åŒ¹é…</em>å¯¹ç­‰å¾…æ—¶é—´çš„è¦æ±‚ä¸é‚£ä¹ˆä¸¥æ ¼ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¹˜è½¦çš„å…¨éƒ¨å†å²è®°å½•</p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒï¼š</h3><ul><li><p><a href="https://zhuanlan.zhihu.com/p/83039334" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/83039334</a></p></li><li><p><a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">Lyftçš„åœ°å›¾åŒ¹é…ç®—æ³•è®ºæ–‡ç¿»è¯‘</a></p><ul><li><p>åœ°å›¾åŒ¹é…ç®—æ³•çš„æ€§èƒ½å–å†³äº<strong>é“è·¯ç½‘ç»œæ•°æ®</strong>çš„<strong>è´¨é‡</strong></p></li><li><p>è§£å†³é—®é¢˜çš„ä¸€ç§å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨<strong>çŠ¶æ€ç©ºé—´æ¨¡å‹</strong> ã€‚ çŠ¶æ€ç©ºé—´æ¨¡å‹æ˜¯æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œå…¶ä¸­ç³»ç»Ÿå…·æœ‰â€œéšè—â€çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ— æ³•ç›´æ¥è§‚å¯Ÿåˆ°ï¼Œä½†ä¼šå¼•èµ·å¯è§çš„è§‚å¯Ÿã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„éšè—çŠ¶æ€æ˜¯æˆ‘ä»¬è¦ä¼°ç®—çš„æ±½è½¦åœ¨é“è·¯ç½‘ç»œä¸Šçš„å®é™…ä½ç½®ã€‚ æˆ‘ä»¬ä»…è§‚å¯Ÿåˆ°éšè—çŠ¶æ€çš„ä¿®æ”¹ç‰ˆæœ¬ï¼šè§‚å¯Ÿå€¼(åŸå§‹ä½ç½®æ•°æ®)ã€‚ æˆ‘ä»¬å‡è®¾ç³»ç»Ÿçš„çŠ¶æ€ä»¥ä»…å–å†³äºå½“å‰çŠ¶æ€çš„æ–¹å¼æ¼”åŒ–(é©¬å°”å¯å¤«å‡è®¾)ï¼Œå¹¶è¿›ä¸€æ­¥å®šä¹‰äº†ä»éšè—çŠ¶æ€åˆ°éšè—çŠ¶æ€çš„è½¬ç§»å¯†åº¦å’Œä»éšè—çŠ¶æ€åˆ°è§‚å¯Ÿçš„å¯†åº¦ã€‚</p><p>å¸¸ç”¨çš„åœ°å›¾åŒ¹é…çŠ¶æ€ç©ºé—´æ¨¡å‹æ˜¯ç¦»æ•£çŠ¶æ€<strong>éšé©¬å°”å¯å¤«æ¨¡å‹</strong> (Newsonï¼†Krumm [2]ï¼ŒDiDiçš„IJCAI-19æ•™ç¨‹[3]ï¼ŒUberçš„Map Matching [4])ã€‚ åœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹è·¯æ®µä¸Šçš„æœ€è¿‘ç‚¹æ¥ç”Ÿæˆå€™é€‰å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">ç»´ç‰¹æ¯”ç®—æ³•</a>æŸ¥æ‰¾æœ€å¯èƒ½çš„éšè—çŠ¶æ€åºåˆ—ã€‚</p><ul><li>å¯¹äºä¸åŒçš„å»ºæ¨¡é€‰æ‹©å’Œè¾“å…¥æ•°æ®è€Œè¨€ï¼Œå®ƒç›¸å¯¹ä¸çµæ´»</li><li>å®ƒç¼©æ”¾ä¸¥é‡(O(NÂ²)ï¼Œå…¶ä¸­Næ˜¯æ¯ä¸ªçŠ¶æ€ä¸‹å¯èƒ½çš„å€™é€‰æ•°)</li><li>å®ƒä¸èƒ½å¾ˆå¥½åœ°åº”å¯¹é«˜é¢‘è§‚æµ‹(è¯·å‚é˜…Newsonï¼†Krumm [2])ã€‚</li></ul></li></ul></li><li><p><a href="http://qikan.cqvip.com/Qikan/Article/Detail?id=1000359922&amp;from=Qikan_Search_Index" target="_blank" rel="noopener">GPSå®šä½ä¸åœ°å›¾åŒ¹é…æ–¹æ³•ç ”ç©¶</a></p><ul><li>åœ°å›¾åŒ¹é…ç®—æ³•ä»åŸç†ä¸Šå¯ä»¥è§£é‡Šä¸ºä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼šï¼ˆ1ï¼‰æ‰¾åˆ°è½¦è¾†å½“å‰è¡Œä½¿çš„é“è·¯â€”â€”ç¡®å®šå€™é€‰è·¯æ®µï¼ˆ2ï¼‰å°†å½“å‰GPSå®šä½ç‚¹æŠ•å½±åˆ°è½¦è¾†è¡Œä½¿çš„é“è·¯ä¸Šâ€”â€”å€™é€‰è·¯æ®µåŒ¹é…è§„åˆ™<ul><li>åœ†å¿ƒæ‹“å±•åŠå¾„æ‰¾åˆ°æœ€è¿‘çš„è·¯æ®µï¼ˆå”¯ä¸€ï¼‰â€”â€”æ„å»ºç¬¬ä¸€æ¡è¾¹çš„ç®—æ³•</li></ul></li></ul></li><li><p>[1]è‹æ´, å‘¨ä¸œæ–¹, å²³æ˜¥ç”Ÿ. GPSè½¦è¾†å¯¼èˆªä¸­çš„å®æ—¶åœ°å›¾åŒ¹é…ç®—æ³•[J]. æµ‹ç»˜å­¦æŠ¥, 2001, 30(3):5.</p><ul><li>å¦å¤–ï¼Œä¸ºäº†æé«˜ç®—æ³•çš„é²æ£’æ€§ï¼Œå¯¹äºè¯¯å·®å¼•èµ· çš„é€Ÿåº¦å¼‚å¸¸ï¼Œæˆ‘ä»¬åˆ©ç”¨æ¨æµ‹èˆªä½æ³•å’Œçº¿æ€§æ’å€¼æ¥ è¿›è¡Œ GPSæ•°æ®è¡¥å¿ï¼Œä»¥æ¶ˆé™¤éƒ¨åˆ†GPSæ¥æ”¶å¤–éƒ¨ ç²—å·®</li></ul></li><li><p>[1]ææ¸…æ³‰, é»„ç»ƒ. åŸºäºGPSè½¨è¿¹æ•°æ®çš„åœ°å›¾åŒ¹é…ç®—æ³•[J]. æµ‹ç»˜å­¦æŠ¥, 2010(2):6.</p><ul><li>é’ˆå¯¹ä¼ ç»Ÿå¯¼èˆªç³»ç»Ÿçš„åœ°å›¾åŒ¹é…æ–¹æ³•çš„ç ”ç©¶è¾ƒå¤šã€‚å…¶ä¸­ç‚¹åˆ°çº¿çš„åŒ¹é…ç”±äºç¼ºä¹å¯¹æ•´ä½“è½¨è¿¹è¶‹åŠ¿çš„è€ƒè™‘ï¼Œåœ¨å¤æ‚çš„é“è·¯ç½‘ç¯å¢ƒä¸‹çš„åŒ¹é…æ˜“å¯¼è‡´è¯¯åŒ¹é…ã€‚ä¹Ÿæœ‰æ–¹æ³•ä½¿ç”¨DRã€å·®åˆ†GPSç­‰è¾…åŠ©è®¾å¤‡ï¼Œé‡‡ç”¨æ»¤æ³¢ã€æ¨¡ç³Šé€»è¾‘ã€è¯æ®ç†è®ºç­‰æ–¹æ³•æé«˜åœ°å›¾åŒ¹é…çš„å‡†ç¡®ç‡ã€‚GPSæµ®åŠ¨è½¦è½¨è¿¹æ•°æ®æä¾›äº†æ•´ä½“æ›²çº¿çš„å˜åŒ–è¶‹åŠ¿ï¼Œå¯ä»¥é‡‡ç”¨å…¨å±€æ•´ä½“åŒ¹é…çš„æ€æƒ³ï¼Œä¿è¯è½¨è¿¹çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§14ï¼Ÿã€‚åŸºäºæ›²çº¿ç›¸ä¼¼åº¦çš„ç®—æ³•ä¸€èˆ¬ è¾ƒä¸ºå¤æ‚ï¼Œä½†åŒ¹é…ç²¾åº¦é«˜ï¼Œåˆ©äºè½¨è¿¹çš„ç›´æ¥æ¢å¤ï¼Œé€‚åˆè¿›è¡Œæ•°æ®çš„åå¤„ç†</li><li>ä¸æ•´ä¸ªè½¨è¿¹ç›¸å¯¹ åº”çš„è·¯å¾„å¿…ç„¶æ˜¯è¿é€š çš„è·¯æ®µé›† ï¼Œå¯ä»¥åŸºäºé“è·¯æ‹“æ‰‘ä¸è¿é€šæ€§è®¾è®¡åœ°å›¾åŒ¹é…ç®—æ³•</li><li>keyï¼šé™¤äº†é“è·¯çš„å‡ ä½•è¿é€šæ€§ï¼Œå®é™…è¡Œè½¦è¿˜ä¼šå—åˆ°äº¤é€šè§„åˆ™çš„é™åˆ¶ï¼Œæœ¬æ–‡åŸºäºé“è·¯ç½‘çš„è¡Œè½¦é™åˆ¶ä¿¡æ¯æå‡ºäº†ä¸€ç§GPSæµ®åŠ¨è½¦è½¨è¿¹æ•°æ®çš„å…¨å±€åœ°å›¾åŒ¹é…ç®—æ³•ï¼Œç»¼åˆè€ƒè™‘å¤‡é€‰è·¯æ®µçš„å‡ ä½•è¿é€šæ€§ä¸äº¤é€šç½‘ç»œæ¡ä»¶çº¦æŸæ„å»ºæ•´ä½“å¤‡é€‰è·¯å¾„ï¼Œç„¶åä½¿ç”¨<strong>æ”¹è¿›çš„æ‰«æçº¿æ³•</strong>åˆ¤æ–­å…¨å±€è½¨è¿¹æ›²çº¿ä¸å¤‡é€‰è·¯å¾„çš„ç›¸ä¼¼åº¦ï¼Œå®Œæˆåœ°å›¾åŒ¹é… ã€‚<ul><li>ä¸€å¥è¯æ¦‚æ‹¬ç®—æ³•ï¼šé€šè¿‡è¡Œè½¦é™åˆ¶å°†å€™é€‰çº¿æ®µæ‰¾å‡ºæ¥åï¼Œé€‰æ‹©æ›²çº¿ç›¸ä¼¼åº¦æœ€é«˜çš„</li></ul></li></ul></li><li><p>[1]é™ˆæ»¨, ç‹å¹³, æ–½æ–‡ç¶,ç­‰. GPSè½¨è¿¹æ•°æ®çš„ç»¼åˆåœ°å›¾åŒ¹é…ç®—æ³•ç ”ç©¶[J]. ç”µå­ç§‘æŠ€, 2014, 27(12):4.</p><ul><li>ä»å®é™…çš„åŒ¹é…æ•ˆæœæ¥çœ‹ï¼Œæ­¤åŒ¹é…ç®—æ³•åœ¨äº¤å‰è·¯å£ç­‰è·¯æ®µè¾ƒå¤æ‚çš„åœ°æ–¹å¯æœ‰è¾ƒé«˜åœ°åŒ¹é…å‡†ç¡®ç‡ï¼Œä½†è¯¥æ–¹æ³•ä¾èµ–äºå‰åGPSå®šä½ç‚¹åŒ¹é…å‡†ç¡®åº¦ï¼Œè‹¥å‰ä¸€å®šä½ç‚¹åŒ¹é…é”™è¯¯å°±ä¼šå‡ºç°è¿é”ååº”ï¼Œä»è€Œå¯¼è‡´åé¢ä¸€ç³»åˆ—ç‚¹åŒ¹é…é”™è¯¯ï¼›ä¸”å†å²è½¨è¿¹æ¨ç®—åŒ¹é…æ³•è®¡ç®—é‡è¾ƒå¤§ï¼ŒåŒ¹é…é€Ÿåº¦è¾ƒæ…¢ï¼Œä¸åˆ©äºé«˜é€Ÿå®æ—¶å®šä½ã€‚å› æ­¤ï¼Œéœ€å’Œå…¶ä»–åœ°å›¾åŒ¹é…æ–¹æ³•ç›¸ç»“åˆä½¿ç”¨æ‰èƒ½å–å¾—è¾ƒå¥½çš„åŒ¹é…æ•ˆæœã€‚</li></ul></li><li><p>æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­GPSåœ°å›¾åŒ¹é…ç®—æ³•è®¾è®¡ä¸å®ç°_ç½—æ°æ¶›</p><ul><li>æ¨¡ç³Šé€»è¾‘ï¼š æ•ˆç‡é«˜ï¼Œå®æ—¶æ€§å¥½ï¼Œå¯¹ç»å¤§å¤šæ•°çš„è·¯æ®µçŠ¶å†µéƒ½é€‚ç”¨ã€‚ä¸è¿‡åœ¨è½¦ä¿©æ‹å¼¯å¤„ä»¥åŠè½¦é€Ÿè¾ƒæ…¢çš„æƒ…å†µä¸‹åŒ¹é…æ•ˆæœä¸å°½å¦‚äººæ„ï¼Œä¸”ä¸åŒè·¯æ®µå»ºæ¨¡çš„ç³»æ•°å‡­é ç»éªŒå€¼ï¼Œæ²¡æœ‰ç›¸åº”çš„ç¼ºä¹ç†è®ºä¾æ®ã€‚â€”â€”01ã€06ã€08è®ºæ–‡</li></ul></li><li><p>é«˜çº§åœ°å›¾åŒ¹é…ç®—æ³•ï¼šç ”ç©¶ç°çŠ¶å’Œè¶‹åŠ¿[2021]</p><ul><li><p>ä»å®ç°æŠ€æœ¯æˆ–æ¨¡å‹è§’åº¦å¯¹è¿‘åå¹´æå‡ºçš„ç®—æ³•è¿›è¡Œåˆ†ç±»ï¼Œç®­å¤´æ ‡è®°ç®—æ³•é—´çš„ç»§æ‰¿å…³ç³»ã€‚ä»å›¾2å¯è§ï¼ŒHMMæ¨¡å‹æ˜¯ä¸»æµï¼Œå…¶æ¬¡æ˜¯åŸºäºæœ€å¤§æƒé‡çš„æ¨¡å‹.HMM-News-onã€ST-Matching2 3IVMM3å’ŒHRIS8è¢«å¼•ç”¨å¯¹æ¯”æœ€å¤šï¼Œæ˜¯å…·æœ‰å¼€åˆ›æ€§çš„å·¥ä½œã€‚å¦å¤–ï¼Œä»2019å¹´å¼€å§‹ï¼Œæœ‰ç ”ç©¶é‡‡ç”¨æ·±åº¦å­¦ä¹ æŠ€æœ¯æ¥è§£å†³åœ°å›¾åŒ¹é…é—®é¢˜ã€‚</p><p><img src="/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/E:%5Chexo%5Csource_posts%5C%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%5C09-20%E5%B9%B4%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B.jpg" alt="09-20å¹´åœ°å›¾åŒ¹é…ç®—æ³•å‘å±•å†ç¨‹"></p></li></ul></li></ul><h3 id="points"><a class="markdownIt-Anchor" href="#points"></a> Points:</h3><ul><li><p>å¦å¤–ï¼Œä¸€ä¸ªé‡è¦çš„å®é™…é—®é¢˜æ˜¯ï¼Œå³ä½¿è½¦è¾†å®šä½ç²¾åº¦å¯ä»¥ä¿è¯åœ¨10ç±³ä»¥å†…ï¼Œå½“ç”µå­åœ°å›¾ç¼©æ”¾åˆ°è¾ƒå¤§çš„æ¯”ä¾‹å°ºæ—¶ï¼Œä¹Ÿä¼š<br>å‡ºç°è½¦è¾†åç¦»è¡Œä½¿çš„é“è·¯è€Œé€ æˆçš„è§†è§‰æ··ä¹±ç°è±¡.</p></li><li><p>ç”±äºåŸåŒºå†…åœ°ç‰©ç‰¹å¾å¤æ‚ï¼Œå—å¯†é›†çš„é«˜å¤§å»ºç­‘ç‰©ã€éš§é“ã€ç«‹äº¤æ¡¥ã€æ ‘æœ¨ç­‰åœ°ç‰©çš„åå°„å’Œé®è”½ç­‰å½±å“ï¼Œè½¦æ ½GPSæ¥æ”¶æœºæ¥æ”¶åˆ°çš„å«æ˜Ÿä¿¡å·å­˜åœ¨ä¸¥é‡çš„å¤šå¾„æ•ˆåº”ï¼Œåœ¨æŸäº›åŒºåŸŸå†…ç”šè‡³ä¼šå½¢æˆGPSå®šä½è‚²åŒºï¼Œè§£å†³GPSç›²åŒºé—®é¢˜ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡ç”¨èˆªä½æ¨ç®—æ³•ï¼ˆDR-Dead Reckoningï¼‰ï¼Œè¿™ç§æ–¹æ³•éœ€è¦å°†DRè®¾å¤‡è£…åœ¨è½¦è¾†å‰ç«¯ï¼Œä¸€èˆ¬åœ¨GPSæ¥æ”¶æœºå«æ˜Ÿä¿¡å·å—é˜»æ—¶ä¸€æ ·å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç”¨æˆ·ä½ç½®ï¼Œä½†è¿™ç§æ–¹æ³•éœ€è¦é™„åŠ è®¾å¤‡ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨è®°å¿†æ­£ç¡®GPSä½ç½®ä¿¡æ¯çš„åŸºç¡€ä¸Šåœ¨ä¸€æ®µæ—¶é—´å†…é¢„æµ‹è½¦è¾†ä½ç½®ï¼Œè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æ˜“äºå®ç°ï¼Œç¼ºç‚¹æ˜¯ç²¾åº¦ä¸å¤Ÿï¼ˆæ²¡æœ‰ï¼Œä½œè€…ä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢è¿›è¡Œä½ç½®é¢„æµ‹ï¼Œé¢„æµ‹ç»“æœå¦‚å›¾æ‰€ç¤ºã€‚åœ¨è§„åˆ™è¡Œè¿›æ—¶ï¼Œé¢„æµ‹æ•ˆæœè¾ƒå¥½ï¼Œè§å›¾3ã€å›¾4.ä½†æ˜¯å½“è½¦è¾†è½¬å¼¯æ—¶ï¼Œæ•ˆæœå¾ˆå·®ï¼Œè§å›¾5ã€å›¾6</p></li><li><p>åˆ°æŠ˜çº¿çš„è·ç¦»å®šä¹‰ä¸ºç‚¹åˆ°æŠ˜çº¿ä¸Šæ‰€æœ‰ç›´çº¿æ®µçš„æœ€çŸ­è·ç¦»ï¼šç‚¹åˆ°çº¿æ®µçš„è·ç¦»å®šä¹‰ä¸ºå¦‚æœç‚¹åˆ°ç›´çº¿æ®µæ‰€åœ¨ç›´çº¿çš„æŠ•å½±åœ¨ç›´çº¿æ®µä¸Šï¼Œåˆ™ä¸ºå‚çº¿é•¿åº¦ï¼Œå¦åˆ™ä¸ºå…¶åˆ°ä¸¤ä¸ªç«¯ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚</p></li><li><p>å®šä½è¯¯å·®ï¼š GPSè¯¯å·®ã€ç”µå­åœ°å›¾åº“è¯¯å·®ã€åæ ‡æŠ•å½±å˜æ¢æŠ•å½±</p></li><li><p>éš¾ç‚¹ï¼š</p><ul><li><a href="http://qikan.cqvip.com/Qikan/Article/ReadIndex?id=33650279&amp;info=X19Wa%2bQedw8TOqUh1eM7U0SrEn1nIM08tSny4w0YhPo%3d" target="_blank" rel="noopener">Y-junctioné—®é¢˜</a>â€”â€”ç‚¹åˆ°çº¿çš„åŒ¹é…æ–¹å¼ï¼Œæ²¡æœ‰è€ƒè™‘å…¨å±€åŒ¹é…</li><li>å¹³è¡ŒåŒçº¿è·¯</li></ul></li><li><p>MapMatchingå®ç°çš„æ€è·¯</p><ul><li><strong>ç¦»æ•£ç‚¹é›†åŒ¹é…</strong>ï¼šç›¸å¯¹ç®€å•ï¼Œéšæœºç¦»æ•£ç‚¹æ²¡æœ‰å½¢çŠ¶å’Œæ‹“æ‰‘å…³ç³»ï¼Œç”¨æ¬§æ°è·ç¦»ä½œå¸é™„å³å¯ï¼Œå…¸å‹åº”ç”¨å¦‚ç¦»æ•£çƒ­åŠ›å›¾ã€‚</li><li><strong>æ›²çº¿æ‹Ÿåˆ</strong>ï¼š å®é™…ä¸­æ›´æœ‰åº”ç”¨ä»·å€¼çš„æ˜¯æ›²çº¿æ‹ŸåˆåŒ¹é…å…³ç³»ï¼Œæ¯”å¦‚è½¨è¿¹å’Œè·¯ç½‘ï¼ŒGPSåºåˆ—å’Œå¯¼èˆªè·¯çš„ç›¸ä¼¼æ€§ã€‚</li></ul></li><li><p>MapMatchingç®—æ³•çš„åˆ†ç±»ï¼š</p><p><strong>ä»¥ä½¿ç”¨åˆ°çš„ä¿¡æ¯æ¥åˆ’åˆ†</strong></p><p>ç°æœ‰çš„ç®—æ³•å¯è¢«åˆ†æˆå››ç±»ï¼šå‡ ä½•ã€æ‹“æ‰‘ã€æ¦‚ç‡ã€é«˜çº§ã€‚</p><p>aï¼‰åŸºäºå‡ ä½•çš„ç®—æ³•è€ƒè™‘GPSç‚¹ä¸é“è·¯çš„å‡ ä½•ä¿¡æ¯ï¼Œå¦‚è·ç¦»ã€è§’åº¦ç­‰ï¼›</p><p>bï¼‰åŸºäºæ‹“æ‰‘çš„ç®—æ³•ä½¿ç”¨é“è·¯æ‹“æ‰‘ä¿¡æ¯æ¥æ§åˆ¶ï¼›</p><p>cï¼‰æ¦‚ç‡æ–¹æ³•é€šè¿‡è€ƒè™‘GPSç‚¹çš„æ¦‚ç‡ï¼›</p><p>dï¼‰é«˜çº§çš„ç®—æ³•å¾€å¾€ç»¼åˆè€ƒè™‘ä½¿ç”¨å…¨é¢ä¿¡æ¯ï¼Œæœ‰å¡å°”æ›¼æ»¤æ³¢ã€æ¨¡ç³Šé€»è¾‘æ¨¡å‹ã€éšå¼é©¬å°”å¯å¤«æ¨¡å‹ç­‰ç­‰ã€‚</p><p><strong>2.2 ä»¥è€ƒè™‘é‡‡æ ·ç‚¹çš„èŒƒå›´æ¥åˆ’åˆ†</strong></p><p>æ ¹æ®è€ƒè™‘é‡‡æ ·ç‚¹çš„èŒƒå›´ï¼Œå¯åˆ†æˆå±€éƒ¨/å¢é‡ç®—æ³•ã€å…¨å±€ç®—æ³•ã€‚</p><p>aï¼‰å±€éƒ¨/å¢é‡ç®—æ³•æ˜¯è´ªå©ªç®—æ³•ï¼Œæ¯æ¬¡ç¡®å®šä¸€ä¸ªåŒ¹é…ç‚¹ï¼Œä¸‹ä¸ªç‚¹ä»å·²ç»ç¡®å®šçš„åŒ¹é…ç‚¹å¼€å§‹ã€‚è¿™äº›æ–¹æ³•æ ¹æ®è·ç¦»å’Œæ–¹å‘ç›¸ä¼¼æ€§æ¥æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜ç‚¹æˆ–è¾¹ã€‚ï¼ˆåœ¨çº¿åŒ¹é…ï¼‰</p><p>bï¼‰å…¨å±€ç®—æ³•æ˜¯è¦ä»è·¯ç½‘ä¸­æ‰¾åˆ°ä¸€æ¡ä¸é‡‡æ ·è½¨è¿¹æœ€æ¥è¿‘çš„åŒ¹é…è½¨è¿¹ã€‚ä¸ºäº†æµ‹é‡é‡‡æ ·è½¨è¿¹å’ŒåŒ¹é…è½¨è¿¹çš„ç›¸ä¼¼æ€§ï¼Œå¤§å¤šæ•°ç®—æ³•ä½¿ç”¨â€œFrechetè·ç¦»â€æˆ–è€…æ˜¯â€œå¼±Frechetè·ç¦»â€ã€‚è¿˜æœ‰æ—¶ç©ºåŒ¹é…ç®—æ³•ã€æŠ•ç¥¨ç®—æ³•ç­‰ã€‚ï¼ˆç¦»çº¿åŒ¹é…ï¼‰</p><p><strong>ä»¥é‡‡æ ·ç‚¹çš„é¢‘ç‡æ¥åˆ’åˆ†</strong></p><p>æ ¹æ®è½¨è¿¹æ•°æ®çš„é‡‡æ ·é¢‘ç‡ï¼Œç°æœ‰çš„åœ°å›¾åŒ¹é…ç®—æ³•å¯åˆ†æˆï¼š</p><p>aï¼‰é«˜é¢‘é‡‡æ ·ç®—æ³•ï¼ˆæ‰€æœ‰å±€éƒ¨ç®—æ³•ã€éƒ¨åˆ†å…¨å±€ç®—æ³•å¦‚Frechetè·ç¦»åˆ¤åˆ«æ³•ç­‰ï¼‰</p><p>bï¼‰ä½é¢‘é‡‡æ ·ç®—æ³•ï¼ˆST-matchingç®—æ³•ã€IVVMç®—æ³•ï¼‰</p><p>ä¸€èˆ¬è®¤ä¸º30såŠå…¶ä»¥ä¸Šä¸ºä½é¢‘é‡‡æ ·ï¼Œ1sï½10sä¸ºé«˜é¢‘é‡‡æ ·ã€‚</p><p><a href="https://www.cnblogs.com/LBSer/p/4612031.html#!comments" target="_blank" rel="noopener">https://www.cnblogs.com/LBSer/p/4612031.html#!comments</a></p></li><li><p>æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­GPSåœ°å›¾åŒ¹é…ç®—æ³•è®¾è®¡ä¸å®ç°</p><p><img src="/2022/02/26/ç ”ç©¶ç”Ÿworkâ€”â€”åœ°å›¾åŒ¹é…/E:%5Chexo%5Csource_posts%5C%E7%A0%94%E7%A9%B6%E7%94%9Fwork%E2%80%94%E2%80%94%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%5C%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%E7%BB%84%E4%BB%B6.jpg" alt="åœ°å›¾åŒ¹é…ç»„ä»¶"></p></li></ul><h3 id="ç®—æ³•è¯„ä¼°çš„æ ‡å‡†"><a class="markdownIt-Anchor" href="#ç®—æ³•è¯„ä¼°çš„æ ‡å‡†"></a> ç®—æ³•è¯„ä¼°çš„æ ‡å‡†</h3><ul><li>å®æ—¶æ€§</li><li>å¯é æ€§(é²æ£’æ€§)</li><li>åŒ¹é…çš„ç²¾åº¦</li></ul><h2 id="æœ´ç´ ç®—æ³•"><a class="markdownIt-Anchor" href="#æœ´ç´ ç®—æ³•"></a> æœ´ç´ ç®—æ³•ï¼š</h2><p>å¿«é€ŸåŒ¹é…ç®—æ³•çš„æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ­¥1æ¥æ”¶GPSå®šä½æ•°æ®ï¼›</li><li>æ­¥2åˆ¤æ–­å®šä½æ•°æ®æ˜¯å¦æ— æ•ˆï¼Œè‹¥æ— æ•ˆï¼Œåˆ™æ ¹æ®å†å²å®šä½æ•°æ®è¿›è¡Œæ¨æµ‹åŒ¹é…ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›</li><li>æ­¥3åˆ¤æ–­è½¦è¾†å½“å‰æ˜¯å¦å¤„äºåœæ­¢æˆ–ä½é€Ÿæ»‘è¡ŒçŠ¶æ€ï¼Œè‹¥æ˜¯ï¼Œå¯¹å…¶ä½œç›¸åº”å¤„ç†ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›</li><li>æ­¥4ç”±è½¦è¾†å½“å‰ä½ç½®ç‚¹è®¡ç®—å…¶å¯¹åº”çš„å€™é€‰ç½‘æ ¼ï¼Œè¿›è€Œè·å–å…¶ä¸­çš„è·¯æ®µï¼›</li><li>æ­¥5å¯¹æ­¥4å¾—åˆ°çš„è·¯æ®µè¿›è¡Œ<strong>è¿æ¥æ€§æ‹“æ‰‘æ£€æŸ¥</strong>ï¼Œå°†é€šè¿‡æ‹“æ‰‘æ£€æŸ¥çš„è·¯æ®µä½œä¸ºåŒ¹é…å€™é€‰è·¯æ®µï¼›</li><li>æ­¥6åˆ¤æ–­åŒ¹é…å€™é€‰è·¯æ®µæ•°ç›®ï¼Œè‹¥å”¯ä¸€ï¼Œåˆ™ç›´æ¥å°†å…¶ä½œä¸ºåŒ¹é…è·¯æ®µï¼Œå¹¶ç”±å®šä½ç‚¹å‘å…¶ä½œæŠ•å½±ï¼Œç„¶åè½¬ï¼ˆ8ï¼‰ï¼›å¦åˆ™ï¼Œè®¡ç®—æ‰€æœ‰å€™é€‰è·¯æ®µçš„åŒ¹é…åº¦åº¦é‡å€¼fï¼Œï¼ˆi=1,2ï¼Œâ€¦ï¼ŒNï¼‰ï¼Œä»ä¸­é€‰å‡ºæœ€å¤§å€¼fmå’Œæ¬¡å¤§å€¼fmï¼›</li><li>æ­¥7åˆ¤æ–­æœ€å¤§å€¼fmå’Œæ¬¡å¤§å€¼fmä¹‹å·®æ˜¯å¦å¤§äºé˜ˆå€¼fhï¼Œä¸”æœ€å¤§å€¼fmæ˜¯å¦å¤§äºé˜ˆå€¼fhï¼Œå¦‚æœå¤§äºï¼Œåˆ™å°†è·¯æ®µmä½œä¸ºåŒ¹é…è·¯æ®µï¼Œå¹¶ç”±å®šä½ç‚¹å‘å…¶ä½œæŠ•å½±ï¼›å¦åˆ™ï¼Œæš‚ä¸å¯¹æœ¬æ¬¡å®šä½ç»“æœè¿›è¡ŒåŒ¹é…ï¼Œå¾…åé¢å¯¹å…¶è¿›è¡Œå»¶æ—¶åŒ¹é…å¤„ç†ï¼›</li><li>æ­¥8ç»“æŸæœ¬æ¬¡åŒ¹é…</li></ol><p>from : <a href="https://wenku.baidu.com/view/14551bfcfab069dc50220144.html?fr=xueshu_top" target="_blank" rel="noopener">ä¸€ç§é€‚äºè½¦è¾†å¯¼èˆªç³»ç»Ÿçš„å¿«é€Ÿåœ°å›¾åŒ¹é…ç®—æ³•</a>â€”â€”2003</p><h2 id="key"><a class="markdownIt-Anchor" href="#key"></a> Key:</h2><ul><li><p>å‡ºè¡Œæ•°æ®ï¼šé‡‡ç”¨GPSå®šä½ï¼Œé‚£ä¹ˆæ˜¯å¦æ˜¯WGS-84æ•°æ®ï¼Œä½†æ˜¯GISéƒ¨é—¨çš„è·¯ç½‘æ•°æ®åæ ‡æ˜¯ä»€ä¹ˆåæ ‡ç³»ä¸‹çš„</p></li><li><p>åŒçº¿è·¯ï¼š</p></li><li><p>å½“ä¸‹ï¼Œç°åœ¨å¾ˆå¤šç”¨äºMapMatchingçš„æ–¹æ³•ï¼Œå¤§å¤šæ¥è‡ªäºæ¨ç†ã€é¢„æµ‹çš„æ•°å­¦æ–¹æ³•ï¼Œå¦‚éšé©¬å°”å¯å¤«é“¾ã€è´å¶æ–¯æ¨¡å‹ã€ç¥ç»ç½‘ç»œæ¨¡å‹ç­‰ï¼Œä½†åœ¨æ•°æ®ç»“æ„ä¸Šçš„åˆ›æ–°æ¯”è¾ƒå°‘ï¼ŒGISç®—æ³•ï¼Œæ›´å¤šè¦åœ¨è®¡ç®—æœºçš„åŸºç¡€ä¸Šï¼Œç»“åˆæ¯”å¦‚æ—¶ç©ºè§‚å¿µã€æ•°æ®ç‰¹å¾ã€æ‹“æ‰‘å…³ç³»ç­‰å¯¹äºGISç›¸å…³çš„åŸºç¡€ç†è®º</p></li></ul><h2 id="è½¯ä»¶"><a class="markdownIt-Anchor" href="#è½¯ä»¶"></a> è½¯ä»¶</h2><ul><li>mapinfo: å½“ä»Šä¸–ç•Œä¸Šæµè¡Œçš„æ¡Œé¢åœ°ç†ä¿¡æ¯ç³»ç»Ÿ</li><li>graphhopper: è·¯å¾„è§„åˆ’åº“</li><li>arcgis</li><li>openstreetmapâ€”â€”å¼€æºåœ°å›¾ï¼Œç®€ç§°ä¸ºOSM</li></ul><p>çº¿è¦ç´ çš„åŒ¹é…ï¼Œä¸»è¦é€šè¿‡å‡ ä½•ã€æ‹“æ‰‘æˆ–è¯­ä¹‰ç›¸ä¼¼åº¦æ¥è¿›è¡Œè¯†åˆ«ï¼Œå…¶ä¸­é€šè¿‡ç©ºé—´è·ç¦»æ¥è¿›è¡Œè¦ç´ åŒ¹é…çš„å¸¸ç”¨æ–¹å¼æœ‰ï¼š</p><ul><li>é—µå¯å¤«æ–¯åŸºè·ç¦»(Minkowski Distance)</li><li>æ¬§æ°è·ç¦»(Euclidean Distance)</li><li>æ›¼å“ˆé¡¿è·ç¦»(Manhattan Distance)</li><li>åˆ‡æ¯”é›ªå¤«è·ç¦»(Chebyshev Distance)</li><li>æ±‰æ˜è·ç¦»(Hamming distance)</li><li>æ°å¡å¾·ç›¸ä¼¼ç³»æ•°(Jaccard similarity coefficient)</li><li>è±ªæ–¯å¤šå¤«è·ç¦»(Hausdorff Distance)</li><li>å¼—é›·æ­‡è·ç¦»(FrÃ©chetè·ç¦»)</li></ul><p>fromï¼š<a href="http://www.biaozhu.net/9224.html" target="_blank" rel="noopener">é«˜å¾·åœ°å›¾ï¼šåœ°å›¾æ•°æ®å¤„ç†ä¹‹é“è·¯åŒ¹é…ç¯‡</a></p><h1 id="éšé©¬å°”ç§‘å¤«hmm"><a class="markdownIt-Anchor" href="#éšé©¬å°”ç§‘å¤«hmm"></a> éšé©¬å°”ç§‘å¤«HMM</h1><p><strong>HMMæœ‰ä¸‰ä¸ªå…¸å‹(canonical)é—®é¢˜</strong>:</p><ul><li><strong>æ¦‚ç‡è®¡ç®—é—®é¢˜</strong>ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°ï¼Œè®¡ç®—æŸä¸€ç‰¹å®šè¾“å‡ºåºåˆ—çš„æ¦‚ç‡.é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Forward_algorithm" target="_blank" rel="noopener">Forward</a>ç®—æ³•**è§£å†³ï¼›</li><li><strong>é¢„æµ‹é—®é¢˜æˆ–è€…è§£ç ï¼ˆdecodingï¼‰é—®é¢˜</strong>ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°ï¼Œå¯»æ‰¾æœ€å¯èƒ½çš„èƒ½äº§ç”ŸæŸä¸€ç‰¹å®šè¾“å‡ºåºåˆ—çš„<strong>éšå«çŠ¶æ€</strong>çš„åºåˆ—ã€‚é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•**è§£å†³ï¼›</li><li><strong>å­¦ä¹ é—®é¢˜</strong>ï¼šå·²çŸ¥è¾“å‡ºåºåˆ—ï¼Œå¯»æ‰¾æœ€å¯èƒ½çš„çŠ¶æ€è½¬ç§»ä»¥åŠè¾“å‡ºæ¦‚ç‡ã€‚é€šå¸¸ä½¿ç”¨**<a href="http://en.wikipedia.org/wiki/Baum-Welch_algorithm" target="_blank" rel="noopener">Baum-Welch</a>ç®—æ³•**ã€‚</li></ul><h2 id="hmmçš„å‡ ä¸ªé‡è¦å…ƒç´ "><a class="markdownIt-Anchor" href="#hmmçš„å‡ ä¸ªé‡è¦å…ƒç´ "></a> HMMçš„å‡ ä¸ªé‡è¦å…ƒç´ ï¼š</h2><ul><li><p>Ï€(startprob_): éšè—çŠ¶æ€åˆå§‹å‘é‡</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>Ï€</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>:</mo><msub><mi>Ï€</mi><mi>i</mi></msub><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>q</mi><mn>1</mn></msub><mo>=</mo><mi>i</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>i</mi><mo>â‰¤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\pi=\left(\pi_{i}\right): \pi_{i}=P\left(q_{1}=i\right), 1 \leq i \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p></li><li><p>A(transmat_):  çŠ¶æ€è½¬ç§»æ¦‚ç‡çŸ©é˜µ:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">]</mo></mrow><mrow><mi>N</mi><mo>Ã—</mo><mi>N</mi></mrow></msub><mtext>,Â å…¶ä¸­Â </mtext><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>j</mi><mo>âˆ£</mo><msub><mi>q</mi><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>â‰¤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">A=\left[a_{i j}\right]_{N \times N} \text {, å…¶ä¸­ } a_{i j}=P\left(q_{t+1}=j \mid q_{t}=i\right), 1 \leq i, j \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.144139em;vertical-align:-0.394139em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.14252299999999996em;"><span style="top:-2.364192em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394139em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">,Â </span><span class="mord cjk_fallback">å…¶ä¸­</span><span class="mord">Â </span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p></li><li><p>B(emissionprob_): è§‚æµ‹çŠ¶æ€æ¦‚ç‡çŸ©é˜µ</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mrow><mi>N</mi><mo>Ã—</mo><mi>M</mi></mrow></msub><mi mathvariant="normal">ï¼Œ</mi><mtext>Â å…¶ä¸­Â </mtext><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><msub><mi>o</mi><mi>k</mi></msub><mo>âˆ£</mo><msub><mi>q</mi><mi>t</mi></msub><mo>=</mo><mi>j</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>j</mi><mo>â‰¤</mo><mi>N</mi><mo separator="true">,</mo><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B=\left[b_{j}(k)\right]_{N \times M} ï¼Œ \text { å…¶ä¸­ } b_{j}(k)=P\left(o_{t}=o_{k} \mid q_{t}=j\right), 1 \leq j \leq N, 1 \leq k \leq M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.144139em;vertical-align:-0.394139em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.14252299999999996em;"><span style="top:-2.364192em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394139em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord text"><span class="mord">Â </span><span class="mord cjk_fallback">å…¶ä¸­</span><span class="mord">Â </span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></span></p></li><li><p>HMMçš„çŠ¶æ€å˜é‡æ•°ç›®ï¼šN</p></li><li><p>HMMçš„è§‚å¯Ÿå˜é‡æ•°ç›®ï¼šM</p></li></ul><p>å¦‚æœè§‚æµ‹åºåˆ—æ˜¯ä¸€ç»´çš„ï¼Œåˆ™è§‚æµ‹çŠ¶æ€çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯ä¸€ç»´çš„æ™®é€šé«˜æ–¯åˆ†å¸ƒã€‚å¦‚æœè§‚æµ‹åºåˆ—æ˜¯Nç»´çš„ï¼Œåˆ™éšè—çŠ¶æ€å¯¹åº”çš„è§‚æµ‹çŠ¶æ€çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯Nç»´é«˜æ–¯åˆ†å¸ƒã€‚é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å‚æ•°å¯ä»¥ç”¨Î¼Î¼è¡¨ç¤ºé«˜æ–¯åˆ†å¸ƒçš„æœŸæœ›å‘é‡ï¼ŒÎ£è¡¨ç¤ºé«˜æ–¯åˆ†å¸ƒçš„åæ–¹å·®çŸ©é˜µã€‚åœ¨GaussianHMMç±»ä¸­ï¼Œâ€œmeansâ€ç”¨æ¥è¡¨ç¤ºå„ä¸ªéšè—çŠ¶æ€å¯¹åº”çš„é«˜æ–¯åˆ†å¸ƒæœŸæœ›å‘é‡Î¼å½¢æˆçš„çŸ©é˜µï¼Œè€Œâ€œcovarsâ€ç”¨æ¥è¡¨ç¤ºå„ä¸ªéšè—çŠ¶æ€å¯¹åº”çš„é«˜æ–¯åˆ†å¸ƒåæ–¹å·®çŸ©é˜µÎ£å½¢æˆçš„ä¸‰ç»´å¼ é‡ã€‚</p><p>from :<a href="https://www.cnblogs.com/pinard/p/7001397.html" target="_blank" rel="noopener">ç”¨hmmlearnå­¦ä¹ éšé©¬å°”ç§‘å¤«æ¨¡å‹HMM</a></p><h2 id="mapmatchingä¸hmm"><a class="markdownIt-Anchor" href="#mapmatchingä¸hmm"></a> MapMatchingä¸Hmm</h2><ul><li>è§‚å¯Ÿå˜é‡ï¼šä»GPSè®¾å¤‡ä¸­å¾—åˆ°çš„ä½ç½®ä¿¡æ¯ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼‰</li><li>éšè—çŠ¶æ€ï¼šæ‹¥æœ‰GPSè®¾å¤‡çš„ç‰©ä½“ï¼ˆè½¦ï¼Œäººç­‰ï¼‰å®é™…æ‰€åœ¨çš„ä½ç½®è·¯æ®µã€‚</li><li>è§‚æµ‹æ¦‚ç‡ï¼šä¾‹å¦‚ï¼Œç°æµ‹çš„GPSç‚¹ç¦»æ—è¾¹è·¯æ®µä¸Šçš„ä½ç½®è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸå®ç‚¹åœ¨è¿™ä¸ªè·¯æ®µä¸Šçš„æ¦‚ç‡è¶Šå¤§çŠ¶æ€ã€‚</li><li>çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼šä¾‹å¦‚ï¼Œå‰åä¸¤ä¸ªçœŸå®çš„ä½ç½®ç‚¹çš„è·ç¦»è¶Šè¿‘ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»çš„æ¦‚ç‡è¶Šå¤§</li></ul><p>åœ¨ä¸‹é¢ç›¸å…³è®ºæ–‡å·¥ä½œä¸­ä¼šè¯´æ˜åœ¨è¿™å‡ ç¯‡è®ºæ–‡ä¸­å…¶å®åªç”¨åˆ°äº†é¢„æµ‹é—®é¢˜çš„<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•,ä¸‹é¢ä¹Ÿä¼šå¦å¼€ä¸€å°èŠ‚å…·ä½“æè¿°ä¸‹<a href="http://en.wikipedia.org/wiki/Viterbi_algorithm" target="_blank" rel="noopener">Viterbi</a>ç®—æ³•ã€‚</p><p><strong>Map-Matchingçš„ä¸¤ä¸ªå˜é‡</strong>ï¼š</p><ul><li>ä»GPSè®¾å¤‡ä¸­å¾—åˆ°çš„ä½ç½®ä¿¡æ¯ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼‰ï¼šHMMä¸­è§‚å¯Ÿå˜é‡ï¼›</li><li>æ‹¥æœ‰GPSè®¾å¤‡çš„ç‰©ä½“ï¼ˆè½¦ï¼Œäººç­‰ï¼‰å®é™…æ‰€åœ¨çš„ä½ç½®ï¼šHMMä¸­çš„éšè—çŠ¶æ€å˜é‡ï¼Œå®é™…åœ°å›¾æ˜¯ä¸çŸ¥é“GPSè®¾å¤‡çš„å‡†ç¡®ä½ç½®çš„ã€‚</li></ul><p>è¿™æ ·å°±æŠŠMap-Matchingé—®é¢˜ä¸HMMç»“åˆèµ·æ¥äº†ã€‚ä¸‰ä¸ªé—®é¢˜åœ¨Map-Matchingä¸­æœ‰ç”¨çš„æ˜¯ä¸¤ä¸ªé—®é¢˜ï¼šï¼ˆ1ï¼‰é¢„æµ‹é—®é¢˜ï¼›ï¼ˆ2ï¼‰å­¦ä¹ é—®é¢˜ã€‚</p><p>åœ¨è®ºæ–‡ä¸­ï¼Œå®šä¹‰çš„è§„åˆ™è¦æ»¡è¶³äººçš„ç›´è§‚ä¸Šçš„æ„Ÿè§‰ï¼Œå³äººçš„å…ˆéªŒçŸ¥è¯†ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li>è§‚æµ‹æ¦‚ç‡ï¼šè§‚æµ‹çš„GPSç‚¹ç¦»æ—è¾¹è·¯æ®µä¸Šçš„ä½ç½®è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªçœŸå®ç‚¹åœ¨è¿™ä¸ªè·¯æ®µä¸Šçš„æ¦‚ç‡è¶Šå¤§ã€‚</li><li>çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼šè¿™é‡Œæœ‰ä¸¤ç§è§£å†³æ€è·¯ï¼šï¼ˆ1ï¼‰å‰åä¸¤ä¸ªçœŸå®çš„ä½ç½®ç‚¹çš„è·ç¦»è¶Šè¿‘ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»çš„æ¦‚ç‡è¶Šå¤§ï¼›æˆ–è€…ï¼ˆ2ï¼‰çœŸå®è·¯æ®µä¸Šçš„å‰åä¸¤ä¸ªç‚¹çš„è·ç¦»ä¸GPSè§‚æµ‹çš„å‰åä¸¤ä¸ªç‚¹çš„è·ç¦»è¶Šæ¥è¿‘ï¼ŒçŠ¶æ€è½¬ç§»æ¦‚ç‡è¶Šå¤§ã€‚</li></ul><p>from: <a href="https://www.cnblogs.com/mindpuzzle/p/3653043.html" target="_blank" rel="noopener">åŸºäºéšé©¬å°”ç§‘å¤«æ¨¡å‹(HMM)çš„åœ°å›¾åŒ¹é…(Map-Matching)ç®—æ³•</a></p><h3 id="barefoot"><a class="markdownIt-Anchor" href="#barefoot"></a> <a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">barefoot</a></h3><ul><li>è§‚æµ‹æ¦‚ç‡: æµ‹é‡ä½ç½®ä¸å…¶çœŸå®ä½ç½®ä¹‹é—´çš„è·ç¦»ï¼Œç”¨äºå¯¹æµ‹é‡è¯¯å·®è¿›è¡Œå»ºæ¨¡ï¼Œæµ‹é‡è¯¯å·®ç”¨å…·æœ‰ä¸€äº›æ ‡å‡†åå·®<em>Ïƒ</em>çš„é«˜æ–¯åˆ†å¸ƒæ¥æè¿°ï¼ˆé»˜è®¤ä¸º<em>Ïƒ = 5 ç±³</em>ï¼‰ã€‚</li><li>è½¬ç§»æ¦‚ç‡: ç”¨å„ä¸ªä½ç½®æµ‹é‡ä¹‹é—´çš„è·¯ç”±è·ç¦»å’Œè§†çº¿è·ç¦»çš„å·®å¼‚æ¥é‡åŒ–çš„ã€‚è½¬ç§»æ¦‚ç‡å‘ˆè´ŸæŒ‡æ•°åˆ†å¸ƒï¼Œé€Ÿç‡å‚æ•°<em>Î»</em>ï¼ˆé»˜è®¤ä¸º<em>Î» = 0.1</em>ï¼‰æ˜¯å‡å€¼çš„å€’æ•°</li></ul><p>==&gt;</p><ul><li><p><em><strong>åºåˆ—æ¦‚ç‡</strong></em>ï¼š å®šä¹‰<em>p(s 0 â€¦ s t |z 0 â€¦ z t )<em>ä¸ºæœ€å¯èƒ½çš„åºåˆ—åˆ°è¾¾åŒ¹é…å€™é€‰</em>s t</em>çš„æ¦‚ç‡ï¼Œç§°ä¸º s t çš„åºåˆ—æ¦‚ç‡ï¼Œ å¯ä»¥é€šè¿‡é€’å½’ç¡®å®š</p></li><li><p><em><strong>è¿‡æ»¤æ¦‚ç‡</strong></em>ï¼šæˆ‘ä»¬çš„ HMM æ»¤æ³¢å™¨ç¡®å®šå¯¹è±¡å½“å‰ä½ç½®çš„ä¼°è®¡å€¼<em>sÌ… t</em>ï¼Œå®ƒæ˜¯æœ€å¯èƒ½åŒ¹é…çš„å€™é€‰å¯¹è±¡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>âˆˆ</mo><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t âˆˆ S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç»™å®šæµ‹é‡å€¼<code>z0 ... zt</code>ï¼Œå…¶å®šä¹‰ä¸ºï¼š<code>sÌ…t = argmax(st âˆˆ St) p(st|z0 ... zt)</code>, <code>p(st|z0 ... zt)</code>ç§°ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„è¿‡æ»¤æ¦‚ç‡***ï¼Œå¯ä»¥é€’å½’ç¡®å®šï¼š</p><p><code>p(st|z0...zt) = p(st|zt) Â· Î£(st-1 âˆˆ St-1) p(st|st-1) Â· p(st-1|z0 ... zt-1)</code>ã€‚</p></li></ul><p>from: <a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers</a></p><h2 id="coding"><a class="markdownIt-Anchor" href="#coding"></a> Coding</h2><blockquote><p>åœ¨ä¹‹å‰çš„<a href="http://www.cnblogs.com/pinard/p/6945257.html" target="_blank" rel="noopener">HMMç³»åˆ—</a>ä¸­ï¼Œæˆ‘ä»¬å¯¹éšé©¬å°”ç§‘å¤«æ¨¡å‹HMMçš„åŸç†ä»¥åŠä¸‰ä¸ªé—®é¢˜çš„æ±‚è§£æ–¹æ³•åšäº†æ€»ç»“ã€‚æœ¬æ–‡æˆ‘ä»¬å°±ä»å®è·µçš„è§’åº¦ç”¨Pythonçš„<a href="https://hmmlearn.readthedocs.io/en/latest/api.html#hmmlearn-hmm" target="_blank" rel="noopener">hmmlearn</a>åº“æ¥å­¦ä¹ HMMçš„ä½¿ç”¨ã€‚sklearnåº“ä¸­å°†HMMå¼ƒç”¨äº†ï¼Œæ–°å¼€äº†ä¸€ä¸ª<code>hmmlearn</code>çš„æ–°åº“ï¼Œå®‰è£…å‘½ä»¤ä¸ºï¼š<code>pip install hmmlearn</code>ï¼Œå…³äºhmmlearnçš„æ›´å¤šèµ„æ–™åœ¨<a href="http://hmmlearn.readthedocs.io/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>æœ‰ä»‹ç»ã€‚</p></blockquote><p>hmmlearnå®ç°äº†ä¸‰ç§HMMæ¨¡å‹ç±»ï¼ŒæŒ‰ç…§è§‚æµ‹çŠ¶æ€æ˜¯è¿ç»­çŠ¶æ€è¿˜æ˜¯ç¦»æ•£çŠ¶æ€ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ã€‚</p><ol><li>GaussianHMM è§‚æµ‹çŠ¶æ€è¿ç»­å‹ä¸”ç¬¦åˆé«˜æ–¯åˆ†å¸ƒ</li><li>GMMHMM è§‚æµ‹çŠ¶æ€è¿ç»­å‹ä¸”ç¬¦åˆæ··åˆé«˜æ–¯åˆ†å¸ƒ</li><li>MultinomialHMM è§‚æµ‹çŠ¶æ€ç¦»æ•£å‹</li></ol><p><strong>HMMä¸»è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜</strong><br>å‡è®¾éšè—çŠ¶æ€åºåˆ—å’Œè§‚æµ‹çŠ¶æ€åºåˆ—åˆ†åˆ«ä½¿ç”¨Zå’ŒXè¡¨ç¤ºï¼Œåˆ™è§£å†³çš„3ä¸ªé—®é¢˜å¯è¡¨ç¤ºä¸º:<br>1.è§£ç é—®é¢˜ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡æœ€å¯èƒ½çš„Zï¼›ç»´ç‰¹æ¯”ç®—æ³•<br>2.æ¦‚ç‡é—®é¢˜ï¼šå·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡Xå‡ºç°çš„æ¦‚ç‡ï¼›å‘å‰-å‘åç®—æ³•<br>3.å­¦ä¹ é—®é¢˜ï¼šä»…ç»™å‡ºXå’Œéšè—å±‚ä¸ªæ•°ï¼Œä¼°è®¡æ¨¡å‹å‚æ•°ã€‚ B-Wç®—æ³•ï¼Œé€šå¸¸æ˜¯ç»è¿‡ä¸€å®šæ•°é‡çš„è®­ç»ƒä»¥åï¼Œå¾—åˆ°æ¨¡å‹ï¼Œç„¶åè§£å†³é—®é¢˜1å’Œ2ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Created on 2017-12-4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è§£ç é—®é¢˜ï¼šæœ¬ä¾‹ä¸ºå¤©æ°”å’Œè¡Œä¸ºçš„å…³ç³»</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># hmmlearnå¯ä»¥åœ¨å®‰è£…numpyä»¥åï¼Œå†ä½¿ç”¨pip install hmmlearnå®‰è£…</span></span><br><span class="line"><span class="keyword">from</span> hmmlearn <span class="keyword">import</span> hmm</span><br><span class="line"></span><br><span class="line">states = [<span class="string">"Rainy"</span>, <span class="string">"Sunny"</span>]<span class="comment">##éšè—çŠ¶æ€</span></span><br><span class="line">n_states = len(states)<span class="comment">##éšè—çŠ¶æ€é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">observations = [<span class="string">"walk"</span>, <span class="string">"shop"</span>, <span class="string">"clean"</span>]<span class="comment">##å¯è§‚å¯Ÿçš„çŠ¶æ€</span></span><br><span class="line">n_observations = len(observations)<span class="comment">##å¯è§‚å¯Ÿåºåˆ—çš„é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">start_probability = np.array([<span class="number">0.6</span>, <span class="number">0.4</span>])<span class="comment">##å¼€å§‹è½¬ç§»æ¦‚ç‡ï¼Œå³å¼€å§‹æ˜¯Rainyå’ŒSunnyçš„æ¦‚ç‡</span></span><br><span class="line"><span class="comment">##éšè—é—´å¤©æ°”è½¬ç§»æ··æ·†çŸ©é˜µï¼Œå³Rainyå’ŒSunnyä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼Œä¾‹å¦‚[0,0]è¡¨ç¤ºä»Šå¤©Rainyï¼Œæ˜å¤©Rainyçš„æ¦‚ç‡</span></span><br><span class="line">transition_probability = np.array([</span><br><span class="line">  [<span class="number">0.7</span>, <span class="number">0.3</span>],</span><br><span class="line">  [<span class="number">0.4</span>, <span class="number">0.6</span>]</span><br><span class="line">])</span><br><span class="line"><span class="comment">##éšè—çŠ¶æ€å¤©æ°”å’Œå¯è§†è¡Œä¸ºæ··æ·†çŸ©é˜µï¼Œä¾‹å¦‚[0,0]è¡¨ç¤ºä»Šå¤©Rainyï¼Œwalkè¡Œä¸ºçš„æ¦‚ç‡ä¸º0.1</span></span><br><span class="line">emission_probability = np.array([</span><br><span class="line">  [<span class="number">0.1</span>, <span class="number">0.4</span>, <span class="number">0.5</span>],</span><br><span class="line">  [<span class="number">0.6</span>, <span class="number">0.3</span>, <span class="number">0.1</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ„å»ºäº†ä¸€ä¸ªMultinomialHMMæ¨¡å‹ï¼Œè¿™æ¨¡å‹åŒ…æ‹¬å¼€å§‹çš„è½¬ç§»æ¦‚ç‡ï¼Œéšè—é—´å¤©æ°”è½¬æ¢æ··æ·†çŸ©é˜µï¼ˆtransmatï¼‰ï¼Œéšè—çŠ¶æ€å¤©æ°”å’Œå¯è§†è¡Œä¸ºæ··æ·†çŸ©é˜µemissionprobï¼Œå¯¹æ¨¡å‹å‚æ•°åˆå§‹åŒ–</span></span><br><span class="line">model = hmm.MultinomialHMM(n_components=n_states)</span><br><span class="line">model.startprob_= start_probability</span><br><span class="line">model.transmat_ = transition_probability</span><br><span class="line">model.emissionprob_ = emission_probability</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç»™å‡ºä¸€ä¸ªå¯è§åºåˆ—</span></span><br><span class="line">bob_Actions = np.array([[<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]]).T</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³é—®é¢˜1,è§£ç é—®é¢˜,å·²çŸ¥æ¨¡å‹å‚æ•°å’ŒXï¼Œä¼°è®¡æœ€å¯èƒ½çš„Zï¼› ç»´ç‰¹æ¯”ç®—æ³• </span></span><br><span class="line">logprob, weathers = model.decode(bob_Actions, algorithm=<span class="string">"viterbi"</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Bob Actions:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: observations[x], bob_Actions))</span><br><span class="line"><span class="keyword">print</span> <span class="string">"weathers:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: states[x], weathers))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è§£ç é—®é¢˜ï¼š ç›’å­</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> hmmlearn <span class="keyword">import</span> hmm</span><br><span class="line"></span><br><span class="line">states = [<span class="string">"box 1"</span>, <span class="string">"box 2"</span>, <span class="string">"box3"</span>]</span><br><span class="line">n_states = len(states)</span><br><span class="line"></span><br><span class="line">observations = [<span class="string">"red"</span>, <span class="string">"white"</span>]</span><br><span class="line">n_observations = len(observations)</span><br><span class="line"></span><br><span class="line">start_probability = np.array([<span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.4</span>])</span><br><span class="line"></span><br><span class="line">transition_probability = np.array([</span><br><span class="line">  [<span class="number">0.5</span>, <span class="number">0.2</span>, <span class="number">0.3</span>],</span><br><span class="line">  [<span class="number">0.3</span>, <span class="number">0.5</span>, <span class="number">0.2</span>],</span><br><span class="line">  [<span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.5</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">emission_probability = np.array([</span><br><span class="line">  [<span class="number">0.5</span>, <span class="number">0.5</span>],</span><br><span class="line">  [<span class="number">0.4</span>, <span class="number">0.6</span>],</span><br><span class="line">  [<span class="number">0.7</span>, <span class="number">0.3</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model = hmm.MultinomialHMM(n_components=n_states)</span><br><span class="line">model.startprob_=start_probability</span><br><span class="line">model.transmat_=transition_probability</span><br><span class="line">model.emissionprob_=emission_probability</span><br><span class="line"></span><br><span class="line">seen = np.array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>]]).T</span><br><span class="line">logprob, box = model.decode(seen, algorithm=<span class="string">"viterbi"</span>)</span><br><span class="line">print(<span class="string">"The ball picked:"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: observations[x], seen)))</span><br><span class="line">print(<span class="string">"The hidden box"</span>, <span class="string">", "</span>.join(map(<span class="keyword">lambda</span> x: states[x], box)))</span><br><span class="line">(<span class="string">'The ball picked:'</span>, <span class="string">'red, white, red'</span>)</span><br><span class="line">(<span class="string">'The hidden box'</span>, <span class="string">'box3, box3, box3'</span>)</span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶"><a class="markdownIt-Anchor" href="#é™åˆ¶"></a> é™åˆ¶</h2><ul><li>å¯¹äºä¸åŒçš„å»ºæ¨¡é€‰æ‹©å’Œè¾“å…¥æ•°æ®è€Œè¨€ï¼Œå®ƒç›¸å¯¹ä¸çµæ´»</li><li>å®ƒç¼©æ”¾ä¸¥é‡(O(NÂ²)ï¼Œå…¶ä¸­Næ˜¯æ¯ä¸ªçŠ¶æ€ä¸‹å¯èƒ½çš„å€™é€‰æ•°)</li><li>å®ƒä¸èƒ½å¾ˆå¥½åœ°åº”å¯¹é«˜é¢‘è§‚æµ‹(è¯·å‚é˜…Newsonï¼†Krumm [2])ã€‚</li></ul><p>åŸºäº(æ— å‘³)å¡å°”æ›¼æ»¤æ³¢å™¨çš„æ–°æ¨¡å‹â€”â€”<a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">https://blog.csdn.net/weixin_26713521/article/details/108134220</a></p><h1 id="help-code"><a class="markdownIt-Anchor" href="#help-code"></a> help Code:</h1><ul><li><a href="https://github.com/bmwcarit/barefoot" target="_blank" rel="noopener">https://github.com/bmwcarit/barefoot</a></li><li><a href="https://github.com/oldrev/mapmatchingkit" target="_blank" rel="noopener">https://github.com/oldrev/mapmatchingkit</a></li></ul><h1 id="ç½‘ç»œæ–‡ç« "><a class="markdownIt-Anchor" href="#ç½‘ç»œæ–‡ç« "></a> ç½‘ç»œæ–‡ç« </h1><ul><li><a href="https://blog.csdn.net/weixin_42599077/article/details/114801735" target="_blank" rel="noopener">åœ°å›¾åŒ¹é…å®ä¾‹-å‡ ä½•åŒ¹é…</a>â€”â€”æ•ˆæœå›¾</li><li><a href="https://blog.csdn.net/weixin_26713521/article/details/108134220" target="_blank" rel="noopener">å®šä½åŒ¹é… æ¨¡æ¿åŒ¹é… åœ°å›¾_ä»€ä¹ˆæ˜¯åœ°å›¾åŒ¹é…ï¼Ÿ</a></li><li><a href="https://blog.csdn.net/Feng512275/article/details/96199675?spm=1001.2014.3001.5502" target="_blank" rel="noopener">å‡ºç§Ÿè½¦è½¨è¿¹ç‚¹åœ°å›¾åŒ¹é…ç ”ç©¶</a></li><li><a href="https://blog.csdn.net/yixianfeng41/article/details/73010792" target="_blank" rel="noopener">åœ°å›¾åŒ¹é…å°ç»“</a></li><li><a href="https://www.cnblogs.com/mindpuzzle/p/3653043.html" target="_blank" rel="noopener">åŸºäºéšé©¬å°”ç§‘å¤«æ¨¡å‹(HMM)çš„åœ°å›¾åŒ¹é…(Map-Matching)ç®—æ³•</a></li></ul><h1 id="å·¥ä½œå®‰æ’"><a class="markdownIt-Anchor" href="#å·¥ä½œå®‰æ’"></a> å·¥ä½œå®‰æ’</h1><p>ä½ çš„å·¥ä½œä¸»è¦å®Œæˆä»€ä¹ˆï¼ˆæ¦‚æ‹¬è¯´æ˜å°±è¡Œï¼‰ï¼Œåˆ†ä¸ºé‚£å‡ æ­¥ï¼Œæ¯ä¸€æ­¥å®Œæˆä»€ä¹ˆï¼ˆæ¦‚æ‹¬è¯´æ˜å°±è¡Œï¼‰ï¼Œæ¯ä¸€æ­¥çš„å·¥ä½œé‡ï¼ˆé¢„è®¡å®Œæˆè¿™æ­¥å·¥ä½œéœ€è¦å¤šå°‘ä¸ªå°æ—¶ï¼‰ï¼Œæ¯ä¸€æ­¥å·¥ä½œé¢„è®¡åœ¨ä»€ä¹ˆæ—¶å€™å®Œæˆï¼ˆæ¯”å¦‚ 3.5ï¼‰</p><ul><li>å·¥ä½œåŒ…å«ï¼šåœ°å›¾åŒ¹é…ï¼Œå°†è½¦è¾†çš„æœ‰åºGPSä½ç½®æ•°æ®å…³è”åˆ°ç”µå­åœ°å›¾çš„è·¯ç½‘ä¸Šï¼Œå°†GPSåæ ‡ä¸‹é‡‡æ ·åºåˆ—è½¬æ¢ä¸ºæ•°å­—è·¯ç½‘è·¯å¾„åºåˆ—çš„è¿‡ç¨‹ã€‚å·¥ä½œå†…å®¹ï¼šè§£æè¿‡æ»¤ç‚¹å¹¶è¿›è¡Œåæ ‡è½¬æ¢-&gt;ç‚¹è¿‡æ»¤(ç‚¹ç¨€ç–)-&gt;åœ°å›¾åŒ¹é…ç®—æ³•-&gt;ç‚¹æ˜ å°„</li></ul><table><thead><tr><th>å†…å®¹</th><th>é¢„ä¼°æ—¶é—´</th></tr></thead><tbody><tr><td>æŸ¥é˜…åœ°å›¾åŒ¹é…ç®—æ³•ç›¸å…³çš„è®ºæ–‡-&gt;æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ(16å°æ—¶)</td><td>2022å¹´2æœˆ28æ—¥</td></tr><tr><td>å­¦ä¹ éšé©¬å°”ç§‘å¤«æ¨¡å‹ç›¸å…³ç†è®ºçŸ¥è¯† (6å°æ—¶)</td><td>2022å¹´3æœˆ2æ—¥</td></tr><tr><td>æ‰¾å¯»éšé©¬å°”ç§‘å¤«æ¨¡å‹èµ„æ–™ã€ä»£ç (8å°æ—¶)â€”â€”barefootã€graphhopper</td><td>2022å¹´3æœˆ4æ—¥</td></tr><tr><td>ç†Ÿæ‚‰é¡¹ç›®ä¸­æœ‰å…³åœ°å›¾å¯¹è±¡çš„ä»£ç ï¼ˆ4å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ5æ—¥</td></tr><tr><td>ç§»æ¤éšé©¬å°”ç§‘å¤«æ¨¡å‹åˆ°é¡¹ç›®ä¸­ï¼Œç›®å‰å‚è€ƒï¼šå¼€æº<a href="https://github.com/bmwcarit/barefoot/wiki#stand-alone-servers" target="_blank" rel="noopener">barefoot</a>å®ç°ï¼šç†Ÿæ‚‰ä»£ç (16å°æ—¶)ã€åæ ‡è½¬æ¢ï¼ˆ3å°æ—¶ï¼‰ã€è¾“å…¥è¾“å‡ºæ•°æ®æ ¼å¼æ”¹é€ (10å°æ—¶)ã€é€‚é…ç±»(56å°æ—¶)ã€æ•ˆæœæ£€éªŒï¼ˆ10å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ20æ—¥</td></tr><tr><td>ç‚¹è¿‡æ»¤ï¼ˆ24å°æ—¶ï¼‰: æ …æ ¼åŒ–ï¼ˆ16å°æ—¶ï¼‰ + åŒé˜Ÿåˆ—ï¼ˆ8å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ24æ—¥</td></tr><tr><td>ç‚¹æ˜ å°„ï¼ˆ6å°æ—¶ï¼‰</td><td>2022å¹´3æœˆ25æ—¥</td></tr></tbody></table><h1 id="åº“"><a class="markdownIt-Anchor" href="#åº“"></a> åº“ï¼š</h1><ul><li><a href="https://developers.arcgis.com/javascript/latest/api-reference/esri-geometry-geometryEngine.html" target="_blank" rel="noopener">geometryEngine</a></li><li>net.sf.geographiclib</li><li>com.esri.core.geometryâ€”â€”QuadTree</li><li>graphhopperâ€”â€”org.locationtech.jts.geom  ==&gt; Envelope --&gt; findCandidateSnapsInBBox</li></ul><hr><h1 id="ç®€å•ç‰ˆå®ç°æ€è·¯"><a class="markdownIt-Anchor" href="#ç®€å•ç‰ˆå®ç°æ€è·¯"></a> ç®€å•ç‰ˆå®ç°æ€è·¯</h1><ol><li>æ‰¾åˆ°èµ·å§‹ç‚¹Oå’Œç»ˆç‚¹Dï¼Œä»¥ä¸¤ç‚¹ä¸ºåŠå¾„ç”»åœ†ï¼ŒæŠŠæ‰€æœ‰èŒƒå›´å†…çš„NormalEdgeå…¨éƒ¨åŠ å…¥Listï¼ˆåªè¦èµ·å§‹ç‚¹orç»ˆæ­¢ç‚¹æœ‰ä¸€ä¸ªåœ¨èŒƒå›´å†…ï¼‰</li><li>ç¡®å®šç¬¬ä¸€æ¡===&gt; æ‰¾ç¦»ç¬¬ä¸€ä¸ªGPSç‚¹æœ€è¿‘çš„è¾¹</li><li>likelyRoute.forEachä»ä¸Šä¸€æ¡çš„lowerNormalEdgeä¸­(ä¿è¯æ‹“æ‰‘å¯è¾¾è¿æ¥)ï¼Œä»ä¸­é€‰æ‹©å¾—åˆ†æœ€é«˜ï¼ˆè·ç¦»å’Œæ–¹å‘ï¼‰çš„è¾¹ä½œä¸ºåç»­è¾¹ ã€‚  å¦‚æœæ²¡æœ‰lowerNormalEdgeï¼ˆå¦‚æœæ‰€æœ‰å‰©ä½™çš„ç‚¹éƒ½èƒ½æ˜ å°„åˆ°æœ€åçš„è¿™æ¡è¾¹ä¸Šï¼Œåˆ™è®¤ä¸ºæ˜¯ç»ˆç‚¹ï¼Œæ­¤æ—¶ä¸åœ¨æ„æ­»è·¯ï¼‰ï¼Œ å¹³å¸¸å¦‚æœæ˜¯æ­»è·¯ï¼Œåˆ™æ”¾å¼ƒè¿™æ¡åºåˆ—è·¯å¾„ã€‚TODOï¼šæ²¡æœ‰åç»­è·¯å¾„æ—¶æ˜¯å¦è¦è€ƒè™‘å¢åŠ å¯èƒ½è¾¹é›†ï¼Ÿ</li><li>åˆ°è¾¾ç»ˆç‚¹è¾¹ç»“æŸ</li><li>ä»likelyRouteä¸­é€‰æ‹©å¾—åˆ†æœ€é«˜çš„è·¯å¾„</li></ol><p>ç”¨åˆ°çš„ç»“æ„ï¼š</p><ul><li><code>likelyRoute: list[list]</code>, å­˜æ”¾å¤šæ¡å¯èƒ½</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åœ°å›¾åŒ¹é…&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#åœ°å›¾åŒ¹é…&quot;&gt;&lt;/a&gt; åœ°å›¾åŒ¹é…&lt;/h1&gt;
&lt;p&gt;æ¦‚å¿µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åœ°å›¾åŒ¹é…ï¼ˆMap-Matchingï¼‰æ˜¯å°†è¿è¥è½¦è¾†çš„æœ‰åºçš„GPSä½ç½®å…³è”åˆ°
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç§æœ‰Gitlabé…ç½®SSHè¿æ¥</title>
    <link href="https://nymrli.top/2022/02/25/%E7%A7%81%E6%9C%89Gitlab%E9%85%8D%E7%BD%AESSH%E8%BF%9E%E6%8E%A5/"/>
    <id>https://nymrli.top/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/</id>
    <published>2022-02-25T05:38:19.000Z</published>
    <updated>2022-02-25T06:04:05.992Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>SSHè¿æ¥å¹¶ä¸æ˜¯åƒ<a href="https://so.csdn.net/so/search?q=http&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">http</a>è¿æ¥ä¸€æ ·ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥äº†ã€‚SSHè¿æ¥éœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®</p></blockquote><h1 id="ç”Ÿæˆsshç§˜é’¥å’Œå…¬é’¥"><a class="markdownIt-Anchor" href="#ç”Ÿæˆsshç§˜é’¥å’Œå…¬é’¥"></a> ç”ŸæˆSSHç§˜é’¥å’Œå…¬é’¥</h1><h2 id="æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±"></a> æŸ¥è¯¢æœ‰æ•ˆé‚®ç®±</h2><p>é¦–å…ˆè¦ç¡®å®šä½¿ç”¨çš„é‚®ç®±ï¼Œæ˜¯ä¸æ˜¯è‡ªå·±è®¤ä¸ºçš„é‚®ç®±ï¼Œæ¯”å¦‚æˆ‘ä»¥ä¸ºæ˜¯<code>chenli@sucsoft.com</code>ç»“æœï¼Œå´å‘ç°æ˜¯<code>399-chenli@sucsoft.com</code>ï¼Œé‚£ä¹ˆæŒ‰ç…§è‡ªè®¤ä¸ºçš„é‚®ç®±ç”³è¯·çš„keysé‚£è‡ªç„¶ä¸ä¼šworkã€‚â€”â€”ä¸€èˆ¬æƒ…å†µä¸ä¼šæœ‰æ­§ä¹‰é‚®ç®±å‡ºç°ï¼Œä½†æˆ‘è¿™è¾¹ç¡®å®è·Ÿæƒ³çš„ä¸å¤ªä¸€æ ·</p><h3 id="æŸ¥è¯¢æ–¹æ³•ä¸€æ–°å»ºé¡¹ç›®"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ–¹æ³•ä¸€æ–°å»ºé¡¹ç›®"></a> æŸ¥è¯¢æ–¹æ³•(ä¸€)â€”â€”æ–°å»ºé¡¹ç›®</h3><p>åˆ›å»ºç©ºçš„ä»“åº“ï¼Œæç¤ºä¸­æåŠçš„é‚®ç®±å°±æ˜¯æœ‰æ•ˆé‚®ç®±</p><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/gitlab-ssh.jpg" alt="gitlab-ssh"></p><h3 id="æŸ¥è¯¢æ–¹æ³•äºŒä¸ªäººpreference"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ–¹æ³•äºŒä¸ªäººpreference"></a> æŸ¥è¯¢æ–¹æ³•(äºŒ)â€”â€”ä¸ªäººPreference</h3><ol><li>æ‰“å¼€<code>User Settings-&gt;Profile</code>ï¼Œå…¶ä¸­æœ‰<code>Email</code>ã€<code>public email</code>å’Œ<code>commit email</code>ä¸‰ä¸ªé‚®ç®±ï¼Œå…¶ä¸­è·Ÿæˆ‘ä»¬å¼€å‘å‘½ä»¤æ¯”è¾ƒæœ‰å…³çš„å°±æ˜¯è¿™ä¸ªCommit Emailï¼Œä¹‹å‰æˆ‘çš„é»˜è®¤æ˜¯<code>399-chenli@sucsoft.com</code>ï¼Œè¿™è¾¹è¦è®¾ç½®è‡ªå·±æƒ³è¦çš„ï¼Œæ¯”å¦‚<code>chenli@sucsoft.com</code></li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/email_settings.jpg" alt="email_settings"></p><p>â–²é€‰æ‹©å®Œæˆåï¼Œæ»‘åˆ°æœ€ä¸‹é¢é€‰æ‹©Update profile settings</p><ol start="2"><li>æ‰“å¼€<code>User Settings-&gt;Emails</code>å¯ä»¥çœ‹åˆ°ï¼Œ<code>chenli@sucsoft@sucsoft.com</code>çš„æ ‡ç­¾ä¸­æœ‰commit emailï¼Œå³è®¾ç½®æˆåŠŸ</li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/preference_email.jpg" alt="preference_email"></p><h2 id="gitlabè®¾ç½®å…¬é’¥"><a class="markdownIt-Anchor" href="#gitlabè®¾ç½®å…¬é’¥"></a> Gitlabè®¾ç½®å…¬é’¥</h2><p>ç¡®ä¿é‚®ç®±æ˜¯æœ‰æ•ˆçš„åå°±å¯ä»¥ç”Ÿæˆç§˜é’¥äº†ã€‚</p><ol><li>è®¾ç½®gitä¿¡æ¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. è®¾ç½®gitä¿¡æ¯</span></span><br><span class="line">git config --global user.name <span class="string">"chenli"</span></span><br><span class="line">git config --global user.email <span class="string">"chenli@sucsoft.com"</span></span><br><span class="line"><span class="comment"># 2. ç”Ÿæˆç§˜é’¥å’Œå…¬é’¥</span></span><br><span class="line">$ ssh-keygen -t rsa -C chenli@sucsoft.com</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/c/Users/mrli/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /c/Users/mrli/.ssh/id_rsa</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /c/Users/mrli/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:zKPeKkm0bNzDqZcHUEDcvvDqPG2znRqDrD30yoBb8MM chenli@sucsoft.com</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 3072]----+</span></span><br><span class="line"><span class="string">|   ooo           |</span></span><br><span class="line"><span class="string">|    . o          |</span></span><br><span class="line"><span class="string">|     o           |</span></span><br><span class="line"><span class="string">|    + .o         |</span></span><br><span class="line"><span class="string">|.  + B oS        |</span></span><br><span class="line"><span class="string">| = .B.O. .       |</span></span><br><span class="line"><span class="string">|. E+o*++         |</span></span><br><span class="line"><span class="string">| o BB.B=..       |</span></span><br><span class="line"><span class="string">|. ..*B=*+        |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®å‘½ä»¤è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„ç»“æœåœ¨<code>C:\Users\mrli\.ssh</code>è·¯å¾„ä¸‹ï¼Œæœ‰<code>id_rsa</code>ã€<code>id_rsa.pub</code>ï¼Œå…¶ä¸­<code>id_rsa.pub</code>ä¸ºå…¬é’¥ã€‚</p><ol start="2"><li><p>å°†SSHå…¬é’¥æ·»åŠ åˆ°GitHubè´¦æˆ·</p><ol><li>å¤åˆ¶æ–‡ä»¶è·¯å¾„å†….pubåç¼€é‡Œçš„å†…å®¹</li><li>è¿›å…¥SSH Keysçš„è®¾ç½®é¡µé¢ï¼ˆç™»å½•GitHubï¼Œåœ¨å³ä¸Šè§’å¤´åƒç‚¹å‡»è®¾ç½®ï¼‰</li></ol><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/add_ssh.jpg" alt="add_ssh"></p><ol start="3"><li>ç²˜è´´åï¼ŒTitleä¼šè‡ªåŠ¨æå–ç”Ÿæˆï¼Œç‚¹å‡»<code>Add key</code>åˆ™å®Œæˆæ·»åŠ </li></ol></li></ol><h2 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@gitlab.sucsoft.com</span><br><span class="line">Welcome to GitLab, @chenli!</span><br></pre></td></tr></table></figure><h1 id="more"><a class="markdownIt-Anchor" href="#more"></a> More</h1><h2 id="é…ç½®å¤šä¸ªgitä¿¡æ¯"><a class="markdownIt-Anchor" href="#é…ç½®å¤šä¸ªgitä¿¡æ¯"></a> é…ç½®å¤šä¸ªGitä¿¡æ¯</h2><ol><li>å°†é»˜è®¤çš„<code>id_rsa</code>å’Œ<code>id_rsa.pub</code>æ”¹æˆæŒ‡å®šçš„å¦‚<code>id_rsa_sucsoft.pub</code></li><li><code>.ssh/</code>è·¯å¾„ä¸‹æ·»åŠ <code>config</code>é…ç½®æ–‡ä»¶ï¼Œå¯¹åº”å¡«å†™</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Host github.com                 </span><br><span class="line">    HostName github.com</span><br><span class="line">    IdentityFile C:\\Users\\mrli\\.ssh\\id_rsa_github</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    User Freedomisgood</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Host gitlab.sucsoft.com</span><br><span class="line">    HostName gitlab.sucsoft.com</span><br><span class="line">    IdentityFile C:\\Users\\mrli\\.ssh\\id_rsa_sucsoft</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    User chenli</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šHoståå†™çš„å°±æ˜¯<code>ssh -T git@gitlab.sucsoft.com</code>ä¸­@åé¢çš„å†…å®¹ï¼Œå¦‚æœå†™çš„æ˜¯<code>sucsoft</code>ï¼Œåˆ™å†™æˆ<code>ssh -T git@sucsoft</code>ï¼Œä½†æ˜¯è¿™æ ·å…¶å®è·ŸGitlabé¡µé¢ä¸­ç›´æ¥æä¾›çš„ä¸ä¸€æ ·: <code>git@gitlab.sucsoft.com:suc-frame/xxxx.git</code>ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯è§„èŒƒçš„å†™<code>gitlab.sucsoft.com</code></p><p>â˜…é…ç½®å®Œæˆåæœ€ç»ˆæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼š</p><p><img src="/2022/02/25/ç§æœ‰Gitlabé…ç½®SSHè¿æ¥/more-1.jpg" alt="more-1"></p><p>æ³¨ï¼š known_hostæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¦‚æœç¬¬ä¸€æ¬¡SSHè¿æ¥ç½‘ç«™ï¼Œåˆ™ä¼šå°†hostæ·»åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;SSHè¿æ¥å¹¶ä¸æ˜¯åƒ&lt;a href=&quot;https://so.csdn.net/so/search?q=http&amp;amp;spm=1001.2101.3001.7020&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http&lt;/a&gt;è¿
      
    
    </summary>
    
    
      <category term="git" scheme="https://nymrli.top/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Golang protocçš„ä½¿ç”¨</title>
    <link href="https://nymrli.top/2022/02/22/protoc%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>https://nymrli.top/2022/02/22/protocçš„ä½¿ç”¨/</id>
    <published>2022-02-22T04:04:33.000Z</published>
    <updated>2022-02-22T06:11:07.536Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½¿ç”¨Grpcéœ€è¦æœ‰protocçš„æ”¯æŒ, ä½†é»˜è®¤å®‰è£…çš„<code>/Go/bin</code>ç›®å½•ä¸‹åªæœ‰<code>go.exe</code>ã€<code>gofmt.exe</code>ä¸¤ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå› æ­¤è¦ä½¿ç”¨<code>protoc</code>çš„è¯ï¼Œéœ€è¦è‡ªå·±å»ä¸‹è½½</p></blockquote><ol><li><p>åœ¨<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fprotocolbuffers%2Fprotobuf%2Freleases" target="_blank" rel="noopener">https://github.com/protocolbuffers/protobuf/releases</a>ä¸­ä¸‹è½½Windows64çš„å‹ç¼©åŒ…ï¼Œä¸º<code>$protoc -go_out=. *.proto</code>ä½¿ç”¨åˆ°çš„å‘½ä»¤å¯æ‰§è¡Œæ–‡ä»¶</p></li><li><p>ç¼–å†™<code>.proto</code>æ–‡ä»¶ï¼Œ å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">syntax = &quot;proto3&quot;;</span><br><span class="line"></span><br><span class="line"># æ³¨æ„, è¿™è¾¹ä½¿ç”¨çš„æ˜¯go_package, ç±»ä¼¼çš„è¿˜æœ‰java_package, åé¢çš„å‚æ•°æ˜¯output_pathå’ŒåŒ…å</span><br><span class="line">option go_package = &quot;.;geecachepb&quot;;</span><br><span class="line"></span><br><span class="line">message Request&#123;</span><br><span class="line">  string group = 1;</span><br><span class="line">  string key = 2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">message Response&#123;</span><br><span class="line">  bytes value = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">service GroupCache&#123;</span><br><span class="line">  rpc Get(Request) returns (Response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>protoc -go_out=. *.proto</code>å‘½ä»¤ï¼Œå°†<code>.proto</code>è½¬æ¢æˆè¦ä½¿ç”¨çš„goæ–‡ä»¶</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Code generated by protoc-gen-go. DO NOT EDIT.</span></span><br><span class="line"><span class="comment">// versions:</span></span><br><span class="line"><span class="comment">// protoc-gen-go v1.27.1</span></span><br><span class="line"><span class="comment">// protoc        v3.19.4</span></span><br><span class="line"><span class="comment">// source: geecachepb.proto</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> geecachepb</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">protoreflect <span class="string">"google.golang.org/protobuf/reflect/protoreflect"</span></span><br><span class="line">protoimpl <span class="string">"google.golang.org/protobuf/runtime/protoimpl"</span></span><br><span class="line">reflect <span class="string">"reflect"</span></span><br><span class="line">sync <span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line"><span class="comment">// Verify that this generated code is sufficiently up-to-date.</span></span><br><span class="line">_ = protoimpl.EnforceVersion(<span class="number">20</span> - protoimpl.MinVersion)</span><br><span class="line"><span class="comment">// Verify that runtime/protoimpl is sufficiently up-to-date.</span></span><br><span class="line">_ = protoimpl.EnforceVersion(protoimpl.MaxVersion - <span class="number">20</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Request <span class="keyword">struct</span> &#123;</span><br><span class="line">state         protoimpl.MessageState</span><br><span class="line">sizeCache     protoimpl.SizeCache</span><br><span class="line">unknownFields protoimpl.UnknownFields</span><br><span class="line"></span><br><span class="line">Group <span class="keyword">string</span> <span class="string">`protobuf:"bytes,1,opt,name=group,proto3" json:"group,omitempty"`</span></span><br><span class="line">Key   <span class="keyword">string</span> <span class="string">`protobuf:"bytes,2,opt,name=key,proto3" json:"key,omitempty"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... çœç•¥æ›´å¤š</span></span><br></pre></td></tr></table></figure></li><li><p><code>go get -u github.com/golang/protobuf/protoc-gen-go</code>å®‰è£…ä½¿ç”¨<code>xxxx.pb.go</code>æ–‡ä»¶çš„åº“</p></li><li><p>åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PeerGetter <span class="keyword">interface</span> &#123;</span><br><span class="line">Get(in *pb.Request, out *pb.Response) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *HttpPool)</span> <span class="title">ServeHTTP</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    body, err := proto.Marshal(&amp;pb.Response&#123;Value: view.ByteSlice()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(w, err.Error(), http.StatusInternalServerError)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *httpGetter)</span> <span class="title">Get</span><span class="params">(in *pb.Request, out *pb.Response)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">u := fmt.Sprintf(</span><br><span class="line"><span class="string">"%v%v/%v"</span>,</span><br><span class="line">h.baseURL,</span><br><span class="line">url.QueryEscape(in.GetGroup()),</span><br><span class="line">url.QueryEscape(in.GetKey()),</span><br><span class="line">)</span><br><span class="line">res, err := http.Get(u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> res.Body.Close()</span><br><span class="line"><span class="keyword">if</span> res.StatusCode != http.StatusOK &#123;</span><br><span class="line"><span class="keyword">return</span> fmt.Errorf(<span class="string">"server return %v"</span>, res.Status)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bytes, err := ioutil.ReadAll(res.Body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err = proto.Unmarshal(bytes, out); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> fmt.Errorf(<span class="string">"decoding response body: %v"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨èé£æ ¼"><a class="markdownIt-Anchor" href="#æ¨èé£æ ¼"></a> æ¨èé£æ ¼</h2><ul><li>æ–‡ä»¶(Files)<ul><li>æ–‡ä»¶åä½¿ç”¨å°å†™ä¸‹åˆ’çº¿çš„å‘½åé£æ ¼ï¼Œä¾‹å¦‚ lower_snake_case.proto</li><li>æ¯è¡Œä¸è¶…è¿‡ 80 å­—ç¬¦</li><li>ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ç¼©è¿›</li></ul></li><li>åŒ…(Packages)<ul><li>åŒ…ååº”è¯¥å’Œç›®å½•ç»“æ„å¯¹åº”ï¼Œä¾‹å¦‚æ–‡ä»¶åœ¨<code>my/package/</code>ç›®å½•ä¸‹ï¼ŒåŒ…ååº”ä¸º <code>my.package</code></li></ul></li><li>æ¶ˆæ¯å’Œå­—æ®µ(Messages &amp; Fields)<ul><li>æ¶ˆæ¯åä½¿ç”¨é¦–å­—æ¯å¤§å†™é©¼å³°é£æ ¼(CamelCase)ï¼Œä¾‹å¦‚<code>message StudentRequest { ... }</code></li><li>å­—æ®µåä½¿ç”¨å°å†™ä¸‹åˆ’çº¿çš„é£æ ¼ï¼Œä¾‹å¦‚ <code>string status_code = 1</code></li><li>æšä¸¾ç±»å‹ï¼Œæšä¸¾åä½¿ç”¨é¦–å­—æ¯å¤§å†™é©¼å³°é£æ ¼ï¼Œä¾‹å¦‚ <code>enum FooBar</code>ï¼Œæšä¸¾å€¼ä½¿ç”¨å…¨å¤§å†™ä¸‹åˆ’çº¿éš”å¼€çš„é£æ ¼(CAPITALS_WITH_UNDERSCORES )ï¼Œä¾‹å¦‚ FOO_DEFAULT=1</li></ul></li><li>æœåŠ¡(Services)<ul><li>RPC æœåŠ¡åå’Œæ–¹æ³•åï¼Œå‡ä½¿ç”¨é¦–å­—æ¯å¤§å†™é©¼å³°é£æ ¼ï¼Œä¾‹å¦‚<code>service FooService{ rpc GetSomething() }</code></li></ul></li></ul></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨Grpcéœ€è¦æœ‰protocçš„æ”¯æŒ, ä½†é»˜è®¤å®‰è£…çš„&lt;code&gt;/Go/bin&lt;/code&gt;ç›®å½•ä¸‹åªæœ‰&lt;code&gt;go.exe&lt;/code&gt;ã€&lt;code&gt;gofmt.exe&lt;/code&gt;ä¸¤ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå› æ­¤è¦ä½¿ç”¨&lt;code&gt;protoc&lt;/code
      
    
    </summary>
    
    
      <category term="Go" scheme="https://nymrli.top/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶</title>
    <link href="https://nymrli.top/2022/01/26/%E8%AF%AD%E4%B9%89%E5%8C%96%E7%9A%84%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
    <id>https://nymrli.top/2022/01/26/è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶/</id>
    <published>2022-01-26T14:30:00.000Z</published>
    <updated>2022-01-26T14:40:45.998Z</updated>
    
    <content type="html"><![CDATA[<p>è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ï¼š ç”¨ä¸€ç»„ç®€å•çš„è§„åˆ™åŠæ¡ä»¶æ¥çº¦æŸç‰ˆæœ¬å·çš„é…ç½®å’Œå¢é•¿</p><blockquote><p>ä½œä¸ºä¸€ä½è´Ÿè´£ä»»çš„å¼€å‘è€…ï¼Œä½ ç†å½“ç¡®ä¿æ¯æ¬¡åŒ…å‡çº§çš„è¿ä½œä¸ç‰ˆæœ¬å·çš„è¡¨è¿°ä¸€è‡´ã€‚ç°å®ä¸–ç•Œæ˜¯å¤æ‚çš„ï¼Œæˆ‘ä»¬é™¤äº†æé«˜è­¦è§‰å¤–èƒ½åšçš„ä¸å¤šã€‚ä½ æ‰€èƒ½åšçš„å°±æ˜¯è®©è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ä¸ºä½ æä¾›ä¸€ä¸ªå¥å…¨çš„æ–¹å¼æ¥å‘è¡Œä»¥åŠå‡çº§åŒ…ï¼Œè€Œæ— éœ€æ¨å‡ºæ–°çš„ä¾èµ–åŒ…ï¼ŒèŠ‚çœä½ çš„æ—¶é—´åŠçƒ¦æ¼ã€‚</p><p>å¦‚æœæ²¡æœ‰æŸä¸ªæ­£å¼çš„è§„èŒƒå¯å¾ªï¼Œç‰ˆæœ¬å·å¯¹äºä¾èµ–çš„ç®¡ç†å¹¶æ— å®è´¨æ„ä¹‰ã€‚å°†ä¸Šè¿°çš„æƒ³æ³•å‘½åå¹¶ç»™äºˆæ¸…æ¥šçš„å®šä¹‰ï¼Œè®©ä½ å¯¹è½¯ä»¶ä½¿ç”¨è€…ä¼ è¾¾æ„å‘å˜å¾—å®¹æ˜“ã€‚ä¸€æ—¦è¿™äº›æ„å‘å˜å¾—æ¸…æ¥šï¼Œå¼¹æ€§ï¼ˆä½†åˆä¸ä¼šå¤ªå¼¹æ€§ï¼‰çš„ä¾èµ–è§„èŒƒå°±èƒ½è¾¾æˆã€‚</p><p>å¦‚æœä½ å¯¹æ­¤è®¤åŒï¼Œå¸Œæœ›ç«‹å³å¼€å§‹ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼Œä½ åªéœ€å£°æ˜ä½ çš„å‡½æ•°åº“æ­£åœ¨ä½¿ç”¨å®ƒå¹¶éµå¾ªè¿™äº›è§„åˆ™å°±å¯ä»¥äº†ã€‚è¯·åœ¨ä½ çš„ README æ–‡ä»¶ä¸­ä¿ç•™<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener">æ­¤é¡µé“¾æ¥</a>ï¼Œè®©åˆ«äººä¹ŸçŸ¥é“è¿™äº›è§„åˆ™å¹¶ä»ä¸­å—ç›Šã€‚</p></blockquote><h2 id="target"><a class="markdownIt-Anchor" href="#target"></a> Target:</h2><p>ç‰ˆæœ¬æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼Œç‰ˆæœ¬å·é€’å¢è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li>ä¸»ç‰ˆæœ¬å·ï¼šå½“ä½ åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹ï¼Œ</li><li>æ¬¡ç‰ˆæœ¬å·ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢ï¼Œ</li><li>ä¿®è®¢å·ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£ã€‚</li></ol><p>å…ˆè¡Œç‰ˆæœ¬å·åŠç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ä»¥åŠ åˆ°â€œä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·â€çš„åé¢ï¼Œä½œä¸ºå»¶ä¼¸ã€‚</p><h2 id="è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒsemver"><a class="markdownIt-Anchor" href="#è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒsemver"></a> è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒï¼ˆSemVerï¼‰</h2><p>ä»¥ä¸‹å…³é”®è¯ MUSTã€MUST NOTã€REQUIREDã€SHALLã€SHALL NOTã€SHOULDã€SHOULD NOTã€ RECOMMENDEDã€MAYã€OPTIONAL ä¾ç…§ RFC 2119 çš„å™è¿°è§£è¯»ã€‚</p><ol><li>ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è½¯ä»¶å¿…é¡»ï¼ˆMUSTï¼‰å®šä¹‰å…¬å…± APIã€‚è¯¥ API å¯ä»¥åœ¨ä»£ç ä¸­è¢«å®šä¹‰æˆ–å‡ºç°äºä¸¥è°¨çš„æ–‡ä»¶å†…ã€‚æ— è®ºä½•ç§å½¢å¼éƒ½åº”è¯¥åŠ›æ±‚ç²¾ç¡®ä¸”å®Œæ•´ã€‚</li><li>æ ‡å‡†çš„ç‰ˆæœ¬å·å¿…é¡»ï¼ˆMUSTï¼‰é‡‡ç”¨ X.Y.Z çš„æ ¼å¼ï¼Œå…¶ä¸­ Xã€Y å’Œ Z ä¸ºéè´Ÿçš„æ•´æ•°ï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨æ•°å­—å‰æ–¹è¡¥é›¶ã€‚X æ˜¯ä¸»ç‰ˆæœ¬å·ã€Y æ˜¯æ¬¡ç‰ˆæœ¬å·ã€è€Œ Z ä¸ºä¿®è®¢å·ã€‚æ¯ä¸ªå…ƒç´ å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ•°å€¼æ¥é€’å¢ã€‚ä¾‹å¦‚ï¼š1.9.1 -&gt; 1.10.0 -&gt; 1.11.0ã€‚</li><li>æ ‡è®°ç‰ˆæœ¬å·çš„è½¯ä»¶å‘è¡Œåï¼Œç¦æ­¢ï¼ˆMUST NOTï¼‰æ”¹å˜è¯¥ç‰ˆæœ¬è½¯ä»¶çš„å†…å®¹ã€‚ä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ–°ç‰ˆæœ¬å‘è¡Œã€‚</li><li>ä¸»ç‰ˆæœ¬å·ä¸ºé›¶ï¼ˆ0.y.zï¼‰çš„è½¯ä»¶å¤„äºå¼€å‘åˆå§‹é˜¶æ®µï¼Œä¸€åˆ‡éƒ½å¯èƒ½éšæ—¶è¢«æ”¹å˜ã€‚è¿™æ ·çš„å…¬å…± API ä¸åº”è¯¥è¢«è§†ä¸ºç¨³å®šç‰ˆã€‚</li><li>1.0.0 çš„ç‰ˆæœ¬å·ç”¨äºç•Œå®šå…¬å…± API çš„å½¢æˆã€‚è¿™ä¸€ç‰ˆæœ¬ä¹‹åæ‰€æœ‰çš„ç‰ˆæœ¬å·æ›´æ–°éƒ½åŸºäºå…¬å…± API åŠå…¶ä¿®æ”¹å†…å®¹ã€‚</li><li><strong>ä¿®è®¢å·</strong> Zï¼ˆx.y.Z <code>|</code> x &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨åªåšäº†å‘ä¸‹å…¼å®¹çš„ä¿®æ­£æ—¶æ‰é€’å¢ã€‚è¿™é‡Œçš„ä¿®æ­£æŒ‡çš„æ˜¯é’ˆå¯¹ä¸æ­£ç¡®ç»“æœè€Œè¿›è¡Œçš„å†…éƒ¨ä¿®æ”¹ã€‚</li><li><strong>æ¬¡ç‰ˆæœ¬å·</strong> Yï¼ˆx.Y.z <code>|</code> x &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰å‘ä¸‹å…¼å®¹çš„æ–°åŠŸèƒ½å‡ºç°æ—¶é€’å¢ã€‚åœ¨ä»»ä½•å…¬å…± API çš„åŠŸèƒ½è¢«æ ‡è®°ä¸ºå¼ƒç”¨æ—¶ä¹Ÿå¿…é¡»ï¼ˆMUSTï¼‰é€’å¢ã€‚ä¹Ÿå¯ä»¥ï¼ˆMAYï¼‰åœ¨å†…éƒ¨ç¨‹åºæœ‰å¤§é‡æ–°åŠŸèƒ½æˆ–æ”¹è¿›è¢«åŠ å…¥æ—¶é€’å¢ï¼Œå…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬ä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“æ¬¡ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚</li><li><strong>ä¸»ç‰ˆæœ¬å·</strong> Xï¼ˆX.y.z <code>|</code> X &gt; 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰ä»»ä½•ä¸å…¼å®¹çš„ä¿®æ”¹è¢«åŠ å…¥å…¬å…± API æ—¶é€’å¢ã€‚å…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“ä¸»ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œæ¬¡ç‰ˆæœ¬å·å’Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚</li><li><strong>å…ˆè¡Œç‰ˆæœ¬å·</strong>ï¼šå¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆä¹‹åï¼Œå…ˆåŠ ä¸Š<strong>ä¸€ä¸ªè¿æ¥å·</strong>å†åŠ ä¸Š<strong>ä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”</strong>çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚æ•°å­—å‹çš„æ ‡è¯†ç¬¦ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨å‰æ–¹è¡¥é›¶ã€‚å…ˆè¡Œç‰ˆçš„ä¼˜å…ˆçº§ä½äºç›¸å…³è”çš„æ ‡å‡†ç‰ˆæœ¬ã€‚è¢«æ ‡ä¸Šå…ˆè¡Œç‰ˆæœ¬å·åˆ™è¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬å¹¶éç¨³å®šè€Œä¸”å¯èƒ½æ— æ³•æ»¡è¶³é¢„æœŸçš„å…¼å®¹æ€§éœ€æ±‚ã€‚èŒƒä¾‹ï¼š1.0.0-alphaã€1.0.0-alpha.1ã€1.0.0-0.3.7ã€1.0.0-x.7.z.92ã€‚</li><li><strong>ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯</strong>å¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆæˆ–å…ˆè¡Œç‰ˆæœ¬å·ä¹‹åï¼Œå…ˆåŠ ä¸Š<strong>ä¸€ä¸ªåŠ å·</strong>å†åŠ ä¸Šä¸€è¿ä¸²ä»¥<strong>å¥ç‚¹åˆ†éš”</strong>çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚å½“åˆ¤æ–­ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æ—¶ï¼Œç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ï¼ˆSHOULDï¼‰è¢«å¿½ç•¥ã€‚å› æ­¤å½“ä¸¤ä¸ªç‰ˆæœ¬åªæœ‰åœ¨ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯æœ‰å·®åˆ«æ—¶ï¼Œå±äºç›¸åŒçš„ä¼˜å…ˆå±‚çº§ã€‚èŒƒä¾‹ï¼š1.0.0-alpha+001ã€1.0.0+20130313144700ã€1.0.0-beta+exp.sha.5114f85ã€‚</li><li>ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æŒ‡çš„æ˜¯ä¸åŒç‰ˆæœ¬åœ¨æ’åºæ—¶å¦‚ä½•æ¯”è¾ƒã€‚åˆ¤æ–­ä¼˜å…ˆå±‚çº§æ—¶ï¼Œå¿…é¡»ï¼ˆMUSTï¼‰æŠŠç‰ˆæœ¬ä¾åºæ‹†åˆ†ä¸ºä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·ã€ä¿®è®¢å·åŠå…ˆè¡Œç‰ˆæœ¬å·åè¿›è¡Œæ¯”è¾ƒï¼ˆç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯ä¸åœ¨è¿™ä»½æ¯”è¾ƒçš„åˆ—è¡¨ä¸­ï¼‰ã€‚ç”±å·¦åˆ°å³ä¾åºæ¯”è¾ƒæ¯ä¸ªæ ‡è¯†ç¬¦ï¼Œç¬¬ä¸€ä¸ªå·®å¼‚å€¼ç”¨æ¥å†³å®šä¼˜å…ˆå±‚çº§ï¼šä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·ä»¥æ•°å€¼æ¯”è¾ƒï¼Œä¾‹å¦‚ï¼š1.0.0 &lt; 2.0.0 &lt; 2.1.0 &lt; 2.1.1ã€‚å½“ä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·éƒ½ç›¸åŒæ—¶ï¼Œæ”¹ä»¥ä¼˜å…ˆå±‚çº§æ¯”è¾ƒä½çš„å…ˆè¡Œç‰ˆæœ¬å·å†³å®šã€‚ä¾‹å¦‚ï¼š1.0.0-alpha &lt; 1.0.0ã€‚æœ‰ç›¸åŒä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·çš„ä¸¤ä¸ªå…ˆè¡Œç‰ˆæœ¬å·ï¼Œå…¶ä¼˜å…ˆå±‚çº§å¿…é¡»ï¼ˆMUSTï¼‰é€è¿‡ç”±å·¦åˆ°å³çš„æ¯ä¸ªè¢«å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥æ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå·®å¼‚å€¼åå†³å®šï¼šåªæœ‰æ•°å­—çš„æ ‡è¯†ç¬¦ä»¥æ•°å€¼é«˜ä½æ¯”è¾ƒï¼Œæœ‰å­—æ¯æˆ–è¿æ¥å·æ—¶åˆ™é€å­—ä»¥ ASCII çš„æ’åºæ¥æ¯”è¾ƒã€‚æ•°å­—çš„æ ‡è¯†ç¬¦æ¯”éæ•°å­—çš„æ ‡è¯†ç¬¦ä¼˜å…ˆå±‚çº§ä½ã€‚è‹¥å¼€å¤´çš„æ ‡è¯†ç¬¦éƒ½ç›¸åŒæ—¶ï¼Œæ ä½æ¯”è¾ƒå¤šçš„å…ˆè¡Œç‰ˆæœ¬å·ä¼˜å…ˆå±‚çº§æ¯”è¾ƒé«˜ã€‚èŒƒä¾‹ï¼š1.0.0-alpha &lt; 1.0.0-alpha.1 &lt; 1.0.0-alpha.beta &lt; 1.0.0-beta &lt; 1.0.0-beta.2 &lt; 1.0.0-beta.11 &lt; 1.0.0-rc.1 &lt; 1.0.0ã€‚</li></ol><h2 id="faq"><a class="markdownIt-Anchor" href="#faq"></a> FAQ</h2><p><strong>åœ¨ 0.y.z åˆå§‹å¼€å‘é˜¶æ®µï¼Œæˆ‘è¯¥å¦‚ä½•è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Ÿ</strong></p><p>æœ€ç®€å•çš„åšæ³•æ˜¯ä»¥ 0.1.0 ä½œä¸ºä½ çš„åˆå§‹åŒ–å¼€å‘ç‰ˆæœ¬ï¼Œå¹¶åœ¨åç»­çš„æ¯æ¬¡å‘è¡Œæ—¶é€’å¢æ¬¡ç‰ˆæœ¬å·ã€‚</p><p><strong>å¦‚ä½•åˆ¤æ–­å‘å¸ƒ 1.0.0 ç‰ˆæœ¬çš„æ—¶æœºï¼Ÿ</strong></p><p>å½“ä½ çš„è½¯ä»¶è¢«ç”¨äºæ­£å¼ç¯å¢ƒï¼Œå®ƒåº”è¯¥å·²ç»è¾¾åˆ°äº† 1.0.0 ç‰ˆã€‚å¦‚æœä½ å·²ç»æœ‰ä¸ªç¨³å®šçš„ API è¢«ä½¿ç”¨è€…ä¾èµ–ï¼Œä¹Ÿä¼šæ˜¯ 1.0.0 ç‰ˆã€‚å¦‚æœä½ å¾ˆæ‹…å¿ƒå‘ä¸‹å…¼å®¹çš„é—®é¢˜ï¼Œä¹Ÿåº”è¯¥ç®—æ˜¯ 1.0.0 ç‰ˆäº†ã€‚</p><p><strong>è¿™ä¸ä¼šé˜»ç¢å¿«é€Ÿå¼€å‘å’Œè¿­ä»£å—ï¼Ÿ</strong></p><p>ä¸»ç‰ˆæœ¬å·ä¸ºé›¶çš„æ—¶å€™å°±æ˜¯ä¸ºäº†åšå¿«é€Ÿå¼€å‘ã€‚å¦‚æœä½ æ¯å¤©éƒ½åœ¨æ”¹å˜ APIï¼Œé‚£ä¹ˆä½ åº”è¯¥ä»åœ¨ä¸»ç‰ˆæœ¬å·ä¸ºé›¶çš„é˜¶æ®µï¼ˆ0.y.zï¼‰ï¼Œæˆ–æ˜¯æ­£åœ¨ä¸‹ä¸ªä¸»ç‰ˆæœ¬çš„ç‹¬ç«‹å¼€å‘åˆ†æ”¯ä¸­ã€‚</p><p><strong>å¯¹äºå…¬å…± APIï¼Œè‹¥å³ä½¿æ˜¯æœ€å°ä½†ä¸å‘ä¸‹å…¼å®¹çš„æ”¹å˜éƒ½éœ€è¦äº§ç”Ÿæ–°çš„ä¸»ç‰ˆæœ¬å·ï¼Œå²‚ä¸æ˜¯å¾ˆå¿«å°±è¾¾åˆ° 42.0.0 ç‰ˆï¼Ÿ</strong></p><p>è¿™æ˜¯å¼€å‘çš„è´£ä»»æ„Ÿå’Œå‰ç»æ€§çš„é—®é¢˜ã€‚ä¸å…¼å®¹çš„æ”¹å˜ä¸åº”è¯¥è½»æ˜“è¢«åŠ å…¥åˆ°æœ‰è®¸å¤šä¾èµ–ä»£ç çš„è½¯ä»¶ä¸­ã€‚å‡çº§æ‰€ä»˜å‡ºçš„ä»£ä»·å¯èƒ½æ˜¯å·¨å¤§çš„ã€‚è¦é€’å¢ä¸»ç‰ˆæœ¬å·æ¥å‘è¡Œä¸å…¼å®¹çš„æ”¹ç‰ˆï¼Œæ„å‘³ç€ä½ å¿…é¡»ä¸ºè¿™äº›æ”¹å˜æ‰€å¸¦æ¥çš„å½±å“æ·±æ€ç†Ÿè™‘ï¼Œå¹¶ä¸”è¯„ä¼°æ‰€æ¶‰åŠçš„æˆæœ¬åŠæ•ˆç›Šæ¯”ã€‚</p><p><strong>ä¸ºæ•´ä¸ªå…¬å…± API å†™æ–‡ä»¶å¤ªè´¹äº‹äº†ï¼</strong></p><p>ä¸ºä¾›ä»–äººä½¿ç”¨çš„è½¯ä»¶ç¼–å†™é€‚å½“çš„æ–‡ä»¶ï¼Œæ˜¯ä½ ä½œä¸ºä¸€åä¸“ä¸šå¼€å‘è€…åº”å°½çš„èŒè´£ã€‚ä¿æŒä¸“æ¡ˆé«˜æ•ˆä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨ä»½æ˜¯æŒæ§è½¯ä»¶çš„å¤æ‚åº¦ï¼Œå¦‚æœæ²¡æœ‰äººçŸ¥é“å¦‚ä½•ä½¿ç”¨ä½ çš„è½¯ä»¶æˆ–ä¸çŸ¥é“å“ªäº›å‡½æ•°çš„è°ƒç”¨æ˜¯å¯é çš„ï¼Œè¦æŒæ§å¤æ‚åº¦ä¼šæ˜¯å›°éš¾çš„ã€‚é•¿è¿œæ¥çœ‹ï¼Œä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ä»¥åŠå¯¹äºå…¬å…± API æœ‰è‰¯å¥½è§„èŒƒçš„åšæŒï¼Œå¯ä»¥è®©æ¯ä¸ªäººåŠæ¯ä»¶äº‹éƒ½è¿è¡Œé¡ºç•…ã€‚</p><p><strong>ä¸‡ä¸€ä¸å°å¿ƒæŠŠä¸€ä¸ªä¸å…¼å®¹çš„æ”¹ç‰ˆå½“æˆäº†æ¬¡ç‰ˆæœ¬å·å‘è¡Œäº†è¯¥æ€ä¹ˆåŠï¼Ÿ</strong></p><p>ä¸€æ—¦å‘ç°è‡ªå·±ç ´åäº†è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è§„èŒƒï¼Œå°±è¦ä¿®æ­£è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å‘è¡Œä¸€ä¸ªæ–°çš„æ¬¡ç‰ˆæœ¬å·æ¥æ›´æ­£è¿™ä¸ªé—®é¢˜å¹¶ä¸”æ¢å¤å‘ä¸‹å…¼å®¹ã€‚å³ä½¿æ˜¯è¿™ç§æƒ…å†µï¼Œä¹Ÿä¸èƒ½å»ä¿®æ”¹å·²å‘è¡Œçš„ç‰ˆæœ¬ã€‚å¯ä»¥çš„è¯ï¼Œå°†æœ‰é—®é¢˜çš„ç‰ˆæœ¬å·è®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œå‘Šè¯‰ä½¿ç”¨è€…é—®é¢˜æ‰€åœ¨ï¼Œè®©ä»–ä»¬èƒ½å¤Ÿæ„è¯†åˆ°è¿™æ˜¯æœ‰é—®é¢˜çš„ç‰ˆæœ¬ã€‚</p><p><strong>å¦‚æœæˆ‘æ›´æ–°äº†è‡ªå·±çš„ä¾èµ–ä½†æ²¡æœ‰æ”¹å˜å…¬å…± API è¯¥æ€ä¹ˆåŠï¼Ÿ</strong></p><p>ç”±äºæ²¡æœ‰å½±å“åˆ°å…¬å…± APIï¼Œè¿™å¯ä»¥è¢«è®¤å®šæ˜¯å…¼å®¹çš„ã€‚è‹¥æŸä¸ªè½¯ä»¶å’Œä½ çš„åŒ…æœ‰å…±åŒä¾èµ–ï¼Œåˆ™å®ƒä¼šæœ‰è‡ªå·±çš„ä¾èµ–è§„èŒƒï¼Œä½œè€…ä¹Ÿä¼šå‘ŠçŸ¥å¯èƒ½çš„å†²çªã€‚è¦åˆ¤æ–­æ”¹ç‰ˆæ˜¯å±äºä¿®è®¢ç­‰çº§æˆ–æ˜¯æ¬¡ç‰ˆç­‰çº§ï¼Œæ˜¯ä¾æ®ä½ æ›´æ–°çš„ä¾èµ–å…³ç³»æ˜¯ä¸ºäº†ä¿®å¤é—®é¢˜æˆ–æ˜¯åŠ å…¥æ–°åŠŸèƒ½ã€‚å¯¹äºåè€…ï¼Œæˆ‘ç»å¸¸ä¼šé¢„æœŸä¼´éšç€æ›´å¤šçš„ä»£ç ï¼Œè¿™æ˜¾ç„¶ä¼šæ˜¯ä¸€ä¸ªæ¬¡ç‰ˆæœ¬å·çº§åˆ«çš„é€’å¢ã€‚</p><p><strong>å¦‚æœæˆ‘å˜æ›´äº†å…¬å…± API ä½†æ— æ„ä¸­æœªéµå¾ªç‰ˆæœ¬å·çš„æ”¹åŠ¨æ€ä¹ˆåŠå‘¢ï¼Ÿï¼ˆæ„å³åœ¨ä¿®è®¢ç­‰çº§çš„å‘å¸ƒä¸­ï¼Œè¯¯å°†é‡å¤§ä¸”ä¸å…¼å®¹çš„æ”¹å˜åŠ åˆ°ä»£ç ä¹‹ä¸­ï¼‰</strong></p><p>è‡ªè¡Œåšæœ€ä½³çš„åˆ¤æ–­ã€‚å¦‚æœä½ æœ‰åºå¤§çš„ä½¿ç”¨è€…ç¾¤åœ¨ä¾ç…§å…¬å…± API çš„æ„å›¾è€Œå˜æ›´è¡Œä¸ºåä¼šå¤§å—å½±å“ï¼Œé‚£ä¹ˆæœ€å¥½åšä¸€æ¬¡ä¸»ç‰ˆæœ¬çš„å‘å¸ƒï¼Œå³ä½¿ä¸¥æ ¼æ¥è¯´è¿™ä¸ªä¿®å¤ä»…æ˜¯ä¿®è®¢ç­‰çº§çš„å‘å¸ƒã€‚è®°ä½ï¼Œ è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶å°±æ˜¯é€è¿‡ç‰ˆæœ¬å·çš„æ”¹å˜æ¥ä¼ è¾¾æ„ä¹‰ã€‚è‹¥è¿™äº›æ”¹å˜å¯¹ä½ çš„ä½¿ç”¨è€…æ˜¯é‡è¦çš„ï¼Œé‚£å°±é€è¿‡ç‰ˆæœ¬å·æ¥å‘ä»–ä»¬è¯´æ˜ã€‚</p><p><strong>æˆ‘è¯¥å¦‚ä½•å¤„ç†å³å°†å¼ƒç”¨çš„åŠŸèƒ½ï¼Ÿ</strong></p><p>å¼ƒç”¨ç°å­˜çš„åŠŸèƒ½æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„å®¶å¸¸ä¾¿é¥­ï¼Œä¹Ÿé€šå¸¸æ˜¯å‘å‰å‘å±•æ‰€å¿…é¡»çš„ã€‚å½“ä½ å¼ƒç”¨éƒ¨ä»½å…¬å…± API æ—¶ï¼Œä½ åº”è¯¥åšä¸¤ä»¶äº‹ï¼šï¼ˆ1ï¼‰æ›´æ–°ä½ çš„æ–‡ä»¶è®©ä½¿ç”¨è€…çŸ¥é“è¿™ä¸ªæ”¹å˜ï¼Œï¼ˆ2ï¼‰åœ¨é€‚å½“çš„æ—¶æœºå°†å¼ƒç”¨çš„åŠŸèƒ½é€è¿‡æ–°çš„æ¬¡ç‰ˆæœ¬å·å‘å¸ƒã€‚åœ¨æ–°çš„ä¸»ç‰ˆæœ¬å®Œå…¨ç§»é™¤å¼ƒç”¨åŠŸèƒ½å‰ï¼Œè‡³å°‘è¦æœ‰ä¸€ä¸ªæ¬¡ç‰ˆæœ¬åŒ…å«è¿™ä¸ªå¼ƒç”¨ä¿¡æ¯ï¼Œè¿™æ ·ä½¿ç”¨è€…æ‰èƒ½å¹³é¡ºåœ°è½¬ç§»åˆ°æ–°ç‰ˆ APIã€‚</p><p><strong>è¯­ä¹‰åŒ–ç‰ˆæœ¬å¯¹äºç‰ˆæœ¬çš„å­—ä¸²é•¿åº¦æ˜¯å¦æœ‰é™åˆ¶å‘¢ï¼Ÿ</strong></p><p>æ²¡æœ‰ï¼Œè¯·è‡ªè¡Œåšé€‚å½“çš„åˆ¤æ–­ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œé•¿åˆ° 255 ä¸ªå­—å…ƒçš„ç‰ˆæœ¬å·²è¿‡åº¦å¤¸å¼ ã€‚å†è€…ï¼Œç‰¹å®šçš„ç³»ç»Ÿå¯¹äºå­—ä¸²é•¿åº¦å¯èƒ½ä¼šæœ‰ä»–ä»¬è‡ªå·±çš„é™åˆ¶ã€‚</p><h2 id="ç‰ˆæœ¬alpha-beta-rc"><a class="markdownIt-Anchor" href="#ç‰ˆæœ¬alpha-beta-rc"></a> ç‰ˆæœ¬ï¼šAlphaã€betaã€RC</h2><blockquote><p>è¿™äº›å«åšå…ˆè¡Œç‰ˆæœ¬å·ã€‚è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆä¹‹åï¼Œå…ˆåŠ ä¸Šä¸€ä¸ªè¿æ¥å·å†åŠ ä¸Šä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ï¼Œå¦‚1.0.0-alphaã€1.0.0-alpha.1ã€1.0.0-0.3.7ã€1.0.0-x.7.z.92</p></blockquote><p>å¸¸è§çš„ RC ç‰ˆæœ¬ï¼Œå…¨ç§°æ˜¯ Release Candidateã€‚å…¶ä¸­ Release æ˜¯å‘è¡Œã€å‘å¸ƒçš„æ„æ€ã€‚Candidate æ˜¯å€™é€‰äººçš„æ„æ€ï¼Œç”¨åœ¨è½¯ä»¶æˆ–è€…æ“ä½œç³»ç»Ÿä¸Šå°±æ˜¯å€™é€‰ç‰ˆæœ¬ã€‚å› æ­¤ Release Candidate å°±æ˜¯å‘è¡Œå€™é€‰ç‰ˆæœ¬ã€‚</p><table><thead><tr><th>ç‰ˆæœ¬åç§°</th><th>ä»‹ç»</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Alpha</td><td>å†…æµ‹ç‰ˆæœ¬</td><td>å†…éƒ¨æµ‹è¯•ç‰ˆæœ¬ã€‚</td></tr><tr><td>Beta</td><td>å…¬æµ‹ç‰ˆæœ¬</td><td>Beta é˜¶æ®µä¼šä¸€ç›´åŠ å…¥æ–°çš„åŠŸèƒ½ã€‚</td></tr><tr><td>RC</td><td>å€™é€‰ç‰ˆæœ¬</td><td>å‡ ä¹å°±ä¸ä¼šåŠ å…¥æ–°çš„åŠŸèƒ½äº†ï¼Œè€Œä¸»è¦ç€é‡äºé™¤é”™ã€‚</td></tr><tr><td>Release</td><td>æ­£å¼ç‰ˆæœ¬</td><td>ç¨³å®šç‰ˆæœ¬ã€‚</td></tr></tbody></table><p>RC ç‰ˆæœ¬å’Œ Beta ç‰ˆæœ€å¤§çš„å·®åˆ«åœ¨äº Beta é˜¶æ®µä¼š<strong>ä¸€ç›´åŠ å…¥æ–°çš„åŠŸèƒ½</strong>ï¼Œä½†æ˜¯åˆ°äº† RC é˜¶æ®µï¼Œå‡ ä¹å°±ä¸ä¼šåŠ å…¥æ–°çš„åŠŸèƒ½äº†ï¼Œè€Œä¸»è¦ç€é‡äº<strong>é™¤é”™</strong>ã€‚</p><p>RC ç‰ˆæœ¬ï¼Œå®ƒä¸æ˜¯æœ€ç»ˆçš„ç‰ˆæœ¬ï¼Œè€Œæ˜¯æœ€ç»ˆç‰ˆï¼ˆRTMï¼ŒRelease To Manufactureï¼‰ä¹‹å‰çš„æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚å¹¿ä¹‰ä¸Šå¯¹æµ‹è¯•æœ‰ä¸‰ä¸ªä¼ ç»Ÿçš„ç§°å‘¼ï¼šAlphaï¼ˆÎ±ï¼‰ã€Betaï¼ˆÎ²ï¼‰ã€Gammaï¼ˆÎ³ï¼‰ï¼Œç”¨æ¥æ ‡è¯†æµ‹è¯•çš„é˜¶æ®µå’ŒèŒƒå›´ã€‚Alpha æ˜¯æŒ‡å†…æµ‹ï¼Œå³ç°åœ¨è¯´çš„ CBï¼ŒæŒ‡å¼€å‘å›¢é˜Ÿå†…éƒ¨æµ‹è¯•çš„ç‰ˆæœ¬æˆ–è€…æœ‰é™ç”¨æˆ·ä½“éªŒæµ‹è¯•ç‰ˆæœ¬ã€‚Beta æ˜¯æŒ‡å…¬æµ‹ï¼Œå³é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·å…¬å¼€çš„æµ‹è¯•ç‰ˆæœ¬ã€‚ç„¶ååšè¿‡ä¸€äº›ä¿®æ”¹ï¼Œæˆä¸ºæ­£å¼å‘å¸ƒçš„å€™é€‰ç‰ˆæœ¬æ—¶å«åš Gammaï¼Œç°åœ¨å«åš RCã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ï¼š ç”¨ä¸€ç»„ç®€å•çš„è§„åˆ™åŠæ¡ä»¶æ¥çº¦æŸç‰ˆæœ¬å·çš„é…ç½®å’Œå¢é•¿&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½œä¸ºä¸€ä½è´Ÿè´£ä»»çš„å¼€å‘è€…ï¼Œä½ ç†å½“ç¡®ä¿æ¯æ¬¡åŒ…å‡çº§çš„è¿ä½œä¸ç‰ˆæœ¬å·çš„è¡¨è¿°ä¸€è‡´ã€‚ç°å®ä¸–ç•Œæ˜¯å¤æ‚çš„ï¼Œæˆ‘ä»¬é™¤äº†æé«˜è­¦è§‰å¤–èƒ½åšçš„ä¸å¤šã€‚ä½ æ‰€èƒ½åšçš„å°±æ˜¯è®©è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ä¸ºä½ æä¾›ä¸€ä¸ªå¥å…¨
      
    
    </summary>
    
    
      <category term="è®¡ç®—æœºåŸºç¡€çŸ¥è¯†" scheme="https://nymrli.top/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>Springboot-Kotlin-Mockito</title>
    <link href="https://nymrli.top/2022/01/03/Springboot-Kotlin-Mockito/"/>
    <id>https://nymrli.top/2022/01/03/Springboot-Kotlin-Mockito/</id>
    <published>2022-01-03T09:19:10.000Z</published>
    <updated>2022-01-03T10:50:45.305Z</updated>
    
    <content type="html"><![CDATA[<p>åˆè¯† Mockito è¿™ä¸ªæµ‹è¯•æ¡†æ¶åï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ Mock çš„å±æ€§åˆ›å»ºä¸€ä¸ªè¢«æµ‹è¯•ç±»å®ä¾‹æ—¶ï¼Œå¤§æ¦‚ä¼šä¸‹é¢è¿™ä¹ˆçº¯æ‰‹å·¥æ¥æ‰“é€ ã€‚</p><p>æ‰‹å·¥è¿‡ç¨‹è§: <a href="https://www.jianshu.com/p/bb705a56f620" target="_blank" rel="noopener">https://www.jianshu.com/p/bb705a56f620</a></p><p>å¦‚æœæ‰€æœ‰çš„ Mock å¯¹è±¡å…¨éƒ¨é€šè¿‡æ‰‹å·¥æ¥åˆ›å»ºï¼Œé‚£å°±ä¸å®¹æ˜“ä½“ç°å‡º Mockito çš„ä¼˜è¶Šæ€§å‡ºæ¥ã€‚å› æ­¤å¯¹äºè¢«æµ‹è¯•å¯¹è±¡çš„åˆ›å»ºï¼ŒMock å±æ€§çš„æ³¨å…¥åº”è¯¥è®© @Mock å’Œ @InjectMocksè¿™ä¸¤ä¸ªæ³¨è§£å¤§æ˜¾èº«æ‰‹äº†ã€‚</p><h2 id="mockitoèƒ½åŠ›"><a class="markdownIt-Anchor" href="#mockitoèƒ½åŠ›"></a> Mockitoèƒ½åŠ›</h2><ul><li>@Mockï¼šå¯¹å‡½æ•°çš„è°ƒç”¨å‡æ‰§è¡Œmockï¼ˆå³è™šå‡å‡½æ•°ï¼‰ï¼Œä¸æ‰§è¡ŒçœŸæ­£éƒ¨åˆ†ã€‚</li><li>@Spyï¼šå¯¹å‡½æ•°çš„è°ƒç”¨å‡æ‰§è¡ŒçœŸæ­£éƒ¨åˆ†ã€‚</li><li>@InjectMocksï¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå…¶ä½™ç”¨@Mockï¼ˆæˆ–@Spyï¼‰æ³¨è§£åˆ›å»ºçš„mockå°†è¢«æ³¨å…¥åˆ°ç”¨è¯¥å®ä¾‹ä¸­ã€‚</li></ul><p>@Autowird æ–¹å¼æ˜¯åŸºäºSpringbootæ¡†æ¶å¯åŠ¨çš„è‡ªåŠ¨æ³¨å…¥ã€‚åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œå¦‚æœæ²¡æœ‰å¯åŠ¨ spring æ¡†æ¶ï¼Œæ­¤æ—¶å°±éœ€è¦é€šè¿‡ @ InjectMockså®Œæˆä¾èµ–æ³¨å…¥ï¼š @InjectMocksä¼šå°†å¸¦æœ‰@Spy å’Œ@Mock æ³¨è§£çš„å¯¹è±¡å°è¯•æ³¨å…¥åˆ°è¢« æµ‹è¯•çš„ç›®æ ‡ç±»ä¸­ã€‚è®°ä½ä¸‹é¢è¿™ä¸¤å¥è¯å³å¯ï¼š</p><ul><li>Usually when you are unit testing, you shouldnâ€™t initialize Spring context. So remove Autowiring.</li><li>Usually when you do integration testing, you should use real dependencies. So remove mocking.</li></ul><p>è¿™è¾¹ä¹Ÿè§£é‡Šäº†ï¼Œ<code>@RunWith(MockitoJUnitRunner::class)</code>çš„å«ä¹‰ï¼Œå…¶å®æ˜¯ç»™ä¸‹é¢Mockitoæ³¨å…¥çš„æˆå‘˜æä¾›ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨<code>@SpringBootTest</code>çš„åŸå› ä¸»è¦è¿˜æ˜¯å¯åŠ¨å¤ªå¤šï¼Œè¿è¡Œå¤ªé‡çš„è€ƒè™‘ã€‚é‚£ä»€ä¹ˆæ—¶å€™å¾—ç”¨<code>@SpringBootTest</code>å‘¢ï¼Ÿâ€”â€”æœ€ç®€å•çš„æƒ…å†µï¼Œå³è¦æ³¨å…¥controlleråˆè¦æ³¨å…¥serviceï¼ŒåŒæ—¶éœ€è¦<code>@mock</code>å­˜å‚¨å±‚çš„repositoryï¼Œç”±äºcontrollerå’Œserviceéƒ½éœ€è¦æ ‡æ³¨<code>@InjectMocks</code>, ä½†<strong>InjectMockså­—æ®µæ˜¯æ— æ³•æ³¨å…¥å…¶ä»–InjectMockså­—æ®µçš„</strong>ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨Springæ¥åšå®¹å™¨ç®¡ç†ã€‚</p><h2 id="mockå’ŒmockbeanåŒºåˆ«"><a class="markdownIt-Anchor" href="#mockå’ŒmockbeanåŒºåˆ«"></a> <code>@Mock</code>å’Œ<code>@MockBean</code>åŒºåˆ«</h2><p><strong>MockBean</strong>çš„ä»‹ç»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åœ¨åšå•å…ƒæµ‹è¯•æ—¶ï¼Œå¦‚æœæƒ³è¦ mock UserRepository çš„é€»è¾‘ï¼Œåªéœ€è¦å£°æ˜ä¸€ä¸ªå˜é‡å¹¶åœ¨ä¸Šé¢åŠ ä¸Š @MockBean çš„æ³¨é‡Šå³å¯ï¼Œ</span><br><span class="line">ä¹‹åä½¿ç”¨ when().thenReturn() æ¥è®¾å®š mock UserRepository çš„è¡Œä¸ºã€‚</span><br><span class="line">åœ¨è¿è¡Œæ—¶ SpringBoot ä¼šæ‰«æåˆ°ä½ æ³¨é‡Šçš„ mock ï¼Œå¹¶è‡ªåŠ¨è£…é…åˆ°è¢«æµ‹è¯•çš„ controller é‡Œé¢ã€‚</span><br><span class="line">è¿™ä¹Ÿæ˜¯å’Œ @Mock æ³¨é‡Šä¸åŒçš„åœ°æ–¹ï¼Œåè€…åªèƒ½ç”Ÿæˆä¸€ä¸ª Mock ç±»ï¼Œä½†æ˜¯å¹¶ä¸èƒ½è‡ªåŠ¨è£…é…åˆ°å…¶å®ƒç±»é‡Œé¢ã€‚</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œ<code>@Mock</code>æ–¹ä¾¿æ¥åšå•å…ƒæµ‹è¯•ï¼Œ<code>@MockBean</code>å¤§å¤šç”¨æ¥åšæœ‰ä¾èµ–å…³ç³»çš„é›†æˆæµ‹è¯•</p><h2 id="vertify"><a class="markdownIt-Anchor" href="#vertify"></a> vertify</h2><blockquote><p>éªŒè¯è¡Œä¸ºæ˜¯å¦å‘ç”Ÿ</p></blockquote><p><strong>verifyæ–¹æ³•ç”¨äºéªŒè¯ mock bean çš„æ–¹æ³•è°ƒç”¨ï¼Œè¦æ±‚å¿…é¡»æ˜¯mockå¯¹è±¡</strong></p><ul><li><code>Mockito . *verify* (mockBean ).someMethod();</code>è¡¨ç¤ºï¼šsomeMethodæ–¹æ³•è°ƒç”¨äº†ä¸€æ¬¡ï¼Œç›¸å½“äºtimes(1)</li><li><code>Mockito . *verify* (mock Bean, Mockito.times(n) ).someMethod();</code>è¡¨ç¤ºï¼šsomeMethodæ–¹æ³•è°ƒç”¨äº†næ¬¡</li><li><code>Mockito . *verify* (mock Bean, Mockito.never() ).someMethod();</code>è¡¨ç¤ºï¼šsomeMethodæ–¹æ³•æœªæ‰§è¡Œ</li><li><code>Mockito . *verify* (mock Bean, Mockito. atLeastOnce() ).someMethod();</code>è¡¨ç¤ºï¼šsomeMethodæ–¹æ³•è‡³å°‘æ‰§è¡Œè¿‡ä¸€æ¬¡,ç›¸å½“äºatLeast(1)</li></ul><p><strong>éœ€è¦æ³¨æ„çš„ï¼š</strong><code>Mockito.*verify* (mock Bean, Mockito.only() ).someMethod();</code>è¡¨ç¤ºï¼š <strong>ä»…æœ‰someMethodæ–¹æ³•æ‰§è¡Œï¼Œä¸”åªæœ‰ä¸€æ¬¡ï¼Œä¸èƒ½æœ‰å…¶ä»–æ–¹æ³•æ‰§è¡Œ</strong></p><p>more: <a href="https://www.jianshu.com/p/0e6a868b9da0" target="_blank" rel="noopener">https://www.jianshu.com/p/0e6a868b9da0</a></p><h2 id="å¸¸ç”¨çš„-mockito-æ–¹æ³•"><a class="markdownIt-Anchor" href="#å¸¸ç”¨çš„-mockito-æ–¹æ³•"></a> å¸¸ç”¨çš„ Mockito æ–¹æ³•ï¼š</h2><p>Mockitoçš„ä½¿ç”¨ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§ç»„åˆï¼šå‚è€ƒé“¾æ¥</p><p>do/whenï¼šåŒ…æ‹¬doThrow(â€¦).when(â€¦)/doReturn(â€¦).when(â€¦)/doAnswer(â€¦).when(â€¦)<br>given/willï¼šåŒ…æ‹¬given(â€¦).willReturn(â€¦)/given(â€¦).willAnswer(â€¦)<br>when/then: åŒ…æ‹¬when(â€¦).thenReturn(â€¦)/when(â€¦).thenAnswer(â€¦)</p><table><thead><tr><th><strong>æ–¹æ³•å</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>Mockito.mock(classToMock)</td><td>æ¨¡æ‹Ÿå¯¹è±¡</td></tr><tr><td>Mockito.verify(mock)</td><td>éªŒè¯è¡Œä¸ºæ˜¯å¦å‘ç”Ÿ</td></tr><tr><td>Mockito.when(methodCall).thenReturn(value1).thenReturn(value2)</td><td>è§¦å‘æ—¶ç¬¬ä¸€æ¬¡è¿”å›value1ï¼Œç¬¬næ¬¡éƒ½è¿”å›value2</td></tr><tr><td>Mockito.doThrow(toBeThrown).when(mock).[method]</td><td>æ¨¡æ‹ŸæŠ›å‡ºå¼‚å¸¸ã€‚</td></tr><tr><td>Mockito.mock(classToMock,defaultAnswer)</td><td>ä½¿ç”¨é»˜è®¤Answeræ¨¡æ‹Ÿå¯¹è±¡</td></tr><tr><td>Mockito.when(methodCall).thenReturn(value)</td><td>å‚æ•°åŒ¹é…</td></tr><tr><td>Mockito.doReturn(toBeReturned).when(mock).[method]</td><td>å‚æ•°åŒ¹é…ï¼ˆç›´æ¥æ‰§è¡Œä¸åˆ¤æ–­ï¼‰</td></tr><tr><td>Mockito.when(methodCall).thenAnswer(answer))</td><td>é¢„æœŸå›è°ƒæ¥å£ç”ŸæˆæœŸæœ›å€¼</td></tr><tr><td>Mockito.doAnswer(answer).when(methodCall).[method]</td><td>é¢„æœŸå›è°ƒæ¥å£ç”ŸæˆæœŸæœ›å€¼ï¼ˆç›´æ¥æ‰§è¡Œä¸åˆ¤æ–­ï¼‰</td></tr><tr><td>Mockito.spy(Object)</td><td>ç”¨spyç›‘æ§çœŸå®å¯¹è±¡,è®¾ç½®çœŸå®å¯¹è±¡è¡Œä¸º</td></tr><tr><td>Mockito.doNothing().when(mock).[method]</td><td>ä¸åšä»»ä½•è¿”å›</td></tr><tr><td>Mockito.doCallRealMethod().when(mock).[method] <a href="//xn--Mockito-lr4ko4ay553a.when">//ç­‰ä»·äºMockito.when</a>(mock.[method]).thenCallRealMethod();</td><td>è°ƒç”¨çœŸå®çš„æ–¹æ³•</td></tr><tr><td>reset(mock)</td><td>é‡ç½®mock</td></tr></tbody></table><h2 id="matchers"><a class="markdownIt-Anchor" href="#matchers"></a> Matchers</h2><ul><li><p>åŒ¹é…ä»»æ„å‚æ•°</p></li><li><p><code>Mockito.anyInt()</code> ä»»ä½• int å€¼ ï¼›</p></li><li><p><code>Mockito.anyLong()</code> ä»»ä½• long å€¼ ï¼›</p></li><li><p><code>Mockito.anyString()</code> ä»»ä½• String å€¼ ï¼›</p></li><li><p><code>Mockito.any(XXX.class)</code> ä»»ä½• XXX ç±»å‹çš„å€¼ ç­‰ç­‰ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">with_unspecified_arguments</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List list = Mockito.mock(List.class);</span><br><span class="line">    <span class="comment">//åŒ¹é…ä»»æ„å‚æ•°</span></span><br><span class="line">    Mockito.when(list.get(Mockito.anyInt())).thenReturn(<span class="number">1</span>);</span><br><span class="line">    Mockito.when(list.contains(Mockito.argThat(<span class="keyword">new</span> IsValid()))).thenReturn(<span class="keyword">true</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>,list.get(<span class="number">1</span>));</span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>,list.get(<span class="number">999</span>));</span><br><span class="line">    Assert.assertTrue(list.contains(<span class="number">1</span>));</span><br><span class="line">    Assert.assertTrue(!list.contains(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IsValid</span> <span class="keyword">extends</span> <span class="title">ArgumentMatcher</span>&lt;<span class="title">List</span>&gt;</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> obj.equals(<span class="number">1</span>) || obj.equals(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Moreï¼š</p><table><thead><tr><th style="text-align:left">å‡½æ•°å</th><th style="text-align:left">åŒ¹é…ç±»å‹</th></tr></thead><tbody><tr><td style="text-align:left">any()</td><td style="text-align:left">æ‰€æœ‰å¯¹è±¡ç±»å‹</td></tr><tr><td style="text-align:left">anyInt()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ intã€é null çš„ Integer ç±»å‹</td></tr><tr><td style="text-align:left">anyChar()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ charã€é null çš„ Character ç±»å‹</td></tr><tr><td style="text-align:left">anyShort()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ shortã€é null çš„ Short ç±»å‹</td></tr><tr><td style="text-align:left">anyBoolean()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ booleanã€é null çš„ Boolean ç±»å‹</td></tr><tr><td style="text-align:left">anyDouble()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ doubleã€é null çš„ Double ç±»å‹</td></tr><tr><td style="text-align:left">anyFloat()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ floatã€é null çš„ Float ç±»å‹</td></tr><tr><td style="text-align:left">anyLong()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ longã€é null çš„ Long ç±»å‹</td></tr><tr><td style="text-align:left">anyByte()</td><td style="text-align:left">åŸºæœ¬ç±»å‹ byteã€é null çš„ Byte ç±»å‹</td></tr><tr><td style="text-align:left">anyString()</td><td style="text-align:left">String ç±»å‹(ä¸èƒ½æ˜¯ null)</td></tr><tr><td style="text-align:left">anyList()</td><td style="text-align:left">List<t> ç±»å‹(ä¸èƒ½æ˜¯ null)</t></td></tr><tr><td style="text-align:left">anyMap()</td><td style="text-align:left">Map&lt;K, V&gt;ç±»å‹(ä¸èƒ½æ˜¯ null)</td></tr></tbody></table><h1 id="é™„å½•"><a class="markdownIt-Anchor" href="#é™„å½•"></a> é™„å½•</h1><h2 id="junitä¸­çš„åŸºæœ¬æ³¨è§£"><a class="markdownIt-Anchor" href="#junitä¸­çš„åŸºæœ¬æ³¨è§£"></a> Junitä¸­çš„åŸºæœ¬æ³¨è§£ï¼š</h2><p>@Testï¼šä½¿ç”¨è¯¥æ³¨è§£æ ‡æ³¨çš„public voidæ–¹æ³•ä¼šè¡¨ç¤ºä¸ºä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼›<br>@BeforeClassï¼šè¡¨ç¤ºåœ¨ç±»ä¸­çš„ä»»æ„public static voidæ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼›<br>@AfterClassï¼šè¡¨ç¤ºåœ¨ç±»ä¸­çš„ä»»æ„public static voidæ–¹æ³•ä¹‹åæ‰§è¡Œï¼›<br>@Beforeï¼šè¡¨ç¤ºåœ¨ä»»æ„ä½¿ç”¨@Testæ³¨è§£æ ‡æ³¨çš„public voidæ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼›<br>@Afterï¼šè¡¨ç¤ºåœ¨ä»»æ„ä½¿ç”¨@Testæ³¨è§£æ ‡æ³¨çš„public voidæ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼›</p><p>demoï¼š</p><ul><li><a href="https://github.com/enesacikoglu/SpringBootKotlinApi/blob/master/src/test/kotlin/com/cengenes/kotlin/api/service/HotelServiceManagerTest.kt" target="_blank" rel="noopener">https://github.com/enesacikoglu/SpringBootKotlinApi/blob/master/src/test/kotlin/com/cengenes/kotlin/api/service/HotelServiceManagerTest.kt</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åˆè¯† Mockito è¿™ä¸ªæµ‹è¯•æ¡†æ¶åï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ Mock çš„å±æ€§åˆ›å»ºä¸€ä¸ªè¢«æµ‹è¯•ç±»å®ä¾‹æ—¶ï¼Œå¤§æ¦‚ä¼šä¸‹é¢è¿™ä¹ˆçº¯æ‰‹å·¥æ¥æ‰“é€ ã€‚&lt;/p&gt;
&lt;p&gt;æ‰‹å·¥è¿‡ç¨‹è§: &lt;a href=&quot;https://www.jianshu.com/p/bb705a56f620&quot; target=&quot;_blank
      
    
    </summary>
    
    
      <category term="å¼€å‘ç¬”è®°" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£SpringBootæ³¨è§£s</title>
    <link href="https://nymrli.top/2021/12/30/%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s/"/>
    <id>https://nymrli.top/2021/12/30/ç†è§£SpringBootæ³¨è§£s/</id>
    <published>2021-12-30T12:30:45.000Z</published>
    <updated>2021-12-30T14:25:40.982Z</updated>
    
    <content type="html"><![CDATA[<h2 id="reuqestbodyå’Œrequestparam"><a class="markdownIt-Anchor" href="#reuqestbodyå’Œrequestparam"></a> @ReuqestBodyå’Œ@RequestParam</h2><p>è¿™ä¸¤ä¸ªæ³¨è§£éƒ½æ˜¯åœ¨ControlleræŸä¸ªMappingå‡½æ•°çš„å½¢å‚å‰åŠ ä¸Šçš„ï¼Œä½†ä¸¤ä¸ªå…·ä½“æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿåœ¨ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬è¯¥å¦‚ä½•é€‰æ‹©å‘¢? è¿™è·Ÿæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·ä»¥ä»€ä¹ˆå½¢å¼æ¥è¯·æ±‚æ¥å£æœ‰å…³ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè¯·æ±‚å¤´çš„Content-typeæœ‰å¤šä¸ªï¼Œå¦‚</p><p>å¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š</p><ul><li>text/html ï¼š HTMLæ ¼å¼</li><li>text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼</li><li>text/xml ï¼š XMLæ ¼å¼</li><li>image/gif ï¼šgifå›¾ç‰‡æ ¼å¼</li><li>image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼</li><li>image/pngï¼špngå›¾ç‰‡æ ¼å¼</li></ul><p>ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š</p><ul><li>application/xhtml+xml ï¼šXHTMLæ ¼å¼</li><li>application/xmlï¼š XMLæ•°æ®æ ¼å¼</li><li>application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼</li><li>â­ï¸application/jsonï¼š JSONæ•°æ®æ ¼å¼</li><li>application/pdfï¼špdfæ ¼å¼</li><li>application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼</li><li>application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰</li><li>â­ï¸application/x-www-form-urlencoded ï¼š<code>&lt;form encType=&quot;&quot;&gt;</code>ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰</li></ul><p>å¦å¤–ä¸€ç§å¸¸è§çš„åª’ä½“æ ¼å¼æ˜¯ä¸Šä¼ æ–‡ä»¶ä¹‹æ—¶ä½¿ç”¨çš„ï¼š</p><ul><li>multipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼</li></ul><p>å…¶ä¸­ï¼ŒPOSTè¯·æ±‚æœ€å¸¸ç”¨çš„æ˜¯<code>application/x-www-form-urlencoded</code>,æµè§ˆå™¨çš„åŸç”Ÿ form è¡¨å•ï¼Œå¦‚æœä¸è®¾ç½® enctype å±æ€§ï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šä»¥ application/x-www-form-urlencoded æ–¹å¼æäº¤æ•°æ®ã€‚æ•°æ®æŒ‰ç…§ key1=val1&amp;key2=val2 çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œkey å’Œ val éƒ½è¿›è¡Œäº† URL è½¬ç ã€‚è¯·æ±‚ç±»ä¼¼äºä¸‹é¢è¿™æ ·</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-www.png" alt="post-www"></p><p>æ­¤å¤–ï¼Œ<code>application/json</code>ä¹Ÿæ˜¯POSTæ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å½¢å¼ï¼Œä¹Ÿæ˜¯ç›®å‰æ¯”è¾ƒæ¨èçš„ï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²ã€‚åœ¨è¿™ç§ç¼–ç æ–¹å¼ä¸‹ï¼Œè¯·æ±‚å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-json.png" alt="post-json"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯å“ªç§ç¼–ç ï¼ŒPOSTåŸºæœ¬ä¸Šéƒ½æ˜¯ä»è¯·æ±‚ä½“ä¸­å–æ•°æ®è§£æçš„ã€‚è€Œ<code>@RequestBody</code>æ­£æ˜¯å¯¹åº”çš„è¯·æ±‚ä½“ï¼›<code>@RequestParam</code>å‘¢ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯<strong>æ¥è‡ªrequestHeader</strong>ä¸­ï¼Œå³<strong>è¯·æ±‚å¤´</strong>ã€‚<strong>é€šå¸¸ç”¨äºGETè¯·æ±‚</strong>ï¼ŒåŠŸèƒ½æ˜¯<em>ä»URLä¸­æå–è¯·æ±‚å‚æ•°</em>ã€‚æ¯”å¦‚å¸¸è§çš„urlï¼š<code>http://localhost:8081/spring-boot-study/novel/findByAuthorAndType?author=å”å®¶ä¸‰å°‘&amp;type=å·²å®Œç»“</code>ã€‚å¯¹åº”çš„æ¥å£ä¸º<code>public List&lt;NovelEntity&gt; findByAuthorAndType(@RequestParam(value=&quot;author&quot;, required=false,defaultValue=&quot;å¤©èš•åœŸè±†&quot;) String author, @RequestParam(value=&quot;type&quot;) String type)</code></p><p>@RequestParamæœ‰ä¸‰ä¸ªé…ç½®å‚æ•°ï¼š</p><ul><li><code>required</code> è¡¨ç¤ºæ˜¯å¦å¿…é¡»ï¼Œé»˜è®¤ä¸º <code>true</code>ï¼Œå¿…é¡»ã€‚</li><li><code>defaultValue</code> å¯è®¾ç½®è¯·æ±‚å‚æ•°çš„é»˜è®¤å€¼ã€‚</li><li><code>value</code> ä¸ºæ¥æ”¶urlå‚æ•°çš„å‚æ•°åï¼ˆç›¸å½“äºkeyå€¼ï¼‰ã€‚</li></ul><p><strong>@RequestParamç”¨æ¥å¤„ç† <code>Content-Type</code> ä¸º <code>application/x-www-form-urlencoded</code> ç¼–ç çš„å†…å®¹ï¼Œ<code>Content-Type</code>é»˜è®¤ä¸ºè¯¥å±æ€§ã€‚</strong></p><p><strong>@RequestParamä¹Ÿå¯ç”¨äºå…¶å®ƒç±»å‹çš„è¯·æ±‚ï¼Œä¾‹å¦‚ï¼šGETã€POSTã€DELETEç­‰è¯·æ±‚</strong>ã€‚æ¯”å¦‚å‘è¡¨ä¸­æ’å…¥å•æ¡æ•°æ®ï¼Œ<code>Controller</code> å±‚çš„å†™æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>ä½†æ˜¯ï¼Œè¿™æ ·ä¸æ”¯æŒæ‰¹é‡æ’å…¥æ•°æ®ï¼Œç›¸å¯¹ä¹‹ä¸‹ï¼Œjsonæ¥è¡¨è¾¾çš„ä¼˜åŠ¿å°±å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯@RequestParamæ²¡åŠæ³•å¤„ç†<code>application/json</code>ï¼Œç‚¹å‡»å‘é€çš„è¯ï¼Œä¼šæŠ¥é”™åå°æ¥æ”¶ä¸åˆ°å€¼ï¼Œä¸º <code>null</code>ã€‚</p><p>æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨å¯¹åº”çš„<code>@RequestBody</code>ï¼Œå®ƒä¸€èˆ¬ç”¨äºå¤„ç†é <code>Content-Type: application/x-www-form-urlencoded</code>ç¼–ç æ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚ï¼š<code>application/json</code>ã€<code>application/xml</code>ç­‰ç±»å‹çš„æ•°æ®ã€‚å°±<code>application/json</code>ç±»å‹çš„æ•°æ®è€Œè¨€ï¼Œä½¿ç”¨æ³¨è§£@RequestBodyå¯ä»¥å°†bodyé‡Œé¢æ‰€æœ‰çš„jsonæ•°æ®ä¼ åˆ°åç«¯ï¼Œåç«¯å†è¿›è¡Œè§£æã€‚å¦‚<code>public Map&lt;String, Boolean&gt; saveBatchNovel(@RequestBody List&lt;NovelEntity&gt; novelEntityList)</code></p><p>æ­¤å¤–ï¼Œé’ˆå¯¹å¸Œæœ›ç”¨æˆ·ä¼ å…¥çš„ä¸ºæŒ‡å®šå‚æ•°çš„è¯ï¼Œæœ‰ç›¸åº”çš„Entityï¼Œä½¿ç”¨@RequestBodyä¼šæ ¹æ®è¯·æ±‚ä¸»ä½“ä¸­çš„å‚æ•°åä¸å¯¹è±¡çš„å±æ€§åè¿›è¡ŒåŒ¹é…å¹¶ç»‘å®šå€¼ï¼Œè‡ªåŠ¨å°†å‚æ•°å°è£…æˆè¯¥å¯¹è±¡ï¼Œå¹¶ä¸”è¿˜å¯ä»¥é€šè¿‡@Validæ³¨è§£å¯¹è¯·æ±‚ä¸»ä½“ä¸­çš„å‚æ•°è¿›è¡Œæ ¡éªŒã€‚</p><p>æ€»ç»“ï¼š</p><ul><li><code>@RequestParam</code>çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯<em>ä»URLä¸­æå–è¯·æ±‚å‚æ•°</em>ï¼Œå³æ¥æ”¶çš„å‚æ•°æ˜¯æ¥è‡ªHTTPè¯·æ±‚å¤´çš„QueryStringä¸­ã€‚</li><li><code>@RequestBody</code>åŠŸèƒ½æ˜¯ä»è¯·æ±‚ä½“é‡æå–å‚æ•°ï¼Œå¹¶å°è£…æˆå¯¹è±¡</li></ul><p>é¢å¤–ç»éªŒæ€»ç»“ï¼š</p><blockquote><p>æ ‡å‡†åè®®ä¸‹ï¼Œé€šå¸¸è®¤ä¸ºGETè¯·æ±‚æ˜¯æ²¡æœ‰è¯·æ±‚ä½“çš„ï¼Œåªæœ‰POSTè¯·æ±‚æœ‰è¯·æ±‚ä½“</p></blockquote><ul><li><p>getè¯·æ±‚åªèƒ½ä¼ queryå‚æ•°ï¼Œqueryå‚æ•°éƒ½æ˜¯æ‹¼åœ¨è¯·æ±‚åœ°å€ä¸Šçš„</p></li><li><p>postå¯ä»¥åŒæ—¶ä¼ bodyå’Œqueryä¸¤ç§å½¢å¼çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/post/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">postHello</span><span class="params">(@PathVariable Long id,</span></span></span><br><span class="line"><span class="function"><span class="params">                                         @RequestParam(value = <span class="string">"name"</span>, required = <span class="keyword">false</span>, defaultValue = <span class="string">"CL"</span>)</span> String name,</span></span><br><span class="line"><span class="function">                                         @RequestBody User user</span></span><br><span class="line"><span class="function">    ) </span>&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HashMap&lt;String, String&gt;() &#123;&#123;</span><br><span class="line">            put(<span class="string">"name"</span>, name);</span><br><span class="line">            put(<span class="string">"id"</span>, String.valueOf(id));</span><br><span class="line">        &#125;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>talent-API</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost-query+body.png" alt="post-query+body"></p><p>postman-web</p><p><img src="/2021/12/30/ç†è§£SpringBootæ³¨è§£s/E:%5Chexo%5Csource_posts%5C%E7%90%86%E8%A7%A3SpringBoot%E6%B3%A8%E8%A7%A3s%5Cpost+body+query2.png" alt="post+body+query2"></p><p>é’ˆå¯¹æ¥å£çš„æµ‹è¯•ï¼Œæœ€å¥½è¿˜æ˜¯æ‰‹åŠ¨è®¾ç½®Content-typeæ¯”è¾ƒå¥½</p></li></ul><p><strong>@PathVariable</strong></p><blockquote><p>æ‰¿æ¥ä¸Šæ–‡ï¼ŒåŒæ ·ä½œä¸ºå‚æ•°ä¼ å…¥çš„è¿˜æœ‰@PathVariableï¼Œå®ƒå¯ä»¥ä»URLä¸­æå–å˜é‡</p></blockquote><p><code>@PathVariable</code>æ³¨è§£æ˜¯å°†æ–¹æ³•ä¸­çš„å‚æ•°ç»‘å®šåˆ°è¯·æ±‚URIä¸­çš„æ¨¡æ¿å˜é‡ä¸Šã€‚å¯ä»¥é€šè¿‡<code>@RequestMapping</code>æ³¨è§£æ¥æŒ‡å®šURIçš„æ¨¡æ¿å˜é‡ï¼Œç„¶åä½¿ç”¨<code>@PathVariable</code>æ³¨è§£å°†æ–¹æ³•ä¸­çš„å‚æ•°ç»‘å®šåˆ°æ¨¡æ¿å˜é‡ä¸Šã€‚ç‰¹åˆ«åœ°ï¼Œ<code>@PathVariable</code>æ³¨è§£å…è®¸æˆ‘ä»¬ä½¿ç”¨valueæˆ–nameå±æ€§æ¥ç»™å‚æ•°å–ä¸€ä¸ªåˆ«åã€‚ä¸‹é¢æ˜¯ä½¿ç”¨æ­¤æ³¨è§£çš„ä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/users/&#123;id&#125;/roles/&#123;roleId&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Role <span class="title">getUserRole</span><span class="params">(@PathVariable <span class="keyword">long</span> id, @PathVariable <span class="keyword">long</span> roleId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿å˜é‡åéœ€è¦ä½¿ç”¨<code>{ }</code>è¿›è¡ŒåŒ…è£¹ï¼Œå¦‚æœæ–¹æ³•çš„å‚æ•°åä¸URIæ¨¡æ¿å˜é‡åä¸€è‡´ï¼Œåˆ™åœ¨<code>@PathVariable</code>ä¸­å°±å¯ä»¥çœç•¥åˆ«åçš„å®šä¹‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;reuqestbodyå’Œrequestparam&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#reuqestbodyå’Œrequestparam&quot;&gt;&lt;/a&gt; @ReuqestBodyå’Œ@RequestParam&lt;/h2&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ³¨
      
    
    </summary>
    
    
      <category term="å¼€å‘ç¬”è®°" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Springä¸­çš„Bean</title>
    <link href="https://nymrli.top/2021/12/30/Spring%E4%B8%AD%E7%9A%84Bean/"/>
    <id>https://nymrli.top/2021/12/30/Springä¸­çš„Bean/</id>
    <published>2021-12-30T02:46:34.000Z</published>
    <updated>2021-12-30T02:46:35.302Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°</title>
    <link href="https://nymrli.top/2021/12/29/SpringCloud%E7%AC%94%E8%AE%B0/"/>
    <id>https://nymrli.top/2021/12/29/SpringCloudç¬”è®°/</id>
    <published>2021-12-29T15:14:51.000Z</published>
    <updated>2021-12-30T14:29:21.107Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¬”è®°å†…å®¹å¤§å¤šæ¥è‡ªï¼š<a href="https://www.bilibili.com/video/BV18E411x7eT?p=8" target="_blank" rel="noopener">å°šç¡…è°·SpringCloudæ¡†æ¶å¼€å‘æ•™ç¨‹</a></p><p>è·Ÿåšç¬”è®°ï¼š<a href="https://blog.csdn.net/MOKEXFDGH/article/details/107209899" target="_blank" rel="noopener">https://blog.csdn.net/MOKEXFDGH/article/details/107209899</a></p><p>è·Ÿåšå·¥ç¨‹ä»£ç ï¼š <a href="https://github.com/liusCoding/springcloud-2020%E3%80%81https://gitee.com/exclusiver/springcloud2020" target="_blank" rel="noopener">https://github.com/liusCoding/springcloud-2020ã€https://gitee.com/exclusiver/springcloud2020</a></p></blockquote><h2 id="mvné…ç½®"><a class="markdownIt-Anchor" href="#mvné…ç½®"></a> <strong>MVNé…ç½®</strong></h2><ul><li><p>æ¯ä¸ªmoduleçš„pomé…ç½®æ–‡ä»¶ä¸­æœ€é‡è¦çš„ä¸‰ä¸ªï¼šGAVå³ <code>groupId</code>ã€<code>artifactId</code>ã€<code>version</code></p></li><li><p>dependencyManagementå£°æ˜ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥èµ·åˆ°ä½œç”¨ï¼š</p><ul><li><ol><li>çº¦å®šä¾èµ–çš„ç»Ÿä¸€ç‰ˆæœ¬</li><li>å­moduleä¸ç”¨å†™groupIdå’Œversion</li></ol><p>æ³¨ï¼šdependencyManagementåªæ˜¯å£°æ˜äº†ä¾èµ–çš„çº¦å®šï¼Œä½†æ˜¯åœ¨å­æ¨¡å—ä¸­ç¡®å®šè¦ä½¿ç”¨è¿™ä¸ªä¾èµ–æ—¶ï¼Œè¿˜æ˜¯éœ€è¦dependencyæŒ‡å‡ºï¼Œå³dependencyManagementåªæ˜¯<strong>å£°æ˜</strong>ï¼Œå¹¶æ²¡æœ‰å®é™…å¼•å…¥ã€‚æ­¤å¤–ï¼Œå¦‚æœå­æ¨¡å—æƒ³è¦æ‘†è„±çº¦å®šç‰ˆæœ¬çš„è¯ï¼Œå¯ä»¥é€šè¿‡ç‰¹åˆ«åˆ—å‡ºversionä»è€ŒæŒ‡å®šç‰ˆæœ¬</p></li></ul></li></ul><h2 id="ä¸šåŠ¡å¼€å‘æµç¨‹"><a class="markdownIt-Anchor" href="#ä¸šåŠ¡å¼€å‘æµç¨‹"></a> <strong>ä¸šåŠ¡å¼€å‘æµç¨‹</strong></h2><ol><li>å»ºè¡¨SQL</li><li>Entities</li><li>Dao</li><li>Service</li><li>Controller</li></ol><p>åˆ›å»ºmysqlæ•°æ®åº“ï¼š</p><ol><li>é€šè¿‡å›¾å½¢ç•Œé¢â€”â€”å­—ç¬¦é›†é€‰ utf8,  æ’åºè§„åˆ™é€‰  utf8_general_ci</li><li>é€šè¿‡SQL</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span>  <span class="string">`wordpress`</span> <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span>  <span class="string">`wordpress`</span> <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚æ¨¡æ‹Ÿ"><a class="markdownIt-Anchor" href="#è¯·æ±‚æ¨¡æ‹Ÿ"></a> <strong>è¯·æ±‚æ¨¡æ‹Ÿ</strong></h2><ul><li>æµè§ˆå™¨å¯¹POSTæ”¯æŒä¸å¤ªå‹å¥½ï¼Œéœ€è¦ä½¿ç”¨å¦‚PostManç­‰å·¥å…·ï¼šæµè§ˆå™¨è¾“å…¥<code>http://localhost:8001/create?serial=23</code>ï¼Œä¸€æ—¦æˆ´ä¸Šäº†è¿™ä¸ª<code>?xxx=yyy</code>çš„è¯·æ±‚å‚æ•°ï¼Œåˆ™ä¼šè¢«è®¤ä¸ºæ˜¯Getè¯·æ±‚</li></ul><h2 id="æ³¨è§£ä½¿ç”¨"><a class="markdownIt-Anchor" href="#æ³¨è§£ä½¿ç”¨"></a> <strong>æ³¨è§£ä½¿ç”¨</strong></h2><ul><li><code>@mapper</code>å¯¹åº”<code>@Resource</code>(javax.annotation)</li><li><code>@Repository</code>å¯¹åº”<code>@Autowired</code></li></ul><p>åœ¨Daoå±‚å®šä¹‰æ—¶ï¼Œæ¨èä½¿ç”¨<code>@Mapper</code>(apache.ibatis)ï¼Œè€Œä¸æ˜¯<code>@Repository</code>(org.springframework.stereotype)ï¼Œå› ä¸ºåè€…åœ¨æ’å…¥çš„æ—¶å€™å¯èƒ½ä¼šæœ‰é—®é¢˜</p><h2 id="æ·»åŠ çƒ­éƒ¨ç½²"><a class="markdownIt-Anchor" href="#æ·»åŠ çƒ­éƒ¨ç½²"></a> æ·»åŠ çƒ­éƒ¨ç½²</h2><ol><li><p>æ·»åŠ devtoolsä¾èµ–åˆ°å·¥ç¨‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨pomä¸­æŒ‡å®šæ·»åŠ æ’ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">fork</span>&gt;</span>true<span class="tag">&lt;/<span class="name">fork</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">addResources</span>&gt;</span>true<span class="tag">&lt;/<span class="name">addResources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>enabling automatic build</p><p><img src="/2021/12/29/SpringCloudç¬”è®°/E:%5Chexo%5Csource_posts%5CSpringCloud%E7%AC%94%E8%AE%B0%5C%E7%83%AD%E9%83%A8%E7%BD%B2%E8%AE%BE%E7%BD%AE.png" alt="çƒ­éƒ¨ç½²è®¾ç½®"></p></li><li><p>ä¿®æ”¹&quot;Updating Registrer&quot; ï¼ˆé€šè¿‡åœ¨pomæ–‡ä»¶ä¸­<code>ctrl+shift+alt+/</code>æŒ‰å‡ºmaintenanceï¼‰==&gt;IDEA2021ä¸­ä¸éœ€è¦è®¾ç½®äº†</p></li><li><p>é‡å¯IDEA</p></li></ol><p>æ³¨ï¼šä¸Šè¿°åªæ˜¯é‡å¯ï¼ŒJrebelæ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çƒ­éƒ¨ç½²</p><h2 id="resttemplate"><a class="markdownIt-Anchor" href="#resttemplate"></a> RestTemplate</h2><blockquote><p>Javaä¸­è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£APIæ—¶ï¼Œæ˜¯é€šè¿‡HttpClientåº“æ¥åˆ›å»ºè¯·æ±‚çš„ï¼›è€Œå¯¹äºé€šè¿‡åŸºäºHttpçš„Restfulå¾®æœåŠ¡æ¥å£ï¼ŒSpringbootæä¾›äº†ä¸€å¥—æ–¹æ³•: RestTemplate</p></blockquote><p>RestTemplatejæä¾›äº†å¤šç§ä¾¿æ·è®¿é—®è¿œç¨‹HttpæœåŠ¡çš„æ–¹æ³•ï¼Œæ˜¯â€”ç§ç®€å•ä¾¿æ·çš„è®¿é—® restfulæœåŠ¡æ¨¡æ¿ç±»ï¼Œæ˜¯ Springæä¾›çš„ç”¨äºè®¿é—®<strong>RestæœåŠ¡çš„å®¢æˆ·ç«¯</strong>æ¨¡æ¿å·¥å…·é›†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String PAYMENT_URL = <span class="string">"http://localhost:8001"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/create"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">create</span><span class="params">(Payment payment)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.postForObject(PAYMENT_URL + <span class="string">"/payment/create"</span>, payment, CommonResult.class);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºpostForObjectä¼šä»¥ application/jsonçš„å½¢å¼å‘é€æ•°æ®, æ‰€ä»¥åœ¨Paymentç³»ç»Ÿçš„æ¥å£ä¸­å¦‚æœä¸åŠ ä¸Š @RequestBody çš„è¯ï¼Œåˆ™æ— æ³•å°è£…æˆç›¸åº”çš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PaymentService paymentService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/create"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">create</span><span class="params">(@RequestBody  Payment payment)</span> </span>&#123;<span class="comment">// åŠ ä¸Š@RequestBodyæ³¨è§£</span></span><br><span class="line">        <span class="keyword">int</span> result = paymentService.create(payment);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨å†Œä¸­å¿ƒ"><a class="markdownIt-Anchor" href="#æ³¨å†Œä¸­å¿ƒ"></a> æ³¨å†Œä¸­å¿ƒ</h2><ul><li>æœåŠ¡æ³¨å†Œ:å°†æœåŠ¡ä¿¡æ¯æ³¨å†Œè¿›æ³¨å†Œä¸­å¿ƒ</li><li>æœåŠ¡å‘ç°:ä»æ³¨å†Œä¸­å¿ƒä¸Šè·å–æœåŠ¡ä¿¡æ¯å®è´¨:å­˜keyæœåŠ¡å‘½å–valueè°ƒç”¨åœ°å€</li></ul><h2 id="eurekaç¯å¢ƒæ­å»º"><a class="markdownIt-Anchor" href="#eurekaç¯å¢ƒæ­å»º"></a> eurekaç¯å¢ƒæ­å»º</h2><h3 id="æœåŠ¡ç«¯server"><a class="markdownIt-Anchor" href="#æœåŠ¡ç«¯server"></a> æœåŠ¡ç«¯server</h3><ol><li>åˆ›å»ºç›¸åº”çš„å·¥ç¨‹æˆ–è€…module</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka-server--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka-server--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ç¼–å†™yml</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  instance:</span></span><br><span class="line"><span class="attr">    hostname:</span> <span class="string">localhost</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line"><span class="attr">    register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># è‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line"><span class="attr">    fetch-registry:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span></span><br></pre></td></tr></table></figure><ol start="3"><li>ç»™applicationåŠ ä¸ŠEnableEurekaServerè‡ªåŠ¨æ³¨å…¥çš„æ³¨è§£ï¼Œå¹¶è¡¨æ˜æ˜¯eurekaæœåŠ¡ç«¯</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> MrLi</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-12-30 16:46</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaMain7001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(EurekaMain7001.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®¢æˆ·ç«¯client"><a class="markdownIt-Anchor" href="#å®¢æˆ·ç«¯client"></a> å®¢æˆ·ç«¯client</h3><blockquote><p>è™½ç„¶å«å®¢æˆ·ç«¯ï¼Œä½†å…¶å®æ˜¯ç›¸å¯¹äºeurekaæœåŠ¡è€Œè¨€çš„ï¼Œå¯¹äºæš´éœ²çš„rpcæœåŠ¡æ¥çœ‹ï¼Œä»–æ˜¯æ¥å£æœåŠ¡çš„æœåŠ¡ç«¯</p></blockquote><ol><li><p>åŠ pom</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å¢åŠ ymlé…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±, é»˜è®¤ä¸ºtrue</span></span><br><span class="line"><span class="attr">    register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># æ˜¯å¦ä»EurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueï¼›å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡</span></span><br><span class="line"><span class="attr">    fetch-registry:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line">      <span class="comment"># è®¾ç½®äºeurekaServeräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://localhost:7001/eureka</span></span><br></pre></td></tr></table></figure></li><li><p>applicaitonä¸ŠåŠ æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentMain8001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æœåŠ¡è¿è¡Œåœ¨ http://localhost:8001/"</span>);</span><br><span class="line">        SpringApplication.run(PaymentMain8001.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>ä¸ºäº†é˜²æ­¢å•ç‚¹æ•…éšœçš„é—®é¢˜ï¼Œè¿™è¾¹å¯ä»¥å¢åŠ ä¸€ä¸ªEurekaServerçš„å®ä¾‹ï¼Œä»è€Œç»„æˆEurekaServeré›†ç¾¤ï¼Œç›¸äº’æ³¨å†Œç›¸äº’å®ˆæœ›ã€‚</p><h3 id="é›†ç¾¤æ­å»º"><a class="markdownIt-Anchor" href="#é›†ç¾¤æ­å»º"></a> é›†ç¾¤æ­å»º</h3><ol><li>å…ˆå¯åŠ¨eurekaæ³¨å†Œä¸­å¿ƒ</li><li>å¯åŠ¨æœåŠ¡æä¾›è€…: paymentæ”¯ä»˜æœåŠ¡</li><li>æ”¯ä»˜æœåŠ¡å¯åŠ¨åä¼šæŠŠè‡ªèº«ä¿¡æ¯(æ¯”æœåŠ¡åœ°å€ä»¥<strong>åˆ«å</strong>æ–¹å¼æ³¨å†Œè¿›eureka)</li><li>æ¶ˆè´¹è€…orderæœåŠ¡åœ¨éœ€è¦è°ƒç”¨æ¥å£æ—¶,ä½¿ç”¨<strong>æœåŠ¡åˆ«å</strong>å»æ³¨å†Œä¸­å¿ƒè·å–å®é™…çš„RPCè¿œç¨‹è°ƒç”¨<strong>åœ°å€</strong></li><li>æ¶ˆè´¹è€…è·å¾—è°ƒç”¨åœ°å€å,åº•å±‚å®é™…æ˜¯åˆ©ç”¨<strong>HttpClient</strong>æœ¯å®ç°è¿œç¨‹è°ƒç”¨</li><li>æ¶ˆè´¹è€…è·å¾—æœåŠ¡åœ°å€åä¼šç¼“å­˜åœ¨æœ¬åœ°jvmå†…å­˜ä¸­,é»˜è®¤<em>æ¯é—´éš”30ç§’</em>æ›´æ–°ä¸€æ¬¡æœåŠ¡è°ƒç”¨åœ°å€</li></ol><blockquote><p>é—®é¢˜:å¾®æœåŠ¡RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æœ€æ ¸å¿ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>A: é«˜å¯ç”¨,è¯•æƒ³ä½ çš„æ³¨å†Œä¸­å¿ƒåªæœ‰ä¸€ä¸ªohly one,å®ƒå‡ºæ•…éšœäº†é‚£å°±å‘µå‘µäº†,è¿™ä¼šå¯¼è‡´æ•´ä¸ªä¸ºæœåŠ¡ç¯å¢ƒä¸å¯ç”¨ã€‚ æ‰€ä»¥è§£å†³åŠæ³•:æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤,å®ç°è´Ÿè½½å‡è¡¡+æ•…éšœå®¹é”™</p></blockquote><ol><li><p>åˆ›å»ºå¤šä¸ªeurekaå®ä¾‹å·¥ç¨‹oræ¨¡å—</p></li><li><p>ä¿®æ”¹hostsæ˜ å°„æ–‡ä»¶: C:\Windows\System32\drivers\etc\HOSTS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">127.0.0.1 eureka7001.com</span><br><span class="line">127.0.0.1 eureka7002.com</span><br></pre></td></tr></table></figure><p>è™½ç„¶eureka7001.comå’Œeureka7002.coméƒ½æŒ‡å‘çš„æ˜¯localhostï¼ŒçœŸæ­£åŒºåˆ†æœåŠ¡çš„æ˜¯é€šè¿‡åé¢çš„portã€‚ä½†ä»ç„¶è¿™ä¹ˆåšçš„ç›®çš„æ˜¯æ¨¡æ‹ŸçœŸå®æƒ…å†µï¼Œä¸ç„¶éƒ½æ˜¯localhostçš„è¯å¯¹ç”¨æˆ·è€Œè¨€ä¸å¥½åŒºåˆ†ã€‚</p></li><li><p>ä¿®æ”¹ymlé…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">7002</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  instance:</span></span><br><span class="line"><span class="attr">    hostname:</span> <span class="string">eureka7002.com</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line"><span class="attr">    register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># è‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line"><span class="attr">    fetch-registry:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line">      <span class="comment"># 7001æŒ‡å‘7002ï¼ˆå³åœ¨7002ä¸­æ³¨å†Œäº†7001çš„åœ°å€ï¼‰</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://eureka7001.com:7001/eureka/</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  instance:</span></span><br><span class="line"><span class="attr">    hostname:</span> <span class="string">eureka7001.com</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line"><span class="attr">    register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># è‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line"><span class="attr">    fetch-registry:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://eureka7002.com:7002/eureka/</span></span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªserverç›¸äº’å­˜äº†å¯¹æ–¹çš„åœ°å€ï¼Œç›¸äº’å®ˆæœ›ä»è€Œå®ç°é«˜å¯ç”¨</p></li></ol><p>åŒæ—¶è¿è¡Œä¸¤ä¸ªapplicationï¼Œç„¶åè¾“å…¥localhost:7001ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢ä¸­DS Replicasæ˜¾ç¤ºæœ‰7002ï¼Œæ‰“å¼€localhost:7002åŒæ ·èƒ½çœ‹åˆ°7001çš„DS Replicaså³é•œåƒ</p><h4 id="æœåŠ¡æ¥å…¥é›†ç¾¤"><a class="markdownIt-Anchor" href="#æœåŠ¡æ¥å…¥é›†ç¾¤"></a> æœåŠ¡æ¥å…¥é›†ç¾¤</h4><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ˜¯æŠŠé›†ç¾¤ä¸­çš„åœ°å€å…¨éƒ¨å¡«ä¸Š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±, é»˜è®¤ä¸ºtrue</span></span><br><span class="line"><span class="attr">    register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># æ˜¯å¦ä»EurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueï¼›å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡</span></span><br><span class="line"><span class="attr">    fetch-registry:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://eureka7001.com:7001/eureka,</span> <span class="attr">http://eureka7002.com:7002/eureka</span></span><br></pre></td></tr></table></figure><h3 id="æœåŠ¡è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#æœåŠ¡è´Ÿè½½å‡è¡¡"></a> æœåŠ¡è´Ÿè½½å‡è¡¡</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ç¬”è®°å†…å®¹å¤§å¤šæ¥è‡ªï¼š&lt;a href=&quot;https://www.bilibili.com/video/BV18E411x7eT?p=8&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å°šç¡…è°·SpringCloudæ¡†æ¶å¼€å‘æ•™ç¨‹&lt;/a&gt;&lt;/
      
    
    </summary>
    
    
      <category term="å¼€å‘ç¬”è®°" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ+PicGo</title>
    <link href="https://nymrli.top/2021/12/29/%E4%BD%BF%E7%94%A8%E4%B8%83%E7%89%9B%E4%BA%91%E4%BD%9C%E5%9B%BE%E5%BA%8A-PicGo/"/>
    <id>https://nymrli.top/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/</id>
    <published>2021-12-29T13:48:37.000Z</published>
    <updated>2021-12-29T14:12:11.451Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è‡ªå·±åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œé€šè¿‡å›¾ç‰‡æ¥è¡¨è¾¾è‡ªå·±çš„æ€è·¯æ— ç–‘æ˜¯ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¹³å¸¸æˆ‘çš„ç¬”è®°éƒ½æ˜¯é€šè¿‡hexoç”Ÿæˆçš„ï¼Œå› æ­¤ä¿å­˜åœ¨æœ¬åœ°è·¯å¾„å³å¯ã€‚ä½†æ˜¯å¦‚æœæƒ³æŠŠæ–‡ç« å‘è¡¨åœ¨ç¬¬ä¸‰æ–¹çš„å¹³å°ä¸Šï¼Œé‚£ä¹ˆè¿™äº›ç›¸å¯¹è·¯å¾„çš„å›¾ç‰‡åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­å°±æ— æ³•è¢«æ£€ç´¢ï¼Œå› æ­¤å¦‚æœèƒ½åœ¨ä¸€ä¸ªå¤§å®¶éƒ½èƒ½è®¿é—®åˆ°çš„åœ°æ–¹å­˜æ”¾è¿™äº›å›¾ç‰‡ï¼Œå†ç»™å‡ºè¿™äº›åœ°æ–¹çš„é“¾æ¥æ—¶é‚£å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚è¦è¾¾åˆ°è¿™ä¸ªéœ€æ±‚ï¼Œåˆ™å°±éœ€è¦ä½¿ç”¨OSSå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p><p>è¿™è¾¹æˆ‘æ¨èçš„æ˜¯ä¸ƒç‰›äº‘ã€‚ä¸ƒç‰›äº‘åœ¨æ³¨å†Œè®¤è¯åæœ‰10Gæ°¸ä¹…å…è´¹ç©ºé—´ï¼Œæ¯æœˆ10Gå›½å†…å’Œ10Gå›½å¤–æµé‡ï¼Œé€Ÿåº¦ç›¸å½“å¿«ï¼Œä¸ƒç‰›äº‘æ˜¯å›½å†…ä¸“ä¸šCDNæœåŠ¡å•†ï¼Œæ’ä»¶æ”¯æŒæ¯”è¾ƒå¤šï¼Œæœ‰å…è´¹SSLè¯ä¹¦ï¼Œä½†httpsæµé‡æ”¶è´¹ã€‚åŒæ—¶ä¸ƒç‰›äº‘è¿˜ä¼šæä¾›30å¤©çš„æµ‹è¯•åŸŸåï¼Œä¸è¿‡è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸ƒç‰›äº‘30å¤©åä¼šå›æ”¶æµ‹è¯•åŸŸåï¼Œå¹¶ä¸”é€šè¿‡æµ‹è¯•åŸŸåå­˜å‚¨çš„æ–‡ä»¶ä¼šåœ¨30å¤©åä¸€èµ·è¢«æ€å‡ºï¼Œå› æ­¤æœ€å¥½è¿˜æ˜¯è¦ç»‘å®šè‡ªå·±çš„å·²å¤‡æ¡ˆçš„åŸŸåã€‚</p></blockquote><h1 id="ä¸ƒç‰›äº‘"><a class="markdownIt-Anchor" href="#ä¸ƒç‰›äº‘"></a> <a href="https://www.qiniu.com/" target="_blank" rel="noopener">ä¸ƒç‰›äº‘</a>åˆ›å»ºä¸é…ç½®</h1><h2 id="åˆ›å»ºç©ºé—´"><a class="markdownIt-Anchor" href="#åˆ›å»ºç©ºé—´"></a> åˆ›å»ºç©ºé—´</h2><p>å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥æ–°å»ºè‡ªå·±çš„å­˜å‚¨ç©ºé—´ï¼Œç‚¹å‡»ã€æ–°å»ºç©ºé—´ã€‘ï¼Œå¯¹ç©ºé—´è¿›è¡Œé…ç½®ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>å­˜å‚¨ç©ºé—´åç§°ä¸èƒ½é‡å¤ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ–°å»ºä¸€ä¸ªåç§°ä¸ºï¼šonestar-blog-img</li><li>å­˜å‚¨åŒºåŸŸé€‰æ‹©ä¸€ä¸ªç¦»ä½ è¿‘ç‚¹çš„ï¼Œæˆ‘é€‰çš„æ˜¯åä¸œï¼Œæ¯ä¸ªåœ°ç‚¹æœ‰ä¸ªç¼–å·çš„ï¼Œåé¢è¦ç”¨æ¥é…ç½®PicGoï¼Œè¿™é‡Œå…ˆè¯´ä¸€ä¸‹åŒºåŸŸå¯¹åº”ç¼–å·: åä¸œï¼šz0ï¼›ååŒ—ï¼šz1ï¼›åå—ï¼šz2ï¼šåŒ—ç¾ï¼šna0ï¼šä¸œå—äºšï¼šas0</li><li>è®¿é—®æ§åˆ¶é€‰æ‹©å…¬å¼€ï¼Œå› ä¸ºè¦ä½œä¸ºå¤–é“¾è¿›è¡Œè®¿é—®</li></ul><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E5%88%9B%E5%BB%BA%E7%A9%BA%E9%97%B4.png" alt="åˆ›å»ºç©ºé—´"></p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F.png" alt="åˆ›å»ºæˆåŠŸ"></p><h2 id="é…ç½®åŸŸåå¹¶ç»‘å®š"><a class="markdownIt-Anchor" href="#é…ç½®åŸŸåå¹¶ç»‘å®š"></a> é…ç½®åŸŸåå¹¶ç»‘å®š</h2><ol><li>ç‚¹å‡»&quot;+ç»‘å®šåŸŸå&quot;æŒ‰é’®</li></ol><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E7%BB%91%E5%AE%9A%E5%9F%9F%E5%90%8D.png" alt="ç»‘å®šåŸŸå"></p><p>2.å°±ä¼šè¿›å…¥å¦‚ä¸‹çš„æ·»åŠ åŸŸåé¡µé¢ï¼Œéœ€è¦åšçš„å°±æ˜¯å¡«å…¥ä¸€ä¸ªä¸‰çº§åŸŸåï¼Œå¦‚æˆ‘ç”³è¯·çš„äºŒçº§åŸŸåä¸ºnymrli.topï¼Œé‚£ä¹ˆè¿™è¾¹æˆ‘å¯ä»¥å†™<code>xxx.nymrli.top</code>ï¼Œè¿™ä¸ªxxxå°±æ˜¯nymrli.topä¸‹çš„å­åŸŸåï¼Œä½†æ˜¯è¿™ä¸ªæ¯•ç«Ÿæ˜¯æˆ‘ä»¬ä¸´æ—¶æƒ³å‡ºæ¥çš„ï¼Œå› æ­¤è¦è®©ä»–ç”Ÿæ•ˆçš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨DNSæœåŠ¡å•†é‚£è¾¹è¿›è¡Œé…ç½®ã€‚</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E6%B7%BB%E5%8A%A0%E5%9F%9F%E5%90%8D.png" alt="æ·»åŠ åŸŸå"></p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E7%82%B9%E5%87%BB%E9%85%8D%E7%BD%AECname.png" alt="ç‚¹å‡»é…ç½®Cname"></p><ol start="3"><li>æ¥ä¸‹æ¥å¼€å§‹é…ç½®CNAMEè§£æï¼Œç”±äºæˆ‘çš„åŸŸåè§£ææ˜¯åœ¨é˜¿é‡Œäº‘åšçš„ï¼Œå› æ­¤éœ€è¦åˆ°é˜¿é‡Œäº‘çš„åŸŸåç®¡ç†æ§åˆ¶å°æ·»åŠ è¿™ä¸ªCNAMEçš„è§£æ</li></ol><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/DNS%E8%AE%B0%E5%BD%95.png" alt="DNSè®°å½•"></p><p>æ·»åŠ å¥½CNAMEè®°å½•åç­‰å¾…ä¸€ä¼šè®©å…¶ç”Ÿæ•ˆåï¼Œå°±èƒ½åˆ°ä¸ƒç‰›äº‘çš„â€œåŸŸåç®¡ç†â€é¡µé¢æŸ¥çœ‹çŠ¶æ€å•¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™è¾¹çš„â€œçŠ¶æ€â€æ˜¾ç¤ºæˆåŠŸäº†</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/%E6%9F%A5%E7%9C%8B%E5%9F%9F%E5%90%8D%E6%98%AF%E5%90%A6%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F%E6%88%90%E5%8A%9F.png" alt="æŸ¥çœ‹åŸŸåæ˜¯å¦é…ç½®æˆåŠŸæˆåŠŸ"></p><h1 id="picgoå›¾åºŠè½¯ä»¶"><a class="markdownIt-Anchor" href="#picgoå›¾åºŠè½¯ä»¶"></a> <a href="https://github.com/Molunerfinn/PicGo/releases/tag/v2.3.0" target="_blank" rel="noopener">Picgoå›¾åºŠè½¯ä»¶</a>é…ç½®</h1><p>è‡ªå¸¦å…è´¹çš„SM.MSå›¾åºŠé…ç½®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ä½†æ˜¯ç”¨åˆ«äººçš„é…ç½®ï¼Œå åˆ«äººçš„èµ„æºæ¯•ç«Ÿä¸å¤ªå¥½ï¼Œå®¹æ˜“è¶…é¢ï¼Œè€Œä¸”å®‰å…¨æ€§ä¹Ÿä¸é«˜ã€‚å› æ­¤é…ç½®è‡ªå·±çš„å­˜å‚¨APIï¼Œè¿™è¾¹ä½¿ç”¨ä¸Šè¿°é…ç½®å¥½çš„ä¸ƒç‰›äº‘ã€‚</p><p><img src="/2021/12/29/ä½¿ç”¨ä¸ƒç‰›äº‘ä½œå›¾åºŠ-PicGo/picgo%E9%85%8D%E7%BD%AE.png" alt="picgoé…ç½®"></p><ul><li>accessKeyå’ŒSecretKeyå¯ä»¥ç‚¹å‡»å¤´åƒåˆ°â€œä¸ªäººä¸­å¿ƒâ€å»æŸ¥çœ‹å¹¶å¤åˆ¶è¿›å»</li><li>å­˜å‚¨ç©ºé—´åå°±æ˜¯ä¸€å¼€å§‹åˆ›å»ºç©ºé—´çš„åå­—</li><li>ç½‘å€çš„è¯å°±æ˜¯è‡ªå·±ç»‘å®šçš„ä¸‰çº§åŸŸå</li><li>è¿™è¾¹æ¯”è¾ƒå®¹æ˜“å¡«é”™çš„æ˜¯å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”çš„å…¶å®æ˜¯åå—ã€åä¸œâ€¦â€¦ä½†éœ€è¦å¡«ç¼–å·ï¼Œè¿™è¾¹ç¼–å·å…³ç³»å¦‚ä¸‹ï¼š<ul><li>z0ï¼›ååŒ—ï¼šz1ï¼›åå—ï¼šz2ï¼šåŒ—ç¾ï¼šna0ï¼šä¸œå—äºšï¼šas0</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;è‡ªå·±åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œé€šè¿‡å›¾ç‰‡æ¥è¡¨è¾¾è‡ªå·±çš„æ€è·¯æ— ç–‘æ˜¯ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¹³å¸¸æˆ‘çš„ç¬”è®°éƒ½æ˜¯é€šè¿‡hexoç”Ÿæˆçš„ï¼Œå› æ­¤ä¿å­˜åœ¨æœ¬åœ°è·¯å¾„å³å¯ã€‚ä½†æ˜¯å¦‚æœæƒ³æŠŠæ–‡ç« å‘è¡¨åœ¨ç¬¬ä¸‰æ–¹çš„å¹³å°ä¸Šï¼Œé‚£ä¹ˆè¿™äº›ç›¸å¯¹è·¯å¾„çš„å›¾ç‰‡åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­å°±æ— æ³•è¢«æ£€ç´¢ï¼Œå› æ­¤å¦‚æœèƒ½åœ¨ä¸€ä¸ªå¤§å®¶éƒ½èƒ½è®¿é—®åˆ°çš„åœ°
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Goçš„è¿›é˜¶å­¦ä¹ </title>
    <link href="https://nymrli.top/2021/12/29/Go%E7%9A%84%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/"/>
    <id>https://nymrli.top/2021/12/29/Goçš„è¿›é˜¶å­¦ä¹ /</id>
    <published>2021-12-29T08:15:07.000Z</published>
    <updated>2021-12-29T15:53:41.639Z</updated>
    
    <content type="html"><![CDATA[<h2 id="goä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿"><a class="markdownIt-Anchor" href="#goä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿"></a> GOä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿</h2><blockquote><p>è¯´åˆ°ç»§æ‰¿æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¹Ÿå¯ä»¥äº†è§£åˆ°åœ¨Goä¸­æ˜¯æ²¡æœ‰<code>extends</code>å…³é”®å­—çš„ï¼Œä¹Ÿå°±æ„å‘³ç€Goå¹¶æ²¡æœ‰åŸç”Ÿçº§åˆ«çš„ç»§æ‰¿æ”¯æŒã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç”¨äº†<strong>ä¼ªç»§æ‰¿</strong>è¿™ä¸ªè¯ã€‚æœ¬è´¨ä¸Šï¼ŒGoä½¿ç”¨interfaceå®ç°çš„åŠŸèƒ½å«ç»„åˆï¼ŒGoæ˜¯é€šè¿‡ç»„åˆ(+åŒ¿åå­—æ®µçš„æŠ€æœ¯)æ¥å®ç°çš„ç»§æ‰¿ï¼Œè¯´çš„æ›´ç²¾ç¡®ä¸€ç‚¹ï¼Œæ˜¯ä½¿ç”¨ç»„åˆæ¥ä»£æ›¿ç»§æ‰¿</p></blockquote><p>æˆ‘ä»¬ç”¨å¾ˆå®¹æ˜“ç†è§£çš„<strong>åŠ¨ç‰©</strong>-<strong>çŒ«</strong>æ¥ä¸¾ä¾‹å­ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹ä»£ç ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Animal <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Animal)</span> <span class="title">Eat</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%v is eating"</span>, a.Name)</span><br><span class="line">    fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">    *Animal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cat := &amp;Cat&#123;</span><br><span class="line">    Animal: &amp;Animal&#123;</span><br><span class="line">        Name: <span class="string">"cat"</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line">cat.Eat() <span class="comment">// cat is eating</span></span><br></pre></td></tr></table></figure><p><strong>ä»£ç åˆ†æ</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªAnimalçš„ç»“æ„ä½“ï¼Œä»£è¡¨åŠ¨ç‰©ç±»ã€‚å¹¶å£°æ˜äº†Nameå­—æ®µï¼Œç”¨äºæè¿°åŠ¨ç‰©çš„åå­—ã€‚ç„¶åï¼Œå®ç°äº†ä¸€ä¸ªä»¥Animalä¸ºreceiverçš„Eatæ–¹æ³•ï¼Œæ¥æè¿°åŠ¨ç‰©è¿›é£Ÿçš„è¡Œä¸ºã€‚æœ€åï¼Œå£°æ˜äº†ä¸€ä¸ªCatç»“æ„ä½“ï¼Œç»„åˆäº†Catå­—æ®µã€‚å†å®ä¾‹åŒ–ä¸€ä¸ªçŒ«ï¼Œè°ƒç”¨Eatæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°ä¼šæ­£å¸¸çš„è¾“å‡ºã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒCatç»“æ„ä½“æœ¬èº«æ²¡æœ‰Nameå­—æ®µï¼Œä¹Ÿæ²¡æœ‰å»å®ç°Eatæ–¹æ³•ã€‚å”¯ä¸€æœ‰çš„å°±æ˜¯ç»„åˆäº†Animalçˆ¶ç±»ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬å°±è¯æ˜äº†å·²ç»é€šè¿‡ç»„åˆå®ç°äº†ç»§æ‰¿ã€‚</p><p><strong>å°†æ¥å£ä¼˜é›…ç®€æ˜åŒ–</strong></p><blockquote><p>æ¥å£ç”¨äºæè¿°æŸä¸ªç±»çš„è¡Œä¸ºã€‚å¯¹äºä¸€ä¸ªæ¥å£çš„ä½¿ç”¨è€…è€Œè¨€ï¼Œæˆ‘éœ€è¦åœ¨æ‹¿åˆ°è¿™ä¸ªæ¥å£çš„åŒæ—¶èƒ½ä¸€ç›®äº†ç„¶çš„çŸ¥é“è¿™ä¸ªç±»å¹²äº†ä»€ä¹ˆï¼Œæœ‰å“ªäº›æ–¹æ³•å¯ä»¥è°ƒç”¨ï¼Œå› æ­¤ä¸Šé¢çš„å†™æ³•æˆ‘ä»¬å¹¶ä¸èƒ½ä»ä¸­çœ‹å‡ºAnimalå…·ä½“æœ‰å“ªäº›åŠŸèƒ½ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè¯´æ˜å®ƒåŠŸèƒ½æ–¹æ³•çš„çˆ¶æ¥å£ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å³å°†è¦æŠ½è±¡çš„åŠ¨ç‰©æ¥å£å°±ä¼šæè¿°ä½œä¸ºä¸€ä¸ªåŠ¨ç‰©ï¼Œå…·æœ‰å“ªäº›è¡Œä¸ºã€‚å¸¸è¯†å‘Šè¯‰æˆ‘ä»¬ï¼ŒåŠ¨ç‰©å¯ä»¥è¿›é£Ÿï¼ˆEatï¼‰ï¼Œå¯ä»¥å‘å‡ºå£°éŸ³ï¼ˆbarkï¼‰ï¼Œå¯ä»¥ç§»åŠ¨ï¼ˆmoveï¼‰ç­‰ç­‰ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç±»æ¯”ã€‚</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹ŸåŠ¨ç‰©è¡Œä¸ºçš„æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> IAnimal <span class="keyword">interface</span> &#123;</span><br><span class="line">    Eat() <span class="comment">// æè¿°åƒçš„è¡Œä¸º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨ç‰© æ‰€æœ‰åŠ¨ç‰©çš„çˆ¶ç±»</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨ç‰©å»å®ç°IAnimalä¸­æè¿°çš„åƒçš„æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Animal)</span> <span class="title">Eat</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%v is eating\n"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨ç‰©çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newAnimal</span><span class="params">(name <span class="keyword">string</span>)</span> *<span class="title">Animal</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;Animal&#123;</span><br><span class="line">        Name: name,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çŒ«çš„ç»“æ„ä½“ ç»„åˆäº†animal</span></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">    *Animal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°çŒ«çš„æ„é€ å‡½æ•° åˆå§‹åŒ–animalç»“æ„ä½“</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newCat</span><span class="params">(name <span class="keyword">string</span>)</span> *<span class="title">Cat</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;Cat&#123;</span><br><span class="line">        Animal: newAnimal(name),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cat := newCat(<span class="string">"cat"</span>)</span><br><span class="line">cat.Eat() <span class="comment">// cat is eating</span></span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°å½¢å‚é—®é¢˜"><a class="markdownIt-Anchor" href="#å‡½æ•°å½¢å‚é—®é¢˜"></a> å‡½æ•°å½¢å‚é—®é¢˜</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span> <span class="title">ServeHTTP</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">c := newContext(w, req)</span><br><span class="line">c.handlers = middlewares</span><br><span class="line">c.engine = engine</span><br><span class="line">engine.router.handle(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå’Œ http ServerHTTP å‡½æ•°åŸå§‹çš„ä¸¤ä¸ªå‚æ•°å¯¹åº” req å’Œ writerã€‚req æ˜¯ç»“æ„ä½“ï¼Œç”¨æŒ‡é’ˆå¯ä»¥èŠ‚çœå†…å­˜ï¼ŒWriter æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œä¸èƒ½ç”¨æŒ‡é’ˆã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;goä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#goä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿&quot;&gt;&lt;/a&gt; GOä¸­é€šè¿‡ç»„åˆæ–¹å¼å®ç°çš„ä¼ªç»§æ‰¿&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯´åˆ°ç»§æ‰¿æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¹Ÿå¯ä»¥äº†è§£åˆ°åœ¨Goä¸­
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¼€å‘æ–¹å‘-æŠ€æœ¯æ ˆ</title>
    <link href="https://nymrli.top/2021/12/28/%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91-%E6%8A%80%E6%9C%AF%E6%A0%88/"/>
    <id>https://nymrli.top/2021/12/28/å¼€å‘æ–¹å‘-æŠ€æœ¯æ ˆ/</id>
    <published>2021-12-28T13:02:43.000Z</published>
    <updated>2021-12-28T16:10:43.781Z</updated>
    
    <content type="html"><![CDATA[<h1 id="cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶"><a class="markdownIt-Anchor" href="#cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶"></a> Cloud å¾®æœåŠ¡å…¨å®¶æ¡¶</h1><blockquote><p>å¾®æœåŠ¡å¼€å‘çš„ä¸»æµæŠ€æœ¯æ ˆ</p></blockquote><ul><li>æœåŠ¡æ³¨å†Œä¸­å¿ƒ<ul><li>:error:eureka åœæ­¢æ›´æ–°</li><li>âŒconsul</li><li>zookeeper</li><li>â­ï¸nacos</li></ul></li><li>æœåŠ¡è´Ÿè½½ä¸è°ƒç”¨<ul><li>âŒ netflix oss ribbon ==&gt; spring cloud loadbalance</li><li>netflix feign ==&gt; Spring cloud OpenFeign</li></ul></li><li>å®¹é‡é™æµ(ç†”æ–­)<ul><li>âŒhystrix: æœ€å…ˆçš„è€å¤§å“¥</li><li>resilience4jï¼šå›½å¤–ä½¿ç”¨è¾ƒå¤š</li><li>â­ï¸spring cloud alibaba sentinel</li></ul></li><li>é…ç½®ä¸­å¿ƒ<ul><li>âŒspring cloud config</li><li>æºç¨‹: apollo</li><li>spring cloud alibaba nacos</li></ul></li><li>æœåŠ¡å¼€å‘<ul><li>spring boot</li></ul></li><li>æµé‡ç›‘æ§</li><li>æœåŠ¡æ€»çº¿:<ul><li>âŒspring cloud bus</li><li>spring cloud alibaba nacos</li></ul></li><li>æœåŠ¡æ²»ç†</li><li>é“¾è·¯è¿½è¸ª<ul><li>spring cloud sleuth</li></ul></li><li>æœåŠ¡ç½‘å…³<ul><li>âŒ(netflix) zuul</li><li>zuul2: èƒæ­»è…¹ä¸­</li><li>â­ï¸spring cloud gateway</li></ul></li><li>matricsï¼ˆæŒ‡æ ‡ï¼‰ç›‘æ§ï¼š<ul><li>kairosDB</li></ul></li><li>æ—¥å¿—ç›‘æ§ï¼š<ul><li>ELK</li></ul></li><li>å¥åº·æ£€æŸ¥å’Œå‘Šè­¦ï¼š<ul><li>zalando</li><li>zmon</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#cloud-å¾®æœåŠ¡å…¨å®¶æ¡¶&quot;&gt;&lt;/a&gt; Cloud å¾®æœåŠ¡å…¨å®¶æ¡¶&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;å¾®æœåŠ¡å¼€å‘çš„ä¸»æµæŠ€æœ¯æ ˆ&lt;/p&gt;
&lt;/blockquote&gt;
      
    
    </summary>
    
    
      <category term="å¼€å‘" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Kotliné›†åˆã€æµå¼æ“ä½œ</title>
    <link href="https://nymrli.top/2021/12/27/Kotlin%E9%9B%86%E5%90%88%E3%80%81%E6%B5%81%E5%BC%8F%E6%93%8D%E4%BD%9C/"/>
    <id>https://nymrli.top/2021/12/27/Kotliné›†åˆã€æµå¼æ“ä½œ/</id>
    <published>2021-12-27T03:14:40.000Z</published>
    <updated>2022-01-03T13:36:36.222Z</updated>
    
    <content type="html"><![CDATA[<p>é™¤äº†æœ€é€šç”¨çš„Arrayä»¥å¤–ï¼Œkotlinä¸­è¿˜æœ‰ä¸€ç±»å®¹å™¨ç»Ÿç§°ä¸ºColletion(é›†åˆ)ï¼Œä»–ä»¬æœ‰</p><ul><li>List<ul><li><strong>List</strong>ï¼šç»§æ‰¿Collectionã€‚ä¸€ä¸ªèŒƒæ€§æœ‰åºçš„åªè¯»é›†åˆã€‚å› ä¸ºæœ‰åºï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨get(position)ç­‰æŸ¥è¯¢çš„æ–¹æ³•</li><li><strong>MutableList</strong>ï¼šç»§æ‰¿Listï¼ŒMutableCollectionã€‚ä¸€ä¸ªæœ‰åºé›†åˆã€‚å¹¶é¢å¤–æä¾›äº†add/removeå…ƒç´ çš„æ–¹æ³•</li></ul></li><li>Set<ul><li><strong>Set</strong>ï¼šç»§æ‰¿Collectionã€‚ä¸€ä¸ªæ— åºå¹¶ä¸æ”¯æŒé‡å¤å…ƒç´ çš„é›†åˆ</li><li><strong>MutableSet</strong>ï¼šç»§æ‰¿Setï¼ŒMutableCollectionï¼Œä¸€ä¸ªæ— åºçš„é›†åˆå¹¶ä¸”ä¸æ”¯æŒé‡å¤å…ƒç´ ã€‚ä½†æ˜¯ï¼Œæ”¯æŒadd/removeå…ƒç´ </li></ul></li><li>Map<ul><li><strong>Map</strong>ï¼šä¸€ä¸ªkey-valueçš„åªè¯»é›†åˆã€‚å¹¶ä¸”keyå”¯ä¸€ã€‚</li><li><strong>MutableMap</strong>ï¼šç»§æ‰¿Mapã€‚æ”¯æŒput/removeå…ƒç´ </li></ul></li></ul><h1 id="list"><a class="markdownIt-Anchor" href="#list"></a> List</h1><ul><li><p><strong>any</strong>ï¼šå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ ä¸åˆ¤æ–­æ¡ä»¶ç›¸ç¬¦ï¼Œåˆ™ è¿”å›true</p></li><li><p><strong>all</strong>ï¼šå¦‚æœå…¨éƒ¨å…ƒç´ ä¸åˆ¤æ–­æ¡ä»¶ç›¸ç¬¦ï¼Œåˆ™ è¿”å›true</p></li><li><p><strong>component1,â€¦,component5</strong>ï¼šè¿”å›é›†åˆçš„ç¬¬nä¸ªå…ƒç´ ï¼Œè¶Šç•Œè¿”å›ArrayIndexOutOfBoundsException</p></li><li><p><strong>contain</strong>ï¼šå¦‚æœæŒ‡å®šå…ƒç´ å¯ä»¥åœ¨é›†åˆæ‰¾åˆ°ï¼Œåˆ™ è¿”å›true</p></li><li><p><strong>containsAll</strong>ï¼šå¦‚æœæŒ‡å®šé›†åˆæ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥åœ¨ç›®æ ‡é›†åˆæ‰¾åˆ°ï¼Œåˆ™ è¿”å›true</p></li><li><p><strong>count</strong>ï¼šè¿”å›ä¸åˆ¤æ–­æ¡ä»¶ç›¸ç¬¦çš„å…ƒç´ ä¸ªæ•°</p></li><li><p><strong>distinct</strong>ï¼šè¿”å›ä¸€ä¸ªåªåŒ…å«ä¸åŒå…ƒç´ çš„æ•°ç»„ï¼Œå³å¯¹åˆ—è¡¨å†…å…ƒç´ å»é‡</p></li><li><p><strong>distinctBy</strong>ï¼šè¿”å›é›†åˆå…ƒç´ <strong>æ‰§è¡ŒæŒ‡å®šæ¡ä»¶å</strong>ï¼Œä¸åŒå…ƒç´ çš„æ•°ç»„ï¼ˆåŸå§‹æ•°ç»„å…ƒç´ ï¼‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">4</span>),list.distinctBy &#123; it%<span class="number">2</span> == <span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>drop</strong>ï¼šè¿”å›æ‰€æœ‰å…ƒç´ çš„åˆ—è¡¨ï¼Œä½†ä¸åŒ…å«å‰nä¸ªå…ƒç´ </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">3</span>,<span class="number">4</span>),list.drop(<span class="number">2</span>))</span><br></pre></td></tr></table></figure></li><li><p><strong>dropLast</strong>ï¼šè¿”å›æ‰€æœ‰å…ƒç´ çš„åˆ—è¡¨ï¼Œä½†ä¸åŒ…å«æœ€ånä¸ªå…ƒç´ </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">2</span>),list.dropLast(<span class="number">2</span>))</span><br></pre></td></tr></table></figure></li><li><p><strong>dropWhile</strong>ï¼šè¿”å›æ‰€æœ‰å…ƒç´ çš„åˆ—è¡¨ï¼Œä½†ä¸åŒ…å«æ»¡è¶³åˆ¤æ–­æ¡ä»¶çš„å…ƒç´ </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),list.dropWhile&#123;it &lt;<span class="number">3</span>&#125;)</span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">3</span>,<span class="number">4</span>),list.dropWhile&#123;it &lt;<span class="number">3</span>&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>elementAt</strong>ï¼šè¿”å›æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼Œåˆ™æŠ›å‡ºArrayIndexOutOfBoundsException</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>,list.elementAt(<span class="number">3</span>))</span><br><span class="line"><span class="comment">// elementAtOrElseï¼šè¿”å›æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼Œåˆ™è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">18</span>,list.elementAtOrElse(<span class="number">6</span>,&#123;it *<span class="number">3</span>&#125;))</span><br><span class="line"><span class="comment">// elementAtOrNull: è¿”å›æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼Œåˆ™è¿”å›null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="literal">null</span>,list.elementAtOrNull(<span class="number">6</span>))</span><br></pre></td></tr></table></figure></li><li><p><strong>filter</strong>:ç­›é€‰å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">2</span>,<span class="number">3</span>),list.filter&#123; it <span class="keyword">in</span> <span class="number">2.</span><span class="number">.3</span> &#125;)</span><br><span class="line">filterIndexed</span><br><span class="line"><span class="comment">// filterIndexedç­›é€‰å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ˆæ¡ä»¶å¤šäº†ä¸€ä¸ªç´¢å¼•å‚æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">4</span>),list.filterIndexed &#123; index, it -&gt; index&gt;<span class="number">0</span> &amp;&amp; it &gt;<span class="number">2</span>&#125; )</span><br><span class="line"><span class="comment">// filterNot: ç­›é€‰å‡ºæ‰€æœ‰ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">4</span>),list.filterNot&#123; it <span class="keyword">in</span> <span class="number">2.</span><span class="number">.3</span> &#125;)</span><br><span class="line">filterNotNull</span><br><span class="line"><span class="comment">// filterNotNull: ç­›é€‰å‡ºæ‰€æœ‰ä¸ä¸ºnullçš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="literal">null</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),list.filterNotNull())</span><br></pre></td></tr></table></figure></li><li><p><strong>first</strong></p><p>è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ,æ²¡æœ‰åˆ™æŠ›å‡ºNoSuchElementException</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">2</span>,list.first &#123; it &gt; <span class="number">1</span> &#125;)</span><br><span class="line"><span class="comment">// firstOrNull: è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œæ²¡æœ‰ï¼Œåˆ™ è¿”å›Null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="literal">null</span>, list.firstOrNull &#123; it &gt; <span class="number">5</span> &#125;)</span><br><span class="line"><span class="comment">// find :åŒfirstOrNullã€‚è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œæ²¡æœ‰ï¼Œåˆ™ è¿”å›Null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">2</span>,list.find &#123; it &gt; <span class="number">1</span> &#125;)</span><br><span class="line"><span class="comment">// findLast: è¿”å›æœ€åä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œæ²¡æœ‰ï¼Œåˆ™ è¿”å›Null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>,list.findLast &#123; it &gt; <span class="number">1</span> &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// last: è¿”å›ç¬¦åˆç»™å®šå‡½æ•°æ¡ä»¶çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨åˆ™æŠ›å‡ºNoSuchElementException</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>, list.last &#123; it % <span class="number">2</span> == <span class="number">0</span> &#125;)</span><br><span class="line"><span class="comment">// lastIndexOf: è¿”å›æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼Œä¸å­˜åœ¨è¿”å›-1</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">2</span>, list.lastIndexOf(<span class="number">2</span>) )</span><br><span class="line"><span class="comment">// lastOrNull: è¿”å›ç¬¦åˆç»™å®šå‡½æ•°æ¡ä»¶çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨è¿”å›null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertNull( list.lastOrNull&#123; it &gt;<span class="number">5</span>&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>single</strong>: è¿”å›ç¬¦åˆæŒ‡å®šå‡½æ•°æ¡ä»¶çš„å•ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæˆ–è€…è¶…è¿‡ä¸€ä¸ªï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚\</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>, list.single &#123; it == <span class="number">4</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// singleOrNull: è¿”å›ç¬¦åˆæŒ‡å®šå‡½æ•°æ¡ä»¶çš„å•ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæˆ–è€…è¶…è¿‡ä¸€ä¸ªï¼Œåˆ™è¿”å›null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="literal">null</span>, list.singleOrNull &#123; it == <span class="number">2</span> &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>flatMap</strong>: éå†æ‰€æœ‰çš„å…ƒç´ ï¼Œä¸ºæ¯ä¸€ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œæœ€åæŠŠæ‰€æœ‰çš„é›†åˆæ”¾åœ¨<em>ä¸€ä¸ªé›†åˆ</em>ä¸­ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>),list.flatMap &#123; it -&gt; listOf(it,it*<span class="number">2</span>) &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>flatten</strong>: éå†ä¸€ä¸ªå•ç‹¬çš„é›†åˆï¼ŒåŒ…å«ç»™å®šåµŒå¥—é›†åˆé‡Œé¢çš„æ‰€æœ‰å…ƒç´ ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(listOf(<span class="number">1</span>,<span class="number">2</span>), listOf(<span class="number">4</span>,<span class="number">2</span>), listOf(<span class="number">3</span>), listOf(<span class="number">4</span>))</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), list.flatten())</span><br></pre></td></tr></table></figure></li><li><p><strong>fold</strong>ï¼š å°†å¯¹é›†åˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œæ˜¯è¿›è¡Œä¹˜æ³•æ“ä½œ</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">48</span>, list.fold(<span class="number">2</span>) &#123; total, next -&gt; total * next &#125;)</span><br><span class="line"><span class="comment">// foldRight: è·Ÿfoldæ“ä½œä¸€æ ·ï¼Œä¸è¿‡æ˜¯ä»æœ€åä¸€ä¸ªåˆ°åˆ°ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œ</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">48</span>, list.foldRight(<span class="number">2</span>) &#123; total, next -&gt; total * next &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>reduce</strong>ï¼š ä¸foldåŠŸèƒ½ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œæ²¡æœ‰åˆå§‹å€¼ã€‚æŠŠé›†åˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªï¼ŒæŒ‰æŒ‡å®šæ¡ä»¶è¿›è¡Œæ“ä½œ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">-7</span>, list.reduce &#123; total, next -&gt; total -next &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>get</strong>:è·å–ç´¢å¼•æ‰€åœ¨çš„å…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›ArrayIndexOutOfBoundsException</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getOrElse: è·å–ç´¢å¼•æ‰€åœ¨çš„å…ƒç´ ï¼Œæ²¡æœ‰å°±è¿”å›é»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">10</span>, list.getOrElse(<span class="number">8</span>, &#123; _ -&gt; <span class="number">10</span> &#125;))</span><br><span class="line">assertEquals(<span class="number">2</span>, list.getOrElse(<span class="number">1</span>, &#123; _ -&gt; <span class="number">10</span> &#125;))</span><br><span class="line"><span class="comment">// getOrNull: è·å–ç´¢å¼•æ‰€åœ¨çš„å…ƒç´ ï¼Œæ²¡æœ‰å°±è¿”å›nul</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="literal">null</span>, list.getOrNull(<span class="number">8</span>))</span><br><span class="line">assertEquals(<span class="number">4</span>, list.getOrNull(<span class="number">2</span>))</span><br></pre></td></tr></table></figure></li><li><p><strong>map</strong>ï¼š è¿”å›ä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½æ ¹æ®ç»™å®šå‡½æ•°æ¡ä»¶è½¬æ¢çš„æ•°ç»„</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>), list.map&#123; it*<span class="number">2</span>&#125; )</span><br><span class="line"><span class="comment">// mapIndexed: åŠŸèƒ½åŒmapï¼Œæ¯”mapå¤šäº†ä¸€ä¸ªç´¢å¼•</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>), list.mapIndexed &#123; index, it -&gt; <span class="keyword">if</span> (index % <span class="number">2</span> == <span class="number">0</span>) index * it <span class="keyword">else</span> it &#125;)</span><br><span class="line"><span class="comment">// mapNotNull: åŒmapã€‚ä½†æ˜¯ï¼Œå…ƒç´ è½¬æ¢ä¸åŒ…å«Null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>,<span class="literal">null</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>), list.mapNotNull &#123; it?.times(<span class="number">2</span>) &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>max</strong>: è¿”å›é›†åˆæœ€å¤§å…ƒç´ ã€‚ä¸å­˜åœ¨è¿”å›null</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>, list.max())</span><br><span class="line"><span class="keyword">val</span> list = emptyList&lt;<span class="built_in">Int</span>&gt;()</span><br><span class="line">assertEquals(<span class="literal">null</span>, list.max())</span><br><span class="line"></span><br><span class="line"><span class="comment">// maxBy:è¿”å›æ ¹æ®æŒ‡å®šå‡½æ•°è½¬æ¢åï¼Œäº§ç”Ÿçš„æœ€å¤§å€¼çš„åŸå§‹å…ƒç´ ï¼ˆè¿”å›çš„è¿˜æ˜¯åŸå§‹å…ƒç´ ï¼‰ã€‚å¦‚æœæ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›nullã€‚</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">1</span>, list.maxBy &#123; -it &#125;)</span><br><span class="line"><span class="comment">// min:è¿”å›é›†åˆæœ€å°å…ƒç´ ï¼Œä¸å­˜åœ¨è¿”å›null</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">1</span>, list.min())</span><br><span class="line"><span class="comment">// minBy: è¿”å›æ ¹æ®æŒ‡å®šå‡½æ•°è½¬æ¢åï¼Œäº§ç”Ÿçš„æœ€å°å€¼çš„åŸå§‹å…ƒç´ ï¼ˆè¿”å›çš„è¿˜æ˜¯åŸå§‹å…ƒç´ ï¼‰ã€‚å¦‚æœæ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›nullã€‚</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(<span class="number">4</span>, list.minBy &#123; -it &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>none</strong>ï¼š å¦‚æœæ²¡æœ‰ä»»ä½•å…ƒç´ ä¸æŒ‡å®šçš„å‡½æ•°æ¡ä»¶åŒ¹é…ï¼Œåˆ™è¿”å›trueã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertTrue(list.none &#123; it &gt; <span class="number">4</span> &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>orEmpty</strong>ï¼š å¦‚æœæ²¡æœ‰ä»»ä½•å…ƒç´ ä¸æŒ‡å®šçš„å‡½æ•°æ¡ä»¶åŒ¹é…ï¼Œåˆ™è¿”å›trueã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertTrue(list.none &#123; it &gt; <span class="number">4</span> &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>sorted</strong>ï¼šè¿”å›æ‰€æœ‰å…ƒç´ åˆ†ç±»æ’åºåˆ—è¡¨ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>), list.sorted())</span><br><span class="line"></span><br><span class="line"><span class="comment">// sortBy:è¿”å›æ‰€æœ‰å…ƒç´ åˆ†ç±»æ’åºåˆ—è¡¨ã€‚é¡ºåºæŒ‰ç…§æŒ‡å®šå‡½æ•°æ¡ä»¶æ’åˆ—</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>), list.sortedBy &#123; -it &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// sortDescending:è¿”å›æ‰€æœ‰å…ƒç´ åˆ†ç±»æ’åºåˆ—è¡¨ã€‚é¡ºåºæŒ‰é™åºæ’åˆ—</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>), list.sortedDescending())</span><br><span class="line"></span><br><span class="line"><span class="comment">// sortedByDescending:è¿”å›æ‰€æœ‰å…ƒç´ åˆ†ç±»æ’åºåˆ—è¡¨ã€‚é¡ºåºæŒ‰æŒ‡å®šå‡½æ•°æ¡ä»¶çš„é™åºæ’åˆ—</span></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>), list.sortedByDescending&#123; -it &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>slice</strong>: è¿”å›ä¸€ä¸ªlistä¸­æŒ‡å®šindexçš„å…ƒç´ ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>), list.slice(<span class="number">1.</span><span class="number">.3</span>))</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">4</span>), list.slice(listOf(<span class="number">0</span>,<span class="number">1</span>)))</span><br></pre></td></tr></table></figure></li><li><p><strong>take</strong>: è¿”å›ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹çš„nä¸ªå…ƒç´ ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(listOf(<span class="number">1</span>,<span class="number">4</span>), list.take(<span class="number">2</span>))</span><br></pre></td></tr></table></figure></li><li><p><strong>zip</strong>: è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨ç”±ä¸¤ä¸ªé›†åˆä¸­ç›¸åŒç´¢å¼•å…ƒç´ å»ºç«‹çš„å…ƒç´ å¯¹ã€‚è¿™ä¸ªåˆ—è¡¨é•¿åº¦ä¸ºæœ€çŸ­é›†åˆçš„é•¿åº¦ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val list = listOf(1, 4, 2, 2)</span><br><span class="line">assertEquals(listOf(Pair(1,10),Pair(4,20),Pair(2,30)), list.zip(listOf(10,20,30)))</span><br></pre></td></tr></table></figure><ul><li><p><strong>groupBy</strong></p><p>è¿”å›ä¸€ä¸ªæ ¹æ®ç»™å®šå‡½æ•°åˆ†ç»„åçš„mapï¼Œ valueä¸ºlist</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">assertEquals(mapOf(<span class="string">"error"</span> to listOf(<span class="number">1</span>), <span class="string">"right"</span> to listOf(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)), list.groupBy &#123; <span class="keyword">if</span> (it % <span class="number">2</span> == <span class="number">0</span>) <span class="string">"right"</span> <span class="keyword">else</span> <span class="string">"error"</span> &#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>associateBy</strong></p><p>é€šè¿‡æŒ‡å®šçš„æ¡ä»¶ï¼ŒæŠŠlistè½¬æ¢æˆmapï¼Œvalueä¸ºå•å…ƒç´ </p><p>2ç§ï¼Œç¬¬ä¸€åªè½¬æ¢mapçš„key;ç¬¬äºŒmapçš„key-valueéƒ½è½¬æ¢</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">assertEquals(hashMapOf(<span class="string">"key1"</span> to <span class="number">1</span>, <span class="string">"key4"</span> to <span class="number">4</span>, <span class="string">"key2"</span> to <span class="number">2</span>), list.associateBy &#123; it -&gt; <span class="string">"key"</span> + it &#125;)</span><br><span class="line">assertEquals(hashMapOf(<span class="string">"key1"</span> to <span class="string">"value1"</span>, <span class="string">"key4"</span> to <span class="string">"value4"</span>, <span class="string">"key2"</span> to <span class="string">"value2"</span>), list.associateBy(&#123; it -&gt; <span class="string">"key"</span> + it &#125;, &#123; it -&gt; <span class="string">"value"</span> + it &#125;))</span><br></pre></td></tr></table></figure></li></ul><h2 id="associatebyå’ŒgroupbyåŒºåˆ«"><a class="markdownIt-Anchor" href="#associatebyå’ŒgroupbyåŒºåˆ«"></a> associateByå’ŒgroupByåŒºåˆ«</h2><blockquote><p>å‡½æ•°associateByå’ŒgroupByæ„å»ºæ¥è‡ªç”±æŒ‡å®šé”®ç´¢å¼•çš„é›†åˆçš„å…ƒç´ çš„æ˜ å°„ã€‚keyåœ¨keySelectorå‚æ•°ä¸­å®šä¹‰ã€‚</p><p>è¿˜å¯ä»¥æŒ‡å®šå¯é€‰çš„valueSelectoræ¥å†é€‰æ‹©å®šä¹‰å°†å­˜å‚¨åœ¨mapå…ƒç´ å€¼ä¸­çš„å†…å®¹ã€‚</p></blockquote><p><strong>åŒºåˆ«</strong></p><p>associateByå’ŒgroupByä¹‹é—´çš„åŒºåˆ«åœ¨äºå®ƒä»¬å¦‚ä½•ä½¿ç”¨ç›¸åŒçš„é”®å¤„ç†å¯¹è±¡ï¼š</p><ul><li>associateByä½¿ç”¨<strong>æœ€åä¸€ä¸ªåˆé€‚çš„<em>å…ƒç´ </em></strong>ä½œä¸º<strong>å€¼</strong>ã€‚</li><li>groupByæ„å»º<strong>æ‰€æœ‰åˆé€‚å…ƒç´ çš„<em>åˆ—è¡¨</em></strong>å¹¶å°†å…¶æ”¾å…¥<strong>å€¼</strong>ä¸­ã€‚</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">StreamPractise</span></span>(</span><br><span class="line">    <span class="keyword">val</span> id: <span class="built_in">Int</span>,</span><br><span class="line">    <span class="keyword">val</span> name: String,</span><br><span class="line">    <span class="keyword">val</span> age: <span class="built_in">Int</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> l = listOf(StreamPractise(<span class="number">1</span>, <span class="string">"hello"</span>, <span class="number">19</span>), StreamPractise(<span class="number">1</span>, <span class="string">"cl"</span>, <span class="number">31</span>))</span><br><span class="line">    <span class="keyword">var</span> res = l.associateBy &#123;  it.id &#125;</span><br><span class="line">    println(res)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#123;1=StreamPractise(id=1, name=cl, age=31)&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> l = listOf(StreamPractise(<span class="number">1</span>, <span class="string">"hello"</span>, <span class="number">19</span>), StreamPractise(<span class="number">1</span>, <span class="string">"cl"</span>, <span class="number">31</span>))</span><br><span class="line">    <span class="keyword">var</span> res = l.groupBy &#123;  it.id &#125;</span><br><span class="line">    println(res)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#123;1=[StreamPractise(id=1, name=hello, age=19), StreamPractise(id=1, name=cl, age=31)]&#125;</span></span><br></pre></td></tr></table></figure><h1 id="map"><a class="markdownIt-Anchor" href="#map"></a> Map</h1><ul><li><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Fget-or-else.html" target="_blank" rel="noopener"><code>getOrElse()</code></a> ä¸ list çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼šå¯¹äºä¸å­˜åœ¨çš„é”®ï¼Œå…¶å€¼ç”±ç»™å®šçš„ lambda è¡¨è¾¾å¼è¿”å›ã€‚</p></li><li><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Fget-or-default.html" target="_blank" rel="noopener"><code>getOrDefault()</code></a> å¦‚æœæ‰¾ä¸åˆ°é”®ï¼Œåˆ™è¿”å›æŒ‡å®šçš„é»˜è®¤å€¼ã€‚</p></li><li><p><code>filter</code>: å¯ä»¥ä½¿ç”¨ <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Ffilter.html" target="_blank" rel="noopener"><code>filter()</code></a> å‡½æ•°æ¥<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.kotlincn.net%2Fdocs%2Freference%2Fcollection-filtering.html" target="_blank" rel="noopener">è¿‡æ»¤</a> map æˆ–å…¶ä»–é›†åˆã€‚ å¯¹ map ä½¿ç”¨ <code>filter()</code> å‡½æ•°æ—¶ï¼Œ <code>Pair</code> å°†ä½œä¸ºå‚æ•°çš„è°“è¯ä¼ é€’ç»™å®ƒã€‚ å®ƒå°†ä½¿ç”¨è°“è¯åŒæ—¶è¿‡æ»¤å…¶ä¸­çš„é”®å’Œå€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val numbersMap = mapOf(<span class="string">"key1"</span> to <span class="number">1</span>, <span class="string">"key2"</span> to <span class="number">2</span>, <span class="string">"key3"</span> to <span class="number">3</span>, <span class="string">"key11"</span> to <span class="number">11</span>)</span><br><span class="line">val filteredMap = numbersMap.filter &#123; (key, <span class="keyword">value</span>) -&gt; key.endsWith(<span class="string">"1"</span>) &amp;&amp; <span class="keyword">value</span> &gt; <span class="number">10</span>&#125;</span><br><span class="line">println(filteredMap)</span><br></pre></td></tr></table></figure></li><li><p><code>put()</code>æ·»åŠ æ–°çš„kv</p></li><li><p><code>putAll()</code>è¦ä¸€æ¬¡æ·»åŠ å¤šä¸ªæ¡ç›®ï¼Œè¯·ä½¿ç”¨ <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Fput-all.html" target="_blank" rel="noopener"><code>putAll()</code></a> ã€‚å®ƒçš„å‚æ•°å¯ä»¥æ˜¯ <code>Map</code> æˆ–ä¸€ç»„ <code>Pair</code> ï¼š <code>Iterable</code> ã€ <code>Sequence</code>æˆ– <code>Array</code> ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val numbersMap = mutableMapOf(<span class="string">"one"</span> to <span class="number">1</span>, <span class="string">"two"</span> to <span class="number">2</span>, <span class="string">"three"</span> to <span class="number">3</span>)</span><br><span class="line">numbersMap.putAll(setOf(<span class="string">"four"</span> to <span class="number">4</span>, <span class="string">"five"</span> to <span class="number">5</span>))</span><br><span class="line"><span class="built_in">println</span>(numbersMap)</span><br></pre></td></tr></table></figure><ul><li><code>remove</code>: è¦ä»å¯å˜ Map ä¸­åˆ é™¤æ¡ç›®ï¼Œè¯·ä½¿ç”¨ <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2F-mutable-map%2Fremove.html" target="_blank" rel="noopener"><code>remove()</code></a> å‡½æ•°ã€‚ è°ƒç”¨ <code>remove()</code> æ—¶ï¼Œå¯ä»¥ä¼ é€’é”®æˆ–æ•´ä¸ªé”®å€¼å¯¹ã€‚ å¦‚æœåŒæ—¶æŒ‡å®šé”®å’Œå€¼ï¼Œåˆ™ä»…å½“é”®å€¼éƒ½åŒ¹é…æ—¶ï¼Œæ‰ä¼šåˆ é™¤æ­¤çš„å…ƒç´ ã€‚</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">val numbersMap = mutableMapOf(<span class="string">"one"</span> to <span class="number">1</span>, <span class="string">"two"</span> to <span class="number">2</span>, <span class="string">"three"</span> to <span class="number">3</span>)</span><br><span class="line">numbersMap.<span class="keyword">remove</span>(<span class="string">"one"</span>)</span><br><span class="line">println(numbersMap)</span><br><span class="line">numbersMap.<span class="keyword">remove</span>(<span class="string">"three"</span>, <span class="number">4</span>)            <span class="comment">//ä¸ä¼šåˆ é™¤ä»»ä½•æ¡ç›®</span></span><br><span class="line">println(numbersMap)</span><br></pre></td></tr></table></figure></li><li><p><code>plus</code> ä¸ <code>minus</code> æ“ä½œ</p><p>ç”±äºéœ€è¦è®¿é—®å…ƒç´ çš„é”®ï¼Œ<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Fplus.html" target="_blank" rel="noopener"><code>plus</code></a>ï¼ˆ<code>+</code>ï¼‰ä¸ <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fkotlinlang.org%2Fapi%2Flatest%2Fjvm%2Fstdlib%2Fkotlin.collections%2Fminus.html" target="_blank" rel="noopener"><code>minus</code></a>ï¼ˆ<code>-</code>ï¼‰è¿ç®—ç¬¦å¯¹ map çš„ä½œç”¨ä¸å…¶ä»–é›†åˆä¸åŒã€‚ <code>plus</code> è¿”å›åŒ…å«ä¸¤ä¸ªæ“ä½œæ•°å…ƒç´ çš„ <code>Map</code> ï¼šå·¦ä¾§çš„ Map ä¸å³ä¾§çš„ Pair æˆ–å¦ä¸€ä¸ª Map ã€‚ å½“å³ä¾§æ“ä½œæ•°ä¸­æœ‰å·¦ä¾§ <code>Map</code> ä¸­å·²å­˜åœ¨çš„é”®æ—¶ï¼Œè¯¥æ¡ç›®å°†ä½¿ç”¨å³ä¾§çš„å€¼ï¼ˆè¦†ç›–ï¼‰ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val numbersMap = mapOf(<span class="string">"one"</span> to <span class="number">1</span>, <span class="string">"two"</span> to <span class="number">2</span>, <span class="string">"three"</span> to <span class="number">3</span>)</span><br><span class="line"><span class="built_in">println</span>(numbersMap + Pair(<span class="string">"four"</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">println</span>(numbersMap + Pair(<span class="string">"one"</span>, <span class="number">10</span>))</span><br><span class="line"><span class="built_in">println</span>(numbersMap + mapOf(<span class="string">"five"</span> to <span class="number">5</span>, <span class="string">"one"</span> to <span class="number">11</span>))</span><br></pre></td></tr></table></figure><p>minus å°†æ ¹æ®å·¦ä¾§ Map æ¡ç›®åˆ›å»ºä¸€ä¸ªæ–° Map ï¼Œå³ä¾§æ“ä½œæ•°å¸¦æœ‰é”®çš„æ¡ç›®å°†è¢«å‰”é™¤ã€‚ å› æ­¤ï¼Œå³ä¾§æ“ä½œæ•°å¯ä»¥æ˜¯å•ä¸ªé”®æˆ–é”®çš„é›†åˆï¼š list ã€ set ç­‰ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val numbersMap = mapOf(<span class="string">"one"</span> to <span class="number">1</span>, <span class="string">"two"</span> to <span class="number">2</span>, <span class="string">"three"</span> to <span class="number">3</span>)</span><br><span class="line"><span class="built_in">println</span>(numbersMap - <span class="string">"one"</span>)</span><br><span class="line"><span class="built_in">println</span>(numbersMap - listOf(<span class="string">"two"</span>, <span class="string">"four"</span>))</span><br></pre></td></tr></table></figure></li><li><p><code>containsKey, containsValue</code></p></li><li><p><code>isNotEmpty</code></p></li><li><p><code>sort map</code>:æ ¹æ®é”®æˆ–è€…å€¼æ’åº</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> mmp = mapOf(<span class="number">1</span> to <span class="string">"aone"</span>, <span class="number">3</span> to <span class="string">"three"</span>, <span class="number">2</span> to <span class="string">"two"</span>, <span class="number">4</span> to <span class="string">"four"</span>)</span><br><span class="line"><span class="keyword">val</span> sortedMap: SortedMap&lt;<span class="built_in">Int</span>, String&gt; = mmp.toSortedMap(Comparator &#123; o1, o2 -&gt;</span><br><span class="line">    println(<span class="string">"o1=<span class="variable">$o1</span>,o2=<span class="variable">$o2</span>"</span>)</span><br><span class="line">    <span class="keyword">if</span> (o1 &gt; o2) <span class="number">1</span> <span class="keyword">else</span> <span class="keyword">if</span> (o1 &lt; o2) <span class="number">-1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">&#125;)</span><br><span class="line">  </span><br><span class="line">println(sortedMap) <span class="comment">//    &#123;1=aone, 2=two, 3=three, 4=four&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>â­ï¸<strong>Convert Map to List</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> keyList = ArrayList(mmp.keys)</span><br><span class="line"><span class="keyword">val</span> valueList = ArrayList(mmp.values)</span><br><span class="line"></span><br><span class="line">println(<span class="string">"Key List: <span class="variable">$keyList</span>"</span>) <span class="comment">//    Key List: [1, 3, 2, 4]</span></span><br><span class="line">println(<span class="string">"Value List: <span class="variable">$valueList</span>"</span>) <span class="comment">//    Value List: [aone, three, two, four]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> list = mmp.toList().map &#123; <span class="string">"<span class="subst">$&#123;it.first&#125;</span>_<span class="subst">$&#123;it.second&#125;</span>"</span> &#125;</span><br><span class="line">println(<span class="string">"list=<span class="variable">$list</span>"</span>) <span class="comment">// list=[1_aone, 3_three, 2_two, 4_four]</span></span><br></pre></td></tr></table></figure></li><li><p>â­ï¸<strong>Converting a List to Map in Kotlin</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">val</span> user1 = User(<span class="string">"John"</span>, <span class="number">18</span>, listOf(<span class="string">"Hiking"</span>, <span class="string">"Running"</span>, <span class="string">"Reading"</span>))</span><br><span class="line"> <span class="keyword">val</span> user2 = User(<span class="string">"Sara"</span>, <span class="number">25</span>, listOf(<span class="string">"Chess"</span>, <span class="string">"Music"</span>))</span><br><span class="line"> <span class="keyword">val</span> user3 = User(<span class="string">"Dave"</span>, <span class="number">34</span>, listOf(<span class="string">"Games"</span>, <span class="string">"Programming"</span>))</span><br><span class="line"> <span class="keyword">val</span> myList = listOf(user1, user2, user3)</span><br><span class="line">  </span><br><span class="line"> <span class="keyword">val</span> myMap = myList.map &#123; it.name to it &#125;.toMap()</span><br><span class="line"> println(myMap) <span class="comment">// &#123;John=User(name=John, age=18, hobbit=[Hiking, Running, Reading]), Sara=User(name=Sara, age=25, hobbit=[Chess, Music]), Dave=User(name=Dave, age=34, hobbit=[Games, Programming])&#125;</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">val</span> amap = myList.associateBy &#123; it.age &#125;</span><br><span class="line"> println(amap) <span class="comment">// &#123;18=User(name=John, age=18, hobbit=[Hiking, Running, Reading]), 25=User(name=Sara, age=25, hobbit=[Chess, Music]), 34=User(name=Dave, age=34, hobbit=[Games, Programming])&#125;</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é™¤äº†æœ€é€šç”¨çš„Arrayä»¥å¤–ï¼Œkotlinä¸­è¿˜æœ‰ä¸€ç±»å®¹å™¨ç»Ÿç§°ä¸ºColletion(é›†åˆ)ï¼Œä»–ä»¬æœ‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;List
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;List&lt;/strong&gt;ï¼šç»§æ‰¿Collectionã€‚ä¸€ä¸ªèŒƒæ€§æœ‰åºçš„åªè¯»é›†åˆã€‚å› ä¸ºæœ‰åºï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨g
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¼€å‘è¿‡ç¨‹ä¸­Mysql APIè®°å½•</title>
    <link href="https://nymrli.top/2021/12/26/%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADMysql-API%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2021/12/26/å¼€å‘è¿‡ç¨‹ä¸­Mysql-APIè®°å½•/</id>
    <published>2021-12-26T12:52:57.000Z</published>
    <updated>2021-12-26T13:27:57.967Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ—¶é—´æ“ä½œ"><a class="markdownIt-Anchor" href="#æ—¶é—´æ“ä½œ"></a> æ—¶é—´æ“ä½œ</h1><h2 id="time_to_sec"><a class="markdownIt-Anchor" href="#time_to_sec"></a> TIME_TO_SEC</h2><blockquote><p><a href="http://c.biancheng.net/mysql/" target="_blank" rel="noopener">MySQL</a> TIME_TO_SEC(time) å‡½æ•°è¿”å›å°†<strong>å‚æ•° time è½¬æ¢ä¸ºç§’æ•°çš„æ—¶é—´å€¼</strong>ï¼Œè½¬æ¢å…¬å¼ä¸ºâ€œå°æ—¶ Ã—3600+ åˆ†é’Ÿ Ã—60+ ç§’â€ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT TIME_TO_SEC(&apos;15:15:15&apos;);</span><br><span class="line">+-------------------------+</span><br><span class="line">| TIME_TO_SEC(&apos;15:15:15&apos;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                   54915 |</span><br><span class="line">+-------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select TIME_TO_SEC(&quot;2021-02-02 04:04:04&quot;);-- åªä¼šè€ƒè™‘æ—¶åˆ†ç§’ï¼Œä¸ä¼šè€ƒè™‘å¹´æœˆæ—¥</span><br><span class="line">+-------------------------+</span><br><span class="line">| TIME_TO_SEC(&quot;2021-02-02 04:04:04&quot;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                   14644 |</span><br><span class="line">+-------------------------+</span><br></pre></td></tr></table></figure><p>å…·ä½“å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT SEC_TO_TIME(TIME_TO_SEC(æ—¶é—´å­—æ®µ)- TIME_TO_SEC(æ—¶é—´å­—æ®µ)%(15*60)) as intervals from tablename</span><br><span class="line">group by intervals</span><br></pre></td></tr></table></figure><h2 id="sec_to_time"><a class="markdownIt-Anchor" href="#sec_to_time"></a> SEC_TO_TIME</h2><blockquote><p>è¿”å›å°†å‚æ•° seconds è½¬æ¢ä¸ºå°æ—¶ã€åˆ†é’Ÿå’Œç§’æ•°çš„æ—¶é—´å€¼ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT SEC_TO_TIME(&apos;54925&apos;);</span><br><span class="line">+----------------------+</span><br><span class="line">| SEC_TO_TIME(&apos;54925&apos;) |</span><br><span class="line">+----------------------+</span><br><span class="line">| 15:15:25             |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="date_format"><a class="markdownIt-Anchor" href="#date_format"></a> <a href="https://www.w3school.com.cn/sql/func_date_format.asp" target="_blank" rel="noopener">DATE_FORMAT</a></h2><blockquote><p>ç”¨äºä»¥ä¸åŒçš„æ ¼å¼æ˜¾ç¤ºæ—¥æœŸ/æ—¶é—´æ•°æ®: <code>DATE_FORMAT(date, format)</code></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DATE_FORMAT(NOW(),&apos;%b %d %Y %h:%i %p&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%m-%d-%Y&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%d %b %y&apos;)</span><br><span class="line">DATE_FORMAT(NOW(),&apos;%d %b %Y %T:%f&apos;)</span><br><span class="line"></span><br><span class="line">Dec 29 2008 11:45 PM</span><br><span class="line">12-29-2008</span><br><span class="line">29 Dec 08</span><br><span class="line">29 Dec 2008 16:25:46.635</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ—¶é—´æ“ä½œ&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ—¶é—´æ“ä½œ&quot;&gt;&lt;/a&gt; æ—¶é—´æ“ä½œ&lt;/h1&gt;
&lt;h2 id=&quot;time_to_sec&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#time_to_sec&quot;
      
    
    </summary>
    
    
      <category term="Mysql" scheme="https://nymrli.top/tags/Mysql/"/>
    
      <category term="å¼€å‘è®°å½•" scheme="https://nymrli.top/tags/%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>Pythonç§‘å­¦è®¡ç®—å¸¸ç”¨APIè®°å½•</title>
    <link href="https://nymrli.top/2021/12/26/Python%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E5%B8%B8%E7%94%A8API%E8%AE%B0%E5%BD%95/"/>
    <id>https://nymrli.top/2021/12/26/Pythonç§‘å­¦è®¡ç®—å¸¸ç”¨APIè®°å½•/</id>
    <published>2021-12-26T09:44:24.000Z</published>
    <updated>2021-12-28T11:57:10.265Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pandas"><a class="markdownIt-Anchor" href="#pandas"></a> pandas</h2><h3 id="to_numericç±»åˆ«ç¦»æ•£åŒ–"><a class="markdownIt-Anchor" href="#to_numericç±»åˆ«ç¦»æ•£åŒ–"></a> <strong>to_numeric</strong>ï¼šç±»åˆ«ç¦»æ•£åŒ–</h3><p>å‚æ•°æè¿°<br>argscalar, list, tuple, 1-d array, or Series<br>errors{â€˜ignoreâ€™, â€˜raiseâ€™, â€˜coerceâ€™}, default â€˜raiseâ€™<br>downcast{â€˜integerâ€™, â€˜signedâ€™, â€˜unsignedâ€™, â€˜floatâ€™} , default None,æŒ‡å®šè½¬æ¢çš„ç±»å‹,é»˜è®¤è¿”å›float64æˆ–int64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="string">'1.0'</span>, <span class="string">'2'</span>, <span class="number">-3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.to_numeric(s)</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">-3.0</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.to_numeric(s, downcast=<span class="string">'float'</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">-3.0</span></span><br><span class="line">dtype: float32</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.to_numeric(s, downcast=<span class="string">'signed'</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>   <span class="number">-3</span></span><br><span class="line">dtype: int8</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="string">'apple'</span>, <span class="string">'1.0'</span>, <span class="string">'2'</span>, <span class="number">-3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.to_numeric(s, errors=<span class="string">'ignore'</span>)</span><br><span class="line"><span class="number">0</span>    apple</span><br><span class="line"><span class="number">1</span>      <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>        <span class="number">2</span></span><br><span class="line"><span class="number">3</span>       <span class="number">-3</span></span><br><span class="line">dtype: object</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.to_numeric(s, errors=<span class="string">'coerce'</span>)</span><br><span class="line"><span class="number">0</span>    NaN</span><br><span class="line"><span class="number">1</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">-3.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š errorsä¸€èˆ¬é‡‡ç”¨&quot;ignore&quot;æˆ–è€…&quot;coerce&quot;ï¼›downcastæŒ‰ç…§éœ€æ±‚æ¥å¡«å†™</p><h3 id="ç¼ºå¤±å€¼ç©ºå€¼å¤„ç†"><a class="markdownIt-Anchor" href="#ç¼ºå¤±å€¼ç©ºå€¼å¤„ç†"></a> ç¼ºå¤±å€¼(ç©ºå€¼)å¤„ç†</h3><p><strong>ç›¸å…³å‡½æ•°</strong></p><ul><li>df.dropna()</li><li>df.fillna()</li><li>df.isnull()</li><li>df.isna()</li></ul><p><strong>ç›¸å…³æ¦‚å¿µ</strong></p><ul><li>ç©ºå€¼ï¼šåœ¨pandasä¸­çš„ç©ºå€¼æ˜¯&quot;&quot;</li><li>ç¼ºå¤±å€¼ï¼šåœ¨dataframeä¸­ä¸ºnanæˆ–è€…naTï¼ˆç¼ºå¤±æ—¶é—´ï¼‰ï¼Œåœ¨seriesä¸­ä¸ºnoneæˆ–è€…nanå³å¯</li></ul><h4 id="dropnaåˆ é™¤ç¼ºå¤±æ•°æ®"><a class="markdownIt-Anchor" href="#dropnaåˆ é™¤ç¼ºå¤±æ•°æ®"></a> <strong>dropna</strong>åˆ é™¤ç¼ºå¤±æ•°æ®</h4><p><code>DataFrame.dropna(axis=0, how='any', thresh=None, subset=None, inplace=False)</code>, å‡½æ•°ä½œç”¨ï¼šåˆ é™¤å«æœ‰ç©ºå€¼çš„è¡Œæˆ–åˆ—</p><ul><li>how:&quot;all&quot;è¡¨ç¤ºè¿™ä¸€è¡Œæˆ–åˆ—ä¸­çš„å…ƒç´ å…¨éƒ¨ç¼ºå¤±ï¼ˆä¸ºnanï¼‰æ‰åˆ é™¤è¿™ä¸€è¡Œæˆ–åˆ—ï¼Œ&quot;any&quot;è¡¨ç¤ºè¿™ä¸€è¡Œæˆ–åˆ—ä¸­åªè¦æœ‰å…ƒç´ ç¼ºå¤±ï¼Œå°±åˆ é™¤è¿™ä¸€è¡Œæˆ–åˆ—</li><li>thresh:ä¸€è¡Œæˆ–ä¸€åˆ—ä¸­è‡³å°‘å‡ºç°äº†threshä¸ªæ‰åˆ é™¤ã€‚</li><li>subsetï¼šåœ¨æŸäº›åˆ—çš„å­é›†ä¸­é€‰æ‹©å‡ºç°äº†ç¼ºå¤±å€¼çš„åˆ—åˆ é™¤ï¼Œä¸åœ¨å­é›†ä¸­çš„å«æœ‰ç¼ºå¤±å€¼å¾—åˆ—æˆ–è¡Œä¸ä¼šåˆ é™¤ï¼ˆæœ‰axiså†³å®šæ˜¯è¡Œè¿˜æ˜¯åˆ—ï¼‰</li><li>inplaceï¼šåˆ·é€‰è¿‡ç¼ºå¤±å€¼å¾—æ–°æ•°æ®æ˜¯å­˜ä¸ºå‰¯æœ¬è¿˜æ˜¯ç›´æ¥åœ¨åŸæ•°æ®ä¸Šè¿›è¡Œä¿®æ”¹ã€‚</li></ul><p>é»˜è®¤å‚æ•°ï¼šåˆ é™¤è¡Œï¼Œåªè¦æœ‰ç©ºå€¼å°±ä¼šåˆ é™¤ï¼Œä¸æ›¿æ¢ã€‚</p><h4 id="fillnaå¡«å……ç¼ºå¤±æ•°æ®"><a class="markdownIt-Anchor" href="#fillnaå¡«å……ç¼ºå¤±æ•°æ®"></a> Fillnaå¡«å……ç¼ºå¤±æ•°æ®</h4><p><strong>å¤„ç†Serieså¯¹è±¡</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> nan <span class="keyword">as</span> NaN</span><br><span class="line"></span><br><span class="line">s = [<span class="number">1</span>, NaN, <span class="number">2</span>, <span class="number">3</span>, NaN]</span><br><span class="line">df = pd.Series(s)</span><br><span class="line">df = df.fillna(<span class="number">5</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure><p><strong>å¤„ç†DataFrameå¯¹è±¡</strong></p><ol><li><p>ä¸ºæ‰€æœ‰çš„NaNçš„ä½ç½®å¡«å……ä¸€ä¸ªç¡®å®šå€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> nan <span class="keyword">as</span> NaN</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame([[<span class="number">1</span>, NaN, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">1</span>, <span class="number">2</span>, NaN, <span class="number">3</span>, NaN]])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">df = df.fillna(<span class="number">5</span>)</span><br><span class="line">print(df)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   0    1    2  3   4</span></span><br><span class="line"><span class="string">0  1  NaN  2.0  3 NaN</span></span><br><span class="line"><span class="string">1  1  2.0  NaN  3 NaN</span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">   0    1    2  3    4</span></span><br><span class="line"><span class="string">0  1  5.0  2.0  3  5.0</span></span><br><span class="line"><span class="string">1  1  2.0  5.0  3  5.0</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></li><li><p>é€šè¿‡å­—å…¸ä¸ºä¸åŒçš„åˆ—å¡«å……ä¸åŒçš„å¸¸æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([[<span class="number">1</span>, NaN, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">1</span>, <span class="number">2</span>, NaN, <span class="number">3</span>, NaN]], columns=[<span class="string">"1st"</span>, <span class="string">"2nd"</span>, <span class="string">"3rd"</span>, <span class="string">"4th"</span>, <span class="string">"5th"</span>])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">df = df.fillna(&#123;<span class="string">"5th"</span>: <span class="number">100</span>&#125;)</span><br><span class="line">print(df)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th  5th</span></span><br><span class="line"><span class="string">0    1  NaN  2.0    3  NaN</span></span><br><span class="line"><span class="string">1    1  2.0  NaN    3  NaN</span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th    5th</span></span><br><span class="line"><span class="string">0    1  NaN  2.0    3  100.0</span></span><br><span class="line"><span class="string">1    1  2.0  NaN    3  100.0</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></li></ol><p>methodå‚æ•°ï¼šæ”¹å˜æ›¿ä»£å€¼çš„æ–¹å¼ï¼Œå½“ä¸ºâ€™ffillâ€™ï¼Œè¡¨ç¤ºç”¨å‰é¢çš„å€¼å¡«å……ï¼Œå½“â€™bfillâ€™è¡¨ç¤ºç”¨åé¢çš„å€¼å¡«å……ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([[<span class="number">1</span>, NaN, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">1</span>, <span class="number">2</span>, NaN, <span class="number">3</span>, NaN]], columns=[<span class="string">"1st"</span>, <span class="string">"2nd"</span>, <span class="string">"3rd"</span>, <span class="string">"4th"</span>, <span class="string">"5th"</span>])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">df = df.fillna(method=<span class="string">"ffill"</span>)  <span class="comment"># bfill</span></span><br><span class="line">print(df)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th  5th</span></span><br><span class="line"><span class="string">0    1  NaN  2.0    3  NaN</span></span><br><span class="line"><span class="string">1    1  2.0  NaN    3  NaN</span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th  5th</span></span><br><span class="line"><span class="string">0    1  NaN  2.0    3  NaN</span></span><br><span class="line"><span class="string">1    1  2.0  2.0    3  NaN</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame([[<span class="number">1</span>, NaN, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">1</span>, <span class="number">2</span>, NaN, <span class="number">3</span>, NaN]], columns=[<span class="string">"1st"</span>, <span class="string">"2nd"</span>, <span class="string">"3rd"</span>, <span class="string">"4th"</span>, <span class="string">"5th"</span>])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">df = df.fillna(method=<span class="string">"bfill"</span>)  <span class="comment"># bfill</span></span><br><span class="line">print(df)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th  5th</span></span><br><span class="line"><span class="string">0    1  NaN  2.0    3  NaN</span></span><br><span class="line"><span class="string">1    1  2.0  NaN    3  NaN</span></span><br><span class="line"><span class="string">----------</span></span><br><span class="line"><span class="string">   1st  2nd  3rd  4th  5th</span></span><br><span class="line"><span class="string">0    1  2.0  2.0    3  NaN</span></span><br><span class="line"><span class="string">1    1  2.0  NaN    3  NaN</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>å‚æ•°ï¼š</p><ul><li>methodï¼šFillnaOptionsï¼Œffill/forwardfill:ç”¨ç¼ºå¤±å€¼å‰é¢çš„ä¸€ä¸ªå€¼ä»£æ›¿ç¼ºå¤±å€¼ï¼›bfill/backfillï¼Œç¼ºå¤±å€¼åé¢çš„ä¸€ä¸ªå€¼ä»£æ›¿å‰é¢çš„ç¼ºå¤±å€¼ã€‚æ³¨æ„è¿™ä¸ªå‚æ•°ä¸èƒ½ä¸valueåŒæ—¶å‡ºç°ï¼ˆvalue:éœ€è¦ç”¨ä»€ä¹ˆå€¼å»å¡«å……ç¼ºå¤±å€¼ï¼‰</li><li>axisï¼šå‚æ•°é»˜è®¤ä¸º0ï¼Œå³æ²¿ç€è¡Œå¡«å……ï¼Œä¸º1åˆ™æ²¿ç€åˆ—å¡«å……</li><li>limitï¼šä¼ å…¥<code>limit</code>é™åˆ¶å¡«å……ä¸ªæ•°</li><li>inplaceï¼šä¼ å…¥inplaceå‚æ•°:æ˜¯å¦åœ¨åŸæ¥çš„æ•°æ®ä¸Šæ“ä½œï¼Œé»˜è®¤ä¸ºFalseï¼Œè¡¨ç¤ºé‡æ–°æ‹·è´äº†ä¸€ä»½æ•°æ®ï¼Œç„¶ååœ¨æ‹·è´çš„æ•°æ®ä¸Šæ“ä½œã€‚</li></ul><h3 id="dateframeæ“ä½œ"><a class="markdownIt-Anchor" href="#dateframeæ“ä½œ"></a> DateFrameæ“ä½œ</h3><h4 id="æ·»åŠ è¡Œ"><a class="markdownIt-Anchor" href="#æ·»åŠ è¡Œ"></a> æ·»åŠ è¡Œ</h4><p>**æ·»åŠ ä¸€è¡Œï¼š**é‡‡ç”¨<code>loc[]</code>æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„é€ ä¸€ä¸ªç©ºçš„dataframe</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.DataFrame(columns=[<span class="string">'name'</span>,<span class="string">'number'</span>])</span><br><span class="line"><span class="comment"># é‡‡ç”¨.locçš„æ–¹æ³•è¿›è¡Œ</span></span><br><span class="line">df.loc[<span class="number">0</span>]=[<span class="string">'cat'</span>, <span class="number">3</span>]  <span class="comment"># å…¶ä¸­loc[]ä¸­éœ€è¦åŠ å…¥çš„æ˜¯æ’å…¥åœ°æ–¹dataframeçš„ç´¢å¼•ï¼Œé»˜è®¤æ˜¯æ•´æ•°å‹</span></span><br><span class="line"><span class="comment"># ä¹Ÿå¯é‡‡ç”¨è¯¸å¦‚df.loc['a'] = ['123',30]çš„å½¢å¼</span></span><br></pre></td></tr></table></figure><p><strong>æ·»åŠ å¤šè¡Œ</strong>==&gt;(åˆå¹¶å¦ä¸€ä¸ªdateframe)ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. é‡‡ç”¨appendæ–¹æ³•åˆå¹¶ä¸¤ä¸ªdataframe</span></span><br><span class="line"><span class="comment"># æ„é€ ä¸¤ä¸ªdataframe</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], columns=<span class="keyword">list</span>(<span class="string">'AB'</span>))</span><br><span class="line">df2 = pd.DataFrame([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]], columns=<span class="keyword">list</span>(<span class="string">'AB'</span>))</span><br><span class="line"><span class="comment"># åˆå¹¶  ignore_indexè®¾ç½®ä¸º Trueå¯ä»¥é‡æ–°æ’åˆ—ç´¢å¼•</span></span><br><span class="line">df.append(df2, ignore_index=<span class="keyword">True</span>)</span><br><span class="line">   A  B</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line"><span class="number">1</span>  <span class="number">3</span>  <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">3</span>  <span class="number">7</span>  <span class="number">8</span></span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ åˆ—"><a class="markdownIt-Anchor" href="#æ·»åŠ åˆ—"></a> æ·»åŠ åˆ—</h4><p>é‡‡ç”¨<code>df[]</code>æ–¹æ³•ç›´æ¥åœ¨åˆ—ä¸Šæ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªdataframe</span></span><br><span class="line">df = pd.DataFrame(columns=[<span class="string">'name'</span>,<span class="string">'number'</span>], data=[[<span class="string">'cat'</span>,<span class="number">3</span>]])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">df</span></span><br><span class="line"><span class="string">  name  number</span></span><br><span class="line"><span class="string">0  cat       3</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># æ·»åŠ ä¸€åˆ—ï¼Œè®¡ç®—æœ‰å¤šå°‘æ¡è…¿</span></span><br><span class="line">df[<span class="string">'leg'</span>] = df[<span class="string">'number'</span>] * <span class="number">4</span></span><br><span class="line"><span class="comment"># æ·»åŠ ä¸€åˆ—ï¼Œç›´æ¥èµ‹å€¼æœ‰å‡ ä¸ªå¤´</span></span><br><span class="line">df[<span class="string">'head'</span>] = <span class="number">1</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">df </span></span><br><span class="line"><span class="string">  name  number  leg  head</span></span><br><span class="line"><span class="string">0  cat       3   12     1</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>é‡‡ç”¨<code>insert()</code>æ–¹æ³•(è¿‡æ—¶deprecated)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨æ–¹æ³•æ˜¯DataFrame.insert(loc, column, value, allow_duplicates=False)</span></span><br><span class="line"><span class="comment"># å³df.insert(æ·»åŠ åˆ—ä½ç½®ç´¢å¼•åºå·ï¼Œæ·»åŠ åˆ—åï¼Œæ•°å€¼ï¼Œæ˜¯å¦å…è®¸åˆ—åé‡å¤)</span></span><br><span class="line">df.insert(<span class="number">1</span>, <span class="string">'tail'</span>, <span class="number">1</span>, allow_duplicates=<span class="keyword">False</span>)</span><br><span class="line">df</span><br><span class="line">  name  tail  number  leg  head</span><br><span class="line"><span class="number">0</span>  cat     <span class="number">1</span>       <span class="number">3</span>   <span class="number">12</span>     <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="åˆå¹¶å¤šä¸ªdataframe"><a class="markdownIt-Anchor" href="#åˆå¹¶å¤šä¸ªdataframe"></a> åˆå¹¶å¤šä¸ªDataFrame</h3><p><a href="https://blog.csdn.net/milton2017/article/details/54406482/" target="_blank" rel="noopener">https://blog.csdn.net/milton2017/article/details/54406482/</a></p><h4 id="è·å¾—æ»¡è¶³æ¡ä»¶çš„è¡Œæˆ–è€…åˆ—"><a class="markdownIt-Anchor" href="#è·å¾—æ»¡è¶³æ¡ä»¶çš„è¡Œæˆ–è€…åˆ—"></a> è·å¾—æ»¡è¶³æ¡ä»¶çš„è¡Œæˆ–è€…åˆ—</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–DataFrameä¸­numTeståˆ—çš„å€¼å¤§äº2çš„è¡Œå†…å®¹</span></span><br><span class="line">arr1 = arr[arr[<span class="string">'numTest'</span>]&gt;<span class="number">2</span>]</span><br><span class="line">print(arr1)</span><br><span class="line"><span class="comment"># è·å–å“ªå‡ è¡Œç¬¦åˆæ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯è·å–ç¬¦åˆæ¡ä»¶çš„è¡Œçš„ç´¢å¼•å€¼</span></span><br><span class="line">result = arr[arr[<span class="string">'numTest'</span>]&gt;<span class="number">2</span>].index.tolist()</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><ul><li><p>ç›´æ¥ç­›é€‰</p><p>ç›´æ¥ä½¿ç”¨åˆ—éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œå¦‚æœéœ€è¦å¤šä¸ªåˆ—åŒæ—¶æ»¡è¶³æ¡ä»¶ï¼Œä½¿ç”¨â€™&amp;â€˜ç¬¦å·è¿æ¥å³å¯ï¼›å¦‚æœåªéœ€è¦æŸä¸€åˆ—æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä½¿ç”¨â€™|'è¿æ¥å¤šä¸ªåˆ—çš„æ¡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">some = all_data[(all_data[<span class="string">'User_id'</span>] == <span class="number">1439408</span>) &amp; (all_data[<span class="string">'Date'</span>].isna())]</span><br><span class="line">print(some)</span><br><span class="line"><span class="comment"># å¾—åˆ°äº†User_id=1439408å’ŒDateä¸ºç©ºçš„æ•°æ®é¡¹</span></span><br><span class="line">   User_id  Merchant_id  Coupon_id Discount_rate  Distance  Date_received  Date</span><br><span class="line"><span class="number">1</span>  <span class="number">1439408</span>         <span class="number">4663</span>    <span class="number">11002.0</span>        <span class="number">150</span>:<span class="number">20</span>       <span class="number">1.0</span>     <span class="number">20160528.0</span>   NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">8591.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160217.0</span>   NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">1078.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160319.0</span>   NaN</span><br><span class="line"><span class="number">4</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">8591.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160613.0</span>   NaN</span><br></pre></td></tr></table></figure></li><li><p>åŸºäºmapç­›é€‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">user_requried = all_data[<span class="string">'User_id'</span>].map(<span class="keyword">lambda</span> x : x==<span class="number">1439408</span>)</span><br><span class="line">date_requried = all_data[<span class="string">'Date'</span>].map(<span class="keyword">lambda</span> x : np.isnan(x))</span><br><span class="line">some = all_data[user_requried &amp; date_requried]</span><br><span class="line">print(some) </span><br><span class="line"><span class="comment"># ç»“æœï¼šå…¶ä¸­mapè¿”å›çš„å€¼å¿…é¡»æ˜¯boolç±»å‹ï¼Œå³æŸä¸€ä¸ªæ¡ä»¶ã€‚ç„¶åä½¿ç”¨ç›´æ¥ç­›é€‰çš„æ–¹å¼ï¼ŒæŠŠæ¡ä»¶åˆå¹¶ï¼Œæœ€ç»ˆå¾—å‡ºç­›é€‰çš„ç»“æœã€‚æˆ‘è®¤ä¸ºä½¿ç”¨æ­¤ç§ç±»å‹çš„æ–¹æ³•æ›´åŠ çš„ä¼˜ç¾ã€‚</span></span><br><span class="line"></span><br><span class="line">   User_id  Merchant_id  Coupon_id Discount_rate  Distance  Date_received  Date</span><br><span class="line"><span class="number">1</span>  <span class="number">1439408</span>         <span class="number">4663</span>    <span class="number">11002.0</span>        <span class="number">150</span>:<span class="number">20</span>       <span class="number">1.0</span>     <span class="number">20160528.0</span>   NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">8591.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160217.0</span>   NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">1078.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160319.0</span>   NaN</span><br><span class="line"><span class="number">4</span>  <span class="number">1439408</span>         <span class="number">2632</span>     <span class="number">8591.0</span>          <span class="number">20</span>:<span class="number">1</span>       <span class="number">0.0</span>     <span class="number">20160613.0</span>   NaN</span><br></pre></td></tr></table></figure></li><li><p>åŸºäºqueryæ–¹æ³•ç­›é€‰</p><p>ç›´æ¥å†™è¡¨è¾¾å¼ï¼Œå¾—å‡ºæƒ³è¦ç­›é€‰çš„ç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">some = all_data.query(<span class="string">'(User_id == 1439408)'</span>)</span><br><span class="line">print(some)</span><br><span class="line"><span class="comment">#ç»“æœï¼šç›´æ¥å†™è¡¨è¾¾å¼å®¹æ˜“è§¦å‘ä¸€äº›ä¸å¿…è¦çš„é—®é¢˜ï¼ˆå€¼çš„ç±»å‹å®¹æ˜“å‡ºé”™ï¼Œä¸€äº›ç‰¹æ®Šå€¼çš„è¡¨è¾¾å›°éš¾ç­‰ï¼‰ï¼Œæ‰€ä»¥å¹¶ä¸å»ºè®®ä½¿ç”¨è¿™æ ·çš„æ–¹æ³•ã€‚</span></span><br></pre></td></tr></table></figure></li></ul><p>æ€»ç»“ï¼š</p><ul><li>ç¡®å®šä¸€ä¸ªæ¡ä»¶â€“&gt; df[â€˜moneyâ€™]&gt;10000)</li><li>ç¡®å®šæ»¡è¶³æ¡ä»¶çš„è¡Œâ€“&gt; df[(df[â€˜moneyâ€™]&gt;10000)]</li><li>ç¡®å®šè¿™äº›è¡Œçš„indexâ€“&gt; df[(df[â€˜moneyâ€™]&gt;10000)].index.tolist()ï¼Œ è¿”å›çš„æ˜¯ä¸€ä¸ªlist</li></ul><h4 id="é€‰å–æŒ‡å®šåˆ—å±•ç¤º"><a class="markdownIt-Anchor" href="#é€‰å–æŒ‡å®šåˆ—å±•ç¤º"></a> é€‰å–æŒ‡å®šåˆ—å±•ç¤º</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é€‰å–æŒ‡å®šçš„åˆ—, ä¸­é—´å†™çš„æ˜¯æ¡ä»¶ï¼Œ ç±»æ¯” df = df[ df["sale"] &gt; 50 ]</span></span><br><span class="line">df = df[ [<span class="string">"sku"</span>,<span class="string">"ebayno"</span>,<span class="string">"sale"</span>] ]</span><br></pre></td></tr></table></figure><h2 id="jieba"><a class="markdownIt-Anchor" href="#jieba"></a> Jieba</h2><blockquote><p>æ–‡æœ¬ç±»çš„æ•°æ®åˆ†æï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ†è¯+è¯äº‘å±•ç¤º</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(data_path)</span><br><span class="line">all_content = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(data[<span class="string">'è¯„è®ºæ ‡é¢˜'</span>])):</span><br><span class="line">all_content = all_content + data[<span class="string">'è¯„è®ºæ ‡é¢˜'</span>][i]</span><br><span class="line">cut_text = <span class="string">" "</span>.join(jieba.cut(all_content))</span><br></pre></td></tr></table></figure><h2 id="wordcloud"><a class="markdownIt-Anchor" href="#wordcloud"></a> WordCloud</h2><blockquote><p>å°†æ•°æ®ä¿å­˜åå°±è¦è¿›è¡Œå¯è§†åŒ–å±•ç¤ºï¼Œä¸€èˆ¬æ–‡æœ¬ç±»çš„éƒ½ä¼šé‡‡ç”¨è¯äº‘</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line"></span><br><span class="line">wordcloud = WordCloud(font_path=ciyunfont_path, mask=background_image, background_color=<span class="string">'white'</span>).generate(cut_text)</span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(result_path):</span><br><span class="line">    os.makedirs(result_path)</span><br><span class="line"><span class="comment"># ä¿å­˜ç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line">plt.savefig(<span class="string">f'<span class="subst">&#123;result_path&#125;</span>/ciyun.png'</span>)</span><br><span class="line"><span class="comment"># æŒ‡å®šè¯äº‘å›¾ä¸ºå¾…æ˜¾ç¤ºçš„å›¾ç‰‡</span></span><br><span class="line">plt.imshow(wordcloud, interpolation=<span class="string">"bilinear"</span>)</span><br><span class="line">plt.axis(<span class="string">"off"</span>)</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;pandas&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#pandas&quot;&gt;&lt;/a&gt; pandas&lt;/h2&gt;
&lt;h3 id=&quot;to_numericç±»åˆ«ç¦»æ•£åŒ–&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#to
      
    
    </summary>
    
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Pythonä¸­å…³äºå›¾ç‰‡çš„æ“ä½œ</title>
    <link href="https://nymrli.top/2021/12/26/Python%E4%B8%AD%E5%85%B3%E4%BA%8E%E5%9B%BE%E7%89%87%E7%9A%84%E8%AF%BB%E5%8F%96/"/>
    <id>https://nymrli.top/2021/12/26/Pythonä¸­å…³äºå›¾ç‰‡çš„è¯»å–/</id>
    <published>2021-12-26T08:16:29.000Z</published>
    <updated>2021-12-26T08:32:11.523Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä»£ç çš„æ—¶å€™ä¸€ç›´è®°é”™åº“ä¸‹å¯¹åº”çš„å›¾ç‰‡æ“ä½œå‡½æ•°åä»¥åŠä»–ä»¬çš„è¿”å›å€¼ç±»å‹ï¼Œå¹²è„†å†™ä¸ªç¬”è®°è®°å½•ä¸‹ã€‚</p></blockquote><p>å›¾ç‰‡è¯»å–ç›¸å…³çš„åŒ…ï¼š</p><ul><li>matplotlib</li><li>PIL/</li><li>cv2</li><li>numpy</li></ul><h1 id="è¯»å–"><a class="markdownIt-Anchor" href="#è¯»å–"></a> è¯»å–</h1><h2 id="matplotlibpyplot-pylab"><a class="markdownIt-Anchor" href="#matplotlibpyplot-pylab"></a> matplotlib.pyplot / pylab</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># from matplotlib import pyplot as plt</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = plt.imread(<span class="string">'examples.png'</span>)</span><br><span class="line">print(type(img), img.dtype, np.min(img), np.max(img))</span><br><span class="line"></span><br><span class="line">[out]</span><br><span class="line">(&lt;type <span class="string">'numpy.ndarray'</span>&gt;, dtype(<span class="string">'float32'</span>), <span class="number">0.0</span>, <span class="number">1.0</span>)    <span class="comment"># matplotlibè¯»å–è¿›æ¥çš„å›¾ç‰‡æ˜¯floatï¼Œ0-1</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼špylabå’ŒpyplotåŒºåˆ«ï¼šå‰è€…å°†numpyã€ä»¥åŠå„ä¸ªåŠŸèƒ½å‡½æ•°å¯¼å…¥äº†å…¶å‘½åç©ºé—´ä¸­ã€‚è¿™æ ·ä¼šä½¿pylabè¡¨ç°çš„å’Œmatlabæ›´åŠ ç›¸ä¼¼ã€‚ç°åœ¨æ¥è¯´æˆ‘ä»¬ç»å¸¸ä½¿ç”¨pyplotï¼Œå› ä¸ºpyplotç›¸æ¯”pylabæ›´åŠ çº¯ç²¹ã€‚</p><h2 id="pilimageopen"><a class="markdownIt-Anchor" href="#pilimageopen"></a> PIL.image.open</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = Image.open(<span class="string">'examples.png'</span>)</span><br><span class="line">print(type(img), np.min(img), np.max(img))</span><br><span class="line">img = np.array(img)     <span class="comment"># å°†PILæ ¼å¼å›¾ç‰‡è½¬ä¸ºnumpyæ ¼å¼</span></span><br><span class="line">print(type(img), img.dtype, np.min(img), np.max(img))</span><br><span class="line"></span><br><span class="line">[out]</span><br><span class="line">(&lt;class 'PIL.PngImagePlugin.PngImageFile'&gt;, 0, 255)    # æ³¨æ„ï¼ŒPILæ˜¯æœ‰è‡ªå·±çš„æ•°æ®ç»“æ„çš„ï¼Œä½†æ˜¯å¯ä»¥è½¬æ¢æˆnumpyæ•°ç»„</span><br><span class="line">(&lt;type <span class="string">'numpy.ndarray'</span>&gt;, dtype(<span class="string">'uint8'</span>), <span class="number">0</span>, <span class="number">255</span>)    <span class="comment"># å’Œç”¨matplotlibè¯»å–ä¸åŒï¼ŒPILå’Œmatlabç›¸åŒï¼Œè¯»è¿›æ¥å›¾ç‰‡å’Œå…¶å­˜å‚¨åœ¨ç¡¬ç›˜çš„æ ·å­æ˜¯ä¸€æ ·çš„ï¼Œuint8ï¼Œ0-255</span></span><br></pre></td></tr></table></figure><p>PILè¯»å–çš„ç»“æœæ˜¯Imageæ ¼å¼çš„ï¼Œéœ€è¦å†é¢å¤–è½¬æ¢æˆnp.arrayçš„å½¢å¼</p><h2 id="cv2imread"><a class="markdownIt-Anchor" href="#cv2imread"></a> cv2.imread</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = cv2.imread(<span class="string">'examples.png'</span>)    <span class="comment"># é»˜è®¤æ˜¯è¯»å…¥ä¸ºå½©è‰²å›¾ï¼Œå³ä½¿åŸå›¾æ˜¯ç°åº¦å›¾ä¹Ÿä¼šå¤åˆ¶æˆä¸‰ä¸ªç›¸åŒçš„é€šé“å˜æˆå½©è‰²å›¾</span></span><br><span class="line">img_gray = cv2.imread(<span class="string">'examples.png'</span>, <span class="number">0</span>)    <span class="comment"># ç¬¬äºŒä¸ªå‚æ•°ä¸º0çš„æ—¶å€™è¯»å…¥ä¸ºç°åº¦å›¾ï¼Œå³ä½¿åŸå›¾æ˜¯å½©è‰²å›¾ä¹Ÿä¼šè½¬æˆç°åº¦å›¾</span></span><br><span class="line">print(type(img), img.dtype, np.min(img), np.max(img))</span><br><span class="line">print(img.shape)</span><br><span class="line">print(img_gray.shape)</span><br><span class="line"></span><br><span class="line">[out]</span><br><span class="line">(&lt;type <span class="string">'numpy.ndarray'</span>&gt;, dtype(<span class="string">'uint8'</span>), <span class="number">0</span>, <span class="number">255</span>)    <span class="comment"># opencvè¯»è¿›æ¥çš„æ˜¯numpyæ•°ç»„ï¼Œç±»å‹æ˜¯uint8ï¼Œ0-255</span></span><br><span class="line">(<span class="number">824</span>, <span class="number">987</span>, <span class="number">3</span>)    <span class="comment"># å½©è‰²å›¾3é€šé“</span></span><br><span class="line">(<span class="number">824</span>, <span class="number">987</span>)    <span class="comment"># ç°åº¦å›¾å•é€šé“</span></span><br></pre></td></tr></table></figure><p><em>æ³¨æ„ï¼Œpylab.imreadå’ŒPIL.Image.openè¯»å…¥çš„éƒ½æ˜¯RBGé¡ºåºï¼Œè€Œcv2.imreadè¯»å…¥çš„æ˜¯BGRé¡ºåºï¼Œæ··åˆä½¿ç”¨çš„æ—¶å€™è¦ç‰¹å¤‡æ³¨æ„</em></p><h1 id="ä¿å­˜"><a class="markdownIt-Anchor" href="#ä¿å­˜"></a> ä¿å­˜</h1><h2 id="pltsavefig"><a class="markdownIt-Anchor" href="#pltsavefig"></a> plt.savefig()</h2><blockquote><p>savefig()æ–¹æ³•ç”¨äºä¿å­˜ç»˜åˆ¶æ•°æ®ååˆ›å»ºçš„å›¾å½¢ã€‚ä½¿ç”¨æ­¤æ–¹æ³•å¯ä»¥å°†åˆ›å»ºçš„å›¾å½¢ä¿å­˜åˆ°æˆ‘ä»¬çš„æœ¬åœ°è®¡ç®—æœºä¸­ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wordcloud = WordCloud(font_path=ciyunfont_path, mask=background_image, background_color=<span class="string">'white'</span>).generate(cut_text)</span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(result_path):</span><br><span class="line">    os.makedirs(result_path)</span><br><span class="line">    <span class="comment"># ä¿å­˜ç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line">    plt.savefig(<span class="string">f'<span class="subst">&#123;result_path&#125;</span>/ciyun.png'</span>)</span><br><span class="line">    <span class="comment"># æŒ‡å®šè¯äº‘å›¾ä¸ºå¾…æ˜¾ç¤ºçš„å›¾ç‰‡</span></span><br><span class="line">    plt.imshow(wordcloud, interpolation=<span class="string">"bilinear"</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œ ä½¿ç”¨savefigçš„è¯å¾—æ³¨æ„ä¸plt.show()çš„ä½ç½®ï¼Œå¦‚æœå…ˆ<code>plt.show()</code>äº†åˆ™ä¿å­˜çš„æ˜¯ç©ºç™½å›¾ç‰‡ã€‚</p><h2 id="pilimage-ä¿å­˜pilæ ¼å¼çš„å›¾ç‰‡"><a class="markdownIt-Anchor" href="#pilimage-ä¿å­˜pilæ ¼å¼çš„å›¾ç‰‡"></a> PIL.image - ä¿å­˜PILæ ¼å¼çš„å›¾ç‰‡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.open(<span class="string">'examples.png'</span>)</span><br><span class="line">img.save(<span class="string">'examples2.png'</span>)</span><br><span class="line">img_gray = img.convert(<span class="string">'L'</span>)</span><br><span class="line">img_gray.save(<span class="string">'examples_gray.png'</span>)    <span class="comment"># ä¸ç®¡æ˜¯ç°åº¦è¿˜æ˜¯å½©è‰²ï¼Œç›´æ¥ç”¨saveå‡½æ•°ä¿å­˜å°±å¯ä»¥ï¼Œä½†æ³¨æ„ï¼Œåªæœ‰PILæ ¼å¼çš„å›¾ç‰‡èƒ½å¤Ÿç”¨saveå‡½æ•°</span></span><br></pre></td></tr></table></figure><h2 id="cv2imwrite"><a class="markdownIt-Anchor" href="#cv2imwrite"></a> cv2.imwrite</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">img = cv2.imread(<span class="string">'examples.png'</span>)    <span class="comment"># è¿™æ˜¯BGRå›¾ç‰‡</span></span><br><span class="line">cv2.imwrite(<span class="string">'examples2.png'</span>, img)    <span class="comment"># è¿™é‡Œä¹Ÿåº”è¯¥ç”¨BGRå›¾ç‰‡ä¿å­˜ï¼Œè¿™é‡Œè¦éå¸¸æ³¨æ„ï¼Œå› ä¸ºç”¨pylabæˆ–PILè¯»å…¥çš„å›¾ç‰‡éƒ½æ˜¯RGBçš„ï¼Œå¦‚æœè¦ç”¨opencvå­˜å›¾ç‰‡å°±å¿…é¡»åšä¸€ä¸ªè½¬æ¢</span></span><br><span class="line">img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span><br><span class="line">cv2.imwrite(<span class="string">'examples_gray.png'</span>, img_gray)</span><br></pre></td></tr></table></figure><h1 id="ç°åº¦å›¾-rgbå›¾ç›¸äº’è½¬æ¢"><a class="markdownIt-Anchor" href="#ç°åº¦å›¾-rgbå›¾ç›¸äº’è½¬æ¢"></a> ç°åº¦å›¾-RGBå›¾ç›¸äº’è½¬æ¢</h1><h2 id="1-pilimage"><a class="markdownIt-Anchor" href="#1-pilimage"></a> 1  PIL.Image</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.open(<span class="string">'examples.png'</span>)</span><br><span class="line">img_gray = img.convert(<span class="string">'L'</span>)    <span class="comment"># RGBè½¬æ¢æˆç°åº¦å›¾åƒ</span></span><br><span class="line">img_rgb = img_gray.convert(<span class="string">'RGB'</span>) <span class="comment"># ç°åº¦è½¬RGB</span></span><br><span class="line">print(img)</span><br><span class="line">print(img_gray)</span><br><span class="line">print(img_rgb)</span><br><span class="line"></span><br><span class="line">[out]</span><br><span class="line">&lt;PIL.PngImagePlugin.PngImageFile image mode=RGB size=<span class="number">987</span>x824 at <span class="number">0x7FC2CCAE04D0</span>&gt;</span><br><span class="line">&lt;PIL.Image.Image image mode=L size=<span class="number">987</span>x824 at <span class="number">0x7FC2CCAE0990</span>&gt;</span><br><span class="line">&lt;PIL.Image.Image image mode=RGB size=<span class="number">987</span>x824 at <span class="number">0x7FC2CCAE0250</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="2-cv2æ³¨æ„opencvåœ¨è¯»å…¥å›¾ç‰‡çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡å‚æ•°å®ç°é¢œè‰²é€šé“çš„è½¬æ¢ä¸‹é¢æ˜¯ç”¨åˆ«çš„æ–¹å¼å®ç°"><a class="markdownIt-Anchor" href="#2-cv2æ³¨æ„opencvåœ¨è¯»å…¥å›¾ç‰‡çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡å‚æ•°å®ç°é¢œè‰²é€šé“çš„è½¬æ¢ä¸‹é¢æ˜¯ç”¨åˆ«çš„æ–¹å¼å®ç°"></a> 2  cv2ï¼ˆæ³¨æ„ï¼Œopencvåœ¨è¯»å…¥å›¾ç‰‡çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡å‚æ•°å®ç°é¢œè‰²é€šé“çš„è½¬æ¢ï¼Œä¸‹é¢æ˜¯ç”¨åˆ«çš„æ–¹å¼å®ç°ï¼‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> plt</span><br><span class="line">img = cv2.imread(<span class="string">'examples.png'</span>)</span><br><span class="line">img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)    <span class="comment"># BGRè½¬ç°åº¦</span></span><br><span class="line">img_bgr = cv2.cvtColor(img_gray, cv2.COLOR_GRAY2BGR)    <span class="comment"># ç°åº¦è½¬BRG</span></span><br><span class="line">img_rgb = cv2.cvtColor(img_gray, cv2.COLOR_GRAY2RGB)    <span class="comment"># ä¹Ÿå¯ä»¥ç°åº¦è½¬RGB</span></span><br></pre></td></tr></table></figure><p>from: <a href="https://www.jianshu.com/p/3977d674da85" target="_blank" rel="noopener">numpyã€cv2ç­‰æ“ä½œå›¾ç‰‡åŸºæœ¬æ“ä½œ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å†™ä»£ç çš„æ—¶å€™ä¸€ç›´è®°é”™åº“ä¸‹å¯¹åº”çš„å›¾ç‰‡æ“ä½œå‡½æ•°åä»¥åŠä»–ä»¬çš„è¿”å›å€¼ç±»å‹ï¼Œå¹²è„†å†™ä¸ªç¬”è®°è®°å½•ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å›¾ç‰‡è¯»å–ç›¸å…³çš„åŒ…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;matplotlib&lt;/li&gt;
&lt;li&gt;PIL/&lt;/li&gt;
&lt;li&gt;cv
      
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="https://nymrli.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="Python" scheme="https://nymrli.top/tags/Python/"/>
    
  </entry>
  
</feed>
