<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="Mrli"><meta name="renderer" content="webkit"><meta name="copyright" content="Mrli"><meta name="keywords" content="Mrli's Blog"><meta name="description" content="æƒ³å’Œä½ è®²ï¼Œè¯´äº†ä¼šå¿ƒåŠ¨ ï¼Œç¼„é»˜ä¼šå¿ƒå®‰ã€‚"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½• Â· Mr.li's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="https://avatars1.githubusercontent.com/u/31088082?s=400&amp;u=7a99ff83916afb3f4c5312bd78a1be17fe0e34ed&amp;v=4"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">Mrli</div><div class="profile-signature">åˆ«è£…ä½œå¾ˆåŠªåŠ›,<br>å› ä¸ºç»“å±€ä¸ä¼šé™ªä½ æ¼”æˆã€‚</div><div class="contacts"><div>Contacts:</div><span><a href="http://sighttp.qq.com/msgrd?v=1&amp;uin=1063052964" target="_black">QQ</a></span><span><a href="https://www.cnblogs.com/nymrli/" target="_black">åšå®¢å›­</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 60vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Mr.li's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-edit"></i><span>2022/05/07</span></span><span class="busuanzi-pv" id="busuanzi_container_page_pv"><i class="post-intro-calendar fa fa-user-o"></i><span id="busuanzi_value_page_pv"></span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="çˆ¬è™«"> çˆ¬è™«</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="Python"> Python</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">11,013</span> | Reading time: <span class="post-count">46</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="é±¼"><a class="markdownIt-Anchor" href="#é±¼"></a> é±¼</h1>
<h2 id="retryæ¨¡å—"><a class="markdownIt-Anchor" href="#retryæ¨¡å—"></a> retryæ¨¡å—</h2>
<p>retryæ˜¯ä¸€ä¸ªç”¨äºé”™è¯¯å¤„ç†çš„æ¨¡å—ï¼ŒåŠŸèƒ½ç±»ä¼¼try-exceptï¼Œä½†å¯ä»¥æ›´åŠ å¿«æ·æ–¹ä¾¿çš„è®¾ç½®é‡è¯•çš„æ¬¡æ•°ï¼Œä»¥åŠæ¯æ¬¡é‡è¯•ä¹‹é—´ç›¸éš”çš„æ—¶é—´ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@retry()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_trouble</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">'''Retry until succeed'''</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'retrying...'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>exceptionsï¼šä¼ å…¥æŒ‡å®šçš„é”™è¯¯ç±»å‹ï¼Œé»˜è®¤ä¸ºExceptionï¼Œå³æ•è·æ‰€æœ‰ç±»å‹çš„é”™è¯¯ï¼Œä¹Ÿå¯ä¼ å…¥<strong>å…ƒç»„å½¢å¼çš„å¤šç§æŒ‡å®šé”™è¯¯ç±»å‹</strong>ã€‚</p>
</li>
<li>
<p>triesï¼šå®šä¹‰æ•è·é”™è¯¯ä¹‹åé‡å¤è¿è¡Œæ¬¡æ•°ï¼Œé»˜è®¤ä¸º-1ï¼Œå³ä¸ºæ— æ•°æ¬¡ã€‚</p>
</li>
<li>
<p>delayï¼šå®šä¹‰æ¯æ¬¡é‡å¤è¿è¡Œä¹‹é—´çš„åœé¡¿æ—¶é•¿ï¼Œå•ä½ç§’ï¼Œé»˜è®¤ä¸º0ï¼Œå³æ— åœé¡¿ã€‚</p>
</li>
<li>
<p>backoffï¼šå‘ˆæŒ‡æ•°å¢é•¿çš„æ¯æ¬¡é‡å¤è¿è¡Œä¹‹é—´çš„åœé¡¿æ—¶é•¿ï¼Œéœ€è¦é…åˆdelayæ¥ä½¿ç”¨ï¼Œè­¬å¦‚delayè®¾ç½®ä¸º3ï¼Œbackoffè®¾ç½®ä¸º2ï¼Œåˆ™ç¬¬ä¸€æ¬¡é—´éš”ä¸º<code>3*2^0=3</code>ç§’ï¼Œç¬¬äºŒæ¬¡<code>3*2^1=6</code>ç§’ï¼Œç¬¬ä¸‰æ¬¡<code>3*2^2</code>=12ç§’ï¼Œä»¥æ­¤ç±»æ¨ï¼Œé»˜è®¤ä¸º1ã€‚</p>
</li>
<li>
<p>max_delayï¼šå®šä¹‰backoffå’Œdelayé…åˆä¸‹å‡ºç°çš„æœ€å¤§ç­‰å¾…æ—¶é—´ä¸Šé™ï¼Œå½“</p>
<p><code>delay*backoff**n</code>å¤§äºmax_delayæ—¶ï¼Œç­‰å¾…é—´éš”å›ºå®šä¸ºè¯¥å€¼è€Œä¸å†å¢é•¿ã€‚</p>
</li>
</ul>
<h2 id="é¡¹ç›®ç»“æ„"><a class="markdownIt-Anchor" href="#é¡¹ç›®ç»“æ„"></a> é¡¹ç›®ç»“æ„</h2>
<blockquote>
<p>å…³äºé¡¹ç›®ç»“æ„ç»„ç»‡ã€‚ç”±äºPythonåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¼šè‡ªåŠ¨å°†<code>.</code>å³å½“å‰è·¯å¾„åŠ å…¥åˆ°åº“æœç´¢è·¯å¾„ï¼Œæ‰€ä»¥å½“ä¸‹è·¯å¾„ä¸‹çš„åŒ…ï¼ˆæ–‡ä»¶å¤¹ä¸‹æœ‰<code>__init__.py</code>ï¼‰éƒ½èƒ½è¢«æ£€æµ‹åˆ°ä½¿ç”¨ï¼Œå¦‚ä¸‹é¢çš„handlerã€helperéƒ½å¯ä»¥ç›´æ¥åœ¨å…¶ä»–æ–‡ä»¶é‡Œé€šè¿‡<code>helper.xxx</code>æ¥è°ƒç”¨ï¼Œä½†æ˜¯é¡¶å±‚çš„<code>settings.py</code>ä¸èƒ½é€šè¿‡<code>feiyu_shoot.settings</code>æ¥è°ƒç”¨ï¼Œå³ä½¿feiyu_shootå·¥ç¨‹ä¸‹ä¹Ÿæœ‰<code>__init__.py</code>ï¼Œå› ä¸ºé¡¹ç›®å·¥ç¨‹çš„ä¸Šå±‚ç›®å½•å¹¶æ²¡æœ‰åŠ å…¥åˆ°Pythonç¯å¢ƒæœç´¢ä¸­ï¼Œæ‰€ä»¥ä»–å®é™…ä¸çŸ¥é“è°æ˜¯<code>feiyu_shoot</code></p>
<p>å› æ­¤ï¼Œæ ¹æ®è¿™ç§è®¾è®¡ï¼Œå¯ä»¥å°†é¡¹ç›®ç»“æ„ç»„ç»‡æˆä¸¤ç§</p>
</blockquote>
<ol>
<li>
<p>ä¸ä¾èµ–å­æ¨¡å—çš„æ”¾åœ¨rootç›®å½•çš„topæ¥å£ï¼šéœ€è¦è¢«å…¶ä»–æ–‡ä»¶å¼•ç”¨çš„åˆ—å…¥æ–‡ä»¶å¤¹ä¸­ä½œä¸ºåº“ä½¿ç”¨ï¼Œä¸éœ€è¦è¢«å¼•ç”¨çš„å¯ä»¥ç›´æ¥æ”¾é¡¶å±‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># helper/runner.py</span></span><br><span class="line"><span class="comment"># handler/ åœ¨.ä¸‹ä½œä¸ºåŒ…å¯¼å…¥</span></span><br><span class="line"><span class="keyword">from</span> handler imoprt ConfigHandler</span><br><span class="line"><span class="comment"># settings.py åœ¨.ä¸‹ä½œä¸ºæ¨¡å—å¯¼å…¥</span></span><br><span class="line"><span class="keyword">from</span> settings <span class="keyword">import</span> USER_AGENT</span><br></pre></td></tr></table></figure>
<p><img src="/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/F:%5CaDevelopment%5CPython%5CpythonGitProject%5Cfeiyu_shoot%5Cdebugs%5CtopFile.jpg" alt="topFile"></p>
</li>
<li>
<p>â˜…å°†å…¥å£æ”¾åœ¨æœ€å¤–å±‚ï¼Œæ ¸å¿ƒå†…å®¹ä½œä¸ºå•ç‹¬ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆæ¨¡å—ï¼‰ï¼šç”±äºfeiyuæ˜¯ä¸ªæ•´ä½“çš„åŒ…ï¼Œæ‰€ä»¥åœ¨feiyuä¸‹çš„ä»»æ„Pythonæ–‡ä»¶ä¸­éƒ½å¯ä»¥é€šè¿‡<code>from feiyu.xxx import yyy</code>æ¥å¯¼å…¥ã€‚</p>
</li>
</ol>
<p><img src="/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/F:%5CaDevelopment%5CPython%5CpythonGitProject%5Cfeiyu_shoot%5Cdebugs%5ConeEntry.jpg" alt="oneEntry"></p>
<p>æ ¹æ®<a href="https://www.jianshu.com/p/e33b4f0373bc" target="_blank" rel="noopener">Pythonæ‰“åŒ…åˆ©å™¨ï¼šauto-py-to-exe</a>ä¸­æ‰“åŒ…è®¡ç®—æœºç¨‹åºçš„æ–¹å¼ï¼Œæ›´æ¨èç¬¬äºŒç§ï¼Œè¿™æ ·ä»£ç èµ„æºæ–‡ä»¶ä½ç½®æ›´ç»Ÿä¸€ï¼Œä¹Ÿæ›´åŠ æ¸…æ™°ä¸€äº›ã€‚</p>
<p>moreï¼š [Pythonä¸­æ¨¡å—ã€åŒ…ã€åº“å®šä¹‰](</p>
<h2 id="pyinstaller"><a class="markdownIt-Anchor" href="#pyinstaller"></a> pyinstaller</h2>
<blockquote>
<p>è‡ªæˆ‘å­¦Pythonä»¥æ¥æ¨èçš„å°±æ˜¯è¿™ä¸ªï¼Œç»è¿‡æ—¶å…‰å˜è¿ï¼Œè¿™ä¸ªä»ç„¶æ˜¯ä¸»æµã€‚</p>
<ul>
<li>PyInstalleræ˜¯<strong>ä¸€ä¸ªè·¨å¹³å°</strong>çš„Pythonåº”ç”¨æ‰“åŒ…å·¥å…·ï¼Œæ”¯æŒ Windows/Linux/MacOSä¸‰å¤§ä¸»æµå¹³å°ï¼Œèƒ½å¤ŸæŠŠ Python è„šæœ¬åŠå…¶æ‰€åœ¨çš„ Python è§£é‡Šå™¨æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå…è®¸æœ€ç»ˆç”¨æˆ·åœ¨æ— éœ€å®‰è£… Python çš„æƒ…å†µä¸‹æ‰§è¡Œåº”ç”¨ç¨‹åºã€‚</li>
<li>PyInstaller åˆ¶ä½œå‡ºæ¥çš„<strong>æ‰§è¡Œæ–‡ä»¶å¹¶ä¸æ˜¯è·¨å¹³å°çš„</strong>ï¼Œå¦‚æœéœ€è¦ä¸ºä¸åŒå¹³å°æ‰“åŒ…ï¼Œå°±è¦åœ¨ç›¸åº”å¹³å°ä¸Šè¿è¡ŒPyInstallerè¿›è¡Œæ‰“åŒ…ã€‚</li>
<li>PyInstalleræ‰“åŒ…çš„æµç¨‹ï¼šè¯»å–ç¼–å†™å¥½çš„Pythoné¡¹ç›®â€“&gt;åˆ†æå…¶ä¸­æ¡ç”¨çš„æ¨¡å—å’Œåº“ï¼Œå¹¶æ”¶é›†å…¶æ–‡ä»¶å‰¯æœ¬ï¼ˆåŒ…æ‹¬Pythonçš„è§£é‡Šå™¨ï¼‰â€“&gt;å°†å‰¯æœ¬å’ŒPythoné¡¹ç›®æ–‡ä»¶ï¼ˆæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹//å°è£…åœ¨ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ä¸­ã€‚</li>
</ul>
</blockquote>
<p>å®‰è£…å°±ä¸ç»†è¯´äº†ï¼Œä¸»è¦è®²ç”¨æ³•ï¼š</p>
<ul>
<li>
<p>é€šè¿‡å‘½ä»¤è¡Œå‘½ä»¤æ‰“åŒ…<code>pyinstaller -F main.py</code>ï¼Œå¸¸ç”¨å‚æ•°</p>
<ul>
<li>-Fï¼š è¡¨ç¤ºç”Ÿæˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼›å¯¹åº”çš„æ˜¯-Dï¼š ç”Ÿæˆæ–‡ä»¶å¤¹å½¢å¼çš„å¯æ‰§è¡Œç¨‹åºï¼ˆé»˜è®¤ï¼‰</li>
<li>-wï¼š è¡¨ç¤ºå»æ‰æ§åˆ¶å°çª—å£ï¼Œè¿™åœ¨GUIç•Œé¢æ—¶éå¸¸æœ‰ç”¨ã€‚ä¸è¿‡å¦‚æœæ˜¯å‘½ä»¤è¡Œç¨‹åºçš„è¯é‚£å°±æŠŠè¿™ä¸ªé€‰é¡¹åˆ é™¤å§ï¼</li>
<li>-pï¼š è¡¨ç¤ºä½ è‡ªå·±è‡ªå®šä¹‰éœ€è¦åŠ è½½çš„åº“è·¯å¾„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨ä¸åˆ°</li>
<li>-iï¼š è¡¨ç¤ºå¯æ‰§è¡Œæ–‡ä»¶çš„å›¾æ ‡</li>
</ul>
</li>
<li>
<p>é€šè¿‡<code>.spec</code>æ‰“åŒ…å®šä¹‰æ–‡ä»¶æ¥æ‰“åŒ…ï¼Œå¯¹åº”å‘½ä»¤è¡Œçš„å‚æ•°ï¼Œ<code>.spec</code>æ–‡ä»¶éƒ½ä¼šæœ‰å¯¹åº”çš„ç”Ÿæˆå†…å®¹ã€‚</p>
<blockquote>
<p>é¦–å…ˆæ ¹æ®mainæ–‡ä»¶ç”Ÿæˆspecæ–‡ä»¶: <code>pyi-makespec -D main.py</code>ã€å¡«å†™å¥½åå†<code>pyinstaller main.spec</code></p>
</blockquote>
<ul>
<li>-Dæ˜¯è®©specä¸­å¤šä¸€ä¸ªcollçš„å®ä¾‹ï¼Œä»è€Œå˜æˆæ–‡ä»¶å¤¹</li>
<li><code>-i</code>ç›¸å½“äº<code>.spec</code>ä¸­EXEä¸­<code>icon=&quot;.\\debugs\\favicon.ico&quot;</code></li>
<li>â€¦(æ›´å¤šspecæ–‡ä»¶å‚æ•°é€‰æ‹©è§ï¼š<a href="https://blog.csdn.net/tangfreeze/article/details/112240342" target="_blank" rel="noopener">https://blog.csdn.net/tangfreeze/article/details/112240342</a>)</li>
<li>-p: ç›¸å½“äºAnalysiså®ä¾‹ä¸­çš„<code>pathex</code>ï¼Œå°±æ˜¯å¡«å…¥è‡ªå·±çš„æ¨¡å—</li>
<li>â€“hiden-import: ç›¸å½“äºAnalysiså®ä¾‹ä¸­çš„hiddenimports</li>
</ul>
</li>
</ul>
<p>å®é™…ä¸Šï¼Œæ ¹æ®å‘½ä»¤è¡Œçš„å‚æ•°ä¼šç”Ÿæˆå¯¹åº”çš„<code>.spec</code>æ–‡ä»¶ã€‚</p>
<p>æ³¨ï¼šå¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯<code>pyinstaller</code>ã€<code>pyi-makespec</code>åé¢éƒ½æ˜¯<code>main.py</code>ï¼Œå› ä¸ºå…¶æ˜¯mainå‡½æ•°å…¥å£æ–‡ä»¶</p>
<p>é™„ï¼šæ ¹æ®feiyuï¼Œåœ¨æ­¤åˆ—ä¸¤ä¸ªå¯è¡Œçš„ï¼š</p>
<ul>
<li>
<p><code>F:\aDevelopment\Python\ShowYourCode\env\Scripts\pyinstaller.exe main.py --add-data=&quot;feiyu\push_config.ini;.\feiyu&quot; --add-data=&quot;feiyu\user_config.toml;.\feiyu&quot; -i debugs\favicon.ico</code></p>
</li>
<li>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- mode: python ; coding: utf-8 -*-</span></span><br><span class="line">block_cipher = <span class="keyword">None</span> <span class="comment"># æ­¤å¤„åœ¨ä½¿ç”¨--key= ä¼šæœ‰å˜åŒ–</span></span><br><span class="line"></span><br><span class="line">a = Analysis([<span class="string">'ai\\main.py'</span>],</span><br><span class="line">             pathex=[<span class="string">'C:\\Users\\Admin\\Downloads\\marsai-master'</span>],</span><br><span class="line">             binaries=[],</span><br><span class="line">             datas=[],<span class="comment"># æ­¤å¤„å¯ä»¥æ·»åŠ é™æ€èµ„æºï¼Œä¾‹å¦‚ä½ æœ‰ä¸ªå›¾ç‰‡æ–‡ä»¶å¤¹imgsï¼Œå¯ä»¥è¿™æ ·å†™[('imgs','imgs'),('test.txt','.')]ï¼Œæ‰“åŒ…ä»¥åä¼šæœ‰ä¸€ä¸ªä¸€æ ·çš„æ–‡ä»¶å¤¹ï¼Œç‚¹è¡¨ç¤ºå½“å‰æ–‡ä»¶å¤¹ã€‚</span></span><br><span class="line">             hiddenimports=[],</span><br><span class="line">             hookspath=[],</span><br><span class="line">             runtime_hooks=[],</span><br><span class="line">             excludes=[],</span><br><span class="line">             win_no_prefer_redirects=<span class="keyword">False</span>,</span><br><span class="line">             win_private_assemblies=<span class="keyword">False</span>,</span><br><span class="line">             cipher=block_cipher,</span><br><span class="line">             noarchive=<span class="keyword">False</span>)</span><br><span class="line">pyz = PYZ(a.pure, a.zipped_data,</span><br><span class="line">             cipher=block_cipher)</span><br><span class="line">exe = EXE(pyz,</span><br><span class="line">          a.scripts,</span><br><span class="line">          [],</span><br><span class="line">          exclude_binaries=<span class="keyword">True</span>,</span><br><span class="line">          name=<span class="string">'main'</span>, <span class="comment"># ç”Ÿæˆçš„exeçš„åå­—</span></span><br><span class="line">          debug=<span class="keyword">False</span>,</span><br><span class="line">          bootloader_ignore_signals=<span class="keyword">False</span>,</span><br><span class="line">          strip=<span class="keyword">False</span>,</span><br><span class="line">          upx=<span class="keyword">True</span>, <span class="comment"># æ‰“åŒ…çš„æ—¶å€™è¿›è¡Œå‹ç¼©ï¼ŒFalseè¡¨ç¤ºä¸å‹ç¼©</span></span><br><span class="line">          console=<span class="keyword">True</span> <span class="comment"># æ˜¯å¦æ˜¾ç¤ºé»‘çª—å£ï¼Œåˆšå¼€å§‹æ‰“åŒ…çš„æ—¶å€™ä¸€èˆ¬éƒ½ä¼šæœ‰é—®é¢˜ï¼Œå»ºè®®è®¾ä¸ºTrueï¼Œè§£å†³æ‰€æœ‰é—®é¢˜åå¯ä»¥è®¾ç½®ä¸ºFalse)</span></span><br><span class="line">coll = COLLECT(exe,</span><br><span class="line">               a.binaries,</span><br><span class="line">               a.zipfiles,</span><br><span class="line">               a.datas,</span><br><span class="line">               strip=<span class="keyword">False</span>,</span><br><span class="line">               upx=<span class="keyword">True</span>,</span><br><span class="line">               upx_exclude=[],</span><br><span class="line">               name=<span class="string">'main'</span> <span class="comment"># æ–‡ä»¶å¤¹çš„åå­—)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>pyinstallerå…¨éƒ½æ˜¯æ§åˆ¶å°çš„å‘½ä»¤ï¼Œå› æ­¤æ²¡é‚£ä¹ˆç›´è§‚ï¼Œæœ‰äººåšäº†GUIç›¸å¯¹ç›´ç™½ã€ç®€å•äº›ï¼Œè§<a href="https://www.jianshu.com/p/e33b4f0373bc" target="_blank" rel="noopener">Pythonæ‰“åŒ…åˆ©å™¨ï¼šauto-py-to-exe</a>ï¼Œå…¶å…³äºè®¡ç®—å™¨ç¨‹åºä¸<code>Additional Files</code>çš„ä½¿ç”¨ä¼šè®©äººå¯¹é¡¹ç›®è¯¥å¦‚æœå¸ƒç½®ç»“æ„å’Œä½¿ç”¨<code>-p</code>å‚æ•°æœ‰ä¸ªæ›´ç¡®ä¿¡çš„è®¤è¯†ï¼ˆå¯¼å…¥è‡ªå·±äº›çš„æ¨¡å—ï¼‰ã€‚</p>
<h2 id="dataclass"><a class="markdownIt-Anchor" href="#dataclass"></a> dataclass</h2>
<h4 id="dataclassesåµŒå¥—"><a class="markdownIt-Anchor" href="#dataclassesåµŒå¥—"></a> dataclassesåµŒå¥—</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nested_dataclass</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(cls)</span>:</span></span><br><span class="line">        cls = dataclass(cls, **kwargs)</span><br><span class="line">        original_init = cls.__init__</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">            <span class="keyword">for</span> name, value <span class="keyword">in</span> kwargs.items():</span><br><span class="line">                <span class="comment"># æ³¨æ„__annotations__å±æ€§</span></span><br><span class="line">                field_type = cls.__annotations__.get(name, <span class="keyword">None</span>)</span><br><span class="line">                <span class="keyword">if</span> is_dataclass(field_type) <span class="keyword">and</span> isinstance(value, dict):</span><br><span class="line">                    new_obj = field_type(**value)</span><br><span class="line">                    kwargs[name] = new_obj</span><br><span class="line">                <span class="keyword">if</span> isinstance(value, list) <span class="keyword">and</span> is_dataclass(field_type[<span class="number">0</span>]):</span><br><span class="line">                    res = []</span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> value:</span><br><span class="line">                        new_obj = field_type[<span class="number">0</span>](**c)</span><br><span class="line">                        res.append(new_obj)</span><br><span class="line">                    kwargs[name] = res</span><br><span class="line">            original_init(self, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">        cls.__init__ = __init__</span><br><span class="line">        <span class="keyword">return</span> cls</span><br><span class="line">    <span class="keyword">return</span> wrapper(args[<span class="number">0</span>]) <span class="keyword">if</span> args <span class="keyword">else</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line"><span class="meta">@nested_dataclass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TagResult</span>:</span></span><br><span class="line">    <span class="string">"""æ‹å–å±•ç¤ºçš„åˆ†é¡µç»“æœ"""</span></span><br><span class="line">    <span class="comment"># å½“å‰é¡µä¸‹å…·ä½“å•†å“çš„ä¿¡æ¯</span></span><br><span class="line">    content: [Content]</span><br><span class="line">	<span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<p><code>**</code>è§£åŒ…å¾—åˆ°çš„é¢å¤–ä¿¡æ¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># é¢å¤–ä¿¡æ¯</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_kwargs</span><span class="params">(cls, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># split the kwargs into native ones and new ones</span></span><br><span class="line">        native_args, new_args = &#123;&#125;, &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> name, val <span class="keyword">in</span> kwargs.items():</span><br><span class="line">            <span class="keyword">if</span> name <span class="keyword">in</span> cls.__annotations__:</span><br><span class="line">                native_args[name] = val</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                new_args[name] = val</span><br><span class="line"></span><br><span class="line">        <span class="comment"># use the native ones to create the class ...</span></span><br><span class="line">        ret = cls(**native_args)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ... and add the new ones by hand</span></span><br><span class="line">        <span class="keyword">for</span> new_name, new_val <span class="keyword">in</span> new_args.items():</span><br><span class="line">            setattr(ret, new_name, new_val)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">return</span> Goods.from_kwargs(**resp) <span class="keyword">if</span> resp <span class="keyword">else</span> <span class="keyword">None</span></span><br></pre></td></tr></table></figure>
<p><code>pydantic.dataclasses.dataclass</code>æ˜¯<code>dataclasses.dataclass with validation</code>çš„æ›¿ä»£å“, è€Œä¸æ˜¯<code>pydantic.BaseModel</code> çš„æ›¿ä»£å“ï¼ˆåœ¨åˆå§‹åŒ–æŒ‚é’©çš„å·¥ä½œæ–¹å¼ä¸Šæœ‰ä¸€ç‚¹ä¸åŒï¼‰ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°†<code>pydanticis.BaseModel</code>å­ç±»åŒ–æ˜¯æ›´å¥½çš„é€‰æ‹©.</p>
<h2 id="tomlè¯­æ³•å­¦ä¹ "><a class="markdownIt-Anchor" href="#tomlè¯­æ³•å­¦ä¹ "></a> tomlè¯­æ³•å­¦ä¹ </h2>
<blockquote>
<p>TOMLæ˜¯å‰GitHub CEOï¼Œ Tom Preston-Wernerï¼Œäº2013å¹´åˆ›å»ºçš„è¯­è¨€ï¼Œå…¶ç›®æ ‡æ˜¯æˆä¸ºä¸€ä¸ªå°è§„æ¨¡çš„æ˜“äºä½¿ç”¨çš„è¯­ä¹‰åŒ–é…ç½®æ–‡ä»¶æ ¼å¼.TOMLæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œå¿…é¡»æ˜¯UTF-8ç¼–ç ã€‚</p>
</blockquote>
<h3 id="tomlå¯¹è±¡"><a class="markdownIt-Anchor" href="#tomlå¯¹è±¡"></a> tomlå¯¹è±¡</h3>
<p><strong>å­—ç¬¦ä¸²</strong>ï¼šè·Ÿpythonä¸­ä¸€æ ·ï¼Œ<code>&quot;&quot;&quot;</code>ã€<code>&quot;</code>ã€<code>'</code>ã€<code>'''</code></p>
<p><strong>æ³¨é‡Š</strong>ï¼š<code>#</code></p>
<p><strong>æ•°ç»„</strong>ï¼šæ•°ç»„ä½¿ç”¨æ–¹æ‹¬å·åŒ…è£¹ã€‚ç©ºæ ¼ä¼šè¢«å¿½ç•¥ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚å…ƒç´ ä½¿ç”¨é€—å·åˆ†éš”ã€‚</p>
<p><strong>æ—¥æœŸæ—¶é—´</strong>ï¼štomlä¸­æ—¥æœŸæ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œè·Ÿæ•°ç»„ä¸€æ ·</p>
<p><strong>é”®å€¼å¯¹</strong></p>
<blockquote>
<p>TOML æ–‡æ¡£çš„ä¸»è¦æ„å»ºå—</p>
</blockquote>
<ul>
<li><strong>é”®</strong>å¯ä»¥æ˜¯è£¸éœ²çš„<strong>è£¸é”®</strong>ï¼Œä¹Ÿå¯ä»¥æ˜¯è¢«åŒ…è£¹åœ¨ä¸€å¯¹ <code>&quot;</code> çš„å†…éƒ¨çš„<strong>å¼•ç”¨é”®</strong>ã€‚<strong>è£¸é”®</strong>åªèƒ½å­˜åœ¨å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç ´æŠ˜å·ï¼ˆ<code>a-zã€A-Zã€0-9ã€-</code>ï¼‰ã€‚æ³¨æ„ï¼Œ<strong>è£¸é”®</strong>å¯ä»¥åªç”±æ•°å­—ç»„æˆï¼Œä¾‹å¦‚ <code>1234</code>ï¼Œä½†å®ƒæ€»æ˜¯è¢«è§£æä¸ºå­—ç¬¦ä¸²ã€‚<strong>å¼•ç”¨é”®</strong>éµå¾ªä¸<strong>åŸºæœ¬å­—ç¬¦ä¸²</strong>æˆ–<strong>å­—é¢å­—ç¬¦ä¸²</strong>å®Œå…¨ç›¸åŒçš„è§„èŒƒï¼Œå¹¶å…è®¸ä½¿ç”¨æ›´å¹¿æ³›çš„é”®åç§°ã€‚æœ€å¥½çš„åšæ³•æ˜¯ä½¿ç”¨<strong>è£¸é”®</strong>ï¼Œé™¤éå¿…è¦æƒ…å†µã€‚</li>
<li><em>å€¼<strong>å¯ä»¥æ˜¯ä»¥ä¸‹ç±»å‹ï¼š<strong>å­—ç¬¦ä¸²</strong>ã€<strong>æ•´æ•°</strong>ã€<strong>æµ®ç‚¹æ•°</strong>ã€<strong>å¸ƒå°”å€¼</strong>ã€<strong>æ—¶é—´</strong>ã€<strong>æ•°ç»„</strong>æˆ–</strong>å†…è”è¡¨</em>*ã€‚æœªç¡®å®šçš„å€¼æ˜¯éæ³•çš„ã€‚</li>
<li>æ³¨ï¼š<strong>é”®</strong>å’Œ<strong>å€¼</strong>å‘¨å›´çš„ç©ºç™½ç¬¦å¿½ç•¥ä¸è®¡ï¼Œ<strong>é”®</strong>ã€<code>=</code> å’Œ<strong>å€¼</strong>å¿…é¡»ä½äºåŒä¸€è¡Œ</li>
</ul>
<p><strong>è¡¨æ ¼</strong></p>
<ul>
<li>
<p>ç©ºè¡¨æ˜¯å…è®¸çš„ï¼Œåªè¦é‡Œé¢æ²¡æœ‰é”®å€¼å¯¹å°±è¡Œäº†ã€‚</p>
</li>
<li>
<p><strong>è¡¨ä¸èƒ½å®šä¹‰å¤šäºä¸€æ¬¡</strong>ï¼Œä¸å…è®¸ä½¿ç”¨ <code>[table]</code> å¤´é‡å®šä¹‰è¿™æ ·çš„è¡¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ä¸è¦è¿™æ ·åš</span><br><span class="line"></span><br><span class="line">[fruit]</span><br><span class="line">apple = &quot;çº¢&quot;</span><br><span class="line"></span><br><span class="line">[fruit]</span><br><span class="line">orange = &quot;æ©™&quot;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>åŒæ ·åœ°ï¼Œä½¿ç”¨ç‚¹åˆ†éš”é”®æ¥é‡å®šä¹‰å·²ç»ä»¥ <code>[table]</code> å½¢å¼å®šä¹‰è¿‡çš„è¡¨ä¹Ÿæ˜¯ä¸å…è®¸çš„ã€‚</p>
</li>
<li>
<p>ä¸è¿‡ï¼Œ<code>[table]</code> å½¢å¼å¯ä»¥è¢«ç”¨æ¥å®šä¹‰é€šè¿‡ç‚¹åˆ†éš”é”®å®šä¹‰çš„è¡¨ä¸­çš„<strong>å­è¡¨</strong>ã€‚</p>
</li>
<li>
<p>ä¸é¼“åŠ±æ— åºåœ°å®šä¹‰è¡¨ï¼Œå³åŒçº§åˆ«å­è¡¨å»ºè®®æ”¾åœ¨ä¸€èµ·å®šä¹‰</p>
</li>
</ul>
<p><strong>å†…è”è¡¨</strong>ï¼š</p>
<blockquote>
<p>å†…è”è¡¨æä¾›äº†ä¸€ç§æ›´ä¸º<strong>ç´§å‡‘çš„è¯­æ³•</strong>æ¥è¡¨ç¤ºè¡¨ã€‚</p>
<p>å†…è”è¡¨è¢«å®Œæ•´åœ°å®šä¹‰åœ¨èŠ±æ‹¬å·ä¹‹ä¸­ï¼š<code>{</code> å’Œ <code>}</code>ã€‚ æ‹¬å·ä¸­ï¼Œå¯ä»¥å‡ºç°é›¶æˆ–æ›´å¤šä¸ªä»¥é€—å·åˆ†éš”çš„é”®å€¼å¯¹ã€‚</p>
</blockquote>
<ul>
<li>å†…è”è¡¨å¾—å‡ºç°åœ¨åŒä¸€è¡Œå†…ã€‚</li>
<li>å†…è”è¡¨ä¸­ï¼Œæœ€åä¸€å¯¹é”®å€¼å¯¹å<strong>ä¸å…è®¸ç»ˆé€—å·</strong>ï¼ˆä¹Ÿç§°ä¸ºå°¾é€—å·ï¼‰ã€‚</li>
<li>ä¸å…è®¸èŠ±æ‹¬å·ä¸­å‡ºç°ä»»ä½•æ¢è¡Œï¼Œé™¤éåœ¨å€¼ä¸­å®ƒä»¬åˆæ³•ã€‚</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name</span> = &#123; first = <span class="string">"Tom"</span>, last = <span class="string">"Preston-Werner"</span> &#125;</span><br><span class="line"><span class="attr">point</span> = &#123; x = <span class="number">1</span>, y = <span class="number">2</span> &#125;</span><br><span class="line"><span class="attr">animal</span> = &#123; type.name = <span class="string">"pug"</span> &#125;</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line"><span class="section">[name]</span></span><br><span class="line"><span class="attr">first</span> = <span class="string">"Tom"</span></span><br><span class="line"><span class="attr">last</span> = <span class="string">"Preston-Werner"</span></span><br><span class="line"><span class="section">[point]</span></span><br><span class="line"><span class="attr">x</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">y</span> = <span class="number">2</span></span><br><span class="line"><span class="section">[animal]</span></span><br><span class="line">type.name = "pug"</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šå°±æ˜¯è¡¨çš„å¦ä¸€ç§ç´§å‡‘å†™æ³•ï¼Œå®šä¹‰çš„è¿˜æ˜¯è¡¨</p>
<p><strong><a href="https://toml.io/cn/v1.0.0#%E8%A1%A8%E6%95%B0%E7%BB%84" target="_blank" rel="noopener">è¡¨æ•°ç»„</a></strong></p>
<blockquote>
<p>è¡¨å¤´çš„ç¬¬ä¸€ä¾‹å®šä¹‰äº†è¿™ä¸ªæ•°ç»„åŠå…¶é¦–ä¸ªè¡¨å…ƒç´ ï¼Œè€Œåç»­çš„æ¯ä¸ªåˆ™åœ¨è¯¥æ•°ç»„ä¸­åˆ›å»ºå¹¶å®šä¹‰ä¸€ä¸ªæ–°çš„è¡¨å…ƒç´ ã€‚<br>
è¿™äº›è¡¨æŒ‰å‡ºç°é¡ºåºæ’å…¥è¯¥æ•°ç»„ã€‚</p>
<p>é¦–å…ˆæ˜¯ä¸ªæ•°ç»„ï¼›å…¶æ¬¡ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¸ºè¡¨å†…å®¹ã€‚</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[[products]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">"Hammer"</span></span><br><span class="line"><span class="attr">sku</span> = <span class="number">738594937</span></span><br><span class="line"><span class="section">[[products]]</span>  <span class="comment"># æ•°ç»„é‡Œçš„ç©ºè¡¨</span></span><br><span class="line"><span class="section">[[products]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">"Nail"</span></span><br><span class="line"><span class="attr">sku</span> = <span class="number">284758393</span></span><br><span class="line"><span class="attr">color</span> = <span class="string">"gray"</span></span><br><span class="line"><span class="comment"># ç­‰ä»·äº JSON çš„å¦‚ä¸‹ç»“æ„ã€‚</span></span><br><span class="line">&#123;</span><br><span class="line">  "products": [</span><br><span class="line">    &#123; "name": "Hammer", "sku": 738594937 &#125;,</span><br><span class="line">    &#123; &#125;,</span><br><span class="line">    &#123; "name": "Nail", "sku": 284758393, "color": "gray" &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ğŸ“–<a href="https://toml.io/cn/v1.0.0#%E8%A1%A8" target="_blank" rel="noopener">Tom çš„ï¼ˆè¯­ä¹‰ï¼‰æ˜æ˜¾ã€ï¼ˆé…ç½®ï¼‰æœ€å°åŒ–çš„è¯­è¨€â€”â€”ä¸­æ–‡æ‰‹å†Œ</a></p>
<p>åº“ï¼š</p>
<ul>
<li>
<p>Pythonï¼štoml</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> toml</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserConfigHandler</span><span class="params">(metaclass=Singleton)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(USER_PARAM_FILE, <span class="string">'r'</span>, encoding=<span class="string">"utf8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.r = toml.load(f)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Go: <code>go get github.com/BurntSushi/toml</code></p>
</li>
</ul>
<h2 id="è‡ªç”¨æŠ¢è´­å°è¯•"><a class="markdownIt-Anchor" href="#è‡ªç”¨æŠ¢è´­å°è¯•"></a> è‡ªç”¨æŠ¢è´­å°è¯•</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">order_auction_goods</span><span class="params">(self, goodsId: int, goodsName: str = <span class="string">""</span>, by_fail_time=False)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ç«‹åˆ»æŠ¢æ‹, æä¾›â‘ æŒ‡å®šå°è¯•æ¬¡æ•°; â‘¡ç›´åˆ°æ²¡æŠ¢åˆ°ä¸ºæ­¢ ä¸¤ç§ç­–ç•¥</span></span><br><span class="line"><span class="string">    @param by_fail_time: å¤±è´¥æ¬¡æ•°é‡è¯• or ä¸æ–­é‡è¯•</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    tryTimes = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> by_fail_time:</span><br><span class="line">        resp = <span class="keyword">None</span></span><br><span class="line">        <span class="comment"># 3æ¬¡é‡è¯•</span></span><br><span class="line">        <span class="keyword">while</span> tryTimes &lt; self.config.userConfig.maxFailCount:</span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">'goodsId'</span>: str(goodsId),</span><br><span class="line">            &#125;</span><br><span class="line">            resp = self._post(self.URL.orderAuctionGoods, data=data, timeout=self.config.timeoutTime)</span><br><span class="line">            <span class="keyword">if</span> resp.get(<span class="string">"code"</span>) != <span class="number">0</span>:</span><br><span class="line">                tryTimes += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># æŠ¢è´­æˆåŠŸè¯´æ˜æœ‰</span></span><br><span class="line">                resp.update(&#123;<span class="string">"goodsId"</span>: str(goodsId), <span class="string">"goodsName"</span>: str(goodsName)&#125;)</span><br><span class="line">                <span class="keyword">return</span> resp</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        resp = &#123;&#125;</span><br><span class="line">        <span class="comment"># 3æ¬¡é‡è¯•</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> resp.get(<span class="string">"msg"</span>) <span class="keyword">or</span> <span class="string">"è§„å®šæ—¶é—´å†…æŠ¢æ‹"</span> <span class="keyword">in</span> resp.get(<span class="string">"msg"</span>):</span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">'goodsId'</span>: str(goodsId),</span><br><span class="line">            &#125;</span><br><span class="line">            resp = self._post(self.URL.orderAuctionGoods, data=data, timeout=self.config.timeoutTime)</span><br><span class="line">            tryTimes += <span class="number">1</span></span><br><span class="line">            <span class="comment"># æŠ¢è´­æˆåŠŸ resp.get("result") == true</span></span><br><span class="line">            <span class="keyword">if</span> resp.get(<span class="string">"result"</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    resp.update(&#123;<span class="string">"goodsId"</span>: goodsId, <span class="string">"goodsName"</span>: goodsName&#125;)</span><br><span class="line">    <span class="keyword">return</span> resp, tryTimes</span><br></pre></td></tr></table></figure>
<h1 id="baseæ•°æ®åº“"><a class="markdownIt-Anchor" href="#baseæ•°æ®åº“"></a> baseæ•°æ®åº“</h1>
<h2 id="åˆ¤æ–­é‡å®šå‘"><a class="markdownIt-Anchor" href="#åˆ¤æ–­é‡å®šå‘"></a> åˆ¤æ–­é‡å®šå‘</h2>
<blockquote>
<p>ç”±äºæœ‰ä¸ªéœ€æ±‚æ˜¯ï¼Œæ²¡æœ‰investorå°±ä¸è¿›è¡Œçˆ¬å–ï¼Œè€Œæ˜¯å¦æœ‰investorå¯ä»¥é€šè¿‡<code>https://xxxx.com/company_finance/investors</code>ä¼šä¸ä¼šè¿›è¡Œé‡å®šå‘è¿›è¡Œåˆ¤æ–­</p>
</blockquote>
<p>é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­æ˜¯å¦å‘ç”Ÿé‡å®šå‘å‘¢ï¼Ÿä¸¤ç§</p>
<ol>
<li>ç¦æ­¢<code>requests.get</code>çš„<code>allow_redirect</code>å±æ€§<br>
1.</li>
<li>è¿è¡Œ<code>allow_redirect</code>ï¼Œç„¶åé€šè¿‡é‡å®šå‘historyæŸ¥çœ‹</li>
</ol>
<h2 id="å›¾ç‰‡æ‡’åŠ è½½"><a class="markdownIt-Anchor" href="#å›¾ç‰‡æ‡’åŠ è½½"></a> å›¾ç‰‡æ‡’åŠ è½½</h2>
<blockquote>
<p>å›¾ç‰‡æ‡’åŠ è½½æ˜¯ä¸€ç§ç½‘é¡µä¼˜åŒ–æŠ€æœ¯ã€‚å›¾ç‰‡ä½œä¸ºä¸€ç§ç½‘ç»œèµ„æºï¼Œåœ¨è¢«è¯·æ±‚æ—¶ä¹Ÿä¸æ™®é€šé™æ€èµ„æºä¸€æ ·ï¼Œå°†å ç”¨ç½‘ç»œèµ„æºï¼Œè€Œä¸€æ¬¡æ€§å°†æ•´ä¸ªé¡µé¢çš„æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œï¼Œå°†å¤§å¤§å¢åŠ <strong>é¡µé¢çš„é¦–å±åŠ è½½æ—¶é—´</strong>ã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œé€šè¿‡å‰åç«¯é…åˆï¼Œä½¿å›¾ç‰‡ä»…åœ¨æµè§ˆå™¨å½“å‰è§†çª—å†…å‡ºç°æ—¶æ‰åŠ è½½è¯¥å›¾ç‰‡ï¼Œè¾¾åˆ°å‡å°‘é¦–å±å›¾ç‰‡è¯·æ±‚æ•°çš„æŠ€æœ¯å°±è¢«ç§°ä¸ºâ€œå›¾ç‰‡æ‡’åŠ è½½â€â€”â€”ä¼˜å…ˆåŠ è½½ç½‘é¡µç»“æ„ï¼Œä»¥åŠé€»è¾‘è„šæœ¬ï¼Œç­‰é‡è¦å†…å®¹å…¨éƒ¨åŠ è½½å®Œæˆä¹‹åå†åŠ è½½é‡è¦ä¼˜å…ˆçº§ä½ä¸€äº›çš„å›¾ç‰‡èµ„æºï¼ˆåŒæ—¶ä¹Ÿæ¯”è¾ƒè€—ç½‘ç»œèµ„æºï¼‰ï¼Œæ˜¯ä¸€ä¸ªä»ç”¨æˆ·ä½“éªŒä¸Šè¿›è¡Œåˆ†å±‚çš„æŠ€æœ¯ã€‚</p>
</blockquote>
<p><strong>ç½‘ç«™ä¸€èˆ¬å¦‚ä½•å®ç°å›¾ç‰‡æ‡’åŠ è½½æŠ€æœ¯å‘¢ï¼Ÿ</strong></p>
<p>åœ¨ç½‘é¡µæºç ä¸­ï¼Œåœ¨imgæ ‡ç­¾ä¸­é¦–å…ˆä¼šä½¿ç”¨ä¸€ä¸ªâ€œ<code>ä¼ªå±æ€§</code>â€ï¼ˆé€šå¸¸ä½¿ç”¨<code>src2</code>ã€<code>origin</code>â€¦â€¦ï¼‰å»å­˜æ”¾çœŸæ­£çš„å›¾ç‰‡é“¾æ¥è€Œå¹¶éæ˜¯ç›´æ¥å­˜æ”¾åœ¨srcå±æ€§ä¸­ã€‚å½“å›¾ç‰‡å‡ºç°åˆ°é¡µé¢çš„å¯è§†åŒ–åŒºåŸŸä¸­ï¼Œä¼šåŠ¨æ€å°†ä¼ªå±æ€§æ›¿æ¢æˆsrcå±æ€§ï¼Œå®Œæˆå›¾ç‰‡çš„åŠ è½½ã€‚</p>
<p>æ¯”å¦‚ï¼š<a href="https://blog.csdn.net/weixin_38507813/article/details/100010232" target="_blank" rel="noopener">ç«™é•¿ç´ ææ¡ˆä¾‹åç»­åˆ†æ</a>ï¼šé€šè¿‡ç»†è‡´è§‚å¯Ÿé¡µé¢çš„ç»“æ„åå‘ç°ï¼Œç½‘é¡µä¸­å›¾ç‰‡çš„é“¾æ¥æ˜¯å­˜å‚¨åœ¨äº†src2è¿™ä¸ªä¼ªå±æ€§ä¸­ã€‚</p>
<p>å› æ­¤é’ˆå¯¹çˆ¬å–è¿™ç±»å›¾ç‰‡è€Œè¨€ï¼Œå¯ä»¥</p>
<ol>
<li>æ‰¾åˆ°è¦çˆ¬å–å›¾ç‰‡çš„ä½ç½®ï¼ˆç½‘é¡µä¸Šçš„ä½ç½®ï¼‰</li>
<li>æŸ¥çœ‹è¯¥ç½‘å€çš„é“¾æ¥img_url</li>
<li>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼ŒCtrl+Fåæ–‡æœ¬æœç´¢è¯¥å›¾ç‰‡é“¾æ¥img_url</li>
<li>å¦‚æœ3æ²¡æœ‰åˆ™åœ¨å¼€å‘è€…å·¥å…·ä¸­Ctrl+Fæœç´¢å¸¦img_urlçš„èµ„æº</li>
<li>å¦‚æœæ˜¯3ï¼Œåˆ™é€šè¿‡æ‰¾åˆ°çš„çœŸæ­£çš„xpathè·¯å¾„è·å–ï¼Œæˆ–è€…reæå–ï¼›å¦‚æœæ˜¯4åˆ™æ¨¡ä»¿æ¥å£å»è¯·æ±‚å›¾ç‰‡</li>
</ol>
<h3 id="æœ¬é¡¹ç›®æ¡ˆä¾‹"><a class="markdownIt-Anchor" href="#æœ¬é¡¹ç›®æ¡ˆä¾‹"></a> æœ¬é¡¹ç›®æ¡ˆä¾‹</h3>
<h2 id="pathlibåº“ä½¿ç”¨"><a class="markdownIt-Anchor" href="#pathlibåº“ä½¿ç”¨"></a> pathlibåº“ä½¿ç”¨</h2>
<ul>
<li>
<p>è·å¾—å½“å‰è„šæœ¬çš„ç»å¯¹è·¯å¾„:<code>Path(__file__).resolve()</code></p>
</li>
<li>
<p>è·å¾—å½“å‰è„šæœ¬æ‰€åœ¨ç›®å½•çš„ç»å¯¹è·¯å¾„: <code>Path(__file__).resolve().parent</code></p>
</li>
<li>
<p>æ ¹æ®è·¯å¾„åˆ›å»ºæ–‡ä»¶å¤¹: <code>LOG_PATH = Path(__file__).resolve().with(&quot;logs&quot;)</code>â€“&gt;<code>./logs/</code>ï¼Œ<code>LOG_PATH.mkdir(parents=True, exist_ok=True)</code>ï¼Œ</p>
<ul>
<li>parents:å¦‚æœçˆ¶ç›®å½•ä¸å­˜åœ¨ï¼Œæ˜¯å¦åˆ›å»ºçˆ¶ç›®å½•ï¼Œå³æ”¯æŒé€’å½’åˆ›å»º</li>
<li>exist_okï¼šåªæœ‰åœ¨ç›®å½•ä¸å­˜åœ¨æ—¶åˆ›å»ºç›®å½•ï¼Œç›®å½•å·²å­˜åœ¨æ—¶ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
</li>
<li>
<p>è·å¾—å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶(éå†æ–‡ä»¶å¤¹): <code>[path for path in example_path.iterdir()]</code></p>
</li>
<li>
<p>è¿”å›ç›®å½•ä¸­æœ€åä¸€ä¸ªéƒ¨åˆ†çš„æ‰©å±•åï¼š<code>Path('/Users/Anders/Documents/abc.gif').suffix</code></p>
</li>
<li>
<p>è¿”å›ç›®å½•ä¸­å¤šä¸ªæ‰©å±•ååˆ—è¡¨ï¼š <code>Path('/Users/Anders/Documents/abc.tar.gz').suffixes</code></p>
</li>
<li>
<p>è¿”å›ç›®å½•ä¸­æœ€åä¸€ä¸ªéƒ¨åˆ†çš„æ–‡ä»¶å: <code>Path('/Users/Anders/Documents/abc.gif').name</code></p>
</li>
<li>
<p>è¿”å›ç›®å½•ä¸­æœ€åä¸€ä¸ªéƒ¨åˆ†çš„æ–‡ä»¶åï¼ˆä½†æ˜¯ä¸åŒ…å«åç¼€ï¼‰: <code>Path('/Users/Anders/Documents/abc.gif').stem</code></p>
</li>
<li>
<p><strong>æ–‡ä»¶æ“ä½œ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">example_path = Path(<span class="string">'/Users/Anders/Documents/information/JH.txt'</span>)</span><br><span class="line"><span class="comment"># ä»¥opençš„å½¢å¼</span></span><br><span class="line"><span class="keyword">with</span> example_path.open(encoding = <span class="string">'GB2312'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    print(f.read())</span><br><span class="line"><span class="comment"># æˆ–è€…ç›´æ¥ç”¨pathlibæä¾›çš„è·å–å†…å®¹çš„æ–¹å¼</span></span><br><span class="line">example_path = Path(<span class="string">'/Users/Anders/Documents/information/JH.txt'</span>)</span><br><span class="line">example_path.read_text(encoding=<span class="string">'GB2312'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>.read_text(): ä»¥æ–‡æœ¬æ¨¡å¼æ‰“å¼€è·¯å¾„å¹¶å¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å†…å®¹ã€‚</p>
</li>
<li>
<p>.read_bytes(): ä»¥äºŒè¿›åˆ¶/å­—èŠ‚æ¨¡å¼æ‰“å¼€è·¯å¾„å¹¶ä»¥å­—èŠ‚ä¸²çš„å½¢å¼è¿”å›å†…å®¹ã€‚</p>
</li>
<li>
<p>.write_text(): æ‰“å¼€è·¯å¾„å¹¶å‘å…¶å†™å…¥å­—ç¬¦ä¸²æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path = Path(<span class="string">'data.json'</span>)</span><br><span class="line">path.write_text(<span class="string">'&#123;"id": 123, "name": "James"&#125;'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>.write_bytes(): ä»¥äºŒè¿›åˆ¶/å­—èŠ‚æ¨¡å¼æ‰“å¼€è·¯å¾„å¹¶å‘å…¶å†™å…¥æ•°æ®ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/itanders/article/details/88754606" target="_blank" rel="noopener">https://blog.csdn.net/itanders/article/details/88754606</a></p>
<h2 id="æŒ‰ä½éªŒè¯ç "><a class="markdownIt-Anchor" href="#æŒ‰ä½éªŒè¯ç "></a> æŒ‰ä½éªŒè¯ç </h2>
<p>è¯¥ç½‘ç«™å¯¹é¢‘ç‡æ£€æµ‹ååˆ†æ•æ„Ÿï¼Œå¾ˆå¿«å°±ä¼šå‡ºç°&quot;æŒ‰ä½&quot;éªŒè¯ç ï¼Œæ¨¡æ‹ŸæŒ‰ä½å€’ä¸éš¾ï¼Œä½†æ˜¯æŒ‰å®Œä»¥åæœ‰æ—¶å¹¶ä¸èƒ½è§£å†³éªŒè¯â€¦</p>
<p>ä½†æ˜¯æ„å¤–å‘ç°ï¼Œåœ¨â€œæ— ç—•æ¨¡å¼â€ä¸‹è¿›è¡Œé‡æ–°ç™»å½•åï¼Œå°±å¯ä»¥è§£å†³éªŒè¯â€¦ä½†æ˜¯é€šè¿‡requestsè¿›è¡Œæ¨¡æ‹Ÿç™»å½•åcookiesè¿˜æ˜¯æ— æ•ˆã€‚</p>
<p>ğŸŒŸè®°å½•ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œä¹‹åçœ‹çœ‹æœ‰æ²¡æœ‰æ—¶é—´å¼„æ¸…æ¥šè¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<blockquote>
<p>æ—¢ç„¶æ¨¡æ‹Ÿä¸è¡Œï¼Œé‚£ä¹ˆå°±æ‰‹åŠ¨ï¼Œå› æ­¤æƒ³ç”¨seleniumæ¥æ¨¡æ‹Ÿç‚¹å‡»ç™»é™†ã€‚ä½†æ˜¯å› ä¸ºä¿„ç½—æ–¯çš„é—®é¢˜ï¼Œæ— æ³•ç™»é™†ã€‚</p>
</blockquote>
<p><img src="/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/E:%5Chexo%5Csource_posts%5C2022%E5%B9%B45%E6%9C%88%E5%8A%B3%E5%8A%A8%E8%8A%82%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95%5C%E8%A2%AB%E5%B0%81.jpg" alt="è¢«å°"></p>
<p>äºæ˜¯åªå¥½æ›´æ¢seleniumä¸ºpyppeteerã€‚ä¹‹å‰å°±å¬è¯´äº†pyppeteeræ˜¯å¯ä»¥ä»£æ›¿seleniumçš„æ¨¡æ‹Ÿç¥å™¨ï¼Œç›¸æ¯”Selenium ä¸å¤ªæ–¹ä¾¿çš„åœ°æ–¹ï¼šæ¯”å¦‚é€Ÿåº¦å¤ªæ…¢ã€å¯¹ç‰ˆæœ¬é…ç½®è¦æ±‚ä¸¥è‹›ï¼Œæœ€éº»çƒ¦æ˜¯ç»å¸¸è¦æ›´æ–°å¯¹åº”çš„é©±åŠ¨ï¼Œè¿˜æœ‰äº›ç½‘é¡µæ˜¯å¯ä»¥æ£€æµ‹åˆ°æ˜¯å¦ä½¿ç”¨äº†Selenium ï¼Œpyppeteeréƒ½æœ‰æå‡ï¼Œè¿™æ¬¡ä¹Ÿå€Ÿæœºä¼šå­¦ä¹ ä¸€ä¸‹ã€‚</p>
<blockquote>
<p>å®‰è£…ï¼š<code>pip install pyppeteer</code>, éœ€è¦Python3.6ä»¥ä¸Šï¼ˆå› ä¸ºç”¨äº†asyncï¼‰</p>
</blockquote>
<h3 id="pyppeteer"><a class="markdownIt-Anchor" href="#pyppeteer"></a> pyppeteer</h3>
<p>æœ€ç®€å•demoï¼šæ‰“å¼€ç½‘é¡µï¼Œå¹¶æˆªå›¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> pyppeteer <span class="keyword">import</span> launch</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># å¯åŠ¨æµè§ˆå™¨</span></span><br><span class="line">    browser = <span class="keyword">await</span> launch(headless=<span class="keyword">True</span>)</span><br><span class="line">    <span class="comment"># æ‰“å¼€å¹¶è·³è½¬é¡µé¢</span></span><br><span class="line">    page = <span class="keyword">await</span> browser.newPage()</span><br><span class="line">    <span class="keyword">await</span> page.goto(<span class="string">'https://example.com'</span>)</span><br><span class="line">    <span class="comment"># æˆªå›¾</span></span><br><span class="line">    <span class="keyword">await</span> page.screenshot(&#123;<span class="string">'path'</span>: <span class="string">'example.png'</span>&#125;)</span><br><span class="line">    <span class="keyword">await</span> browser.close()</span><br><span class="line"></span><br><span class="line">asyncio.get_event_loop().run_until_complete(main())</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡ŒJSï¼Œç›¸å½“äºrequests-htmlä¸­çš„render</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dimensions = <span class="keyword">await</span> page.evaluate(<span class="string">'''() =&gt; &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">        width: document.documentElement.clientWidth,</span></span><br><span class="line"><span class="string">        height: document.documentElement.clientHeight,</span></span><br><span class="line"><span class="string">        deviceScaleFactor: window.devicePixelRatio,</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;'''</span>)</span><br><span class="line"></span><br><span class="line">print(dimensions)</span><br><span class="line"><span class="comment"># &gt;&gt;&gt; &#123;'width': 800, 'height': 600, 'deviceScaleFactor': 1&#125;</span></span><br><span class="line"><span class="keyword">await</span> browser.close()</span><br></pre></td></tr></table></figure>
<p><strong>å…ƒç´ é€‰æ‹©å™¨</strong>ï¼š</p>
<p><code>Page.querySelector()</code>/<code>Page.querySelectorAll()</code>/<code>Page.xpath()</code>ç¼©å†™ä¸º<code>Page.J()</code>, <code>Page.JJ()</code>, and <code>Page.Jx()</code>.</p>
<p>xpathè¿›é˜¶ï¼š</p>
<ul>
<li>starts-with é¡¾åæ€ä¹‰ï¼ŒåŒ¹é…ä¸€ä¸ªå±æ€§å¼€å§‹ä½ç½®çš„å…³é”®å­—</li>
<li>contains åŒ¹é…ä¸€ä¸ªå±æ€§å€¼ä¸­åŒ…å«çš„<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">å­—ç¬¦ä¸²</a></li>
<li><code>text()</code> åŒ¹é…çš„æ˜¯æ˜¾ç¤ºæ–‡æœ¬ä¿¡æ¯ï¼š <code>//a[contains(text(), &quot;ç™¾åº¦æœç´¢&quot;)]</code></li>
</ul>
<p><a href="https://blog.csdn.net/weixin_48615832/article/details/107319268" target="_blank" rel="noopener">xpathçš„containsç”¨æ³•</a></p>
<p><strong>å…ƒç´ æ“ä½œï¼šç‚¹å‡»ã€è¾“å…¥</strong></p>
<ul>
<li><code>pyppeteer.input.Mouse</code>
<ul>
<li><code>click(x: float*, y: float, options: dict = None*, ***kwargs)</code>
<ul>
<li><code>button</code> (str): <code>left</code>, <code>right</code>, or <code>middle</code>, defaults to <code>left</code>ï¼š
<ul>
<li>å³é”®ç‚¹å‡»ï¼š<code>await page.click('a#cccccc',{&quot;button&quot;: &quot;right&quot;})</code></li>
</ul>
</li>
<li><code>clickCount</code> (int): defaults to 1.</li>
<li><code>delay</code> (int|float): Time to wait between <code>mousedown</code> and <code>mouseup</code> in milliseconds. Defaults to 0.</li>
</ul>
</li>
<li><code>down</code>(options: dict = None, *<em>kwargs</em>) `</li>
<li><code>button</code> (str): <code>left</code>, <code>right</code>, or <code>middle</code>, defaults to <code>left</code>.</li>
<li><code>clickCount</code> (int): defaults to 1.</li>
<li><code>move(x: float, y: float, options: dict = None, **kwargs*)</code></li>
<li><code>p(options: dict = None, **kwargs*)</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨xpath</span></span><br><span class="line"><span class="keyword">await</span> page.waitForXPath(<span class="string">'//input[contains(@id, "mat-input")]'</span>)</span><br><span class="line"><span class="keyword">await</span> asyncio.sleep(<span class="number">10</span>)</span><br><span class="line">inputs = <span class="keyword">await</span> page.xpath(<span class="string">'//input[contains(@id, "mat-input")]'</span>)</span><br><span class="line">print(len(inputs))</span><br><span class="line"><span class="keyword">await</span> inputs[<span class="number">1</span>].type(<span class="string">'janetgao@indiana.edu'</span>)</span><br><span class="line"><span class="keyword">await</span> inputs[<span class="number">2</span>].type(<span class="string">'KAProject2021'</span>)</span><br><span class="line"><span class="comment"># ä½¿ç”¨selector</span></span><br><span class="line"><span class="keyword">await</span> page.waitForSelector(<span class="string">'#mat-input-1'</span>)</span><br><span class="line"><span class="keyword">await</span> page.type(<span class="string">'#mat-input-1'</span>, <span class="string">'janetgao@indiana.edu'</span>)</span><br><span class="line"><span class="keyword">await</span> page.type(<span class="string">'#mat-input-2'</span>, <span class="string">'KAProject2021'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>launch</strong></p>
<ul>
<li>
<p><code>headless</code>ï¼šæ— ç•Œé¢æ¨¡å¼</p>
</li>
<li>
<p><code>devtools</code> ï¼šå¯ç”¨å¼€å‘è€…åŠ©æ‰‹</p>
</li>
<li>
<p><code>userDataDir='./userdata'</code>ï¼š è®°å½•äº›ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯”å¦‚cookies</p>
</li>
<li>
<p><code>dumpio=True</code> é˜²æ­¢æµè§ˆå™¨å¼€å¤šä¸ªé¡µé¢è€Œå¡æ­»</p>
</li>
<li>
<p><code>executablePath</code>: æŒ‡å®šè‡ªå®šä¹‰çš„chromeè·¯å¾„</p>
</li>
<li>
<p>å‚æ•°argsè®¾ç½®ï¼Œå¯ä»¥ç±»æ¯”selenium</p>
<ul>
<li>
<p><code>--start-maximized</code>: é¡µé¢å…¨å±</p>
</li>
<li>
<p><code>--window-size={width},{height}</code>ï¼šè®¾ç½®çª—å£å¤§å°ï¼ŒåŒºåˆ«äºé¡µé¢çš„<code>page.setViewport({'width': 1366, 'height': 768})</code></p>
</li>
<li>
<p><code>--disable-infobars</code>:ä¸æ˜¾ç¤ºä¿¡æ¯æ   æ¯”å¦‚ chromeæ­£åœ¨å—åˆ°è‡ªåŠ¨æµ‹è¯•è½¯ä»¶çš„æ§åˆ¶</p>
</li>
<li>
<p><code>--incognito</code>ï¼šç™¾åº¦æœåˆ°çš„chrome.exeæ— ç—•å‘½ä»¤(seleniumæ˜¯å¦‚æ­¤ï¼Œpyppeteerä¸æ¨è)</p>
</li>
<li>
<p><code>--user-agent</code>ï¼š æ¯”å¦‚<code>'--user-agent=Mozilla/5.0'</code></p>
</li>
<li>
<p><code>--proxy-server={proxy}</code>: æµè§ˆå™¨ä»£ç† é…åˆæŸäº›ä¸­é—´äººä»£ç†ä½¿ç”¨</p>
</li>
<li>
<p><code>--no-sandbox</code>,  # å–æ¶ˆæ²™ç›’æ¨¡å¼ æ²™ç›’æ¨¡å¼ä¸‹æƒé™å¤ªå°</p>
</li>
<li>
<p><code>'--log-level=3'</code></p>
</li>
<li>
<p><code>'--load-extension={}'.format(chrome_extension)</code>ã€<code>'--disable-extensions-except={}'.format(chrome_extension)</code> # åŠ è½½æ’ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chrome_extension_path = <span class="string">"æ’ä»¶æ‰€åœ¨ç›®å½•"</span></span><br><span class="line">args = [</span><br><span class="line">    <span class="string">"--load-extension=&#123;&#125;"</span>.format(chrome_extension_path),</span><br><span class="line">    <span class="string">"--disable-extensions-except=&#123;&#125;"</span>.format(chrome_extension_path),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><a href="https://www.cnblogs.com/dyfblog/p/12225796.html" target="_blank" rel="noopener">pyppeteeræ§åˆ¶Chromiumåœ¨éšèº«æ¨¡å¼ä¸‹å¯ç”¨æ’ä»¶ </a></p>
</li>
</ul>
</li>
<li>
<p>more: <a href="https://blog.csdn.net/Coding_CLearLove/article/details/110265509" target="_blank" rel="noopener">launchå‚æ•°è¯´æ˜</a></p>
</li>
</ul>
<p>æ‰§è¡ŒJSï¼š</p>
<ul>
<li>
<p><code>page.evaluate('window.scrollBy(100, document.body.scrollHeight)')</code></p>
</li>
<li>
<p><code>await page.evaluate('alert(&quot;åœ¨æµè§ˆå™¨æ‰§è¡Œjsè„šæœ¬!&quot;)')</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›¸å½“äºæ‹¿åˆ°äº†domå¯¹è±¡</span></span><br><span class="line">element = <span class="keyword">await</span> page.J(<span class="string">'#ul&gt;a[name="tj_trtieba"]'</span>)</span><br><span class="line">print(<span class="keyword">await</span> page.evaluate(<span class="string">'el =&gt; el.innerHTML'</span>, element))</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>page.evaluateOnNewDocument(pageFunction[, â€¦args]), æŒ‡å®šçš„å‡½æ•°åœ¨æ‰€å±çš„é¡µé¢è¢«åˆ›å»ºå¹¶ä¸”æ‰€å±é¡µé¢çš„ä»»æ„scriptæ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨ã€‚å¸¸ç”¨äºä¿®æ”¹é¡µé¢JSç¯å¢ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">page = <span class="keyword">await</span> browser.newPage()</span><br><span class="line"><span class="keyword">await</span> page.setViewPort(&#123;<span class="string">'width'</span>: <span class="number">1366</span>, <span class="string">'height'</span>: <span class="number">768</span>&#125;)</span><br><span class="line"><span class="keyword">await</span> page.evaluateOnNewDocument(<span class="string">'''() =&gt; &#123;</span></span><br><span class="line"><span class="string">        Object.defineProperty(navigator, 'webdriver', &#123;get: () =&gt; false &#125;);</span></span><br></pre></td></tr></table></figure>
<p>é™„â€”ElementHandleå…ƒç´ æ“ä½œï¼š</p>
<ol>
<li>è·å–å…ƒç´ è¾¹ç•Œæ¡†åæ ‡ï¼šboundingBox()ï¼Œè¿”å›å…ƒç´ çš„è¾¹ç•Œæ¡†ï¼ˆç›¸å¯¹äºä¸»æ¡†æ¶ï¼‰=&gt; x åæ ‡ã€ y åæ ‡ã€widthã€height</li>
<li>å…ƒç´ æ˜¯å¦å¯è§ï¼šisIntersectingViewport()</li>
<li>ä¸Šä¼ æ–‡ä»¶ï¼šuploadFile(*filpaths)</li>
<li>ElementHandle ç±» è½¬ Frameç±»ï¼šcontentFrame()ï¼Œå¦‚æœå¥æŸ„æœªå¼•ç”¨iframeï¼Œåˆ™è¿”å›Noneã€‚</li>
<li>èšç„¦è¯¥å…ƒç´ ï¼šfocus()</li>
<li>ä¸é¼ æ ‡ç›¸å…³ï¼šhover () ï¼Œå°†é¼ æ ‡æ‚¬åœåˆ°å…ƒç´ ä¸Šé¢</li>
<li>ä¸é”®ç›˜ç›¸å…³ï¼špress (key[, options])ï¼ŒæŒ‰é”®ï¼Œkey è¡¨ç¤ºæŒ‰é”®çš„åç§°ï¼Œoptionå¯é…ç½®:
<ul>
<li>text (string) - å¦‚æœæŒ‡å®šï¼Œåˆ™ä½¿ç”¨æ­¤æ–‡æœ¬ç”Ÿæˆè¾“å…¥äº‹ä»¶</li>
<li>delay (number) - keydown å’Œ keyup ä¹‹é—´ç­‰å¾…çš„æ—¶é—´ã€‚é»˜è®¤æ˜¯ 0</li>
<li><code>page.keyboard.down('Shift')</code>ï¼šæŒ‰ä¸‹shift</li>
</ul>
</li>
</ol>
<p>more: <a href="https://blog.csdn.net/weizhen11/article/details/102509230" target="_blank" rel="noopener">é¡µé¢å…ƒç´ æ“ä½œ</a></p>
</li>
</ul>
<p><strong>å®‰å…¨æ€§ï¼š</strong></p>
<ol>
<li>åœ¨ä½¿ç”¨ Pyppeteer ä»ç„¶ä¼šé‡åˆ°æ— å¤´æµè§ˆå™¨æ£€æµ‹ï¼Œè¿™é‡Œå®‰åˆ©ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ã€Œpyppeteer-stealthã€ï¼Œã€Œpuppeteer-extra-plugin-stealthã€å¼•ç”¨Githubä¸Šçš„è¯´æ˜ã€ŒApplies various evasion techniques to make detection of headless puppeteer harder.ã€ã€ŒA plugin for puppeteer-extra to prevent detection.ã€ï¼ˆGithubåœ°å€ï¼š<a href="https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth" target="_blank" rel="noopener">https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth</a> ï¼‰ã€‚å¯è§ï¼Œã€Œpyppeteer-stealthã€ä¹Ÿæ˜¯ç”¨äºé˜²æ­¢æœºå™¨äººæ£€æµ‹çš„ã€‚ç”¨æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç»™pageåŠ ä¸Šstealth</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> pyppeteer <span class="keyword">import</span> launch</span><br><span class="line"><span class="keyword">from</span> pyppeteer_stealth <span class="keyword">import</span> stealth</span><br><span class="line"> </span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    browser = <span class="keyword">await</span> launch(headless=<span class="keyword">True</span>)</span><br><span class="line">    page = <span class="keyword">await</span> browser.newPage()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">await</span> stealth(page)  <span class="comment"># &lt;-- Here</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">await</span> page.goto(<span class="string">"https://bot.sannysoft.com/"</span>)</span><br><span class="line">    <span class="keyword">await</span> browser.close()</span><br><span class="line">asyncio.get_event_loop().run_until_complete(main())</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥çœå»éšè—WebDriverç­‰æ“ä½œï¼Œå¯è°“çœæ—¶çœåŠ›çœå¿ƒã€‚</p>
<ol start="2">
<li><code>await page.evaluateOnNewDocument('Object.defineProperty(navigator,&quot;webdriver&quot;,{get:()=&gt;undefined})')</code></li>
<li><code>stealth.min.js</code><a href="https://cloud.tencent.com/developer/article/1755513" target="_blank" rel="noopener">æœ€å®Œç¾æ–¹æ¡ˆï¼æ¨¡æ‹Ÿæµè§ˆå™¨å¦‚ä½•æ­£ç¡®éšè—ç‰¹å¾</a></li>
</ol>
<p><strong>æ— ç—•éšèº«æ¨¡å¼è®¿é—®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">start_browser</span><span class="params">()</span>:</span></span><br><span class="line">    browser = <span class="keyword">await</span> launch(**&#123;<span class="string">"headless"</span>: <span class="keyword">False</span>&#125;)</span><br><span class="line">    <span class="comment"># åˆ›å»ºéšèº«ä¸Šä¸‹æ–‡</span></span><br><span class="line">    browser_context = <span class="keyword">await</span> browser.createIncognitoBrowserContext()</span><br><span class="line">    page = <span class="keyword">await</span> browser_context.newPage()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> page.goto(<span class="string">"http://www.baidu.com"</span>)</span><br><span class="line">    <span class="keyword">await</span> browser.close()</span><br><span class="line">    <span class="keyword">return</span></span><br></pre></td></tr></table></figure>
<p>è¾ƒå…¨çš„APIè¯´æ˜ï¼š<a href="https://blog.csdn.net/Qwertyuiop2016/article/details/92667875" target="_blank" rel="noopener">pyppeteerçš„åŸºæœ¬ä½¿ç”¨</a>ã€<a href="https://blog.csdn.net/weizhen11/article/details/102497647" target="_blank" rel="noopener">é¡µé¢ä¿¡æ¯ã€è®¾ç½®</a></p>
<h3 id="é—®é¢˜æŒ‰é’®ä¸ç”Ÿæ•ˆ"><a class="markdownIt-Anchor" href="#é—®é¢˜æŒ‰é’®ä¸ç”Ÿæ•ˆ"></a> é—®é¢˜ï¼šæŒ‰é’®ä¸ç”Ÿæ•ˆ</h3>
<p>ç½‘é¡µè¾“å…¥è´¦å·å’Œå¯†ç ä¹‹å‰ï¼ŒæŒ‰é’®çŠ¶æ€ä¸º<code>disable=true</code>ï¼Œä¸¤ä¸ªéƒ½è¾“å…¥åæ‰èƒ½æŒ‰ä¸‹ï¼Œè€Œä½¿ç”¨pyppeteeræ—¶ï¼Œå‘ç°æ— è®ºæ€ä¹ˆå°è¯•éƒ½ä¸èƒ½ä½¿å¾—å…¶disableå˜åŒ–ï¼ˆç”¨å¼€å‘è€…åŠ©æ‰‹ä¿®æ”¹åï¼Œæ— æ³•ç”Ÿæˆæ­£ç¡®çš„æäº¤è¯·æ±‚ï¼‰ã€‚çªç„¶å·§åˆä¹‹ä¸­ï¼Œæƒ³åˆ°äº†æ˜¯ä¸æ˜¯å…ƒç´ æ²¡åŠ è½½æˆåŠŸï¼Œäºæ˜¯ç¡®å®åœ¨å¼€å‘è€…åŠ©æ‰‹çš„<code>console</code>ä¸­çœ‹åˆ°æœ‰å¾ˆå¤šä¸æ”¯æŒçš„ï¼Œæ¯”å¦‚angularã€bootstrapâ€¦â€¦</p>
<p>äºæ˜¯ç™¾åº¦é—®é¢˜ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ä»€ä¹ˆè®¾ç½®æ²¡å¼€ï¼Œä½†éƒ½æ²¡æ‰¾åˆ°ã€‚åæ¥æƒ³åˆ°å‡çº§ä¸‹pyppeteerç‰ˆæœ¬ä¼šä¸ä¼šå¥½ä¸€ç‚¹ï¼Œå‘ç°è‡ªå·±çš„ç‰ˆæœ¬ä¸º1.0.2ï¼Œå·²ç»æ˜¯æœ€æ–°çš„äº†(<a href="https://github.com/miyakogi/pyppeteer/issues/306" target="_blank" rel="noopener">https://github.com/miyakogi/pyppeteer/issues/306</a>)ã€‚ç”±äºä¸é€šè¿‡ç¨‹åºç›´æ¥é€šè¿‡æµè§ˆå™¨è¿›å…¥ç¨‹åºä¹Ÿå‡ºç°äº†æ— æ³•ç‚¹å‡»çš„é—®é¢˜ã€‚å†åŠ ä¸Šä¸‹é¢æœ‰äººæå‡ºchromiumæœ‰ç‚¹éš¾ä¸‹è½½ï¼Œå¹¶é€šè¿‡æºç æ‰¾é“äº†é»˜è®¤çš„é…ç½®å’Œè®¾ç½®ï¼Œäºæ˜¯ç»è¿‡ä¸€é˜µçš„æŠ˜è…¾è¿‡åï¼Œæˆ‘å‘ç°**â€œæŒ‰é’®æ— æ³•ç‚¹å‡»â€çš„é—®é¢˜å°±åœ¨äºchromiumç‰ˆæœ¬è¿‡ä½**ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyppeteer.chromium_downloader</span><br><span class="line">print(<span class="string">'é»˜è®¤ç‰ˆæœ¬æ˜¯ï¼š&#123;&#125;'</span>.format(pyppeteer.__chromium_revision__))</span><br><span class="line">print(<span class="string">'å¯æ‰§è¡Œæ–‡ä»¶é»˜è®¤è·¯å¾„ï¼š&#123;&#125;'</span>.format(pyppeteer.chromium_downloader.chromiumExecutable.get(<span class="string">'win64'</span>)))</span><br><span class="line">print(<span class="string">'win64å¹³å°ä¸‹è½½é“¾æ¥ä¸ºï¼š&#123;&#125;'</span>.format(pyppeteer.chromium_downloader.downloadURLs.get(<span class="string">'win64'</span>)))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é»˜è®¤ç‰ˆæœ¬æ˜¯ï¼š588429</span></span><br><span class="line"><span class="string">å¯æ‰§è¡Œæ–‡ä»¶é»˜è®¤è·¯å¾„ï¼šC:\Users\mrli\AppData\Local\pyppeteer\pyppeteer\local-chromium\588429\chrome-win32\chrome.exe</span></span><br><span class="line"><span class="string">win64å¹³å°ä¸‹è½½é“¾æ¥ä¸ºï¼šhttps://storage.googleapis.com/chromium-browser-snapshots/Win_x64/588429/chrome-win32.zip</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<p>ç™»å½•è¿™ä¸ªstorageçš„ç½‘ç«™å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢æ‰€è®°å½•çš„chromiumå…¨éƒ½æ˜¯2013å¹´çš„ç‰ˆæœ¬ï¼Œå¿…ç„¶ç‰ˆæœ¬è½åäº†ã€‚äºæ˜¯ä¸‹è½½æœ€æ–°çš„chromiumè¦†ç›–<code>C:\Users\mrli\AppData\Local\pyppeteer\pyppeteer\local-chromium\588429\chrome-win32</code>ç›®å½•åå†è¿è¡Œï¼ŒæŒ‰é’®ä¸èƒ½ç‚¹å‡»çš„é—®é¢˜å°±æ¶ˆå¤±äº†!~ğŸ˜„</p>
<p>chromiumä¸‹è½½åœ°å€ï¼š<a href="https://registry.npmmirror.com/binary.html?path=chromium-browser-snapshots/Win_x64/%EF%BC%8C%E6%B3%A8%EF%BC%9Achromium%E8%B7%9Fchromedriver%E4%B8%8D%E4%B8%80%E6%A0%B7%EF%BC%8C%E4%BB%96%E8%B7%9F%E8%87%AA%E5%B7%B1%E5%B7%B2%E7%BB%8F%E5%AE%89%E8%A3%85%E7%9A%84chrome%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%85%B3%E8%81%94%E3%80%82chromium%E8%87%AA%E5%B8%A6%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%95%E6%93%8E%E6%A0%B8%E5%BF%83%EF%BC%8C%E6%89%80%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC%E5%8D%B3%E5%8F%AF%EF%BC%8C%E6%AF%94%E5%A6%82%E6%88%91%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%B1%E6%98%AF999303%E3%80%82" target="_blank" rel="noopener">https://registry.npmmirror.com/binary.html?path=chromium-browser-snapshots/Win_x64/ï¼Œæ³¨ï¼šchromiumè·Ÿchromedriverä¸ä¸€æ ·ï¼Œä»–è·Ÿè‡ªå·±å·²ç»å®‰è£…çš„chromeå¹¶æ²¡æœ‰å…³è”ã€‚chromiumè‡ªå¸¦æµè§ˆå™¨å¼•æ“æ ¸å¿ƒï¼Œæ‰€ä»¥ç›´æ¥ä¸‹è½½æœ€æ–°çš„ç‰ˆæœ¬å³å¯ï¼Œæ¯”å¦‚æˆ‘ç›´æ¥ä¸‹è½½çš„å°±æ˜¯999303ã€‚</a></p>
<p>å¯å‘äºï¼š<a href="https://cloud.tencent.com/developer/article/1731720" target="_blank" rel="noopener">ä½¿ç”¨pyppeteer ä¸‹è½½chromium æŠ¥é”™ æˆ–é€Ÿåº¦æ…¢</a>ã€<a href="https://www.cnblogs.com/Summer-skr--blog/p/12020207.html" target="_blank" rel="noopener">pyppeteerä½¿ç”¨æ—¶å¸¸è§çš„bugåŠè§£å†³åŠæ³•ã€è½¬è½½ã€‘ </a></p>
<ul>
<li>ğŸ“–pyppeteerå®æˆ˜æ¡ˆä¾‹ï¼š<a href="https://blog.csdn.net/weixin_44826986/article/details/124114130" target="_blank" rel="noopener">Pyppeteerçš„ä½¿ç”¨â€”â€”çˆ¬å–äº¬ä¸œ</a>â€”â€”æ¶ˆé™¤æŒ‡çº¹ã€é¡µé¢æ»‘åŠ¨äº‹ä»¶ã€è·å–æ•°æ®ï¼Œè·å–åˆ°çš„æ˜¯Jsonæ•°æ®ï¼š<code>(await a[0].getProperty(&quot;textContent&quot;)).jsonValue()</code></li>
<li>ğŸ“–å®˜æ–¹APIï¼š <a href="https://pyppeteer.github.io/pyppeteer/reference.html#pyppeteer.page.Page.xpath%E3%80%81" target="_blank" rel="noopener">https://pyppeteer.github.io/pyppeteer/reference.html#pyppeteer.page.Page.xpathã€</a><a href="https://learnku.com/docs/puppeteer/3.1.0/class-mouse/8549" target="_blank" rel="noopener">puppeteerä¸­æ–‡æ‰‹å†Œ</a></li>
<li><a href="https://www.pythonheidong.com/blog/article/1133668/afc4477523a740d64a23/" target="_blank" rel="noopener">setViewportå…¨å±</a></li>
</ul>
<h1 id="zsxq"><a class="markdownIt-Anchor" href="#zsxq"></a> zsxq</h1>
<h2 id="æ“ä½œworddocx"><a class="markdownIt-Anchor" href="#æ“ä½œworddocx"></a> æ“ä½œwordâ€”â€”docx</h2>
<blockquote>
<p>å®‰è£…: <code>pip install python-docx</code></p>
</blockquote>
<ul>
<li>æ’å…¥å›¾ç‰‡</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">doc = Document()</span><br><span class="line"><span class="comment"># å¢åŠ æ ‡é¢˜</span></span><br><span class="line">doc.add_heading(<span class="string">'python-docx åŸºç¡€è®²è§£ï¼ˆäºŒï¼‰'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æ–‡æ¡£ä¸­å¢åŠ å›¾ç‰‡,å¹¶å¯¹è®¾ç½®å›¾ç‰‡å¤§å°</span></span><br><span class="line"><span class="comment"># å½“åªè®¾ç½®ä¸€ä¸ªæ–¹å‘çš„é•¿åº¦ï¼ˆå®½æˆ–é«˜ï¼‰æ—¶ï¼Œå¦ä¸€æ–¹å‘ä¼šè‡ªåŠ¨ç¼©æ”¾</span></span><br><span class="line">doc.add_picture(<span class="string">'1.png'</span>,width=shared.Inches(<span class="number">1</span>))  <span class="comment"># æŒ‰è‹±å¯¸è®¾ç½®</span></span><br><span class="line">doc.add_picture(<span class="string">'1.png'</span>,height=shared.Cm(<span class="number">2</span>))  <span class="comment"># æŒ‰å˜ç±³è®¾ç½®</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ’å…¥èŠ‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_heading(text=<span class="string">u''</span>, level=<span class="number">1</span>)	        <span class="comment"># å†™å…¥æ ‡é¢˜æ®µè½</span></span><br><span class="line">add_paragraph(text =<span class="string">u''</span>,style=<span class="keyword">None</span>)	<span class="comment"># å†™å…¥æ™®é€šæ®µè½</span></span><br><span class="line">add_picture(image_path_or_streamï¼Œwidth = <span class="keyword">None</span>ï¼Œheight = <span class="keyword">None</span> )	<span class="comment">#æ’å…¥æŒ‡å®šå›¾ç‰‡</span></span><br><span class="line">add_table(rows, cols)					<span class="comment"># æ’å…¥æŒ‡å®šè¡Œæ•°ã€åˆ—æ•°çš„è¡¨æ ¼</span></span><br><span class="line">add_section(self, start_type=<span class="number">2</span>)     		 <span class="comment"># æ·»åŠ èŠ‚ï¼›</span></span><br><span class="line">add_page_break(self)               			 <span class="comment"># åˆ†é¡µç¬¦ï¼›</span></span><br><span class="line">add_paragraph(self, text=<span class="string">''</span>, style=<span class="keyword">None</span>)      <span class="comment"># æ·»åŠ æ®µè½ï¼›</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ·»åŠ é¡µçœ‰</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>document = Document()</span><br><span class="line"><span class="comment"># æ¯ä¸ªèŠ‚sectionéƒ½æœ‰å…¶é¡µçœ‰header</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>section = document.sections[<span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>header = section.header</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>paragraph = header.paragraphs[<span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>paragraph.text = <span class="string">"Title of my document"</span></span><br><span class="line"><span class="comment"># è®¾ç½®é¡µçœ‰æ˜¯å¦è¿æ¥ä¸Šä¸€èŠ‚</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>header.is_linked_to_previous = <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šâ€œé¡µçœ‰ä¹Ÿæ˜¯ä¸€ä¸ªå—çº§å¯¹è±¡ï¼Œé‡Œé¢ä¹ŸåŒ…å«äº† Paragraph å¯¹è±¡,â€ â€œæ‰€ä»¥å¯¹é½æ–¹å¼ï¼Œæ–‡å­—æ ¼å¼è®¾ç½®æ–¹å¼å’Œå‰æ–‡ä»‹ç»ä¸€è‡´ã€‚â€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">head_par = head.paragraphs[<span class="number">0</span>]</span><br><span class="line">head_par.add_run(<span class="string">'é¡µçœ‰'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹é¡µè„š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">font0 = sec0.footer  <span class="comment"># è¿”å›é¡µè„šå¯¹è±¡</span></span><br><span class="line"><span class="comment"># è®¾ç½®é¡µè„š</span></span><br><span class="line">font0_par = font0.paragraphs[<span class="number">0</span>]</span><br><span class="line">font0_par.add_run(<span class="string">'é¡µè„š'</span>)</span><br><span class="line"><span class="comment"># æ³¨: è®¾ç½®é¡µè„šæŒ‰åºåˆ—å¢åŠ çš„æ–¹å¼æš‚æœªæ‰¾åˆ°</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ·»åŠ è¡¨æ ¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">table1 = doc.add_table(<span class="number">2</span>,<span class="number">3</span>,style =<span class="string">'Table Grid'</span> )</span><br><span class="line"><span class="comment"># è¡¨æ ¼è®¾ç½®è‡ªåŠ¨è°ƒæ•´åˆ—å®½ï¼Œï¼ˆé»˜è®¤ä¹Ÿä¸ºçœŸï¼‰</span></span><br><span class="line">table1.autofit = <span class="keyword">True</span></span><br><span class="line"><span class="comment"># ä¸ºè¡¨æ ¼å¯¹è±¡å¢åŠ åˆ—</span></span><br><span class="line">table1.add_column(shared.Inches(<span class="number">3</span>)) <span class="comment"># éœ€æŒ‡å®šå®½åº¦</span></span><br><span class="line"><span class="comment"># ä¸ºè¡¨æ ¼å¯¹è±¡å¢åŠ è¡Œ</span></span><br><span class="line">table1.add_row() <span class="comment"># åªèƒ½é€è¡Œæ·»åŠ </span></span><br><span class="line"><span class="comment"># è·å–è¡Œå¯¹è±¡</span></span><br><span class="line">row0 = table1.rows[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># è·å–åˆ—å¯¹è±¡</span></span><br><span class="line">col0 = table1.columns[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># è®¾ç½®å•å…ƒæ ¼å¯¹é½æ–¹å¼: å‚ç›´å¯¹é½æ–¹å¼</span></span><br><span class="line"><span class="keyword">from</span> docx.enum.table <span class="keyword">import</span> WD_ALIGN_VERTICAL</span><br><span class="line">table1.cell(<span class="number">0</span>,<span class="number">0</span>).vertical_alignment = WD_ALIGN_VERTICAL.TOP</span><br><span class="line"><span class="comment"># åˆå¹¶å•å…ƒæ ¼</span></span><br><span class="line">cell_new = table1.cell(<span class="number">2</span>,<span class="number">0</span>).merge(table1.cell(<span class="number">2</span>,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>æ³¨: å•å…ƒæ ¼å†…å…¶å®ä¹Ÿæ˜¯æœ‰ paragraph å¯¹è±¡çš„ï¼Œå³å¯¹å•å…ƒæ ¼å†…å­—ä½“è®¾ç½®æ–¹å¼ï¼Œå’Œå¯¹æ®µè½ä¸­æ–‡å­—æ ¼å¼è®¾ç½®æ–¹æ³•ä¸€æ ·ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cell_par = cell_new.paragraphs[<span class="number">0</span>] <span class="comment"># è·å–åˆ°å¯¹è±¡</span></span><br><span class="line"><span class="comment"># è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line"><span class="keyword">from</span> docx.enum.text <span class="keyword">import</span> WD_ALIGN_PARAGRAPH</span><br><span class="line">cell_par.paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER</span><br><span class="line"><span class="comment"># è·å– run å¯¹è±¡</span></span><br><span class="line">cell_run = cell_new.paragraphs[<span class="number">0</span>].runs[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># è®¾ç½®å­—ä½“</span></span><br><span class="line">cell_run.font.name = <span class="string">'Times New Roman'</span></span><br><span class="line"><span class="keyword">from</span> docx.oxml.ns <span class="keyword">import</span> qn</span><br><span class="line">cell_run.font.element.rPr.rFonts.set(qn(<span class="string">'w:eastAsia'</span>),<span class="string">'æ¥·ä½“'</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> RGBColor</span><br><span class="line">cell_run.font.color.rgb = RGBColor(<span class="number">255</span>,<span class="number">55</span>,<span class="number">55</span>) <span class="comment"># çº¢è‰²</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ®µè½è®¾ç½®</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ®µè½ç¼©è¿›</span></span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> Inches</span><br><span class="line">paragraph = document.add_paragraph(<span class="string">"ä½ è¯´å•¥"</span>)</span><br><span class="line">paragraph_format = paragraph.paragraph_format</span><br><span class="line">paragraph_format.left_indent = Inches(<span class="number">0.5</span>)</span><br><span class="line"><span class="comment"># é¦–è¡Œç¼©è¿›</span></span><br><span class="line">paragraph_format.first_line_indent = Inches(<span class="number">-0.25</span>)</span><br><span class="line"><span class="comment"># æ®µè½è¡Œè·</span></span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> Length</span><br><span class="line"></span><br><span class="line">paragraph.line_spacing_rule = WD_LINE_SPACING.EXACTLY <span class="comment">#å›ºå®šå€¼</span></span><br><span class="line">paragraph_format.line_spacing = Pt(<span class="number">18</span>) <span class="comment"># å›ºå®šå€¼18ç£…</span></span><br><span class="line">paragraph.line_spacing_rule = WD_LINE_SPACING.MULTIPLE <span class="comment">#å¤šå€è¡Œè·</span></span><br><span class="line">paragraph_format.line_spacing = <span class="number">1.75</span> <span class="comment"># 1.75å€è¡Œé—´è·</span></span><br></pre></td></tr></table></figure>
<p>æ›´å¤šæ“ä½œæ ·å¼è§ï¼š</p>
<ul>
<li>â˜…<a href="https://blog.csdn.net/lly1122334/article/details/109669667" target="_blank" rel="noopener">Pythonæ“çºµWordç¥å™¨â€”â€”python-docxå¤§å…¨ï¼ˆå«æ’å…¥pptxå›¾è¡¨ï¼‰</a></li>
<li><a href="https://blog.csdn.net/zhouz92/article/details/107066709" target="_blank" rel="noopener">Python-docx è¯»å†™ Word æ–‡æ¡£ï¼šæ’å…¥å›¾ç‰‡ã€è¡¨æ ¼ï¼Œè®¾ç½®è¡¨æ ¼æ ·å¼ï¼Œç« èŠ‚ï¼Œé¡µçœ‰é¡µè„šç­‰</a>â€”â€”è¡¨æ ¼ã€é¡µçœ‰é¡µè„š</li>
<li><a href="https://zhuanlan.zhihu.com/p/61340025" target="_blank" rel="noopener">python-docxå¤„ç†wordæ–‡æ¡£</a>â€”â€”æ®µè½æ“ä½œï¼ˆå­—ä½“å±æ€§å¯é€‰é¡¹ï¼‰</li>
</ul>
<h3 id="saveåæ“ä½œdocumentå¯¹è±¡å†saveä¼šè¦†ç›–"><a class="markdownIt-Anchor" href="#saveåæ“ä½œdocumentå¯¹è±¡å†saveä¼šè¦†ç›–"></a> Saveåæ“ä½œDocumentå¯¹è±¡å†saveä¼šè¦†ç›–</h3>
<p>Documentå¯¹è±¡åœ¨saveä¹‹åï¼Œå¯¹å…¶æ“ä½œä»ç„¶æœ‰æ•ˆï¼Œåç»­çš„æ“ä½œåœ¨æ–°çš„saveä¸­ä¼šä¿ç•™ä¸Šæ¬¡saveçš„è®°å½•ï¼Œç„¶åå†æ·»åŠ æ–°çš„ï¼ˆå®åˆ™æ˜¯è¦†ç›–ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">d = Document()</span><br><span class="line">resp = requests.get(<span class="string">"https://images.zsxq.com/FodneHQIMESZXJWe4SahoZ_J_vGs?imageMogr2/auto-orient/quality/100!/ignore-error/1&amp;e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:onEkC9y8uloYeHTrEIpYk4dstaw="</span>)</span><br><span class="line">bf = BytesIO()</span><br><span class="line">bf.write(resp.content)</span><br><span class="line">d.add_picture(bf)</span><br><span class="line">bf.close()</span><br><span class="line">d.save(<span class="string">"test.docx"</span>)</span><br><span class="line"><span class="comment"># saveä¹‹åå¯ä»¥ç»§ç»­ **æ’å…¥**, ç„¶åå†ä¿å­˜</span></span><br><span class="line">d.add_paragraph(<span class="string">"he"</span>)</span><br><span class="line">d.save(<span class="string">"test.docx"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£"><a class="markdownIt-Anchor" href="#ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£"></a> ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£</h3>
<p><a href="https://link.zhihu.com/?target=https%3A//python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener">python-docx</a> ä¸ä»…å¯ä»¥åˆ›å»ºwordæ–‡æ¡£ï¼Œè¿˜å¯ä»¥ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line">document = Document(<span class="string">'existing-document-file.docx'</span>)</span><br><span class="line"><span class="comment"># å¯ä»¥å°† å·²å­˜åœ¨ docxçš„å†…å®¹ä¿å­˜åˆ°æ–°çš„docxä¸­</span></span><br><span class="line">document.save(<span class="string">'new-file-name.docx'</span>)</span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ è¦†ç›–å½“å‰docx æˆæ–°çš„docx</span></span><br></pre></td></tr></table></figure>
<p>ä½†å…¶å®å§ï¼Œè¿™ç©æ„å„¿<strong>åªèƒ½ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£</strong>ï¼Œä¹‹æ‰€ä»¥æœ‰ä¸ªâ€œåˆ›å»ºç©ºç™½æ–‡æ¡£â€çš„åŠŸèƒ½ï¼Œåªä¸è¿‡æ˜¯æ‹·è´ä¸€ä»½ç©ºç™½wordæ–‡æ¡£åˆ°å·¥ä½œåŒºé—´ï¼Œå†åœ¨ç©ºç™½æ–‡æ¡£ä¸Šç¼–è¾‘ï¼Œçœ‹èµ·æ¥ä¼¼ä¹æ˜¯â€œåˆ›å»ºç©ºç™½æ–‡æ¡£â€ç½¢äº†ã€‚æœ¬è´¨ä¸Šè¿˜æ˜¯ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£â€¦</p>
<p>æ‰“å¼€ä¸€ä¸ªwordæ–‡æ¡£ï¼Œç¼–è¾‘å®Œåï¼Œä¸€å®šè¦è®°å¾—ä¿å­˜ã€‚å¦‚æœä¿å­˜æ–‡ä»¶åå’ŒåŸæ–‡ä»¶åä¸ä¸€æ ·ï¼Œåˆ™ä¼šå¦å­˜ä¸ºä¸€ä»½wordæ–‡æ¡£ï¼›è‹¥æ–‡ä»¶åä¸€æ ·ï¼Œåˆ™ä¼šä¸åŠ æç¤ºçš„ä¿å­˜ä¿®æ”¹å†…å®¹ã€‚</p>
<h2 id="__slots__ä½œç”¨"><a class="markdownIt-Anchor" href="#__slots__ä½œç”¨"></a> <code>__slots__</code>ä½œç”¨</h2>
<p>ç”¨äºéœ€è¦ç»´æŠ¤ä¸¤ä¸ªSaver, å› æ­¤ä¸­é—´æ ¹æ®è¿”å›å€¼æ¥è·å¾—äº†æšä¸¾ç¡®å®šsaverå¯¹è±¡, ä½†æ˜¯saverå¯¹è±¡æœ‰ä¸ªsaver_nameçš„å±æ€§å¹¶æ²¡æœ‰ç»‘å®šèµ·æ¥, å› æ­¤æƒ³åˆ°<br>
é€šè¿‡<code>setattr</code>æ¥æ·»åŠ å±æ€§</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="comment"># ä½¿ç”¨__slots__åæ·»åŠ ageå±æ€§æŠ¥é”™: AttributeError: 'A' object has no attribute 'age'</span></span><br><span class="line">    __slots__ = (<span class="string">"name"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name=<span class="string">"cl"</span>)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">a = A()</span><br><span class="line">setattr(a, <span class="string">"age"</span>, <span class="number">18</span>)</span><br><span class="line">print(a)</span><br><span class="line">print(a.__dict__)</span><br><span class="line">print(a.age)</span><br></pre></td></tr></table></figure>
<p>ä½†ä¸å¹¸çš„æ˜¯Documentä¸­ä¹Ÿæ— æ³•é€šè¿‡<code>setattr</code>æ·»åŠ å±æ€§, åŸå› åº”è¯¥æ˜¯Documentç±»ä¹Ÿå®šä¹‰äº†<code>__slots__</code>ã€‚</p>
<p>åœ¨æ­¤, ä¹Ÿæ˜ç¡®ä¸‹<code>__slots__</code>çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li><code>__slots__</code>æ•°æ®ç±»å‹ä¸ºå…ƒç»„</li>
<li><code>__slots__</code>åªå¯¹å½“å‰ç±»ç”Ÿæ•ˆï¼Œå¯¹å…¶å­ç±»ä¸ç”Ÿæ•ˆ</li>
</ul>
<h2 id="bytesioä½¿ç”¨"><a class="markdownIt-Anchor" href="#bytesioä½¿ç”¨"></a> BytesIOä½¿ç”¨</h2>
<p>è¯´èµ·IOï¼Œå¾ˆå¤šäººé¦–å…ˆæƒ³åˆ°çš„æ˜¯ç£ç›˜ä¸­çš„æ–‡ä»¶ï¼Œå°†ç£ç›˜ä¸­çš„æ–‡ä»¶è¯»åˆ°<a href="https://so.csdn.net/so/search?q=%E5%86%85%E5%AD%98&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">å†…å­˜</a>ä»¥åŠå†…å­˜å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œæ˜¾ç„¶è¿™ç§æ–‡ä»¶ä¸å†…å­˜çš„File-IOæ˜¯ç§éå¸¸å…¸å‹çš„IOã€‚ç„¶è€Œå…¶å®è¿˜å­˜åœ¨ä¸€ç§å†…å­˜å’Œå†…å­˜ä¹‹é—´çš„IOï¼Œå«ç±»æ–‡ä»¶å¯¹è±¡ï¼ˆfile-like objectï¼Œåœ¨å†…å­˜ä¸­åˆ›å»ºï¼Œå¯ä»¥åƒæ–‡ä»¶ä¸€æ ·è¢«æ“ä½œï¼‰ã€‚PythonåŸç”Ÿæä¾›ä¸¤ä¸ªç±»æ–‡ä»¶å¯¹è±¡ï¼šStringIOå’ŒBytesIOã€‚</p>
<p>Qé—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆè¦æœ‰å†…å­˜çº§åˆ«çš„IOï¼Ÿ</p>
<p>Aï¼šç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œå°±æ˜¯å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜çš„ä¸€å—åŒºåŸŸï¼Œä¾›åé¢é‡å¤ä½¿ç”¨ã€‚å…¶ä¼˜ç‚¹å°±æ˜¯æŒä¹…åŒ–ç¨³å®šä¸ä¸¢å¤±ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯æ¯æ¬¡è¦ä½¿ç”¨éƒ½è¦ä»ç£ç›˜è¯»å…¥ï¼Œç›¸å¯¹å†…å­˜è€Œè¨€å¾ˆç¼“æ…¢ï¼›å¦‚æœåªæ˜¯çŸ­æ—¶é—´çš„é‡å¤åˆ©ç”¨ï¼Œå¹¶ä¸å¸Œæœ›é•¿æœŸæŒä¹…åŒ–ï¼Œè€Œä¸”å¯¹é€Ÿåº¦çš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è€ƒè™‘ç¼“å­˜ã€‚è¯´åˆ°ç¼“å­˜ï¼Œå¾ˆå¤šæœ‹å‹å°±æƒ³åˆ°redisï¼Œç†Ÿæ‚‰pythonçš„æœ‹å‹è¿˜ä¼šæƒ³åˆ°è£…é¥°å™¨å’Œé—­åŒ…å‡½æ•°ã€‚ä¸è¿‡pythonå·²ç»åŸç”Ÿä¸ºæˆ‘ä»¬å‡†å¤‡å¥½äº†ç±»æ–‡ä»¶å¯¹è±¡ï¼šStringIOå’ŒBytesIOï¼Œç”¨äºä¸´æ—¶ç¼“å†²</p>
<p>Qé—®é¢˜äºŒï¼šStringIOå’ŒBytesIOåŒºåˆ«ï¼Ÿ</p>
<p>A:StringIOåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œé‡åˆ°ä»ç½‘ç»œä¸‹è½½çš„å›¾ç‰‡è§†é¢‘ç­‰Bytesç±»å‹çš„å†…å®¹å°±ä¸è¡Œäº†ï¼Œéœ€è¦ç”¨åˆ°ä¸“é—¨å­˜å‚¨Bytesç±»å‹çš„BytesIOå¯¹è±¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> io <span class="keyword">import</span> BytesIO           </span><br><span class="line">In [<span class="number">2</span>]: b=BytesIO()         </span><br><span class="line">In [<span class="number">3</span>]: b.write(<span class="string">'å°ä»˜'</span>.encode(<span class="string">'utf-8'</span>))    </span><br><span class="line">Out[<span class="number">3</span>]: <span class="number">6</span></span><br><span class="line">In [<span class="number">4</span>]: b.getvalue()                          </span><br><span class="line">Out[<span class="number">4</span>]: <span class="string">b'\xe5\xb0\x8f\xe4\xbb\x98'</span></span><br></pre></td></tr></table></figure>
<p>Qé—®é¢˜ä¸‰ï¼šé‚£ä¹ˆè¿™ä¸¤ä¸ªIOæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>
<p>A: BytesIOçœŸæ­£å®ç”¨çš„åœ°æ–¹è¿˜æ˜¯åœ¨äºå­˜å‚¨å›¾ç‰‡è§†é¢‘ç­‰æ•°æ®ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚äº†ä¸€ä¸ªå›¾ç‰‡ï¼Œæ‹¿åˆ°äº†<code>resp.content</code>çš„å­—èŠ‚æµï¼Œç„¶åéœ€è¦æ‰“å¼€å±•ç¤ºå›¾ç‰‡ï¼Œä½†â‘ pillowåº“æ‰“å¼€çš„éƒ½æ˜¯æ–‡ä»¶IOå¯¹è±¡ï¼Œæ— æ³•ç›´æ¥é€šè¿‡å­—èŠ‚æµå±•ç¤ºï¼›â‘¡ä¿å­˜åˆ°æœ¬åœ°ä½œä¸ºæ–‡ä»¶æ‰“å¼€åˆæ²¡å¿…è¦ï¼Œæ—¢å ç”¨å­˜å‚¨ç©ºé—´ï¼Œæ•ˆç‡åˆä½â€“&gt;æ­¤æ—¶å°±å¯ä»¥å†™å…¥åˆ°å†…å­˜ä¸­çš„IO(BytesIO)ä¸­</p>
<p>Qé—®é¢˜å››ï¼šé‚£ä¹ˆStringIOå’ŒBytesIOè·Ÿæ™®é€šç”¨çš„<code>f = open()</code>çš„FileIOæœ‰ä»€ä¹ˆç›¸åŒç‚¹å‘¢</p>
<p>A:StringIOå’ŒBytesIOä»ç„¶ä¸ºIOï¼Œä½†æ‹¥æœ‰å’Œè¯»å†™æ–‡ä»¶å…·æœ‰ä¸€è‡´çš„æ¥å£ï¼Œå…¶æœ¬è´¨æ˜¯å°†å†…å­˜ä½œä¸ºä¸€ä¸ªæ–‡ä»¶çœ‹å¾…ï¼Œåªæ˜¯åœ¨å†…å­˜ä¸­æ“ä½œstrå’Œbytesã€‚</p>
<h3 id="æœ¬é¡¹ç›®æ¡ˆä¾‹-2"><a class="markdownIt-Anchor" href="#æœ¬é¡¹ç›®æ¡ˆä¾‹-2"></a> æœ¬é¡¹ç›®æ¡ˆä¾‹ï¼š</h3>
<blockquote>
<p><code>python-docx</code>åº“ä¸­Documentå¯¹è±¡å¯ä»¥é€šè¿‡<code>add_picture()</code>æ–¹æ³•æ’å…¥å›¾ç‰‡åˆ°wordä¸­ï¼Œä½†æ˜¯<code>add_picture</code>çš„å‚æ•°ä¸º<code>img_path</code>æˆ–è€…<code>stream</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªStreamæµæŒ‡çš„è‚¯å®šæ˜¯å›¾ç‰‡çš„å­—èŠ‚æµï¼Œä½†æ˜¯ç›´æ¥é€šè¿‡bytesæ•°æ®è‚¯å®šæ˜¯æ²¡åŠæ³•ä¼ å…¥çš„ï¼Œå› æ­¤å¯ä»¥<strong>å°†å…¶å†™å…¥åˆ°BytesIOä¸­ï¼Œä¾›å…¶è¯»å–</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> d = Document()</span><br><span class="line">   resp = requests.get(</span><br><span class="line">       <span class="string">"https://images.zsxq.com/FodneHQIMESZXJWe4SahoZ_J_vGs?imageMogr2/auto-orient/quality/100!/ignore-error/1&amp;e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:onEkC9y8uloYeHTrEIpYk4dstaw="</span>)</span><br><span class="line">   bf = BytesIO()</span><br><span class="line">   bf.write(resp.content)</span><br><span class="line">   d.add_picture(bf)</span><br><span class="line">   <span class="comment"># ä¸€å¼ å›¾ç‰‡</span></span><br><span class="line">   bf.close()</span><br><span class="line">   d.save(<span class="string">"test.docx"</span>)</span><br><span class="line">   <span class="comment"># saveä¹‹åå¯ä»¥ç»§ç»­ **æ’å…¥**, ç„¶åå†ä¿å­˜</span></span><br><span class="line">   d.add_paragraph(<span class="string">"he"</span>)</span><br><span class="line">   d.save(<span class="string">"test.docx"</span>)</span><br><span class="line"><span class="comment"># ä¸€å¼ å›¾ç‰‡ï¼Œç”Ÿæˆä¸€ä¸ªBytesIO</span></span><br><span class="line">   bf = BytesIO()</span><br><span class="line">   resp = requests.get(</span><br><span class="line">       <span class="string">"https://images.zsxq.com/FrqnoTw_W2Pqhn1107HLd3jveuSz?e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:MJuNvGjp8XcfDNLPB5eLcouRFRg="</span>)</span><br><span class="line">   bf.write(resp.content)</span><br><span class="line">   d.add_picture(bf)</span><br><span class="line">   d.save(<span class="string">"test.docx"</span>)</span><br><span class="line">   bf.close()</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šé€šè¿‡bf.flush()æ— æ³•æ¸…ç©ºå†…å®¹, å¿…é¡»close(), å¦åˆ™<code>bf.write(æ–°å›¾ç‰‡)</code>ç„¶åå†æ·»åŠ æ—¶ç¬¬äºŒå¼ å›¾ç‰‡å†…å®¹ä»ç„¶ä¸ºç¬¬ä¸€å¼ ã€‚</p>
<p>â˜… --&gt; ç½‘ä¸Šæ²¡èƒ½æ‰¾åˆ°æ¸…é™¤BytesIOå·²æœ‰å†…å®¹ï¼Œå› æ­¤ç»“è®ºä¸ºï¼šä¸€ä¸ªbyteså†…å®¹å ç”¨ä¸€ä¸ªBytesIOï¼Œç”¨å®Œå°±å…³é—­</p>
<h2 id="loguru"><a class="markdownIt-Anchor" href="#loguru"></a> loguru</h2>
<blockquote>
<p>loguruä¸­æä¾›å…¨å±€çš„logger, å¯ä»¥ç›´æ¥é€šè¿‡ <code>from loguru import logger</code> æ¥è·å¾— logger, ä½†æ˜¯è¿™å°±æ„å‘³ç€, è¿™æ ·è·å¾—çš„éƒ½æ˜¯éƒ½ä¸€ä¸ªlogger<br>
å¯¹è±¡, å› æ­¤ä¸å¤ªæ–¹ä¾¿ç”¨äºåˆ†æ¨¡å—çš„æ—¥å¿—ç®¡ç†, è€Œæ˜¯å…¨å±€çš„æ—¥å¿—ç®¡ç†ã€‚</p>
</blockquote>
<p>loguruçš„ä¾¿æ·ä½“ç°åœ¨å…¶<strong>å¼€ç®±å³ç”¨</strong>(å°‘é…ç½®)çš„ç‰¹ç‚¹, ä¸‹é¢ä¸¤è¡Œä»£ç å°±èƒ½è¾“å‡ºç¾è§‚çš„æ—¥å¿—è¾“å‡º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line">logger.info(<span class="string">"hello"</span>)</span><br></pre></td></tr></table></figure>
<p>å…¶æ¬¡, logurué…ç½®æ—¥å¿—æ–‡ä»¶ä¹Ÿéå¸¸æ–¹ä¾¿, ä»–æå‡ºå±äºä¸º**â€œæ²‰é‡â€**<code>sink</code><br>
<code>logger.add(sink='log.txt', format=&quot;{time} {level} {message}&quot;, filter=&quot;my_module&quot;, level=&quot;INFO&quot;)</code><br>
å°†ä¸Šé¢ä¸¤ä¸ªåŠŸèƒ½åˆèµ·æ¥ï¼Œå°±èƒ½å®ç°æœ€åŸºæœ¬çš„æ—¥å¿—åŠŸèƒ½äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line">logger.add(sink=<span class="string">'log.log'</span>, format=<span class="string">"&#123;time&#125; - &#123;level&#125; - &#123;message&#125;"</span>, level=<span class="string">"INFO"</span>)</span><br><span class="line">logger.info(<span class="string">"That's it, beautiful and simple logging!"</span>)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç”¨rotationã€retentionã€compressionè¿›è¡Œæ—¥å¿—çª—å£ã€æ›´æ–°ã€å‹ç¼©ç®¡ç†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">logger.add(<span class="string">"file_1.log"</span>, rotation=<span class="string">"500 MB"</span>)    <span class="comment"># æ—¥å¿—æ–‡ä»¶çš„çª—å£å¤§å°æ˜¯500M</span></span><br><span class="line">logger.add(<span class="string">"file_2.log"</span>, rotation=<span class="string">"12:00"</span>)     <span class="comment"># æ¯å¤©ä¸­åˆ12ç‚¹åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">logger.add(<span class="string">"file_3.log"</span>, rotation=<span class="string">"1 week"</span>)    <span class="comment"># è‡ªåŠ¨æ›´æ–°æ—§æ–‡ä»¶</span></span><br><span class="line">logger.add(<span class="string">"file_X.log"</span>, retention=<span class="string">"10 days"</span>)  <span class="comment"># æ¸…ç†æ—§æ–‡ä»¶</span></span><br><span class="line">logger.add(<span class="string">"file_Y.log"</span>, compression=<span class="string">"zip"</span>)    <span class="comment"># å‹ç¼©æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>
<p>more:</p>
<ul>
<li>ä¿®æ”¹æ—¥å¿—æ–‡å­—çš„é¢œè‰²<br>
<code>logger.add(sys.stdout, colorize=True, format=&quot;&lt;green&gt;{time}&lt;/green&gt; &lt;level&gt;{message}&lt;/level&gt;&quot;)</code></li>
<li>ä½¿ç”¨enqueueï¼Œå¯ä»¥ä¿è¯å¤šçº¿ç¨‹å®‰å…¨ã€å¤šè¿›ç¨‹å®‰å…¨<br>
<code>logger.add(&quot;somefile.log&quot;, enqueue=True)</code><br>
å‚è€ƒ: <a href="https://www.jianshu.com/p/0c27ac960546" target="_blank" rel="noopener">Loguruï¼šä¼˜é›…çš„Pythonç¨‹åºæ—¥å¿—</a></li>
</ul>
<h3 id="æœ¬é¡¹ç›®è‡ªç”¨logurué…ç½®"><a class="markdownIt-Anchor" href="#æœ¬é¡¹ç›®è‡ªç”¨logurué…ç½®"></a> æœ¬é¡¹ç›®è‡ªç”¨logurué…ç½®</h3>
<ol>
<li><code>settings.py</code>ä¸­æ‰¾åˆ°é¡¹ç›®ç»å¯¹è·¯å¾„: <code>basedir = Path(__file__).resolve().parent.parent</code></li>
<li>å°†loguruä¸­çš„loggeræ³¨å†Œä¸ºå…¨å±€LOG, æš´éœ²ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line"><span class="keyword">from</span> helper.settings <span class="keyword">import</span> basedir</span><br><span class="line"></span><br><span class="line">log_folder_path = Path(basedir, <span class="string">'logs'</span>)</span><br><span class="line">log_path = Path(log_folder_path, time.strftime(<span class="string">"%F"</span>))  <span class="comment"># æ—¥å¿—æ ¹ç›®å½• ../logs/yyyy-mm-dd/</span></span><br><span class="line"><span class="comment"># åˆ›å»ºæ—¥å¿—æ–‡ä»¶å¤¹</span></span><br><span class="line">log_path.mkdir(parents=<span class="keyword">True</span>, exist_ok=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®logger</span></span><br><span class="line">logger.add(sink=Path(log_path, <span class="string">"log.txt"</span>), format=<span class="string">"&#123;time&#125; &#123;level&#125; &#123;message&#125;"</span>, level=<span class="string">"INFO"</span>)</span><br><span class="line"><span class="comment"># æš´éœ²LOGç»™å…¶ä»–æ¨¡å—ä½¿ç”¨</span></span><br><span class="line">LOG = logger</span><br></pre></td></tr></table></figure>
<h2 id="retryæ¨¡å—-2"><a class="markdownIt-Anchor" href="#retryæ¨¡å—-2"></a> retryæ¨¡å—</h2>
<blockquote>
<p>â–²æœ¬é¡¹ç›®ä¸­ä¸çŸ¥ä¸ºä½•åŸå› ï¼Œoptions+getä¹‹åæ€»ä¼šå‡ºç°<code>{'succeeded': False, 'code': 1059, 'info': '', 'resp_data': {}}</code>çš„æ•°æ®ï¼Œä½†æ˜¯è¿›è¡Œé‡è¯•å‘é€è¯·æ±‚ååˆèƒ½è§£å†³ï¼Œå› æ­¤retryæ¨¡å—åœ¨è¿™ä¸ªé¡¹ç›®ä¸­å‘æŒ¥ä¸­è¾ƒå¤§çš„ä½œç”¨ã€‚</p>
</blockquote>
<p>retryæ˜¯ä¸€ä¸ªç”¨äºé”™è¯¯å¤„ç†çš„æ¨¡å—ï¼ŒåŠŸèƒ½ç±»ä¼¼try-exceptï¼Œä½†å¯ä»¥æ›´åŠ å¿«æ·æ–¹ä¾¿çš„è®¾ç½®é‡è¯•çš„æ¬¡æ•°ï¼Œä»¥åŠæ¯æ¬¡é‡è¯•ä¹‹é—´ç›¸éš”çš„æ—¶é—´ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@retry()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_trouble</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">'''Retry until succeed'''</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'retrying...'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>exceptionsï¼šä¼ å…¥æŒ‡å®šçš„é”™è¯¯ç±»å‹ï¼Œé»˜è®¤ä¸ºExceptionï¼Œå³æ•è·æ‰€æœ‰ç±»å‹çš„é”™è¯¯ï¼Œä¹Ÿå¯ä¼ å…¥<strong>å…ƒç»„å½¢å¼çš„å¤šç§æŒ‡å®šé”™è¯¯ç±»å‹</strong>ã€‚</p>
</li>
<li>
<p>triesï¼šå®šä¹‰æ•è·é”™è¯¯ä¹‹åé‡å¤è¿è¡Œæ¬¡æ•°ï¼Œé»˜è®¤ä¸º-1ï¼Œå³ä¸ºæ— æ•°æ¬¡ã€‚</p>
</li>
<li>
<p>delayï¼šå®šä¹‰æ¯æ¬¡é‡å¤è¿è¡Œä¹‹é—´çš„åœé¡¿æ—¶é•¿ï¼Œå•ä½ç§’ï¼Œé»˜è®¤ä¸º0ï¼Œå³æ— åœé¡¿ã€‚</p>
</li>
<li>
<p>backoffï¼šå‘ˆæŒ‡æ•°å¢é•¿çš„æ¯æ¬¡é‡å¤è¿è¡Œä¹‹é—´çš„åœé¡¿æ—¶é•¿ï¼Œéœ€è¦é…åˆdelayæ¥ä½¿ç”¨ï¼Œè­¬å¦‚delayè®¾ç½®ä¸º3ï¼Œbackoffè®¾ç½®ä¸º2ï¼Œåˆ™ç¬¬ä¸€æ¬¡é—´éš”ä¸º<code>3*2^0=3</code>ç§’ï¼Œç¬¬äºŒæ¬¡<code>3*2^1=6</code>ç§’ï¼Œç¬¬ä¸‰æ¬¡<code>3*2^2</code>=12ç§’ï¼Œä»¥æ­¤ç±»æ¨ï¼Œé»˜è®¤ä¸º1ã€‚</p>
</li>
<li>
<p>max_delayï¼šå®šä¹‰backoffå’Œdelayé…åˆä¸‹å‡ºç°çš„æœ€å¤§ç­‰å¾…æ—¶é—´ä¸Šé™ï¼Œå½“</p>
<p><code>delay*backoff**n</code>å¤§äºmax_delayæ—¶ï¼Œç­‰å¾…é—´éš”å›ºå®šä¸ºè¯¥å€¼è€Œä¸å†å¢é•¿ã€‚</p>
</li>
</ul>
<h1 id="qkl"><a class="markdownIt-Anchor" href="#qkl"></a> qkl</h1>
<h2 id="requests-html"><a class="markdownIt-Anchor" href="#requests-html"></a> requests-html</h2>
<blockquote>
<p>å®‰è£…: <code>pip install requests-html</code>ï¼Œåªæ”¯æŒpython3.6åŠä»¥ä¸Š</p>
</blockquote>
<p>ç”±äºå…¶ç”¨äº†<code>nuxt</code>æ¡†æ¶ï¼Œå› æ­¤æœ‰äº›è·¯ç”±æ•°æ®ä¿å­˜åœ¨<code>windows.__NUXT__.data</code>ä¸­ï¼Œè€Œè¿™äº›æ•°æ®éƒ½æ˜¯å˜é‡ï¼Œæ— æ³•ç›´æ¥é€šè¿‡æ­£åˆ™æå–å‡ºæ¥ï¼Œä½†æ˜¯å› ä¸ºå…¶å¯ä»¥åœ¨æ§åˆ¶å°è¾“å‡ºå·²ç»æ¸²æŸ“ç”Ÿæˆå¥½çš„<code>windows.__NUXT__.data</code>æ•°æ®ï¼Œå› æ­¤è€ƒè™‘åˆ°ç”¨chromiumåæ‰§è¡Œæ¸²æŸ“è„šæœ¬åº”è¯¥å¯ä»¥å®ç°ã€‚ä½†ä¹‹å‰æœ‰äº†è§£è¿‡requets-htmlï¼Œå…¶ç›¸å¯¹äºè¦å¼€æµè§ˆå™¨è€Œè¨€æ›´åŠ ä¾¿æ·ä¸€äº›ï¼Œäºæ˜¯æœ¬æ¬¡ä½¿ç”¨çš„æ˜¯requests-htmlã€‚</p>
<p><strong>å¿«é€Ÿä¸Šæ‰‹ï¼š</strong></p>
<p>ç”±äºä¸requestsåº“å‡ºäºåŒä¸€ä½œè€…ï¼Œå› æ­¤APIå’Œ<code>requestsåº“</code>éƒ½å·®ä¸å¤šï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äº<code>resp.html</code>è¿™ä¸ªå±æ€§,å®ƒæ˜¯æ•´ä¸ª<code>requests_htmlåº“</code>ä¸­æœ€æ ¸å¿ƒçš„ä¸€ä¸ªç±»ï¼Œè´Ÿè´£å¯¹HTMLè¿›è¡Œè§£æã€‚æ¯”å¦‚åˆ†é¡µã€æ¸²æŸ“ç­‰åŠŸèƒ½éƒ½æ˜¯ç”±è¯¥å¯¹è±¡æä¾›çš„ã€‚</p>
<p>ç›¸æ¯”requestsçš„æ–°åŠŸèƒ½æœ‰ï¼š</p>
<ul>
<li>æ”¯æŒJavaScript</li>
<li>æ”¯æŒé¡µé¢è§£æï¼šCSSé€‰æ‹©å™¨ï¼ˆåˆåjQueryé£æ ¼, æ„Ÿè°¢PyQueryï¼‰ã€æ”¯æŒXpathé€‰æ‹©å™¨</li>
<li>å¯è‡ªå®šä¹‰æ¨¡æ‹ŸUser-Agentï¼ˆæ¨¡æ‹Ÿå¾—æ›´åƒçœŸæ­£çš„webæµè§ˆå™¨ï¼‰</li>
<li>è‡ªåŠ¨è¿½è¸ªé‡å®šå‘</li>
<li>è¿æ¥æ± ä¸cookieæŒä¹…åŒ–</li>
<li>æ”¯æŒå¼‚æ­¥è¯·æ±‚</li>
<li>æ™ºèƒ½å¤šé¡µ</li>
</ul>
<p><strong>è·å–é“¾æ¥</strong></p>
<p>linkså’Œabsolute_linksä¸¤ä¸ªå±æ€§åˆ†åˆ«è¿”å›HTMLå¯¹è±¡(URL)æ‰€åŒ…å«çš„æ‰€æœ‰é“¾æ¥å’Œç»å¯¹é“¾æ¥ï¼ˆå‡ä¸åŒ…å«é”šç‚¹ï¼‰ï¼ˆå·²ç»è‡ªåŠ¨å»æ‰äº†htmlæ ‡ç­¾ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å“åº”é¡µé¢ä¸‹çš„æ‰€æœ‰é“¾æ¥</span></span><br><span class="line">print(r.html.links)</span><br><span class="line">print(r.html.absolute_links)</span><br></pre></td></tr></table></figure>
<p><strong>è·å–å…ƒç´ </strong></p>
<p>request-htmlæ”¯æŒCSSé€‰æ‹©å™¨(å€ŸåŠ©PyQuery)å’ŒXPATH(å€ŸåŠ©lxml)ä¸¤ç§è¯­æ³•æ¥é€‰å–HTMLå…ƒç´ ï¼Œæˆ‘ä¸€èˆ¬ç”¨xpathæ¯”è¾ƒå¤šï¼Œå› æ­¤å°±ä»‹ç»xpathäº†ï¼Œselectorçš„ç”¨æ³•æ˜¯ç±»ä¼¼çš„ã€‚</p>
<p>XPATè¯­æ³•ï¼Œéœ€è¦å¦ä¸€ä¸ªå‡½æ•°xpathçš„æ”¯æŒï¼Œå®ƒæœ‰4ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>selectorï¼Œè¦ç”¨çš„XPATHé€‰æ‹©å™¨ï¼›</li>
<li>cleanï¼Œå¸ƒå°”å€¼ï¼Œå¦‚æœä¸ºçœŸä¼šå¿½ç•¥HTMLä¸­styleå’Œscriptæ ‡ç­¾é€ æˆçš„å½±å“ï¼ˆåŸæ–‡æ˜¯sanitizeï¼Œå¤§æ¦‚è¿™ä¹ˆç†è§£ï¼‰;</li>
<li>firstï¼Œå¸ƒå°”å€¼ï¼Œå¦‚æœä¸ºçœŸä¼šè¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™ä¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ åˆ—è¡¨ï¼›</li>
<li><code>_encoding</code>ï¼Œç¼–ç æ ¼å¼ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(r.html.xpath(<span class="string">"//div[@id='menu']"</span>, first=<span class="keyword">True</span>).text)</span><br><span class="line">print(r.html.xpath(<span class="string">"//div[@id='menu']/a"</span>))</span><br><span class="line"><span class="comment"># å¦‚æœXPATHä¸­åŒ…å«text()æˆ–@hrefè¿™æ ·çš„å­å±æ€§ï¼Œé‚£ä¹ˆç»“æœç›¸åº”çš„ä¼šå˜æˆç®€å•çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œä¸æ˜¯HTMLå…ƒç´ ã€‚</span></span><br><span class="line">print(r.html.xpath(<span class="string">"//div[@class='content']/span/text()"</span>))</span><br></pre></td></tr></table></figure>
<p><strong>å…ƒç´ å†…å®¹</strong></p>
<p>è¦æœç´¢å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼Œç”¨searchå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(e.search(<span class="string">'è¿˜æ˜¯&#123;&#125;æ²¡å¤´è„‘'</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># è¾“å‡ºä¸ºï¼š é‚£ä¸ª</span></span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªé“¾æ¥å±æ€§</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(e.links) <span class="comment"># ç›¸å¯¹è·¯å¾„ </span></span><br><span class="line">print(e.absolute_links) <span class="comment"># ç»å¯¹è·¯å¾„</span></span><br></pre></td></tr></table></figure>
<p><strong>JavaScriptæ”¯æŒ</strong></p>
<p>æœ‰äº›ç½‘ç«™æ˜¯ä½¿ç”¨JavaScriptæ¸²æŸ“çš„ï¼Œç›´æ¥çˆ¬å–é¡µé¢ç»“æ„æˆ–è€…æ˜¯æ¥å£è·å¾—æ•°æ®å¯èƒ½ä¸æ˜¯æƒ³è¦çš„æ•°æ®ï¼Œè¿™æ ·çš„ç½‘ç«™requests-htmlä¹Ÿå¯ä»¥å¤„ç†JSæ¸²æŸ“ã€‚å…³é”®ä¸€æ­¥å°±æ˜¯åœ¨HTMLç»“æœä¸Šè°ƒç”¨ä¸€ä¸‹renderå‡½æ•°ï¼Œå®ƒä¼šåœ¨ç”¨æˆ·ç›®å½•ï¼ˆé»˜è®¤æ˜¯~/.pyppeteer/ï¼‰ä¸­ä¸‹è½½ä¸€ä¸ªchromiumï¼Œç„¶åç”¨å®ƒæ¥æ‰§è¡ŒJSä»£ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">h = session.get(<span class="string">'http://python-requests.org/'</span>) </span><br><span class="line">h.html.render()</span><br><span class="line">r.html.search(<span class="string">'Python 2 will retire in only &#123;months&#125; months!'</span>)[<span class="string">'months'</span>] <span class="string">'&lt;time&gt;25&lt;/time&gt;'</span></span><br></pre></td></tr></table></figure>
<p>renderå‡½æ•°è¿˜æœ‰ä¸€äº›å‚æ•°ï¼š</p>
<ul>
<li>retries: åŠ è½½é¡µé¢å¤±è´¥çš„æ¬¡æ•°</li>
<li>script: é¡µé¢ä¸Šéœ€è¦æ‰§è¡Œçš„JSè„šæœ¬ï¼ˆå¯é€‰ï¼‰</li>
<li>wait: åŠ è½½é¡µé¢å‰çš„ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé˜²æ­¢è¶…æ—¶ï¼ˆå¯é€‰ï¼‰</li>
<li>scrolldown: é¡µé¢å‘ä¸‹æ»šåŠ¨çš„æ¬¡æ•°</li>
<li>sleep: åœ¨é¡µé¢åˆæ¬¡æ¸²æŸ“ä¹‹åçš„ç­‰å¾…æ—¶é—´</li>
<li>reload: å¦‚æœä¸ºå‡ï¼Œé‚£ä¹ˆé¡µé¢ä¸ä¼šä»æµè§ˆå™¨ä¸­åŠ è½½ï¼Œè€Œæ˜¯ä»å†…å­˜ä¸­åŠ è½½</li>
<li>keep_page: å¦‚æœä¸ºçœŸï¼Œå…è®¸ä½ ç”¨r.html.pageè®¿é—®é¡µé¢</li>
</ul>
<p><strong>æ™ºèƒ½åˆ†é¡µ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rq = session.get(<span class="string">"https://reddit.com"</span>) </span><br><span class="line"><span class="keyword">for</span> html <span class="keyword">in</span> rq.html:</span><br><span class="line">	print(html)</span><br></pre></td></tr></table></figure>
<p><strong>ç›´æ¥ä½¿ç”¨HTML</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests_html </span><br><span class="line"><span class="keyword">import</span> HTML doc = <span class="string">"&lt;a href='https://httpbin.org'&gt;"</span> </span><br><span class="line">html = HTML(html=doc) </span><br><span class="line">print(html.links) &#123;<span class="string">'https://httpbin.org'</span>&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç›´æ¥æ¸²æŸ“JSä»£ç </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">script = <span class="string">""" </span></span><br><span class="line"><span class="string">	() =&gt; &#123; </span></span><br><span class="line"><span class="string">		return &#123; </span></span><br><span class="line"><span class="string">			width: document.documentElement.clientWidth, height: document.documentElement.clientHeight, deviceScaleFactor: window.devicePixelRatio, </span></span><br><span class="line"><span class="string">				&#125; </span></span><br><span class="line"><span class="string">			&#125; </span></span><br><span class="line"><span class="string">		"""</span> </span><br><span class="line">val= html.render(script=script,reload=<span class="keyword">False</span>) </span><br><span class="line">print(val) print(html.html)</span><br></pre></td></tr></table></figure>
<h3 id="rhtmlpageä¸æµè§ˆå™¨äº¤äº’"><a class="markdownIt-Anchor" href="#rhtmlpageä¸æµè§ˆå™¨äº¤äº’"></a> r.html.pageä¸æµè§ˆå™¨äº¤äº’</h3>
<blockquote>
<p>requests-htmlå°†å¯¹chromiumçš„é”®ç›˜å’Œé¼ æ ‡APIæ“ä½œèšåˆåœ¨äº†<code>r.html.page</code>å¯¹è±¡ä¸‹</p>
</blockquote>
<p><strong>é”®ç›˜äº‹ä»¶</strong></p>
<ul>
<li>keyboard.down(â€˜é”®ç›˜åç§°â€™):æŒ‰ä¸‹é”®ç›˜ä¸å¼¹èµ·(ä¸é”®ç›˜æœ‰ç‚¹ä¸å¤ªdown(â€˜hâ€™)åªä¼šå‡ºç°ä¸€ä¸ªhè€Œä¸æ˜¯hhhhhhhâ€¦)</li>
<li>keyboard.up(â€˜é”®ç›˜åç§°â€™):æŠ¬èµ·æŒ‰é”®</li>
<li>keyboard.press(â€˜é”®ç›˜åç§°â€™):æŒ‰ä¸‹+å¼¹èµ·</li>
<li>keyboard.type(â€˜è¾“å…¥çš„å­—ç¬¦ä¸²å†…å®¹â€™ï¼Œ{â€˜delayâ€™:100}) delayä¸ºæ¯ä¸ªå­è¾“å…¥åå»¶è¿Ÿæ—¶é—´å•ä½ä¸º<code>ms</code></li>
</ul>
<p><strong>é¼ æ ‡äº‹ä»¶</strong></p>
<p><strong>ç‚¹å‡»</strong></p>
<ul>
<li>click(â€˜cssé€‰æ‹©å™¨â€™,{ â€˜buttonâ€™ï¼šâ€˜leftâ€™, â€˜clickCountâ€™:1,â€˜delayâ€™:0})
<ul>
<li>buttonä¸ºé¼ æ ‡çš„æŒ‰é”®<code>left</code>, <code>right</code>, or <code>middle</code>,</li>
<li>clickCount:ç‚¹å‡»æ¬¡æ•°é»˜è®¤æ¬¡æ•°ä¸º1</li>
<li>delay:ç‚¹å‡»å»¶è¿Ÿæ—¶é—´,å•ä½æ˜¯æ¯«ç§’</li>
</ul>
</li>
<li>mouse.click(x, y,{ â€˜buttonâ€™ï¼šâ€˜leftâ€™, â€˜clickCountâ€™:1,â€˜delayâ€™:0})
<ul>
<li>x,y:muberæ•°æ®ç±»å‹,ä»£è¡¨ç‚¹å‡»å¯¹è±¡çš„åæ ‡</li>
</ul>
</li>
</ul>
<p><strong>ç‚¹ä¸‹å»ä¸æŠ¬èµ·</strong></p>
<ul>
<li>mouse.down({â€˜buttonâ€™:xxx,clickCount:xxx})</li>
</ul>
<p><strong>æŠ¬èµ·é¼ æ ‡</strong></p>
<ul>
<li>mouse.up({â€˜buttonâ€™:xxx,clickCount:xxx})</li>
</ul>
<p><strong>ç­‰å¾…</strong></p>
<ul>
<li>waitFor(â€˜é€‰æ‹©å™¨, æ–¹æ³• æˆ–è€… è¶…æ—¶æ—¶é—´â€™)
<ul>
<li>é€‰æ‹©å™¨: css é€‰æ‹©å™¨æˆ–è€…ä¸€ä¸ªxpath æ ¹æ®æ˜¯ä¸æ˜¯<code>//</code>å¼€å¤´</li>
<li>æ–¹æ³•:æ—¶å€™æ­¤æ–¹æ³•æ˜¯<a href="https://zhaoqize.github.io/puppeteer-api-zh_CN/#?product=Puppeteer&amp;version=v1.19.0&amp;show=api-pagewaitforfunctionpagefunction-options-args" target="_blank" rel="noopener">page.waitForFunction()</a>çš„ç®€å†™</li>
<li>è¶…æ—¶æ—¶é—´:å•ä½æ¯«ç§’</li>
</ul>
</li>
</ul>
<p><strong>ç­‰å¾…å…ƒç´ åŠ è½½</strong>: <code>waitForSelector('cssé€‰æ‹©å™¨')</code></p>
<p><strong>è·å–x,yåæ ‡</strong></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mydic =await r.html.page.evaluate(<span class="string">''</span><span class="string">'() =&gt;&#123; </span></span><br><span class="line"><span class="string">       var a = document.querySelector('</span><span class="comment">#kw')   #å¯¹è±¡çš„cssé€‰æ‹©å™¨</span></span><br><span class="line">       var b = a.getBoundingClientRect()</span><br><span class="line">       <span class="keyword">return</span> &#123;<span class="string">'x'</span><span class="symbol">:b</span>.x,<span class="string">'y'</span><span class="symbol">:b</span>.y , <span class="string">'width'</span><span class="symbol">:b</span>.width , <span class="string">'height'</span><span class="symbol">:b</span>.height &#125;</span><br><span class="line">       &#125;<span class="string">''</span><span class="string">')</span></span><br></pre></td></tr></table></figure>
<p>ğŸ“–</p>
<ul>
<li><a href="https://blog.csdn.net/weixin_52182640/article/details/119741570" target="_blank" rel="noopener">pythonè‡ªå­¦çˆ¬è™«ä¹‹requests-html</a>â€”â€”æ•´ä½“APIä»‹ç»</li>
<li><a href="https://www.cnblogs.com/guapitomjoy/p/12153557.html" target="_blank" rel="noopener">requests-htmlåº“renderæ–¹æ³•çš„ä½¿ç”¨ </a>â€”â€”ä¸æµè§ˆå™¨äº¤äº’æ“ä½œ</li>
</ul>
<h2 id="request-htmlå¼‚æ­¥"><a class="markdownIt-Anchor" href="#request-htmlå¼‚æ­¥"></a> request-htmlå¼‚æ­¥</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests_html <span class="keyword">import</span> AsyncHTMLSession</span><br><span class="line">asession = AsyncHTMLSession()</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">get_pyclock</span><span class="params">(index)</span>:</span></span><br><span class="line">    r = <span class="keyword">await</span> asession.get(<span class="string">'http://httpbin.org/get'</span>)</span><br><span class="line">    <span class="keyword">await</span> r.html.arender()</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">results = asession.run(get_pyclock, get_pyclock,</span><br><span class="line">                       get_pyclock)  <span class="comment"># è¿™é‡Œä½œè€…å°†åŒä¸€ä¸ªé¡µé¢ä½¿ç”¨å¼‚æ­¥æ–¹å¼è¿›è¡Œäº†3æ¬¡æ¸²æŸ“ï¼Œä½†æ˜¯å®é™…ä¸Šä½¿ç”¨çš„æ—¶é—´å¹¶ä¸æ˜¯å¹³æ—¶çš„3å€ï¼å¯èƒ½åªæ˜¯æ¯”å¹³æ—¶æ¸²æŸ“ä¸€ä¸ªé¡µé¢å¤šèŠ±äº†ä¸€ç‚¹æ—¶é—´è€Œå·²ï¼è¿™å°±æ˜¯å¼‚æ­¥çš„å¥½å¤„ï¼</span></span><br><span class="line">print(results)</span><br></pre></td></tr></table></figure>
<p>and:<a href="https://cloud.tencent.com/developer/article/1575104" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1575104</a></p>
<ul>
<li>ğŸ“–asession.runæ— æ³•ä¼ å‚çš„é—®é¢˜â€”â€”<a href="https://www.cnblogs.com/angelyan/p/13913926.html" target="_blank" rel="noopener">ä¿®æ”¹requests_html.AsyncHTMLSessionsä½¿å¾—æ”¯æŒurlå‚æ•°</a></li>
</ul>
<h2 id="charlesvpnæ— æ³•å…±ç”¨è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#charlesvpnæ— æ³•å…±ç”¨è§£å†³æ–¹æ¡ˆ"></a> charles+VPNæ— æ³•å…±ç”¨â€”â€”è§£å†³æ–¹æ¡ˆ</h2>
<blockquote>
<p>ç”±äºä¸¤ä¸ªéƒ½æ˜¯ä»£ç†å‹çš„è½¯ä»¶ï¼Œå› æ­¤å¾€å¾€é»˜è®¤éƒ½æŒ‡å®šäº†ä¸€ä¸ªç«¯å£ï¼Œå¯¼è‡´å¦ä¸€ä¸ªå¤±æ•ˆï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡è®¾ç½®è®©ä»–ä»¬ç«¯å£äº’çŸ¥ã€‚</p>
</blockquote>
<p>æœ€è¿‘éœ€è¦æŠ“ä¸€ä¸ªéœ€è¦ç¿»å¢™æ‰èƒ½è®¿é—®çš„ç½‘é¡µçš„åŒ…ï¼Œå‘ç°VPNç›´è¿æ—¶ä¼šå¯¼è‡´ Fiddler å’Œ Charles æŠ“åŒ…å·¥å…·æ— æ³•æ­£å¸¸è¿›è¡ŒæŠ“åŒ…ï¼Œç½‘ä¸Šæ‰¾äº†ä»¥åå‘ç°äº†ä¸€äº›è§£å†³æ–¹æ¡ˆï¼š<a href="https://github.com/mopduan/team/issues/13" target="_blank" rel="noopener">Github:VPNç›´è¿ï¼Œå¯¼è‡´ Fiddler å’Œ Charles æŠ“åŒ…å·¥å…·æ— æ³•æ­£å¸¸è¿›è¡ŒæŠ“åŒ…è§£å†³æ–¹æ¡ˆ </a>â€”â€”è¯•äº†è²Œä¼¼æ²¡ç”¨ã€<a href="https://www.jianshu.com/p/651ee335f97f?from=singlemessage" target="_blank" rel="noopener">windowsä¸‹ï¼Œå®ç°vpnè®¿é—®ä¸‹çš„charlesæŠ“åŒ…è®¾ç½®ä¸­æ— ç½‘ç»œé—®é¢˜çš„è§£å†³</a>â€”â€”æ”¶æ­¤å¯å‘æŒ‡å¯¼äº†åœ¨charlesçš„<code>Proxy-&gt;external proxy</code>å…è®¸å…¶ä»–ç«¯å£ä»£ç†</p>
<p><strong>1.æ‰¾åˆ°VPNè½¯ä»¶çš„ä»£ç†ç«¯å£proxy port</strong></p>
<p>æˆ‘è¿™è¾¹ä½¿ç”¨çš„æ˜¯vmessï¼Œå¯ä»¥åœ¨<code>é€‰é¡¹-&gt;å‚æ•°è®¾ç½®</code>ä¸­æŸ¥çœ‹ï¼Œéœ€è¦æ˜ç¡®çš„å‚æ•°æ˜¯ç«¯å£å’Œåè®®ï¼Œæˆ‘è¿™è¾¹æ˜¯10808å’Œsocksåè®®</p>
<p><img src="/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/.%5C2022%E5%B9%B45%E6%9C%88%E5%8A%B3%E5%8A%A8%E8%8A%82%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95%5Cvmess%E5%8F%82%E6%95%B0.jpg" alt="vmesså‚æ•°"></p>
<p><strong>2.è®¾ç½®charlesï¼š</strong></p>
<p><code>Proxy-&gt;external proxy</code>, é¦–å…ˆå…è®¸å…¶ä»–proxyï¼Œç„¶åæ ¹æ®åˆšåˆšæŸ¥çœ‹åˆ°çš„vmessç«¯å£å’Œåè®®è¿›è¡Œå¡«å†™</p>
<p><img src="/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/.%5C2022%E5%B9%B45%E6%9C%88%E5%8A%B3%E5%8A%A8%E8%8A%82%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95%5Ccharles.jpg" alt="charles"></p>
<p><strong>3.è®¾ç½®å®Œæˆï¼Œå¼€å§‹æŠ“åŒ…</strong></p>
<p>å®Œç»“æ’’èŠ±~</p>
<h3 id="requestsä½¿ç”¨ä»£ç†"><a class="markdownIt-Anchor" href="#requestsä½¿ç”¨ä»£ç†"></a> requestsä½¿ç”¨ä»£ç†</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'authority'</span>: <span class="string">'cn.v2ex.com'</span>,</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="string">'user-agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36'</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># æ ¸å¿ƒæ˜¯è¦é…ç½®ä¸‹é¢çš„ä»£ç†</span></span><br><span class="line">http_proxy = <span class="string">"socks5h://127.0.0.1:10808"</span></span><br><span class="line">https_proxy = <span class="string">"socks5h://127.0.0.1:10808"</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">"https"</span>: https_proxy,</span><br><span class="line">    <span class="string">"http"</span>: http_proxy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">'https://cn.v2ex.com/about'</span>, cookies=cookies, headers=headers, proxies=proxies)</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šä¸€å¼€å§‹åœ¨Sublimeé‡Œè¿è¡Œçš„ï¼Œç»“æœä¸€ç›´åœ¨<code>response.text</code>æ—¶æŠ¥ç¼–ç é”™è¯¯ï¼Œä½†æ˜¯é€šè¿‡ç½‘é¡µçš„content-typeå’Œmeta charsetè¿›è¡Œç¡®è®¤è¿‡æ²¡é—®é¢˜ï¼Œåæ¥ç»è¿‡ä¸€ä¸ªå¯å‘æƒ³åˆ°ä¼šä¸ä¼šæ˜¯æ§åˆ¶å°æœ‰ç¼–ç æ˜¾ç¤ºä¸äº†ï¼Œäºæ˜¯åœ¨Pycharmä¸­è¿è¡Œï¼ŒæˆåŠŸ!</p>
<h3 id="aiohttpä½¿ç”¨socksä»£ç†"><a class="markdownIt-Anchor" href="#aiohttpä½¿ç”¨socksä»£ç†"></a> aiohttpä½¿ç”¨socksä»£ç†</h3>
<blockquote>
<p>from: <a href="https://pypi.org/project/aiohttp-socks/%E3%80%81https://www.cnblogs.com/john-xiong/p/13812567.html" target="_blank" rel="noopener">https://pypi.org/project/aiohttp-socks/ã€https://www.cnblogs.com/john-xiong/p/13812567.html</a></p>
</blockquote>
<ol>
<li>
<p><code>pip install aiohttp_socks</code></p>
</li>
<li>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">connector = ProxyConnector.from_url(<span class="string">'socks5://127.0.0.1:10808'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">getDataByChromeDriver</span><span class="params">(url)</span>:</span></span><br><span class="line">	<span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession(connector=connector) <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(url) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> response.text()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">        loop.run_until_complete(asyncio.wait([getDataByChromeDriver(index) <span class="keyword">for</span> title, index <span class="keyword">in</span> title_list.items()]))</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>è¿è¡Œå³å¯</p>
</li>
</ol>
<h3 id="request-htmlä½¿ç”¨ä»£ç†"><a class="markdownIt-Anchor" href="#request-htmlä½¿ç”¨ä»£ç†"></a> request-htmlä½¿ç”¨ä»£ç†</h3>
<blockquote>
<p><a href="https://baijiahao.baidu.com/s?id=1701142223076604985&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">Pythonçˆ¬è™«ä¸€ä¸ªrequests_htmlæ¨¡å—è¶³çŸ£ï¼ï¼ˆæ”¯æŒJSåŠ è½½&amp;å¼‚æ­¥è¯·æ±‚ï¼‰</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests_html <span class="keyword">import</span> AsyncHTMLSession</span><br><span class="line"></span><br><span class="line">http_proxy = <span class="string">"socks5h://127.0.0.1:10808"</span></span><br><span class="line">https_proxy = <span class="string">"socks5h://127.0.0.1:10808"</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">"https"</span>: https_proxy,</span><br><span class="line">    <span class="string">"http"</span>: http_proxy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">session = AsyncHTMLSession()</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">getDataByChromeDriver</span><span class="params">(index: Union[int, str])</span>:</span></span><br><span class="line">	response = <span class="keyword">await</span> session.get(<span class="string">'https://www.qkl123.com/sector/&#123;&#125;'</span>.format(index), headers=headers, proxies=proxies)</span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://nymrli.top">Mrli</a></p><p> <span>Link:  </span><a href="https://nymrli.top/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/">https://nymrli.top/2022/05/02/2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2022/05/05/seleniumä¸è¡Œçš„å·¥ä½œ-pyppeteerä¸Š/" title="seleniumä¸è¡Œçš„å·¥ä½œ,pyppeteerä¸Š"><span>< PreviousPost</span><br><span class="prevTitle">seleniumä¸è¡Œçš„å·¥ä½œ,pyppeteerä¸Š</span></a><a class="nextSlogan" href="/2022/04/29/mitmproxyæ‹¦æˆªä»£ç†â€”â€”PCç‰ˆHttpCanary/" title="mitmproxyæ‹¦æˆªä»£ç†â€”â€”PCç‰ˆHttpCanary"><span>NextPost ></span><br><span class="nextTitle">mitmproxyæ‹¦æˆªä»£ç†â€”â€”PCç‰ˆHttpCanary</span></a><div class="clear"></div></div><div id="comment"><div id="container"></div><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>var gitment = new Gitment({
  id: '2022å¹´5æœˆåŠ³åŠ¨èŠ‚çˆ¬è™«é¡¹ç›®è®°å½•',
  owner: 'Freedomisgood',
  repo: 'Freedomisgood.github.io',
  oauth: {
    client_id: 'bc5a81fe36017dcd8b63',
    client_secret: '949cec3a1b91742c6249c47259791e4b80a6fa69',
  },
})
gitment.render('container')</script></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><p class="beian"><span>å¤‡æ¡ˆå·:è‹ICPå¤‡18015439å·</span></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 60vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#é±¼"><span class="toc-number">1.</span> <span class="toc-text"> é±¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#retryæ¨¡å—"><span class="toc-number">1.1.</span> <span class="toc-text"> retryæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é¡¹ç›®ç»“æ„"><span class="toc-number">1.2.</span> <span class="toc-text"> é¡¹ç›®ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pyinstaller"><span class="toc-number">1.3.</span> <span class="toc-text"> pyinstaller</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dataclass"><span class="toc-number">1.4.</span> <span class="toc-text"> dataclass</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dataclassesåµŒå¥—"><span class="toc-number">1.4.0.1.</span> <span class="toc-text"> dataclassesåµŒå¥—</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tomlè¯­æ³•å­¦ä¹ "><span class="toc-number">1.5.</span> <span class="toc-text"> tomlè¯­æ³•å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tomlå¯¹è±¡"><span class="toc-number">1.5.1.</span> <span class="toc-text"> tomlå¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è‡ªç”¨æŠ¢è´­å°è¯•"><span class="toc-number">1.6.</span> <span class="toc-text"> è‡ªç”¨æŠ¢è´­å°è¯•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#baseæ•°æ®åº“"><span class="toc-number">2.</span> <span class="toc-text"> baseæ•°æ®åº“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆ¤æ–­é‡å®šå‘"><span class="toc-number">2.1.</span> <span class="toc-text"> åˆ¤æ–­é‡å®šå‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å›¾ç‰‡æ‡’åŠ è½½"><span class="toc-number">2.2.</span> <span class="toc-text"> å›¾ç‰‡æ‡’åŠ è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœ¬é¡¹ç›®æ¡ˆä¾‹"><span class="toc-number">2.2.1.</span> <span class="toc-text"> æœ¬é¡¹ç›®æ¡ˆä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pathlibåº“ä½¿ç”¨"><span class="toc-number">2.3.</span> <span class="toc-text"> pathlibåº“ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æŒ‰ä½éªŒè¯ç "><span class="toc-number">2.4.</span> <span class="toc-text"> æŒ‰ä½éªŒè¯ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pyppeteer"><span class="toc-number">2.4.1.</span> <span class="toc-text"> pyppeteer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é—®é¢˜æŒ‰é’®ä¸ç”Ÿæ•ˆ"><span class="toc-number">2.4.2.</span> <span class="toc-text"> é—®é¢˜ï¼šæŒ‰é’®ä¸ç”Ÿæ•ˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#zsxq"><span class="toc-number">3.</span> <span class="toc-text"> zsxq</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æ“ä½œworddocx"><span class="toc-number">3.1.</span> <span class="toc-text"> æ“ä½œwordâ€”â€”docx</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#saveåæ“ä½œdocumentå¯¹è±¡å†saveä¼šè¦†ç›–"><span class="toc-number">3.1.1.</span> <span class="toc-text"> Saveåæ“ä½œDocumentå¯¹è±¡å†saveä¼šè¦†ç›–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£"><span class="toc-number">3.1.2.</span> <span class="toc-text"> ç¼–è¾‘å·²å­˜åœ¨çš„wordæ–‡æ¡£</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#__slots__ä½œç”¨"><span class="toc-number">3.2.</span> <span class="toc-text"> __slots__ä½œç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bytesioä½¿ç”¨"><span class="toc-number">3.3.</span> <span class="toc-text"> BytesIOä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœ¬é¡¹ç›®æ¡ˆä¾‹-2"><span class="toc-number">3.3.1.</span> <span class="toc-text"> æœ¬é¡¹ç›®æ¡ˆä¾‹ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loguru"><span class="toc-number">3.4.</span> <span class="toc-text"> loguru</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœ¬é¡¹ç›®è‡ªç”¨logurué…ç½®"><span class="toc-number">3.4.1.</span> <span class="toc-text"> æœ¬é¡¹ç›®è‡ªç”¨logurué…ç½®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#retryæ¨¡å—-2"><span class="toc-number">3.5.</span> <span class="toc-text"> retryæ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qkl"><span class="toc-number">4.</span> <span class="toc-text"> qkl</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#requests-html"><span class="toc-number">4.1.</span> <span class="toc-text"> requests-html</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rhtmlpageä¸æµè§ˆå™¨äº¤äº’"><span class="toc-number">4.1.1.</span> <span class="toc-text"> r.html.pageä¸æµè§ˆå™¨äº¤äº’</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#request-htmlå¼‚æ­¥"><span class="toc-number">4.2.</span> <span class="toc-text"> request-htmlå¼‚æ­¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#charlesvpnæ— æ³•å…±ç”¨è§£å†³æ–¹æ¡ˆ"><span class="toc-number">4.3.</span> <span class="toc-text"> charles+VPNæ— æ³•å…±ç”¨â€”â€”è§£å†³æ–¹æ¡ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#requestsä½¿ç”¨ä»£ç†"><span class="toc-number">4.3.1.</span> <span class="toc-text"> requestsä½¿ç”¨ä»£ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aiohttpä½¿ç”¨socksä»£ç†"><span class="toc-number">4.3.2.</span> <span class="toc-text"> aiohttpä½¿ç”¨socksä»£ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#request-htmlä½¿ç”¨ä»£ç†"><span class="toc-number">4.3.3.</span> <span class="toc-text"> request-htmlä½¿ç”¨ä»£ç†</span></a></li></ol></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>