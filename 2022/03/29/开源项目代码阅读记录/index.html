<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="Mrli"><meta name="renderer" content="webkit"><meta name="copyright" content="Mrli"><meta name="keywords" content="Mrli's Blog"><meta name="description" content="æƒ³å’Œä½ è®²ï¼Œè¯´äº†ä¼šå¿ƒåŠ¨ ï¼Œç¼„é»˜ä¼šå¿ƒå®‰ã€‚"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½• Â· Mr.li's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="https://avatars1.githubusercontent.com/u/31088082?s=400&amp;u=7a99ff83916afb3f4c5312bd78a1be17fe0e34ed&amp;v=4"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">Mrli</div><div class="profile-signature">åˆ«è£…ä½œå¾ˆåŠªåŠ›,<br>å› ä¸ºç»“å±€ä¸ä¼šé™ªä½ æ¼”æˆã€‚</div><div class="contacts"><div>Contacts:</div><span><a href="http://sighttp.qq.com/msgrd?v=1&amp;uin=1063052964" target="_black">QQ</a></span><span><a href="https://www.cnblogs.com/nymrli/" target="_black">åšå®¢å›­</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 60vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Mr.li's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-edit"></i><span>2022/05/29</span></span><span class="busuanzi-pv" id="busuanzi_container_page_pv"><i class="post-intro-calendar fa fa-user-o"></i><span id="busuanzi_value_page_pv"></span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="ä»£ç é˜…è¯»"> ä»£ç é˜…è¯»</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">15,047</span> | Reading time: <span class="post-count">68</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="çˆ¬è™«ç³»åˆ—"><a class="markdownIt-Anchor" href="#çˆ¬è™«ç³»åˆ—"></a> çˆ¬è™«ç³»åˆ—</h1>
<h2 id="æŠ¢è´­-ç§’æ€"><a class="markdownIt-Anchor" href="#æŠ¢è´­-ç§’æ€"></a> æŠ¢è´­ã€ç§’æ€</h2>
<h3 id="taobao_seckill"><a class="markdownIt-Anchor" href="#taobao_seckill"></a> <strong><a href="https://github.com/jerry3747/taobao_seckill" target="_blank" rel="noopener"> taobao_seckill</a></strong></h3>
<blockquote>
<p>æ·˜å®ç§’æ€ç‰©å“ï¼šåˆ†ä¸ºseleniumç‰ˆå’Œrequestç½‘ç»œè¯·æ±‚ç‰ˆï¼Œå¾®å°çš„åŒºåˆ«åœ¨äºï¼Œapiå…ˆè¯·æ±‚çš„æ˜¯è´­ç‰©è½¦çš„ç‰©å“ä¿¡æ¯ï¼Œseleniumåˆ™æ˜¯å‹¾é€‰é€‰æ‹©æ¡†ã€‚</p>
<p>æµç¨‹å¤§è‡´éƒ½ç›¸åŒï¼šâ‘ keep_waitç­‰å¾…ä¸´è¿‘æŠ¢è´­æ—¶é—´-----&gt;â‘¡å°†éœ€è¦çš„ä¿¡æ¯ç¼“å­˜ä½ï¼Œä¸å†åˆ·æ–°ï¼ˆæ¯”å¦‚è¦æŠ¢è´­çš„ç‰©å“ä¿¡æ¯ã€cookiesâ€¦ï¼‰-----&gt;â‘¢è¿›è¡Œç»“ç®—(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘£æäº¤è®¢å•(/ç‚¹å‡»æŒ‰é’®)-----&gt;â‘¤æ”¯ä»˜è®¢å•(/ç‚¹å‡»æŒ‰é’®)ï¼›</p>
</blockquote>
<ul>
<li>
<p><a href="https://www.cnblogs.com/amiza/p/10175543.html" target="_blank" rel="noopener">ä½¿ç”¨browsercookieæ¥ç®¡ç†æµè§ˆå™¨cookies</a>â€”â€”ä»æµè§ˆå™¨æå–ä¿å­˜çš„cookiesçš„å·¥å…·ã€‚å®ƒæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„çˆ¬è™«å·¥å…·ï¼Œé€šè¿‡åŠ è½½ä½ æµè§ˆå™¨çš„cookiesåˆ°ä¸€ä¸ªcookiejarå¯¹è±¡é‡Œé¢ï¼Œè®©ä½ è½»æ¾ä¸‹è½½éœ€è¦ç™»å½•çš„ç½‘é¡µå†…å®¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cj = browsercookie.chrome()	<span class="comment"># browsercookie.load() åœ¨ä¸çŸ¥é“æˆ–è€…ä¸å…³å¿ƒæµè§ˆå™¨æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(url, cookies=cj)</span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½œä¸ºå¼€å‘è€…çš„æˆ‘ä»¬éƒ½æ˜¯å°†cookiesæ‰‹åŠ¨å†™å…¥æˆ–è€…æ˜¯ä¼ å…¥ç¨‹åºçš„ï¼Œè€Œbrowsercookieç”¨é€”ï¼Œæˆ‘æƒ³å¯ä»¥æ˜¯å°†éœ€è¦ä¼ å…¥cookiesçš„ç¨‹åºæ‰“åŒ…ç»™ä¸ä¼šæå–Cookiesçš„ç”¨æˆ·ä½¿ç”¨ã€‚ï¼ˆç±»ä¼¼é€šè¿‡seleniumç™»é™†åï¼Œæ‹¿å–cookieså†å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¿™è¾¹æ˜¯è®©/å€ŸåŠ©ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨æ¥æ‹¿å–cookiesï¼‰</p>
</li>
<li>
<p>ä½¿ç”¨tkinteræ­å»ºç®€å•çš„GUIï¼šç‚¹å‡»â€œå¼€å§‹â€çš„æŒ‰é’®åä¼šå°†å¯†ç æ¡†å’ŒæŠ¢è´­è®¾ç½®æ—¶é—´æ¡†çš„å†…å®¹ä¼ å…¥ï¼Œä½œä¸ºå®ä¾‹åŒ–ChromeDriverSpiderçš„å‚æ•°ï¼Œå¹¶è¿è¡Œå®ä¾‹çš„sec_killæ–¹æ³•å¼€å§‹æ‰§è¡ŒæŠ¢è´­</p>
</li>
<li>
<p>é…ç½®chromeDriverå¯åŠ¨é…ç½®é¡¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_chrome_options</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""é…ç½®å¯åŠ¨é¡¹"""</span></span><br><span class="line">    chrome_options = webdriver.ChromeOptions()</span><br><span class="line">    chrome_options.accept_untrusted_certs = <span class="keyword">True</span></span><br><span class="line">    chrome_options.assume_untrusted_cert_issuer = <span class="keyword">True</span></span><br><span class="line">    arguments = [<span class="string">'--no-sandbox'</span>, <span class="string">'--disable-impl-side-painting'</span>, <span class="string">'--disable-setuid-sandbox'</span>, <span class="string">'--disable-seccomp-filter-sandbox'</span>,</span><br><span class="line">    <span class="string">'--disable-breakpad'</span>, <span class="string">'--disable-client-side-phishing-detection'</span>, <span class="string">'--disable-cast'</span>,</span><br><span class="line">    <span class="string">'--disable-cast-streaming-hw-encoding'</span>, <span class="string">'--disable-cloud-import'</span>, <span class="string">'--disable-popup-blocking'</span>,</span><br><span class="line">    <span class="string">'--ignore-certificate-errors'</span>, <span class="string">'--disable-session-crashed-bubble'</span>, <span class="string">'--disable-ipv6'</span>,</span><br><span class="line">    <span class="string">'--allow-http-screen-capture'</span>, <span class="string">'--start-maximized'</span>]</span><br><span class="line">    <span class="keyword">for</span> arg <span class="keyword">in</span> arguments:</span><br><span class="line">    chrome_options.add_argument(arg)</span><br><span class="line">    chrome_options.add_argument(<span class="string">f'--user-agent=<span class="subst">&#123;choice(get_useragent_data())&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> chrome_options</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="taobao_api"><a class="markdownIt-Anchor" href="#taobao_api"></a> <strong><a href="https://github.com/gaoxt/taobao_api" target="_blank" rel="noopener">taobao_api</a></strong></h3>
<blockquote>
<p>seleniumå’Œapiç»“åˆï¼šç™»é™†é€»è¾‘ä½¿ç”¨äº†seleniumï¼Œåˆ·æ–°è´­ç‰©è½¦å’Œä¸‹å•è°ƒç”¨äº†æ‰‹æœºæ·˜å®taobao_apiï¼Œè‡ªåŠ¨ä»˜æ¬¾ä¹Ÿä½¿ç”¨äº†seleniumï¼Œèƒ½è‡ªåŠ¨æ¨¡æ‹Ÿè§¦æ‘¸è¾“å…¥å¯†ç ä»˜æ¬¾ï¼Œæ¥å£ç­¾åsignç”Ÿæˆæ–¹æ³•å‚è€ƒget_sign_valã€‚</p>
</blockquote>
<ul>
<li>
<p>åŒæ­¥é˜¿é‡Œäº‘æ—¶é—´æœåŠ¡å™¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸€æ¬¡æ€§è®¾ç½®</span></span><br><span class="line">sudo sntp -sS ntp.aliyun.com</span><br><span class="line"><span class="comment">#æ°¸ä¹…è®¾ç½®</span></span><br><span class="line">sudo systemsetup -setnetworktimeserver ntp.aliyun.com</span><br><span class="line">sudo systemsetup -setusingnetworktime on</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å±•ç¤ºQRCode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment"># æ‰¾åˆ°äºŒç»´ç å›¾ç‰‡çš„é“¾æ¥</span></span><br><span class="line">   img = WebDriverWait(browser, <span class="number">2</span>, <span class="number">0.1</span>).until(</span><br><span class="line">       EC.presence_of_element_located((By.XPATH, <span class="string">"//div[@id='J_QRCodeImg']/img"</span>))).get_attribute(<span class="string">'src'</span>)</span><br><span class="line">   <span class="comment"># è·å¾—å›¾ç‰‡å­—èŠ‚æµå†…å®¹</span></span><br><span class="line">   img_content = requests.get(img, timeout=<span class="number">5</span>).content</span><br><span class="line">   <span class="comment"># ä¿å­˜åˆ°æœ¬åœ°å›¾ç‰‡ä¸­</span></span><br><span class="line">   file_name = <span class="string">'taobao_qrcode.png'</span></span><br><span class="line">   fp = open(file_name, <span class="string">'wb'</span>)</span><br><span class="line">   fp.write(img_content)</span><br><span class="line">   fp.close()</span><br><span class="line"><span class="comment"># å°†å…¶è§£ç æˆé“¾æ¥ï¼Œ pyzbarä¸ºäºŒç»´ç å’Œæ¡å½¢ç åº“ ==&gt; ä¸ªäººè§‰å¾—ä¿å­˜åå¯ä»¥ç›´æ¥è½¬æˆPILçš„Imageç„¶åimg.show()</span></span><br><span class="line">   <span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">   barcode_url = <span class="string">''</span></span><br><span class="line">   barcodes = decode(Image.open(file_name))</span><br><span class="line">   <span class="keyword">for</span> barcode <span class="keyword">in</span> barcodes:</span><br><span class="line">       <span class="comment"># è§£æè·å¾—äºŒç»´ç åçš„å†…å®¹ï¼›å¦‚æœæ˜¯æ¡å½¢ç ï¼Œåˆ™è¿”å›æ¡å½¢ç æ•°</span></span><br><span class="line">       barcode_url = barcode.data.decode(<span class="string">"utf-8"</span>)</span><br><span class="line"><span class="comment"># ç”ŸæˆäºŒç»´ç å¹¶é€šè¿‡æ§åˆ¶å°æ‰“å°</span></span><br><span class="line">   qr = qrcode.QRCode()</span><br><span class="line">   qr.add_data(barcode_url)</span><br><span class="line">   qr.print_ascii(invert=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼š<a href="http://zbar.sourceforge.net/" target="_blank" rel="noopener">ZBar</a>æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å¥—ä»¶ï¼Œç”¨äºä»å„ç§æ¥æºï¼ˆå¦‚è§†é¢‘æµã€å›¾åƒæ–‡ä»¶å’ŒåŸå§‹å¼ºåº¦ä¼ æ„Ÿå™¨ï¼‰è¯»å–æ¡å½¢ç ï¼›<code>pyzbar</code> æ˜¯é€šè¿‡ <code>Python2</code>å’Œ<code>3</code>æ¥å£ï¼Œä½¿ç”¨ <code>ZBar</code> åº“è¯»å–ä¸€ç»´æ¡å½¢ç å’ŒQRç  ã€‚=&gt;<a href="https://blog.csdn.net/qq_37924224/article/details/109582507" target="_blank" rel="noopener">è¯»å–æ¡å½¢ç </a>ã€<a href="https://blog.csdn.net/hxj0323/article/details/112969622" target="_blank" rel="noopener">è¯»å–äºŒç»´ç </a></p>
</li>
</ul>
<h3 id="jd_seckill"><a class="markdownIt-Anchor" href="#jd_seckill"></a> <strong><a href="https://github.com/andyzys/jd_seckill" target="_blank" rel="noopener">jd_seckill</a></strong></h3>
<blockquote>
<ol>
<li>é¢„çº¦å•†å“</li>
<li>ç§’æ€æŠ¢è´­å•†å“: â‘ <strong>è®¿é—®</strong>å•†å“çš„æŠ¢è´­<strong>é“¾æ¥</strong>ï¼ˆç”¨äºè®¾ç½®cookieç­‰â€”&gt;â‘¡è®¿é—®æŠ¢è´­è®¢å•<strong>ç»“ç®—é¡µé¢</strong>----&gt;â‘¢<strong>æäº¤æŠ¢</strong>è´­ï¼ˆç§’æ€ï¼‰<strong>è®¢å•</strong> [_get_seckill_order_dataç”Ÿæˆæäº¤æŠ¢è´­è®¢å•æ‰€éœ€çš„è¯·æ±‚ä½“å‚æ•°ã€è·å–ç§’æ€åˆå§‹åŒ–ä¿¡æ¯ï¼ˆåŒ…æ‹¬ï¼šåœ°å€ï¼Œå‘ç¥¨ï¼Œtokenï¼‰]</li>
</ol>
</blockquote>
<ul>
<li>
<p>ä»UAListä¸­é€šè¿‡<code>random.choice(USER_AGENTS)</code>éšæœºUA</p>
</li>
<li>
<p>ä½¿ç”¨å†…ç½®configparseræ¨¡å—è§£æconfig.ini</p>
<ul>
<li>RawConfigParseræ˜¯æœ€åŸºç¡€çš„INIæ–‡ä»¶è¯»å–ç±»ï¼›ConfigParserã€SafeConfigParser<a href="https://blog.csdn.net/miner_k/article/details/77857292" target="_blank" rel="noopener">æ”¯æŒå¯¹%(value)så˜é‡çš„è§£æ</a>ï¼ŒSafeConfigParserç±»å®ç°äº†ConfigParserç›¸åŒçš„æ¥å£ï¼Œæ–°å¢å¦‚ä¸‹æ–¹æ³•ï¼šsetå­˜åœ¨ä¿å­˜çš„æ–¹æ³•</li>
<li>sectionä¸‹çš„option(key)å¯ä»¥ä¸å¡«valueå€¼ï¼Œå³ä¸ºç©ºã€‚</li>
<li>from: <a href="https://blog.csdn.net/tianzhu123/article/details/6893755" target="_blank" rel="noopener">pythonä¸­RawConfigParserç±»ã€ConfigParserç±»ã€SafeConfigParserç±»ä¸­å‡½æ•°ä»‹ç»</a>ã€</li>
</ul>
</li>
<li>
<p>å¤šè¿›ç¨‹æ± ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ProcessPoolExecutor(work_count) <span class="keyword">as</span> pool:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(work_count):</span><br><span class="line">        pool.submit(self.seckill)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç§’æ€æ—¶é—´æ¯”è¾ƒ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buy_time = datetime.strptime(global_config.getRaw(<span class="string">'config'</span>,<span class="string">'buy_time'</span>), <span class="string">"%Y-%m-%d %H:%M:%S.%f"</span></span><br><span class="line">now_time = datetime.now</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> now_time() &gt;= buy_time:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><a href="https://github.com/woxiqingxian/jd_seckill/pull/2/commits/63a41a0609912d5643bc11f3419fe7dd8e84a00a" target="_blank" rel="noopener">è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´</a>ï¼š<code>https://api.m.jd.com/client.action?functionId=queryMaterialProducts&amp;client=wh5</code></p>
</li>
</ul>
<h3 id="jd-assistant"><a class="markdownIt-Anchor" href="#jd-assistant"></a> <strong><a href="https://github.com/tychxn/jd-assistant" target="_blank" rel="noopener">jd-assistantâ˜…</a></strong></h3>
<blockquote>
<p>æ˜¯<a href="#jd_seckill">jd_seckill</a>çš„ä¼˜åŒ–è¿›é˜¶ç‰ˆæœ¬</p>
<ul>
<li>
<p>æ™®é€šå•†å“è´­ä¹°ä¸»è¦æµç¨‹ï¼š<code>(1)æ¸…ç©ºè´­ç‰©è½¦</code> --&gt; <code>(2)æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</code> --&gt; <code>(3)æäº¤è®¢å•</code></p>
</li>
<li>
<p>é¢„çº¦æŠ¢è´­å•†å“ç‰¹ç‚¹ï¼š</p>
<ol>
<li>éœ€è¦æå‰ç‚¹å‡»é¢„çº¦</li>
<li>å¤§éƒ¨åˆ†æ­¤ç±»å•†å“åœ¨é¢„çº¦åè‡ªåŠ¨åŠ å…¥è´­ç‰©è½¦ï¼Œä½†æ˜¯æ— æ³•å‹¾é€‰âœ“ï¼Œä¹Ÿæ— æ³•ï¸è¿›å…¥åˆ°ç»“ç®—é¡µé¢</li>
<li>åˆ°äº†æŠ¢è´­çš„æ—¶é—´ç‚¹åå°†å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œæ­¤æ—¶æ‰èƒ½å‹¾é€‰å¹¶ä¸‹å•</li>
</ol>
</li>
<li>
<p>æ™®é€šå•†å“ï¼šèƒ½åŠ å…¥è´­ç‰©è½¦ğŸ›’ï¼Œç„¶åè¿›å…¥è´­ç‰©è½¦ç»“ç®—ä¸‹å•.</p>
</li>
<li>
<p>æŠ¢è´­å•†å“ï¼šéœ€ææå‰é¢„çº¦ï¼Œå¼€å§‹æŠ¢è´­æ—¶æœ‰â€œç«‹å³æŠ¢è´­â€æŒ‰é’®ğŸ”˜ï¼Œç‚¹å‡»æŒ‰é’®åå•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œç„¶åç»“ç®—ä¸‹å•.</p>
</li>
</ul>
<p>â­ï¸æŠ¢è´­å—å¤šç§å› ç´ å½±å“ï¼š<strong>ç½‘é€Ÿã€è´¦å·è´¨é‡ã€è¿æ°”</strong>ç­‰ç­‰ï¼Œä»…ä¾›å¨±ä¹ï¼Œè®¤çœŸå°±è¾“äº†.</p>
</blockquote>
<ul>
<li>
<p>deprecatedã€check_loginè£…é¥°å™¨ï¼šä¼ å…¥äº†selfå‚æ•°ï¼Œå¹¶é€šè¿‡selfå®ä¾‹è°ƒç”¨äº†ç±»çš„å…¶ä»–æˆå‘˜æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_login</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="string">"""ç”¨æˆ·ç™»é™†æ€æ ¡éªŒè£…é¥°å™¨ã€‚è‹¥ç”¨æˆ·æœªç™»é™†ï¼Œåˆ™è°ƒç”¨æ‰«ç ç™»é™†"""</span></span><br><span class="line"><span class="meta">    @functools.wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_func</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.is_login:</span><br><span class="line">            logger.info(<span class="string">"&#123;0&#125; éœ€ç™»é™†åè°ƒç”¨ï¼Œå¼€å§‹æ‰«ç ç™»é™†"</span>.format(func.__name__))</span><br><span class="line">            self.login_by_QRcode()</span><br><span class="line">        <span class="keyword">return</span> func(self, *args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> new_func</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å¯†ç åŠ å¯†â€”â€”<strong><a href="https://github.com/Legrandin/pycryptodome" target="_blank" rel="noopener">pycryptodome</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_pwd</span><span class="params">(password, public_key=RSA_PUBLIC_KEY)</span>:</span></span><br><span class="line">    rsa_key = RSA.importKey(public_key)</span><br><span class="line">    encryptor = Cipher_pkcs1_v1_5.new(rsa_key)</span><br><span class="line">    cipher = b64encode(encryptor.encrypt(password.encode(<span class="string">'utf-8'</span>)))</span><br><span class="line">    <span class="keyword">return</span> cipher.decode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æä¾›JSè„šæœ¬æ–‡ä»¶æ¥è·å–å•†å“çš„ä¿¡æ¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥ä¸‹ä»£ç åœ¨è®¢å•ç»“ç®—é¡µé¢çš„å¼€å‘è€…å·¥å…·Consoleä¸­æ‰§è¡Œï¼Œç”¨äºè·å–å¿…è¦çš„å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> eid = $(<span class="string">'#eid'</span>).val();</span><br><span class="line"><span class="keyword">var</span> fp = $(<span class="string">'#fp'</span>).val();</span><br><span class="line"><span class="keyword">var</span> trackId = getTakId();</span><br><span class="line"><span class="keyword">var</span> riskControl = $(<span class="string">'#riskControl'</span>).val();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`eid = <span class="subst">$&#123;eid&#125;</span>\nfp = <span class="subst">$&#123;fp&#125;</span>\ntrack_id = <span class="subst">$&#123;trackId&#125;</span>\nrisk_control = <span class="subst">$&#123;riskControl&#125;</span>`</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>cookieséªŒè¯-é€šè¿‡è¯»å–æœ¬åœ°ä¿å­˜çš„cookiesæ—¶è¦å…ˆéªŒè¯ä¸‹cookiesæ˜¯å¦æœ‰æ•ˆï¼šrequestsåº“çš„ä½¿ç”¨æ–¹å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_validate_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""éªŒè¯cookiesæ˜¯å¦æœ‰æ•ˆï¼ˆæ˜¯å¦ç™»é™†ï¼‰</span></span><br><span class="line"><span class="string">    é€šè¿‡è®¿é—®ç”¨æˆ·è®¢å•åˆ—è¡¨é¡µè¿›è¡Œåˆ¤æ–­ï¼šè‹¥æœªç™»å½•ï¼Œå°†ä¼šé‡å®šå‘åˆ°ç™»é™†é¡µé¢ã€‚</span></span><br><span class="line"><span class="string">    :return: cookiesæ˜¯å¦æœ‰æ•ˆ True/False</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    url = <span class="string">'https://order.jd.com/center/list.action'</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">'rid'</span>: str(int(time.time() * <span class="number">1000</span>)),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = self.sess.get(url=url, params=payload, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == requests.codes.OK:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(e)</span><br><span class="line">    <span class="comment"># åˆ›å»ºæ–°çš„session</span></span><br><span class="line">    self.sess = requests.session()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>äºŒç»´ç ç™»å½•ï¼šä¸‹è½½äºŒç»´ç <code>_get_QRcode</code>â€“&gt;è¯¢é—®è·å–äºŒç»´ç æ‰«æçŠ¶æ€<code>_get_QRcode_ticket</code>â€”&gt;éªŒè¯äºŒç»´ç ä¿¡æ¯(<code>_validate_QRcode_ticket</code>)â€“&gt;è®¾ç½®<code>is_login=Trueå’Œsave_cookies</code>ï¼ˆäºŒç»´ç æœ‰æ•ˆæœŸçº¦120sï¼Œæµè§ˆå™¨å¤§çº¦2så‘é€ä¸€ä¸ªè¯·æ±‚è¯¢é—®æ‰«æçŠ¶æ€ï¼‰â€”â€”çœ‹ä»£ç æ˜¯assistantå‚è€ƒäº†2018å¹´çš„**<a href="https://github.com/adyzng/jd-autobuy" target="_blank" rel="noopener">jd-autobuy</a>**</p>
</li>
<li>
<p>æ‰«æäºŒç»´ç ï¼šå†™å…¥å›¾ç‰‡å’Œæ‰“å¼€å›¾ç‰‡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_image</span><span class="params">(resp, image_file)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(image_file, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># ä»ç½‘ç»œè¯·æ±‚ä¸­ä¸‹è½½å†…å®¹</span></span><br><span class="line">        <span class="keyword">for</span> chunk <span class="keyword">in</span> resp.iter_content(chunk_size=<span class="number">1024</span>):</span><br><span class="line">            f.write(chunk)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_image</span><span class="params">(image_file)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> os.name == <span class="string">"nt"</span>:</span><br><span class="line">        os.system(<span class="string">'start '</span> + image_file)  <span class="comment"># for Windows</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> os.uname()[<span class="number">0</span>] == <span class="string">"Linux"</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"deepin"</span> <span class="keyword">in</span> os.uname()[<span class="number">2</span>]:</span><br><span class="line">                os.system(<span class="string">"deepin-image-viewer "</span> + image_file)  <span class="comment"># for deepin</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                os.system(<span class="string">"eog "</span> + image_file)  <span class="comment"># for Linux</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            os.system(<span class="string">"open "</span> + image_file)  <span class="comment"># for Mac</span></span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šåˆ¤æ–­æ“ä½œç³»ç»Ÿè¿˜å¯ä»¥å€ŸåŠ©å†…ç½®çš„platformåº“<code>platform.system().lower()</code>å¾—åˆ°[linuxã€windowsã€mac]</p>
</li>
</ul>
<p>â–²cookieså’ŒäºŒç»´ç ç»“åˆä½¿ç”¨ï¼š</p>
<ol>
<li>å¦‚æœç™»é™†æˆåŠŸåˆ™å§cookiesæŒä¹…åŒ–</li>
<li>ä½¿ç”¨äºŒç»´ç ç™»é™†å‰ï¼Œå…ˆåŠ è½½éªŒè¯ä¹‹å‰æŒä¹…åŒ–çš„cookiesæ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæœ‰æ•ˆåˆ™æ— éœ€å†æ¬¡æ‰«ç ç™»é™†(åœ¨QRCode_loginçš„èµ·å§‹ä½ç½®åˆ¤æ–­validationä¸­ä¿®æ”¹çš„is_loginæ˜¯å¦ä¸ºTrue)</li>
</ol>
<h3 id="jd-seckill-maotai"><a class="markdownIt-Anchor" href="#jd-seckill-maotai"></a> <strong><a href="https://github.com/hello8817/jd-seckill-maotai" target="_blank" rel="noopener"> jd-seckill-maotai</a></strong></h3>
<blockquote>
<ul>
<li>
<h2 id="ä¸»è¦åŠŸèƒ½"><a class="markdownIt-Anchor" href="#ä¸»è¦åŠŸèƒ½"></a> ä¸»è¦åŠŸèƒ½</h2>
<ul>
<li>ç™»é™†äº¬ä¸œå•†åŸï¼ˆ<a href="http://www.jd.com" target="_blank" rel="noopener">www.jd.com</a>ï¼‰
<ul>
<li>ç”¨äº¬ä¸œAPPæ‰«ç ç»™å‡ºçš„äºŒç»´ç </li>
</ul>
</li>
<li>é¢„çº¦èŒ…å°
<ul>
<li>å®šæ—¶è‡ªåŠ¨é¢„çº¦</li>
</ul>
</li>
<li>ç§’æ€é¢„çº¦åç­‰å¾…æŠ¢è´­
<ul>
<li>å®šæ—¶å¼€å§‹è‡ªåŠ¨æŠ¢è´­</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>ç‰¹åˆ«å£°æ˜ï¼š</strong></p>
<ul>
<li>æœ¬ä»“åº“å‘å¸ƒçš„<code>jd_seckill_maotai</code>é¡¹ç›®ä¸­æ¶‰åŠçš„ä»»ä½•è„šæœ¬ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ï¼Œå‡†ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚</li>
<li>æœ¬é¡¹ç›®å†…æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç¦æ­¢ä»»ä½•å…¬ä¼—å·ã€è‡ªåª’ä½“è¿›è¡Œä»»ä½•å½¢å¼çš„è½¬è½½ã€å‘å¸ƒã€‚</li>
<li><code>ChinaVolvocars</code> å¯¹ä»»ä½•è„šæœ¬é—®é¢˜æ¦‚ä¸è´Ÿè´£ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç”±ä»»ä½•è„šæœ¬é”™è¯¯å¯¼è‡´çš„ä»»ä½•æŸå¤±æˆ–æŸå®³.</li>
<li>è¯·å‹¿å°†<code>jd_seckill_maotai</code>é¡¹ç›®çš„ä»»ä½•å†…å®¹ç”¨äºå•†ä¸šæˆ–éæ³•ç›®çš„ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚</li>
<li>å¦‚æœä»»ä½•å•ä½æˆ–ä¸ªäººè®¤ä¸ºè¯¥é¡¹ç›®çš„è„šæœ¬å¯èƒ½æ¶‰å«Œä¾µçŠ¯å…¶æƒåˆ©ï¼Œåˆ™åº”åŠæ—¶é€šçŸ¥å¹¶æä¾›èº«ä»½è¯æ˜ï¼Œæ‰€æœ‰æƒè¯æ˜ï¼Œæˆ‘ä»¬å°†åœ¨æ”¶åˆ°è®¤è¯æ–‡ä»¶ååˆ é™¤ç›¸å…³è„šæœ¬ã€‚</li>
<li>æ‚¨å¿…é¡»åœ¨ä¸‹è½½åçš„24å°æ—¶å†…ä»è®¡ç®—æœºæˆ–æ‰‹æœºä¸­å®Œå…¨åˆ é™¤ä»¥ä¸Šå†…å®¹ã€‚</li>
<li>æœ¬é¡¹ç›®éµå¾ª<code>GPL-3.0 License</code>åè®®ï¼Œå¦‚æœæœ¬ç‰¹åˆ«å£°æ˜ä¸<code>GPL-3.0 License</code>åè®®æœ‰å†²çªä¹‹å¤„ï¼Œä»¥æœ¬ç‰¹åˆ«å£°æ˜ä¸ºå‡†ã€‚</li>
<li><em><strong>æ‚¨ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em><br>
<em><strong>æ‚¨åœ¨æœ¬å£°æ˜æœªå‘å‡ºä¹‹æ—¶ç‚¹ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•ä»£ç æˆ–é¡¹ç›®ä¸”æ­¤æ—¶è¿˜åœ¨ä½¿ç”¨ï¼Œåˆ™è§†ä¸º<code>å·²æ¥å—</code>æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»</strong></em></li>
</ul>
</blockquote>
<blockquote>
<p>æ ¹æ®12æœˆ14æ—¥ä»¥æ¥æŠ¢èŒ…å°çš„æ—¥å¿—åˆ†æï¼Œå¤§èƒ†æ¨æ–­å†æ¥å†å‰è¿”å›Jsonæ¶ˆæ¯ä¸­<code>resultCode</code>ä¸<strong>å°ç™½ä¿¡ç”¨</strong>çš„å…³ç³»ã€‚<br>
è¿™é‡Œä¸»è¦åˆ†æå‡ºç°é¢‘ç‡æœ€é«˜çš„<code>90016</code>å’Œ<code>90008</code>ã€‚</p>
<table>
<thead>
<tr>
<th>æ¡ˆä¾‹</th>
<th>å°ç™½ä¿¡ç”¨</th>
<th>90016</th>
<th>90008</th>
<th>æŠ¢åˆ°è€—æ—¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¼ ä¸‰</td>
<td>63.8</td>
<td>59.63%</td>
<td>40.37%</td>
<td>æš‚æœªæŠ¢åˆ°</td>
</tr>
<tr>
<td>æå››</td>
<td>92.9</td>
<td>72.05%</td>
<td>27.94%</td>
<td>4å¤©</td>
</tr>
<tr>
<td>ç‹äº”</td>
<td>99.6</td>
<td>75.70%</td>
<td>24.29%</td>
<td>æš‚æœªæŠ¢åˆ°</td>
</tr>
<tr>
<td>èµµå…­</td>
<td>103.4</td>
<td>91.02%</td>
<td>8.9%</td>
<td>2å¤©</td>
</tr>
</tbody>
</table>
<p>é£æ§æ”¾è¡Œåæ‰ä¼šè¿›è¡ŒæŠ¢è´­ï¼Œè¿™æ—¶å€™ç”¨çš„åº”è¯¥æ˜¯æ°´åº“è®¡æ•°æ¨¡å‹ï¼Œå‡è®¾æ— æ³•ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰æ•°æ®çš„æƒ…å†µä¸‹æ¥å°½é‡çš„åšåˆ°æŠ¢è´­æˆåŠŸç”¨æˆ·çš„å‡åŒ€åˆ†å¸ƒï¼Œè¿™æ ·å°±å’Œæ¦‚ç‡ç›¸å…³äº†ã€‚</p>
<p><strong>æŠ¢è´­ç»“æœç¡®è®¤</strong></p>
<p>æŠ¢è´­æ˜¯å¦æˆåŠŸé€šå¸¸åœ¨ç¨‹åºå¼€å§‹çš„ä¸€åˆ†é’Ÿå†…å¯è§åˆ†æ™“ï¼<br>
æœç´¢æ—¥å¿—ï¼Œå‡ºç°â€œæŠ¢è´­æˆåŠŸï¼Œè®¢å•å·xxxxx&quot;ï¼Œä»£è¡¨æˆåŠŸæŠ¢åˆ°äº†ï¼ŒåŠ¡å¿…åŠå°æ—¶å†…æ”¯ä»˜è®¢å•ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼<br>
è‹¥ä¸¤åˆ†é’Ÿè¿˜æœªæŠ¢è´­æˆåŠŸï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ²¡æŠ¢åˆ°ï¼ç¨‹åºæš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æ‰‹åŠ¨STOPï¼</p>
</blockquote>
<ul>
<li>
<p>åœ¨ç¨‹åºå¼€å§‹è¿è¡Œåï¼Œä¼šæ£€æµ‹æœ¬åœ°æ—¶é—´ä¸äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ï¼Œè¾“å‡ºçš„å·®å€¼ä¸ºã€æœ¬åœ°æ—¶é—´-äº¬ä¸œæœåŠ¡å™¨æ—¶é—´ã€‘ï¼Œå³-50ä¸ºæœ¬åœ°æ—¶é—´æ¯”äº¬ä¸œæœåŠ¡å™¨æ—¶é—´æ…¢50msã€‚ æœ¬ä»£ç çš„æ‰§è¡Œçš„æŠ¢è´­æ—¶é—´ä»¥æœ¬åœ°ç”µè„‘/æœåŠ¡å™¨æ—¶é—´ä¸ºå‡†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, ...)</span>:</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®</span></span><br><span class="line">	self.diff_time = self.local_time() - self.jd_time()</span><br><span class="line"><span class="comment"># ....</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="comment"># æœ¬åœ°æ—¶é—´å‡å»ä¸äº¬ä¸œçš„æ—¶é—´å·®(ms)ï¼Œèƒ½å¤Ÿå°†æ—¶é—´è¯¯å·®æå‡åˆ°0.1ç§’é™„è¿‘, å…·ä½“ç²¾åº¦ä¾èµ–è·å–äº¬ä¸œæœåŠ¡å™¨æ—¶é—´çš„ç½‘ç»œæ—¶é—´æŸè€—</span></span><br><span class="line">    <span class="keyword">if</span> self.local_time() - self.diff_time &gt;= self.buy_time_ms:</span><br><span class="line">        logger.info(<span class="string">'æ—¶é—´åˆ°è¾¾ï¼Œå¼€å§‹æ‰§è¡Œâ€¦â€¦'</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(self.sleep_interval)</span><br></pre></td></tr></table></figure>
<p>è¡¥å……ï¼šPythonçš„æ—¶é—´æˆ³é»˜è®¤éƒ½æ˜¯ç§’çº§åˆ«çš„ï¼Œå¦‚æœè¦msçº§åˆ«çš„ï¼Œåˆ™è¦ä¹˜ä»¥1000</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡timeï¼Œä»¥å…ƒç»„ï¼ˆstruct_timeï¼‰ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># è·å¾—10ä½ç§’çº§æ—¶é—´æˆ³</span></span><br><span class="line">seconds = time.time()</span><br><span class="line"><span class="comment"># è·å¾—13ä½æ¯«ç§’çº§æ—¶é—´æˆ³==&gt;javaé»˜è®¤13ä½</span></span><br><span class="line">millis = int(round(time.time() * <span class="number">1000</span>))</span><br><span class="line"><span class="comment"># åŒæ ·ï¼Œtimeä¸‹çš„mktimeä¹Ÿéœ€è¦*1000</span></span><br><span class="line">time.mktime(self.buy_time.timetuple()) * <span class="number">1000.0</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">é€šè¿‡datetimeï¼Œä»¥datetimeç±»å®ä¾‹å¯¹è±¡ä¸ºæ ¸å¿ƒå®ç°æ—¶é—´æˆ³å’Œæ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„ç›¸äº’è½¬æ¢ã€‚</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># è·å¾—å½“å‰æ—¶é—´</span></span><br><span class="line">now = datetime.now()</span><br><span class="line">timestamp = datetime.timestamp(now)</span><br><span class="line">print(<span class="string">"æ—¶é—´æˆ³ ="</span>, timestamp)</span><br><span class="line"><span class="comment"># ä¹Ÿæ˜¯10ä½sçº§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1648622589.624272</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="jd_mask"><a class="markdownIt-Anchor" href="#jd_mask"></a> <strong><a href="https://github.com/Lasx/jd_mask" target="_blank" rel="noopener">jd_mask</a></strong></h3>
<blockquote>
<p>æ­¤toolåªå•ç‹¬æ”¯æŒ<strong>é¢„çº¦-æŠ¢è´­-æˆåŠŸåç›´æ¥æäº¤è®¢å•</strong>çš„å•†å“ï¼Œå¦‚[å£ç½©]ï¼Œåªæä¾›å­¦ä¹ å‚è€ƒç”¨é€”.</p>
</blockquote>
<p>â“‚ï¸é˜…è¯»äº†å¤šä»½äº¬ä¸œæŠ¢è´­çš„ä»£ç åï¼Œå‘ç°åŸºæœ¬éƒ½æ˜¯ä»ä¸€ä¸ªæ¨¡æ¿é‡Œä¸æ–­ä¼˜åŒ–å‘å±•å‡ºæ¥çš„ï¼Œååº”äº†å¼€æºçš„æ„ä¹‰ï¼Œä¹Ÿååº”äº†äº¬ä¸œéƒ¨åˆ†ç»†èŠ‚çš„ä¿®æ”¹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¾—åˆ°ä¸€ä¸ªå‘Šç¤ºï¼šåœ¨å®ç°ç›¸åŒåŠŸèƒ½å‰ï¼Œä¸å¦¨å¤šçœ‹çœ‹ã€å€Ÿé‰´ä¸‹ä»¥å¾€å¯è¡Œçš„ä»£ç ã€‚</p>
<h3 id="automatic_ticket_purchase"><a class="markdownIt-Anchor" href="#automatic_ticket_purchase"></a> <strong><a href="https://github.com/MakiNaruto/Automatic_ticket_purchase" target="_blank" rel="noopener">Automatic_ticket_purchase</a></strong></h3>
<p>å¤§éº¦ç½‘æŠ¢è´­æµç¨‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[å¼€å§‹] --&gt; B(ç™»é™†)</span><br><span class="line">    B --&gt; C&#123;æ˜¯å¦åˆ©ç”¨cookiesç™»é™†&#125;</span><br><span class="line">    C --&gt; |å¦| D[é¡µé¢ç™»é™†]</span><br><span class="line">    C --&gt; |æ˜¯| E[ç™»é™†éªŒè¯]</span><br><span class="line">    D --&gt; E</span><br><span class="line">    E --&gt; G&#123;æ˜¯å¦ç™»é™†æˆåŠŸ&#125;</span><br><span class="line">    G --&gt; |æ˜¯| F[è·å–è´­ç¥¨å¿…è¦ä¿¡æ¯]</span><br><span class="line">    G --&gt; |å¦|ED</span><br><span class="line">    F --&gt; L[æ£€æµ‹æŠ¢ç¥¨ç°åœ¨è´­ç¥¨çŠ¶æ€]</span><br><span class="line">    L --&gt; M&#123;ç›®æ ‡ç¥¨å¯è¿›è¡ŒæŠ¢è´­&#125;</span><br><span class="line">    M --&gt; |å³å°†å¼€æŠ¢|L</span><br><span class="line">    M --&gt; |ç¼ºè´§ç™»è®°|ED((ç»“æŸ))</span><br><span class="line">	M --&gt; |ç«‹åˆ»è´­ä¹°|N&#123;æŠ¢è´­&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è·Ÿé™æ—¶ã€å®šæ—¶ç§’æ€ä¸åŒçš„æ˜¯ï¼Œå¤§éº¦ç½‘çš„æŠ¢è´­ä¿¡æ¯æ˜¯é ä¸æ–­åˆ·æ–°çš„ï¼Œéœ€è¦é€šè¿‡ä¸æ–­æ£€æµ‹é¡µé¢å†…å®¹ï¼Œåˆ¤æ–­ç›®å‰ç¥¨çš„å¯å¦è´­ä¹°æƒ…å†µã€‚å¦‚æœåˆ·æ–°ä¸ºå¯è´­ä¹°åˆ™è¿›è¡ŒæŠ¢è´­è´­ä¹°ã€‚</p>
</blockquote>
<ul>
<li>
<p>ç‚¹å‡»è´­ä¹°æ˜¯å¯¹æŒ‡å®šæ¥å£å‘é€è¯·æ±‚ï¼Œå¹¶æ›´æ–°cookies(cookieså«Œå°‘ä¸å«Œå¤š)ï¼šstep2_click_buy_now</p>
</li>
<li>
<p>æäº¤è®¢å•ï¼šstep3_submit_order</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">response = self.session.post(<span class="string">'https://buy.damai.cn/multi/trans/createOrder'</span>,</span><br><span class="line">                             headers=headers,</span><br><span class="line">                             params=params,</span><br><span class="line">                             data=submit_order_info,</span><br><span class="line">                             cookies=self.login_cookies)</span><br><span class="line">buy_status = json.loads(response.text)</span><br><span class="line"><span class="keyword">if</span> buy_status.get(<span class="string">'success'</span>) <span class="keyword">is</span> <span class="keyword">True</span> <span class="keyword">and</span> buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>):</span><br><span class="line">    print(<span class="string">'-'</span> * <span class="number">10</span>, <span class="string">'æŠ¢ç¥¨æˆåŠŸ, è¯·å‰å¾€ å¤§éº¦ç½‘-&gt;æˆ‘çš„å¤§éº¦-&gt;äº¤æ˜“ä¸­å¿ƒ-&gt;è®¢å•ç®¡ç† ç¡®è®¤è®¢å•'</span>, <span class="string">'-'</span> * <span class="number">10</span>)</span><br><span class="line">    print(<span class="string">'alipayOrderId: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayOrderId'</span>))</span><br><span class="line">    print(<span class="string">'æ”¯ä»˜å®æ”¯ä»˜é“¾æ¥: '</span>, buy_status.get(<span class="string">'module'</span>).get(<span class="string">'alipayWapCashierUrl'</span>))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="nikerobot"><a class="markdownIt-Anchor" href="#nikerobot"></a> <strong><a href="https://github.com/cxiaoer/NikeRobot" target="_blank" rel="noopener"> NikeRobot</a></strong></h3>
<ul>
<li>
<p>pdbè°ƒè¯•æ–­ç‚¹ï¼š==&gt;å®é™…ä¸ŠPycharmçš„è°ƒè¯•æ›´åŠ å¥½ç”¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">	pdb.set_trace()</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å°†ç±»æˆå‘˜å±æ€§è½¬æˆå­—å…¸å½¢å¼: <code>NikeLoginParam().__dict__</code></p>
</li>
<li>
<p>è‡ªå·±ç®¡ç†çº¿ç¨‹ï¼šåˆ›å»ºç»§æ‰¿Threadçš„æ‰§è¡Œç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œåœ¨mainä¸­è¿›è¡Œåˆ›å»ºå¤šä¸ªå®ä¾‹MyThread().start()ï¼Œå¹¶joinä½ã€‚</p>
</li>
</ul>
<h3 id="hpv4g"><a class="markdownIt-Anchor" href="#hpv4g"></a> <strong><a href="https://github.com/xiangmingzhe0928/hpv4g" target="_blank" rel="noopener">hpv4g</a>â˜…</strong></h3>
<ul>
<li>
<p>æ˜¯å¦ä½¿ç”¨ä»£ç†ï¼š<code>init_ip_proxy_pool</code></p>
</li>
<li>
<p>å¤šçº¿ç¨‹å‚æ•°è®¾ç½®: python3.8ä¸­ThreadPoolExecutorçš„é»˜è®¤workerï¼š<code>max_workers = min(32, os.cpu_count() + 4)</code></p>
</li>
<li>
<p>çº¿ç¨‹æ± ï¼šThreadPoolExecutor</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, FIRST_COMPLETED</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> ThreadPoolExecutor(max_workers=max_workers) <span class="keyword">as</span> t:</span><br><span class="line">    fs = [t.submit(sec_kill_task, miao_miao, params[i % _params_len],</span><br><span class="line">                   <span class="keyword">None</span> <span class="keyword">if</span> <span class="keyword">not</span> _ip_proxys_len <span class="keyword">else</span> &#123;</span><br><span class="line">                       <span class="string">'http'</span>: <span class="keyword">None</span> <span class="keyword">if</span> (index := i % _ip_proxys_len) == <span class="number">0</span> <span class="keyword">else</span> ip_proxys[index]&#125;) <span class="keyword">for</span> i <span class="keyword">in</span></span><br><span class="line">          range(max_workers + <span class="number">5</span>)]</span><br><span class="line">    <span class="comment"># 120Såç»“æŸä»»åŠ¡, æœ‰ä¸€ä¸ªå®Œæˆåˆ™å®Œæˆ</span></span><br><span class="line">    wait(fs, <span class="number">120</span>, return_when=FIRST_COMPLETED)</span><br><span class="line">    <span class="keyword">global</span> KILL_FLAG</span><br><span class="line">    KILL_FLAG = <span class="keyword">True</span></span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;æœ¬è½®æœªæˆåŠŸç§’æ€åˆ°ç–«è‹—&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç¼“å­˜é…ç½®â€”â€”éé»˜è®¤å‚æ•°çš„è£…é¥°å™¨ï¼šè€ƒè™‘æå‰ç¼“å­˜ç–«è‹—åˆ—è¡¨ ç§’æ€å¼€å§‹åè·³è¿‡æŸ¥è¯¢åˆ—è¡¨ç­‰æ“ä½œ ç›´æ¥è°ƒç”¨ç§’æ€æ¥å£</p>
</li>
<li>
<p>è·å–æœåŠ¡å™¨å½“å‰æ—¶é—´æˆ³</p>
</li>
<li>
<p>ç›´æ¥è®¾ç½®loggingä¸­çš„log</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># è®¾ç½®é…ç½®</span></span><br><span class="line">logging.basicConfig(handlers=[logging.FileHandler(filename=LOG_NAME,</span><br><span class="line">                                                  encoding=<span class="string">'utf-8'</span>, mode=<span class="string">'a+'</span>)],</span><br><span class="line">                    format=<span class="string">'%(asctime)s %(message)s'</span>,</span><br><span class="line">                    level=getattr(logging, args.log))</span><br><span class="line"><span class="comment"># ä½¿ç”¨</span></span><br><span class="line">logging.info(<span class="string">"xxx"</span>)</span><br><span class="line">logging.debug(<span class="string">"yyy"</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>argueparserä½¿ç”¨ï¼š</p>
<ul>
<li>
<p>actionå‚æ•°: <code>parser.add_argument('-reload_cache', action='store_true', help='åˆ·æ–°--region_codeç–«è‹—åˆ—è¡¨æœ¬åœ°ç¼“å­˜')</code>ï¼Œå‡ºç°reload_cacheå‚æ•°åˆ™ä¸ºtrueï¼Œæ‰€ä»¥é»˜è®¤ä¸ºfalse</p>
</li>
<li>
<p><code>parser.add_argument('--log', default='WARNING', choices=['DEBUG', 'INFO', 'WARNING', 'ERROR'],help='æ—¥å¿—çº§åˆ« é»˜è®¤WARNING')</code></p>
</li>
<li>
<p>add_argumentä¸­çš„typeå®é™…ä¸Šæ˜¯ä¸ªç±»å‹è½¬åŒ–å™¨ï¼Œå¦‚type=intï¼Œå¦‚æœæ— æ³•è½¬æˆintåˆ™æŠ¥é”™ï¼Œå› æ­¤å¯ä»¥å€Ÿæ­¤å‚æ•°å¯¹è¾“å…¥è¿›è¡Œçº¦æŸ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_valid_int_type</span><span class="params">(i)</span>:</span></span><br><span class="line">    valid_int = int(i)</span><br><span class="line">    <span class="keyword">if</span> valid_int &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> argparse.ArgumentTypeError(<span class="string">f'invalid int argument:<span class="subst">&#123;i&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> valid_int</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>requestsä½¿ç”¨ï¼š</p>
<ul>
<li>
<p><code>raise_for_status</code>çŠ¶æ€ç éæˆåŠŸæ—¶æŠ›å‡ºå¼‚å¸¸</p>
</li>
<li>
<p>è‡ªå®šä¹‰<code>_get(url, params=None, error_exit=True, **kwargs)</code>æ–¹æ³•ï¼Œæ·»åŠ å‚æ•°ï¼šerror_exit:è¿”å›4XX 5XXé”™è¯¯æ—¶ æ˜¯å¦é€€å‡º</p>
</li>
<li>
<p>cookiesé™¤äº†æ”¾åœ¨requests.get(cookies=xxxCookieDict)ï¼Œè¿˜å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²è®¾ç½®åœ¨header[â€œ<strong>cookie</strong>â€]ä¸­ï¼ˆæ— sï¼‰ï¼Œå¦‚<code>self._headers[&quot;cookie&quot;]=&quot;k1=v1;_xxhm_=%7B%2x%7D;k3=wxapptoken:v3&quot;</code>ï¼Œé€šè¿‡<code>;</code>æ¥åˆ†å‰²</p>
</li>
<li>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># disable ssl warnings</span></span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="æŠ¢è´­å‹ä»£ç æ€»ç»“"><a class="markdownIt-Anchor" href="#æŠ¢è´­å‹ä»£ç æ€»ç»“"></a> æŠ¢è´­å‹ä»£ç æ€»ç»“ï¼š</h3>
<ul>
<li>
<p>å®ç°ä¸»è¦åˆ†ä¸ºselenium(è‡ªåŠ¨æµ‹è¯•å·¥å…·)æ¨¡æ‹Ÿç‚¹å‡»ï¼›apiæ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</p>
</li>
<li>
<p>ç™»é™†ä¹‹åä¼šå¯¹cookiesè¿›è¡ŒæŒä¹…åŒ–ï¼Œä½¿ç”¨pickleçš„å¥½å¤„æ˜¯æ— æ³•æ˜æ–‡çœ‹æ‡‚ã€å¤åˆ¶</p>
</li>
<li>
<p>å¯ä»¥é€šè¿‡æŒä¹…åŒ–çš„cookiesæ¥ç™»é™†ï¼Œä½†ä¼šæ£€æµ‹cookiesæ˜¯å¦ä»ç„¶æœ‰æ•ˆ</p>
</li>
<li>
<p>å®šæ—¶æŠ¢è´­ä¼šç­‰å¾…sleepåˆ°ä¸´è¿‘æ—¶é—´(while True+sleep(time)çš„æ–¹å¼ or sleepUntil+while try)ï¼Œç„¶åå†è¿›è¡Œå¤šæ¬¡æŠ¢è´­è¯·æ±‚ï¼ˆå¦‚æœæŠ¢è´­çš„2åˆ†é’Ÿå†…æ²¡æŠ¢åˆ°ï¼Œå¤§å¤šæ²¡å¸Œæœ›äº†ï¼Œåªå¥½ç­‰å¾…ä¸‹æ¬¡ï¼‰ï¼›å¦‚æœæ˜¯<a href="#Automatic_ticket_purchase">ç­‰å¾…é¡µé¢åˆ·æ–°çš„</a>ï¼Œåˆ™ä¸æ–­è¯·æ±‚é¡µé¢ï¼Œç­‰åˆ°ç»“æœæ”¹å˜ã€‚</p>
<ul>
<li>æ³¨æ„ï¼šç­‰å¾…é—´éš”ä¸è¦è¶…è¿‡æ—¶é—´é˜ˆå€¼ï¼Œå¦‚180så‰æ£€æŸ¥ï¼Œå¦‚æœä¸ç¬¦åˆä¸èƒ½è®©å…¶ç­‰å¾…190s</li>
</ul>
</li>
<li>
<p>æ¨é€å·¥å…·ï¼šæä¾›ä¸€ä¸ªè‡ªå·±å†™çš„</p>
<p>config.ini</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[pusher]</span></span><br><span class="line"><span class="attr">pusher_type</span> = pushplus</span><br><span class="line"><span class="attr">push_title</span> = é£é±¼ç§’æ€</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://sct.ftqq.com/</span></span><br><span class="line"><span class="section">[serverchan]</span></span><br><span class="line"><span class="attr">sec_key</span> = SCU35113Te369cebc21f6e483c03fffc400c4c5c05bdad63995c32</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://open.dingtalk.com/document/group/custom-robot-access</span></span><br><span class="line"><span class="section">[dingding]</span></span><br><span class="line"><span class="attr">access_token</span> =</span><br><span class="line"><span class="attr">secret</span> =</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://www.pushplus.plus/</span></span><br><span class="line"><span class="section">[pushplus]</span></span><br><span class="line"><span class="attr">pushplus_token</span> = fedcf6b08f6f4aaeb2948b7d7010eb93</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">'Mrli'</span></span><br><span class="line"></span><br><span class="line">CONFIG_INI_FILENAME = <span class="string">"push_config.ini"</span></span><br><span class="line">CONFIG_INI_PATH = Path(__file__).resolve().parent.with_name(<span class="string">"push_config.ini"</span>)</span><br><span class="line"></span><br><span class="line">REMIND_MSG = <span class="string">"""</span></span><br><span class="line"><span class="string">[pusher]</span></span><br><span class="line"><span class="string">pusher_type = pushplus</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[serverchan]</span></span><br><span class="line"><span class="string">sec_key =</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[dingding]</span></span><br><span class="line"><span class="string">access_token =</span></span><br><span class="line"><span class="string">secret =</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[pushplus]</span></span><br><span class="line"><span class="string">pushplus_token = </span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PusherException</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, message)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        super().__init__(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IPushUtil</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PushplusPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.pushplus_token = options.get(<span class="string">"pushplus_token"</span>)</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        d = &#123;</span><br><span class="line">            <span class="string">"token"</span>: self.pushplus_token,</span><br><span class="line">            <span class="string">"template"</span>: <span class="string">"markdown"</span>,</span><br><span class="line">            <span class="string">"title"</span>: <span class="string">"&#123;push_title&#125;-&#123;title&#125;"</span>.format(push_title=self.push_title, title=title),</span><br><span class="line">            <span class="string">"content"</span>: content</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(<span class="string">"http://www.pushplus.plus/send"</span>, data=d)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">200</span> &lt;= res.json().get(<span class="string">"code"</span>) &lt; <span class="number">300</span>):</span><br><span class="line">            print(res.json())</span><br><span class="line">        <span class="keyword">return</span> <span class="number">200</span> &lt;= res.json().get(<span class="string">"code"</span>) &lt; <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ServerChanPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.sec_key = options.get(<span class="string">"sec_key"</span>)</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'text'</span>: <span class="string">"&#123;push_title&#125;-&#123;title&#125;"</span>.format(push_title=self.push_title, title=title),</span><br><span class="line">            <span class="string">'desp'</span>: content</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=<span class="string">'https://sc.ftqq.com/&#123;&#125;.send'</span>.format(self.sec_key), data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (res.json().get(<span class="string">"errmsg"</span>) == <span class="string">"success"</span>):</span><br><span class="line">            print(res.json())</span><br><span class="line">        <span class="keyword">return</span> res.json().get(<span class="string">"errmsg"</span>) == <span class="string">"success"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DingDingPush</span><span class="params">(IPushUtil)</span>:</span></span><br><span class="line">    URL = <span class="string">"https://oapi.dingtalk.com/robot/send"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, push_title, options: dict)</span>:</span></span><br><span class="line">        self.access_token = options.get(<span class="string">"access_token"</span>)</span><br><span class="line">        self.secret = options.get(<span class="string">"secret"</span>)</span><br><span class="line">        self.target_url = self.get_url()</span><br><span class="line">        self.push_title = push_title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_url</span><span class="params">(self)</span>:</span></span><br><span class="line">        timestamp = round(time.time() * <span class="number">1000</span>)</span><br><span class="line">        secret_enc = bytes(self.secret, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">        string_to_sign = <span class="string">"&#123;&#125;\n&#123;&#125;"</span>.format(timestamp, self.secret)</span><br><span class="line">        string_to_sign_enc = bytes(string_to_sign, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">        hmac_code = hmac.new(</span><br><span class="line">            secret_enc, string_to_sign_enc, digestmod=hashlib.sha256</span><br><span class="line">        ).digest()</span><br><span class="line">        sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class="line">        <span class="keyword">return</span> self.URL + <span class="string">"?access_token=&#123;access_token&#125;&amp;timestamp=&#123;timestamp&#125;&amp;sign=&#123;sign&#125;"</span>.format(</span><br><span class="line">            access_token=self.access_token, timestamp=timestamp, sign=sign)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        msg = self.gen_markdown_msg(title, content)</span><br><span class="line">        <span class="keyword">return</span> self.send(msg)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(self, message)</span>:</span></span><br><span class="line">        resp = requests.post(self.target_url, json=message)</span><br><span class="line">        <span class="keyword">return</span> resp.json()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_text_msg</span><span class="params">(content, at=None, at_all=False)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> at <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            at = []</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"msgtype"</span>: <span class="string">"text"</span>,</span><br><span class="line">            <span class="string">"text"</span>: &#123;<span class="string">"content"</span>: content&#125;,</span><br><span class="line">            <span class="string">"at"</span>: &#123;<span class="string">"atMobiles"</span>: at, <span class="string">"isAtAll"</span>: at_all&#125;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_markdown_msg</span><span class="params">(self, title, text, at=None, at_all=False)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">generateText</span><span class="params">()</span>:</span></span><br><span class="line">            res = <span class="string">""</span></span><br><span class="line">            <span class="comment"># æœ€é¡¶è¡Œæ˜¾ç¤ºæ ‡é¢˜</span></span><br><span class="line">            res += <span class="string">"# "</span> + <span class="string">"&#123;&#125;-"</span>.format(self.push_title) + title + <span class="string">"\n"</span></span><br><span class="line">            <span class="comment"># å†…å®¹</span></span><br><span class="line">            res += text</span><br><span class="line">            <span class="comment"># atå¯¹è±¡</span></span><br><span class="line">            res += reduce(<span class="keyword">lambda</span> x, y: x + <span class="string">"@"</span> + y, at, <span class="string">""</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"msgtype"</span>: <span class="string">"markdown"</span>,</span><br><span class="line">            <span class="string">"markdown"</span>: &#123;</span><br><span class="line">                <span class="string">"title"</span>: title,</span><br><span class="line">                <span class="string">"text"</span>: generateText()</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"at"</span>: &#123;<span class="string">"atMobiles"</span>: at, <span class="string">"isAtAll"</span>: at_all&#125;,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pusher</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, logger=None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> logger:</span><br><span class="line">            self.cout = logger.info</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cout = <span class="keyword">print</span></span><br><span class="line">        self._pusher = self.init()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        å®ä¾‹åŒ–pusher</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">from</span> configparser <span class="keyword">import</span> RawConfigParser</span><br><span class="line">        cp = RawConfigParser()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(CONFIG_INI_PATH):</span><br><span class="line">            <span class="keyword">raise</span> PusherException(</span><br><span class="line">                <span class="string">"è¯·åˆ›å»º&#123;filename&#125;é…ç½®æ–‡ä»¶\npusheré…ç½®ä¿¡æ¯å¦‚ä¸‹:\n&#123;msg&#125;"</span>.format(filename=CONFIG_INI_FILENAME, msg=REMIND_MSG))</span><br><span class="line">        cp.read(CONFIG_INI_PATH, encoding=<span class="string">"utf8"</span>)</span><br><span class="line">        pusher_type = cp.get(<span class="string">"pusher"</span>, <span class="string">"pusher_type"</span>).lower()</span><br><span class="line">        push_title = cp.get(<span class="string">"pusher"</span>, <span class="string">"push_title"</span>)</span><br><span class="line">        <span class="comment"># æ˜¯å¦ä½¿ç”¨äº†pusher</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pusher_type:</span><br><span class="line">            self.cout(<span class="string">"åˆå§‹åŒ–Pusher: å½“å‰æœªé…ç½®Pusher, å¦‚æœéœ€è¦æ¨é€åŠŸèƒ½, åˆ™åœ¨&#123;filename&#125;"</span>.format(filename=CONFIG_INI_FILENAME))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">        generator_info = dict(cp.items(pusher_type))</span><br><span class="line">        <span class="comment"># æ£€æŸ¥pusheré…ç½®</span></span><br><span class="line">        <span class="keyword">if</span> pusher_type <span class="keyword">and</span> <span class="keyword">not</span> self._valid(generator_info):</span><br><span class="line">            <span class="keyword">raise</span> PusherException(<span class="string">"&#123;&#125;_pusheré…ç½®é”™è¯¯ï¼Œä¸èƒ½ä¸ºç©º~"</span>.format(pusher_type))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pusher_type == <span class="string">"serverchan"</span>:</span><br><span class="line">            <span class="keyword">return</span> ServerChanPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">elif</span> pusher_type == <span class="string">"dingding"</span>:</span><br><span class="line">            <span class="keyword">return</span> DingDingPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">elif</span> pusher_type == <span class="string">"pushplus"</span>:</span><br><span class="line">            <span class="keyword">return</span> PushplusPush(push_title, generator_info)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> PusherException(<span class="string">"ä¸å¯çŸ¥pusherç±»å‹~"</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_valid</span><span class="params">(config_dict: dict)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        åˆ¤æ–­å­—å…¸å€¼æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="string">        :param dict:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> config_dict.values():</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> v:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, content: str, title: str = <span class="string">""</span>)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self._pusher:</span><br><span class="line">            self.cout(<span class="string">"å½“å‰æœªé…ç½®pusher, æ¶ˆæ¯æ— æ³•å‘é€"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> self._pusher.push(content, title)</span><br></pre></td></tr></table></figure>
<h2 id="weibospider"><a class="markdownIt-Anchor" href="#weibospider"></a> <a href="https://github.com/dataabc/weiboSpider" target="_blank" rel="noopener">weiboSpider</a></h2>
<blockquote>
<p>å¯ä»¥è¿ç»­çˆ¬å–<strong>ä¸€ä¸ª</strong>æˆ–<strong>å¤šä¸ª</strong>æ–°æµªå¾®åšç”¨æˆ·ï¼ˆå¦‚<a href="https://weibo.cn/u/1223178222" target="_blank" rel="noopener">èƒ¡æ­Œ</a>ã€<a href="https://weibo.cn/u/1669879400" target="_blank" rel="noopener">è¿ªä¸½çƒ­å·´</a>ã€<a href="https://weibo.cn/u/1729370543" target="_blank" rel="noopener">éƒ­ç¢§å©·</a>ï¼‰çš„æ•°æ®ï¼Œå¹¶å°†ç»“æœä¿¡æ¯å†™å…¥<strong>æ–‡ä»¶</strong>æˆ–<strong>æ•°æ®åº“</strong>ã€‚</p>
</blockquote>
<ul>
<li>â‘ å…è®¸ç”¨æˆ·æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶ï¼›â‘¡å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œå¹¶å¯¹éæ³•é¡¹è¿›è¡Œæç¤º</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	config = _get_config()</span><br><span class="line">    config_util.validate_config(config)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_config</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""è·å–config.jsonæ•°æ®"""</span></span><br><span class="line">    src = os.path.split(</span><br><span class="line">        os.path.realpath(__file__))[<span class="number">0</span>] + os.sep + <span class="string">'config_sample.json'</span></span><br><span class="line">    config_path = os.getcwd() + os.sep + <span class="string">'config.json'</span></span><br><span class="line">    <span class="keyword">if</span> FLAGS.config_path:</span><br><span class="line">        config_path = FLAGS.config_path</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate_config</span><span class="params">(config)</span>:</span></span><br><span class="line">    <span class="string">"""éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># éªŒè¯filterã€pic_downloadã€video_download</span></span><br><span class="line">    argument_list = [<span class="string">'filter'</span>, <span class="string">'pic_download'</span>, <span class="string">'video_download'</span>]</span><br><span class="line">    <span class="keyword">for</span> argument <span class="keyword">in</span> argument_list:</span><br><span class="line">        <span class="keyword">if</span> config[argument] != <span class="number">0</span> <span class="keyword">and</span> config[argument] != <span class="number">1</span>:</span><br><span class="line">            logger.warning(<span class="string">u'%så€¼åº”ä¸º0æˆ–1,è¯·é‡æ–°è¾“å…¥'</span>, config[argument])</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éªŒè¯since_date</span></span><br><span class="line">    since_date = config[<span class="string">'since_date'</span>]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> _is_date(str(since_date))) <span class="keyword">and</span> (<span class="keyword">not</span> isinstance(since_date, int)):</span><br><span class="line">        logger.warning(<span class="string">u'since_dateå€¼åº”ä¸ºyyyy-mm-ddå½¢å¼æˆ–æ•´æ•°,è¯·é‡æ–°è¾“å…¥'</span>)</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>
<h2 id="proxy_pool"><a class="markdownIt-Anchor" href="#proxy_pool"></a> <strong><a href="https://github.com/jhao104/proxy_pool" target="_blank" rel="noopener">proxy_pool</a>â˜…</strong></h2>
<blockquote>
<p>çˆ¬è™«ä»£ç†IPæ± é¡¹ç›®,ä¸»è¦åŠŸèƒ½ä¸ºå®šæ—¶é‡‡é›†ç½‘ä¸Šå‘å¸ƒçš„å…è´¹ä»£ç†éªŒè¯å…¥åº“ï¼Œå®šæ—¶éªŒè¯å…¥åº“çš„ä»£ç†ä¿è¯ä»£ç†çš„å¯ç”¨æ€§ï¼Œæä¾›APIå’ŒCLIä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥æ‰©å±•ä»£ç†æºä»¥å¢åŠ ä»£ç†æ± IPçš„è´¨é‡å’Œæ•°é‡ã€‚</p>
<p>æ¨¡å—ç»„æˆï¼šè·å–åŠŸèƒ½ã€å­˜å‚¨åŠŸèƒ½ã€æ ¡éªŒåŠŸèƒ½ã€æ¥å£ç®¡ç†</p>
<p>â­ï¸ç¨‹åºä¸»è¦æ˜¯å¯åŠ¨äº†<code>startServer</code>çš„APIæ¥å£æœåŠ¡ã€<code>startScheduler</code>å®šæ—¶æœåŠ¡</p>
<ul>
<li><code>startServer-&gt;runFlask</code>ï¼šæ˜¯å‘å¤–æä¾›äº†é€šè¿‡<strong>proxyHandler</strong>æ¥è·å¾—Redisä¸­çš„proxyæ•°æ®</li>
<li><code>startScheduler-&gt;sche.add_task(__runProxyFetch)ã€sche.add_task(__runProxyCheck)</code>ï¼Œ
<ul>
<li><code>__runProxyFetch:proxy_fetcher.run()-&gt;proxy_queue-&gt;Checker(&quot;raw&quot;, proxy_queue)</code>è·å¾—å„ä¸ªä»£ç†ç½‘ç«™çš„ä»£ç†ä¿¡æ¯åï¼Œè¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸåˆ™å…¥åº“</li>
<li><code>__runProxyCheck:proxy in proxy_handler.getAll()-&gt;proxy_queue-&gt;Checker(&quot;use&quot;, proxy_queue)</code>ï¼šé€šè¿‡proxy_handleræ‹¿åˆ°åº“é‡Œæ‰€æœ‰ç°å­˜çš„æ•°æ®åï¼Œè¿›è¡Œæœ‰æ•ˆæ€§æ ¡éªŒï¼Œæ— æ•ˆçš„åˆ™åˆ é™¤ï¼Œæœ‰æ•ˆçš„åˆ™æ›´æ–°ä¿¡æ¯</li>
</ul>
</li>
</ul>
<p>ä½œä¸ºå­˜å‚¨åŠŸèƒ½çš„æ¥å£proxyHandlerï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªAPIæœåŠ¡ä¸å®šæ—¶æœåŠ¡çš„ä¸­ä»‹ã€‚ç¨‹åºä¹Ÿæ˜¯é€šè¿‡å­˜å‚¨åŠŸèƒ½ï¼Œå°†æ ¸å¿ƒçš„ä¸¤ä¸ªåŠŸèƒ½ï¼š<u>å®šæ—¶æŠ“å–çš„proxyæ•°æ®</u>ä¸<u>æä¾›proxyæ•°æ®ç»™ç”¨æˆ·ä½¿ç”¨</u>æˆåŠŸè”ç³»åœ¨äº†ä¸€èµ·</p>
</blockquote>
<ul>
<li>
<p>é€šè¿‡å…ƒç±»å®ç°å•ä¾‹æ¨¡å¼ï¼šConfigHandlerï¼Œå…¶å¯ä»¥åœ¨ä»»æ„æ¨¡å—ä¸­ä»¥c = ConfigHandler()çš„å½¢å¼è·å¾—ï¼Œè€Œä¸æ˜¯<code>ConfigHandler.getInstance()</code></p>
</li>
<li>
<p><code>@LazyProperty</code>æ‡’åŠ è½½å±æ€§çš„è£…é¥°å™¨ï¼š åªæœ‰ç”¨åˆ°æ—¶æ‰ä¼šåŠ è½½å¹¶å°†å€¼æ³¨å…¥åˆ°<code>__dict__</code>ã€åŠ è½½ä¸€æ¬¡åå€¼å°±ä¸å†å˜åŒ–ã€ï¼›è®²è§£å¯è§ï¼š<a href="https://www.jianshu.com/p/708dc26f9b92%E2%80%94%E2%80%94%E6%8F%8F%E8%BF%B0%E7%AC%A6or%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%AE%9E%E7%8E%B0" target="_blank" rel="noopener">https://www.jianshu.com/p/708dc26f9b92â€”â€”æè¿°ç¬¦orä¿®é¥°ç¬¦å®ç°</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LazyProperty</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># åœ¨è¢«æ³¨è§£ç±»æ–¹æ³•è¢«è§£é‡Šå™¨è¿è¡Œçš„æ—¶å€™å°±ä¼šåˆ›å»ºLazyPropertyå®ä¾‹å¹¶è¿”å›</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func)</span>:</span></span><br><span class="line">        self.func = func</span><br><span class="line">    <span class="string">"""é€šè¿‡pythonæè¿°ç¬¦æ¥å®ç°"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> instance <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä¼šå°†ç»“æœå€¼é€šè¿‡setattræ–¹æ³•å­˜å…¥åˆ°instanceå¯¹è±¡å®ä¾‹çš„__dict__ä¸­</span></span><br><span class="line">            value = self.func(instance)</span><br><span class="line">            setattr(instance, self.func.__name__, value)</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigHandler</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    <span class="comment"># è¿”å›ä¸€ä¸ªLazyPropertyå®ä¾‹ </span></span><br><span class="line"><span class="meta">    @LazyProperty</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serverHost</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.environ.get(<span class="string">"HOST"</span>, setting.HOST)</span><br><span class="line">c = ConfigHandler()</span><br><span class="line"><span class="comment"># ä¼šè§¦å‘ConfigHandler.__dict__["serverHost"], ç„¶åæ¥è€Œè§¦å‘LazyPropertyçš„__get__ï¼Œvalue = self.func(instance)ä¼šå¾—åˆ°çœŸæ­£serverHostå‡½æ•°çš„å€¼åå°†å…¶è®¾ç½®åœ¨ConfigHandler instanceå¯¹è±¡çš„__dict__ä¸­ï¼Œç”±äºå¯¹è±¡çš„__dict__["serverHost"]=valueä¼˜å…ˆçº§é«˜äºç±»çš„__dict__["serverHost"]=LazyProperty()å¯¹è±¡ï¼Œå› æ­¤ä¹‹åè°ƒç”¨å¾—åˆ°çš„æ˜¯valueç»“æœ</span></span><br><span class="line">print(c.serverHost)</span><br></pre></td></tr></table></figure>
<p><code>__get__</code>åªæœ‰è®¿é—®ç±»å±æ€§çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™è¾¹æ˜¯é€šè¿‡setattrå°†serverHostè®¾ç½®æˆäº†ConfigHandlerçš„ç±»å±æ€§</p>
</li>
<li>
<p>å°è£…äº†ä¸€ä¸ªè¯·æ±‚å·¥å…·ç±»<code>WebRequest</code>:</p>
<ul>
<li>å¢åŠ äº†å¼‚å¸¸å¤„ç†çš„åŠŸèƒ½</li>
<li>å¢åŠ äº†æ—¥å¿—åŠŸèƒ½</li>
<li>è¯·æ±‚å¤´ä¼šå¾—åˆ°éšæœºUA</li>
<li>è®¾ç½®é‡è¯•</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨clickåˆ›å»ºå­å‘½ä»¤ï¼š</p>
<ol>
<li>å¾—åˆ°ä¸€ä¸ªclick_group</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CONTEXT_SETTINGS = dict(help_option_names=[<span class="string">'-h'</span>, <span class="string">'--help'</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">@click.group(context_settings=CONTEXT_SETTINGS)</span></span><br><span class="line"><span class="meta">@click.version_option(version=VERSION)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cli</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""ProxyPool cliå·¥å…·"""</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æŒ‡å®šgroupä¸‹çš„å­å‘½ä»¤</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cli.command(name="server")</span></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥è®¾ç½®å‚æ•°: @click.option('--count', default=1, help='Number of greetings.') --&gt; def server(count)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">""" å¯åŠ¨apiæœåŠ¡ """</span></span><br><span class="line">    click.echo(BANNER)</span><br><span class="line">    startServer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    cli()</span><br></pre></td></tr></table></figure>
<p>ç„¶åé€šè¿‡bashè„šæœ¬åŒæ—¶å¼€å¯ä¸¤ä¸ªè¿›ç¨‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">python proxyPool.py server &amp;</span><br><span class="line">python proxyPool.py schedule</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>DbClient DBå·¥å‚ç±»</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DbClient</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, db_conn)</span>:</span></span><br><span class="line">        self.parseDbConn(db_conn)</span><br><span class="line">        self.__initDbClient()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parseDbConn</span><span class="params">(cls, db_conn)</span>:</span></span><br><span class="line">        <span class="comment"># å¯ä»¥å…³æ³¨ä¸€ä¸‹urlparseçš„ä½¿ç”¨</span></span><br><span class="line">        db_conf = urlparse(db_conn)</span><br><span class="line">        cls.db_type = db_conf.scheme.upper().strip()</span><br><span class="line">        <span class="comment"># _NetlocResultMixinBaseå¯¹è±¡æ¥è·å–æƒ³è¦çš„å‚æ•°</span></span><br><span class="line">        cls.db_host = db_conf.hostname</span><br><span class="line">        cls.db_port = db_conf.port</span><br><span class="line">        cls.db_user = db_conf.username</span><br><span class="line">        cls.db_pwd = db_conf.password</span><br><span class="line">        cls.db_name = db_conf.path[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">return</span> cls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__initDbClient</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        init DB Client</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        __type = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"SSDB"</span> == self.db_type:</span><br><span class="line">            __type = <span class="string">"ssdbClient"</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">"REDIS"</span> == self.db_type:</span><br><span class="line">            __type = <span class="string">"redisClient"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">assert</span> __type, <span class="string">'type error, Not support DB type: &#123;&#125;'</span>.format(self.db_type)</span><br><span class="line">        self.client = getattr(__import__(__type), <span class="string">"%sClient"</span> % self.db_type.title())(host=self.db_host,</span><br><span class="line">port=self.db_port,</span><br><span class="line">username=self.db_user,</span><br><span class="line">password=self.db_pwd,</span><br><span class="line">db=self.db_name)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>pythonä¸­ä½¿ç”¨redis</p>
<blockquote>
<p>Redisä¸­ä»£ç†å­˜æ”¾çš„ç»“æ„ä¸ºhashï¼šhash  æ˜¯ä¸€ä¸ªé”®å€¼(key=&gt;value)å¯¹é›†åˆï¼›æ˜¯ä¸€ä¸ª string ç±»å‹çš„ fieldï¼ˆå­—æ®µï¼‰ å’Œ valueï¼ˆå€¼ï¼‰ çš„<strong>æ˜ å°„è¡¨</strong>ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚</p>
<p>æœ¬é¡¹ç›®ä¸­åº”ç”¨ï¼škeyä¸ºip:port, valueä¸ºä»£ç†å±æ€§çš„å­—å…¸;</p>
</blockquote>
<ul>
<li>pythonä¸åˆ›å»ºè¿æ¥</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install redis</span></span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> Redis, BlockingConnectionPool</span><br><span class="line">conn_dict = &#123;</span><br><span class="line">    <span class="string">"host"</span>: <span class="string">"49.235.118.244"</span>,</span><br><span class="line">    <span class="string">"port"</span>: <span class="number">6379</span>,</span><br><span class="line">    <span class="string">"db"</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">r = Redis(connection_pool=BlockingConnectionPool(decode_responses=<span class="keyword">True</span>,</span><br><span class="line">                                                 timeout=<span class="number">5</span>,</span><br><span class="line">                                                 socket_timeout=<span class="number">15</span>,</span><br><span class="line">                                                 **conn_dict)</span><br><span class="line">         )</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://github.com/jhao104/proxy_pool/blob/master/db/redisClient.py" target="_blank" rel="noopener">â˜…hashä½¿ç”¨å°è£…</a></li>
</ul>
<blockquote>
<p>æ·»åŠ ï¼šsetã€zsetä¸ºaddã€listä¸ºpushã€stringå’Œhashä¸ºset</p>
</blockquote>
<p>å‚è€ƒ:<a href="https://blog.csdn.net/weixin_39576234/article/details/87603701" target="_blank" rel="noopener">RedisåŸºæœ¬æ¦‚å¿µåŠä½¿ç”¨</a>ã€<a href="https://www.runoob.com/redis/redis-sorted-sets.html%E3%80%81" target="_blank" rel="noopener">https://www.runoob.com/redis/redis-sorted-sets.htmlã€</a><a href="https://www.runoob.com/w3cnote/python-redis-intro.html" target="_blank" rel="noopener">â˜…Python redis ä½¿ç”¨ä»‹ç»</a></p>
<p><img src="/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/E:%5Chexo%5Csource_posts%5C%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95%5Credis.jpg" alt="redis"></p>
</li>
<li>
<p>ç»§æ‰¿é‡å†™logging.loggerï¼Œå¯é€‰å‚æ•°ä¸º<code>name, level=DEBUG, stream=True, file=True</code>ï¼Œè®©æ¯ä¸ªåŠŸèƒ½å‡½æ•°éƒ½èƒ½ç”Ÿæˆå•ç‹¬çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œäº†å¯é€‰æ§åˆ¶ã€‚</p>
<p>ç›¸æ¯”å•ä¾‹ï¼Œæ—¥å¿—ç²¾åº¦æ›´ç»†ï¼Œä½†ä¹Ÿä½¿ç”¨èµ·æ¥ä¹Ÿæ›´éº»çƒ¦ï¼Œéœ€è¦è€ƒè™‘ä»€ä¹ˆåœ°æ–¹éœ€è¦ã€‚</p>
</li>
<li>
<p>æä¾›&quot;æ‰©å±•ä»£ç†&quot;æ¥å£</p>
<ol>
<li>
<p>åœ¨<a href="https://github.com/jhao104/proxy_pool/blob/1a3666283806a22ef287fba1a8efab7b94e94bac/fetcher/proxyFetcher.py#L21" target="_blank" rel="noopener">ProxyFetcher</a>ç±»ä¸­æ·»åŠ è‡ªå®šä¹‰çš„è·å–ä»£ç†çš„é™æ€æ–¹æ³•ï¼Œ è¯¥æ–¹æ³•éœ€è¦ä»¥ç”Ÿæˆå™¨(yield)å½¢å¼è¿”å›<code>host:ip</code>æ ¼å¼çš„ä»£ç†</p>
</li>
<li>
<p>æ·»åŠ å¥½æ–¹æ³•åï¼Œä¿®æ”¹<a href="https://github.com/jhao104/proxy_pool/blob/1a3666283806a22ef287fba1a8efab7b94e94bac/setting.py#L47" target="_blank" rel="noopener">setting.py</a>æ–‡ä»¶ä¸­çš„<code>PROXY_FETCHER</code>é¡¹ä¸‹æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•çš„åå­—:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PROXY_FETCHER = [</span><br><span class="line">    <span class="string">"freeProxy01"</span>,    </span><br><span class="line">    <span class="string">"freeProxy02"</span>,</span><br><span class="line">    <span class="comment"># ....</span></span><br><span class="line">    <span class="string">"freeProxyCustom1"</span>  <span class="comment">#  # ç¡®ä¿åå­—å’Œä½ æ·»åŠ æ–¹æ³•åå­—ä¸€è‡´</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><code>schedule</code> è¿›ç¨‹ä¼šæ¯éš”ä¸€æ®µæ—¶é—´æŠ“å–ä¸€æ¬¡ä»£ç†ï¼Œä¸‹æ¬¡æŠ“å–æ—¶ä¼šè‡ªåŠ¨è¯†åˆ«è°ƒç”¨ä½ å®šä¹‰çš„æ–¹æ³•ã€‚</p>
</li>
</ol>
<p><a href="https://github.com/jhao104/proxy_pool/blob/master/helper/fetch.py" target="_blank" rel="noopener">å®ç°æ–¹å¼</a>ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">self.log.info(<span class="string">"ProxyFetch : start"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»é…ç½®ä¸­æ‹¿æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">for</span> fetch_source <span class="keyword">in</span> self.conf.fetchers:</span><br><span class="line">    <span class="comment"># åˆ¤æ–­ProxyFetcherä¸­æ˜¯å¦æœ‰å®šä¹‰ã€æ˜¯å¦å¯è°ƒç”¨</span></span><br><span class="line">	fetcher = getattr(ProxyFetcher, fetch_source, <span class="keyword">None</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> fetcher:</span><br><span class="line">		self.log.error(<span class="string">"ProxyFetch - &#123;func&#125;: class method not exists!"</span>.format(func=fetch_source))</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> callable(fetcher):</span><br><span class="line">		self.log.error(<span class="string">"ProxyFetch - &#123;func&#125;: must be class method"</span>.format(func=fetch_source))</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	thread_list.append(_ThreadFetcher(fetch_source, proxy_dict))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> thread_list:</span><br><span class="line">    thread.setDaemon(<span class="keyword">True</span>)</span><br><span class="line">    thread.start()</span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> thread_list:</span><br><span class="line">    thread.join()</span><br><span class="line">self.log.info(<span class="string">"ProxyFetch - all complete!"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Cpython(é»˜è®¤å®‰è£…çš„éƒ½æ˜¯Cpython)ä¸­Dictå’Œlistã€tupleéƒ½æ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„</p>
<ul>
<li>
<p>ä»¥è£…é¥°å™¨çš„å½¢å¼å°†è¿‡æ»¤å™¨å°†å…¥åˆ°å®¹å™¨ä¸­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyValidator</span><span class="params">(withMetaclass<span class="params">(Singleton)</span>)</span>:</span></span><br><span class="line">    pre_validator = []</span><br><span class="line">    http_validator = []</span><br><span class="line">    https_validator = []</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addPreValidator</span><span class="params">(cls, func)</span>:</span></span><br><span class="line">        cls.pre_validator.append(func)</span><br><span class="line">        <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®é™…ä¸Šæ‰§è¡Œäº† formatValidator=ProxyValidator.addPreValidator(formatValidator)</span></span><br><span class="line"><span class="comment"># ç”±äºaddPreValidatorè¿”å›äº†func, æ‰€ä»¥formatValidatorè¿˜æ˜¯åŸæ¥çš„addPreValidator, ä½†åœ¨ç±»å®šä¹‰çš„æ—¶å€™ProxyValidator.pre_validatoræ·»åŠ äº†formatValidatoræ–¹æ³•</span></span><br><span class="line"><span class="meta">@ProxyValidator.addPreValidator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">formatValidator</span><span class="params">(proxy)</span>:</span></span><br><span class="line">    <span class="string">"""æ£€æŸ¥ä»£ç†æ ¼å¼"""</span></span><br><span class="line">    verify_regex = <span class="string">r"\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;:\d&#123;1,5&#125;"</span></span><br><span class="line">    _proxy = findall(verify_regex, proxy)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">True</span> <span class="keyword">if</span> len(_proxy) == <span class="number">1</span> <span class="keyword">and</span> _proxy[<span class="number">0</span>] == proxy <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoValidator</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">""" æ ¡éªŒæ‰§è¡Œå™¨ """</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validator</span><span class="params">(cls, proxy)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æ ¡éªŒå…¥å£</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            proxy: Proxy Object</span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Proxy Object</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        http_r = cls.httpValidator(proxy)</span><br><span class="line">        https_r = <span class="keyword">False</span> <span class="keyword">if</span> <span class="keyword">not</span> http_r <span class="keyword">else</span> cls.httpsValidator(proxy)</span><br><span class="line"></span><br><span class="line">        proxy.check_count += <span class="number">1</span></span><br><span class="line">        proxy.last_time = datetime.now().strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">        proxy.last_status = <span class="keyword">True</span> <span class="keyword">if</span> http_r <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">if</span> http_r:</span><br><span class="line">            <span class="keyword">if</span> proxy.fail_count &gt; <span class="number">0</span>:</span><br><span class="line">                proxy.fail_count -= <span class="number">1</span></span><br><span class="line">            proxy.https = <span class="keyword">True</span> <span class="keyword">if</span> https_r <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            proxy.fail_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> proxy</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preValidator</span><span class="params">(cls, proxy)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> func <span class="keyword">in</span> ProxyValidator.pre_validator:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> func(proxy):</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><a href="http://www.network-science.de/ascii/" target="_blank" rel="noopener">starter-banner</a>ï¼šå¯åŠ¨æ¨ªå¹…</p>
<ul>
<li>reflection: Noã€adjustment: cewnterã€Stretch: Yesã€width: 80</li>
<li>è¿˜ä¸é”™çš„fontï¼š
<ul>
<li>5lineobliqueâ€”â€”å¥½çœ‹</li>
<li>banner3â€”â€”æ¸…æ¥š</li>
<li>bellâ€”â€”æŠ½è±¡</li>
<li>bigâ€”â€”æ¸…æ™°</li>
<li>bigchiefâ€”â€”ç­‰é«˜çº¿ç‰ˆæœ¬ã€è‰ºæœ¯</li>
<li>blockâ€”â€”å—çŠ¶</li>
<li>bulbheadâ€”â€”å¯çˆ±</li>
<li>larry3dâ€”â€”ç«‹ä½“3d</li>
<li>ogreâ€”â€”æ¸…æ™°</li>
<li>puffyâ€”â€”æ¸…æ™°+ä¸€ç‚¹å¯çˆ±</li>
<li>slantâ€”â€”æ¸…æ™°+æ–œä½“</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å®šæ—¶å™¨æ¡†æ¶apscheduleé…ç½®:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">scheduler = BlockingScheduler(logger=scheduler_log, timezone=timezone)</span><br><span class="line"></span><br><span class="line">scheduler.add_job(__runProxyCheck, <span class="string">'interval'</span>, minutes=<span class="number">2</span>, id=<span class="string">"proxy_check"</span>, name=<span class="string">"proxyæ£€æŸ¥"</span>)</span><br><span class="line"></span><br><span class="line">executors = &#123;</span><br><span class="line">    <span class="comment"># job_defaultsä¸­çš„max_instancesä¹Ÿå—é™äºmax_workers, æ‰€ä»¥è¦å¤§äºmax_instancesï¼›æ­¤å¤–max_workersä¹Ÿå†³å®šäº†åŒæ—¶èƒ½å¤„ç†å‡ ä¸ªåŒæ—¶å‘ç”Ÿçš„task</span></span><br><span class="line">    <span class="string">'default'</span>: &#123;<span class="string">'type'</span>: <span class="string">'threadpool'</span>, <span class="string">'max_workers'</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    <span class="string">'processpool'</span>: ProcessPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line">&#125;</span><br><span class="line">job_defaults = &#123;</span><br><span class="line">    <span class="comment"># åˆå¹¶å°†æ‰€æœ‰è¿™äº›é”™è¿‡çš„æ‰§è¡Œåˆå¹¶ä¸ºä¸€ä¸ª, é»˜è®¤ä¸ºTrueã€‚ å¦‚æœæ˜¯å®šæ—¶çš„å­˜å‚¨ä»»åŠ¡çš„è¯ï¼Œå‚æ•°è‚¯å®šä¸åŒï¼Œä¸èƒ½åˆå¹¶æ‰€ä»¥å¾—æ‰‹åŠ¨è®¾ç½®False</span></span><br><span class="line">    <span class="comment"># åƒæœ¬é¡¹ç›®æ¯éš”ä¸€æ®µæ—¶é—´æŠ“å–åˆ°çš„æ•°æ®ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥å½“ä½œä¸€æ¬¡é”™è¯¯ä»»åŠ¡åˆå¹¶</span></span><br><span class="line">    <span class="string">'coalesce'</span>: <span class="keyword">False</span>,</span><br><span class="line">    <span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä½œä¸šåªå…è®¸åŒæ—¶è¿è¡Œä¸€ä¸ªå®ä¾‹ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½œä¸šå³å°†è¿è¡Œï¼Œä½†å‰ä¸€æ¬¡è¿è¡Œå°šæœªå®Œæˆï¼Œåˆ™è®¤ä¸ºæœ€è¿‘ä¸€æ¬¡è¿è¡Œå¤±è´¥ã€‚é€šè¿‡åœ¨æ·»åŠ ä½œä¸šæ—¶ä½¿ç”¨å…³é”®å­—å‚æ•°ï¼Œå¯ä»¥è®¾ç½®è°ƒåº¦ç¨‹åºå…è®¸åŒæ—¶è¿è¡Œçš„ç‰¹å®šä½œä¸šçš„æœ€å¤§å®ä¾‹æ•°ã€‚é»˜è®¤ä¸º1</span></span><br><span class="line">    <span class="string">'max_instances'</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="comment"># æ¡†æ¶ä¼šæ£€æŸ¥æ¯ä¸ªé”™è¿‡çš„æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœå½“å‰è¿˜åœ¨misfire_grace_timeæ—¶é—´å†…ï¼Œåˆ™ä¼šé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼Œè®¾é«˜ç‚¹å°±å¯ä»¥é¿å…ä»»åŠ¡è¢«æ¼æ‰æ‰§è¡Œã€‚é»˜è®¤ä¸º1</span></span><br><span class="line">    <span class="comment"># "misfire_grace_time": 5  è¯¥é¡¹ç›®æœªä½¿ç”¨ï¼Œè€Œæ˜¯é‡‡ç”¨äº†å¤šä»»åŠ¡å®ä¾‹æ¥è§„é¿ä»»åŠ¡é”™è¿‡æ‰§è¡Œ==&gt;å³å®˜æ–¹ç»™å‡ºä¸¤ç§æ–¹æ¡ˆä¸­çš„å¦ä¸€ç§ã€‚ä»»åŠ¡é”™è¿‡ä¿¡æ¯ï¼šRun time of job "say (trigger: interval[0:00:02])" was missed by 0:00:03.010383</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduler.configure(executors=executors, job_defaults=job_defaults, timezone=timezone)</span><br><span class="line">scheduler.start()</span><br></pre></td></tr></table></figure>
<p>job_defaultså‚æ•°å«ä¹‰è§<a href="https://apscheduler.readthedocs.io/en/3.x/userguide.html?highlight=max_instances#modifying-jobs" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€<a href="https://blog.csdn.net/weixin_44301439/article/details/124062178" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44301439/article/details/124062178</a></p>
<p>æ³¨ï¼š ç»è¿‡æµ‹è¯•ï¼Œåœ¨add_taskä¸­çš„funcå¦‚æœèµ·äº†å¤šä¸ªçº¿ç¨‹ï¼Œå…¶æ‰§è¡Œä¸å—é™äºscheçš„é…ç½®</p>
</li>
<li>
<p>Pythonä¸­å¦‚æœåªæ˜¯ä½¿ç”¨å…¨å±€å˜é‡åˆ™ä¸éœ€è¦ç”¨globalå£°æ˜ï¼ˆå› ä¸ºå˜é‡æœå¯»ä¼šç”±å†…å¾€å¤–ï¼‰ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ä¿®æ”¹åˆ™éœ€è¦ç”¨globalå£°æ˜ï¼Œå¦åˆ™æ— æ³•æ‰¾åˆ°ç›¸åº”å˜é‡</p>
</li>
<li>
<p>ç”Ÿæˆå™¨ï¼šä½¿ç”¨äº†yieldå…³é”®å­—çš„å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨ï¼Œç”Ÿæˆå™¨æ˜¯ä¸€ç±»ç‰¹æ®Šçš„è¿­ä»£å™¨ã€‚</p>
<p>ä½œç”¨ï¼š</p>
<ul>
<li>å¤„ç†å¤§é‡æ•°æ®ï¼šç”Ÿæˆå™¨ä¸€æ¬¡è¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œä¸æ˜¯ä¸€æ¬¡è¿”å›æ‰€æœ‰ç»“æœã€‚æ¯”å¦‚<code>sum([i for i in range(10000000000000)])</code>ä¼šå¡æœºï¼›<code>sum(i for i in range(10000000000000))</code>åˆ™ä¸ä¼š</li>
<li><a href="https://blog.csdn.net/a200822146085/article/details/89388362" target="_blank" rel="noopener">ä»£ç æ›´åŠ ç®€æ´</a>ï¼šå¯ä»¥å‡å°‘å˜é‡ã€ç©ºé—´</li>
<li>è¿­ä»£å™¨æœ¬èº«çš„ä½œç”¨</li>
</ul>
<p>yieldå…³é”®å­—æœ‰ä¸¤ç‚¹ä½œç”¨ï¼š</p>
<p>ä¿å­˜å½“å‰è¿è¡ŒçŠ¶æ€ï¼ˆ<strong>æ–­ç‚¹</strong>ï¼‰ï¼Œç„¶åæš‚åœæ‰§è¡Œï¼Œå³å°†ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰æŒ‚èµ·ï¼›å¯ä»¥ä½¿ç”¨next()å‡½æ•°è®©ç”Ÿæˆå™¨ä»æ–­ç‚¹å¤„<strong>ç»§ç»­æ‰§è¡Œ</strong>ï¼Œå³å”¤é†’ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰<br>
å°†yieldå…³é”®å­—åé¢è¡¨è¾¾å¼çš„å€¼ä½œä¸º<strong>è¿”å›å€¼è¿”å›</strong>ï¼Œæ­¤æ—¶å¯ä»¥ç†è§£ä¸ºèµ·åˆ°äº†returnçš„ä½œç”¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__runProxyFetch</span><span class="params">()</span>:</span>     </span><br><span class="line">    <span class="keyword">for</span> proxy <span class="keyword">in</span> proxy_fetcher.run():</span><br><span class="line">        proxy_queue.put(proxy)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fetcher</span><span class="params">(object)</span>:</span></span><br><span class="line">    name = <span class="string">"fetcher"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># ...</span></span><br><span class="line">        <span class="comment"># ç›¸æ¯”ä½¿ç”¨ç”Ÿæˆæ¨å¯¼å¼ return [p for p in proxy_dict.values() if DoValidator.preValidator(p.proxy)]ï¼Œ ä½¿ç”¨yieldç”Ÿæˆå™¨å¯ä»¥èŠ‚çœç©ºé—´</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> proxy_dict.values():</span><br><span class="line">                <span class="keyword">if</span> DoValidator.preValidator(_.proxy):</span><br><span class="line">                    <span class="keyword">yield</span> _</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>åº”ç”¨éƒ¨ç½²ï¼š</p>
<p>â‘ å¯¹apkæ¢æºï¼›â‘¡è®¾ç½®æ—¶åŒº</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.6</span>-alpine</span><br><span class="line"><span class="comment"># ..</span></span><br><span class="line"><span class="comment"># apk repository</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> sed -i <span class="string">'s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g'</span> /etc/apk/repositories</span></span><br><span class="line"><span class="bash"><span class="comment"># timezone</span></span></span><br><span class="line"><span class="bash">RUN apk add -U tzdata &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; apk del tzdata</span></span><br><span class="line"><span class="bash"><span class="comment"># ...</span></span></span><br><span class="line"><span class="bash">ENTRYPOINT [ <span class="string">"sh"</span>, <span class="string">"start.sh"</span> ]</span></span><br></pre></td></tr></table></figure>
<p><code>docker-compose.yml</code>ï¼š é•œåƒè¿˜æ²¡ç¼–è¯‘å¥½çš„æƒ…å†µã€‚ï¼ˆå¦‚æœè‡ªå·±æ”¹äº†åŠŸèƒ½å¹¶å¯ç”¨çš„è¯ï¼Œéœ€è¦ç”¨è¿™ç§ï¼›æˆ–è€…è‡ªå·±å‘å¸ƒé•œåƒåç”¨åä¸€ç§ï¼‰</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  proxy_pool:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">proxy_pool</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5010:5010"</span></span><br><span class="line"><span class="attr">    links:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">proxy_redis</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="attr">      DB_CONN:</span> <span class="string">"redis://@proxy_redis:6379/0"</span></span><br><span class="line"><span class="attr">  proxy_redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">"redis"</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">proxy_redis</span></span><br></pre></td></tr></table></figure>
<p><code>docker-compose.yml</code>ï¼šåˆ«äººé•œåƒå·²ç»ç¼–è¯‘å¥½å¹¶ä¸Šä¼ </p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">    expose:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="number">6379</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">jhao104/proxy_pool</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">DB_CONN=redis://redis:6379/0</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5010:5010"</span></span><br><span class="line"><span class="attr">    depends_on:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">redis</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="schedulerçš„é€»è¾‘"><a class="markdownIt-Anchor" href="#schedulerçš„é€»è¾‘"></a> schedulerçš„é€»è¾‘</h3>
<p><img src="/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/E:%5Chexo%5Csource_posts%5C%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95%5Cproxy_pool%E6%97%B6%E5%BA%8F%E5%9B%BE.png" alt="proxy_poolæ—¶åºå›¾"></p>
<h3 id="é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™"><a class="markdownIt-Anchor" href="#é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™"></a> é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™ï¼š</h3>
<ul>
<li>settings: é…ç½®æ–‡ä»¶</li>
<li>mainï¼šå¯åŠ¨æ–‡ä»¶</li>
<li>apiï¼šæä¾›è·å–proxyæ•°æ®æ¥å£</li>
<li>handler:
<ul>
<li>loggerHandlerï¼šæ—¥å¿—ç±»</li>
<li>configHandlerï¼šå•ä¾‹çš„é…ç½®æ¥å£ç±»</li>
<li>ProxyHandler: Proxy CRUDæ“ä½œç±»</li>
</ul>
</li>
<li>fetcher: ä»£ç†æ•°æ®è·å–ç±»</li>
<li>db:
<ul>
<li>dbClinetï¼š å­˜å‚¨åŠŸèƒ½æ¥å£ç±»</li>
<li>redisClientï¼šå­˜å‚¨åŠŸèƒ½å®ç°ç±»</li>
</ul>
</li>
<li>helper
<ul>
<li>scheduler: å®šæ—¶ä»»åŠ¡çš„å®šä¹‰ä¸å¯åŠ¨ç±»</li>
<li>validator: proxyæœ‰æ•ˆæ€§æ ¡éªŒç±»</li>
<li>check: å…·ä½“æ‰§è¡Œæ ¡éªŒé€»è¾‘ç±»</li>
<li>proxy: è·å–çš„proxyæ•°æ®å°è£…ç±»</li>
</ul>
</li>
<li>utils:
<ul>
<li>lazyPropertyï¼š æ‡’åŠ è½½æè¿°å™¨</li>
<li>singleton: å•ä¾‹ç®¡ç†å™¨ç±»</li>
<li>sixï¼š python2ä¸python3å…¼å®¹ç±»</li>
<li>webRequest: ç½‘ç»œè¯·æ±‚å°è£…ç±»</li>
</ul>
</li>
</ul>
<h2 id="æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ä¸‰æ»‘å—ç¼ºå£è¯†åˆ«"><a class="markdownIt-Anchor" href="#æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ä¸‰æ»‘å—ç¼ºå£è¯†åˆ«"></a> æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸‰ï¼‰ï¼šæ»‘å—ç¼ºå£è¯†åˆ«</h2>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸¤å¼ å›¾ç‰‡ï¼š1. å¸¦ç¼ºå£çš„èƒŒæ™¯å›¾ï¼›2. ä¸ä¹‹å¯¹åº”çš„æ¥å£å›¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">imshow</span><span class="params">(img, winname=<span class="string">'test'</span>, delay=<span class="number">0</span>)</span>:</span></span><br><span class="line">    <span class="string">"""cv2å±•ç¤ºå›¾ç‰‡"""</span></span><br><span class="line">    cv2.imshow(winname, img)</span><br><span class="line">    cv2.waitKey(delay)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pil_to_cv2</span><span class="params">(img)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    pilè½¬cv2å›¾ç‰‡</span></span><br><span class="line"><span class="string">    :param img: pilå›¾åƒ, &lt;type 'PIL.JpegImagePlugin.JpegImageFile'&gt;</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    img = cv2.cvtColor(np.asarray(img), cv2.COLOR_RGB2BGR)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_cv2</span><span class="params">(img)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    äºŒè¿›åˆ¶å›¾ç‰‡è½¬cv2</span></span><br><span class="line"><span class="string">    :param img: äºŒè¿›åˆ¶å›¾ç‰‡æ•°æ®, &lt;type 'bytes'&gt;</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># å°†å›¾ç‰‡å­—èŠ‚ç bytes, è½¬æ¢æˆä¸€ç»´çš„numpyæ•°ç»„åˆ°ç¼“å­˜ä¸­</span></span><br><span class="line">    img_buffer_np = np.frombuffer(img, dtype=np.uint8)</span><br><span class="line">    <span class="comment"># ä»æŒ‡å®šçš„å†…å­˜ç¼“å­˜ä¸­è¯»å–ä¸€ç»´numpyæ•°æ®, å¹¶æŠŠæ•°æ®è½¬æ¢(è§£ç )æˆå›¾åƒçŸ©é˜µæ ¼å¼</span></span><br><span class="line">    img_np = cv2.imdecode(img_buffer_np, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> img_np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv2_open</span><span class="params">(img, flag=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ç»Ÿä¸€è¾“å‡ºå›¾ç‰‡æ ¼å¼ä¸ºcv2å›¾åƒ, &lt;type 'numpy.ndarray'&gt;</span></span><br><span class="line"><span class="string">    :param img: &lt;type 'bytes'/'numpy.ndarray'/'str'/'Path'/'PIL.JpegImagePlugin.JpegImageFile'&gt;</span></span><br><span class="line"><span class="string">    :param flag: é¢œè‰²ç©ºé—´è½¬æ¢ç±»å‹, default: None</span></span><br><span class="line"><span class="string">        eg: cv2.COLOR_BGR2GRAYï¼ˆç°åº¦å›¾ï¼‰</span></span><br><span class="line"><span class="string">    :return: cv2å›¾åƒ, &lt;numpy.ndarray&gt;</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(img, bytes):</span><br><span class="line">        img = bytes_to_cv2(img)</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, (str, Path)):</span><br><span class="line">        img = cv2.imread(str(img))</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, np.ndarray):</span><br><span class="line">        img = img</span><br><span class="line">    <span class="keyword">elif</span> isinstance(img, PIL.Image):</span><br><span class="line">        img = pil_to_cv2(img)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f'è¾“å…¥çš„å›¾ç‰‡ç±»å‹æ— æ³•è§£æ: <span class="subst">&#123;type(img)&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">        img = cv2.cvtColor(img, flag)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_distance</span><span class="params">(bg, tp, im_show=False, save_path=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :param bg: èƒŒæ™¯å›¾è·¯å¾„æˆ–Pathå¯¹è±¡æˆ–å›¾ç‰‡äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="string">        eg: 'assets/bg.jpg'</span></span><br><span class="line"><span class="string">            Path('assets/bg.jpg')</span></span><br><span class="line"><span class="string">    :param tp: ç¼ºå£å›¾è·¯å¾„æˆ–Pathå¯¹è±¡æˆ–å›¾ç‰‡äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="string">        eg: 'assets/tp.jpg'</span></span><br><span class="line"><span class="string">            Path('assets/tp.jpg')</span></span><br><span class="line"><span class="string">    :param im_show: æ˜¯å¦æ˜¾ç¤ºç»“æœ, &lt;type 'bool'&gt;; default: False</span></span><br><span class="line"><span class="string">    :param save_path: ä¿å­˜è·¯å¾„, &lt;type 'str'/'Path'&gt;; default: None</span></span><br><span class="line"><span class="string">    :return: ç¼ºå£ä½ç½®</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># è¯»å–å›¾ç‰‡</span></span><br><span class="line">    bg_gray = cv2_open(bg, flag=cv2.COLOR_BGR2GRAY)</span><br><span class="line">    tp_gray = cv2_open(tp, flag=cv2.COLOR_BGR2GRAY)</span><br><span class="line">    <span class="comment"># è¾¹ç¼˜æ£€æµ‹</span></span><br><span class="line">    tp_gray = cv2.Canny(tp_gray, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">    bg_gray = cv2.Canny(bg_gray, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">    <span class="comment"># ç›®æ ‡åŒ¹é…</span></span><br><span class="line">    result = cv2.matchTemplate(bg_gray, tp_gray, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">    <span class="comment"># è§£æåŒ¹é…ç»“æœ</span></span><br><span class="line">    min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(result)</span><br><span class="line"></span><br><span class="line">    distance = max_loc[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> save_path <span class="keyword">or</span> im_show:</span><br><span class="line">        <span class="comment"># éœ€è¦ç»˜åˆ¶çš„æ–¹æ¡†é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">        tp_height, tp_width = tp_gray.shape[:<span class="number">2</span>]</span><br><span class="line">        <span class="comment"># çŸ©å½¢å·¦ä¸Šè§’ç‚¹ä½ç½®</span></span><br><span class="line">        x, y = max_loc</span><br><span class="line">        <span class="comment"># çŸ©å½¢å³ä¸‹è§’ç‚¹ä½ç½®</span></span><br><span class="line">        _x, _y = x + tp_width, y + tp_height</span><br><span class="line">        <span class="comment"># ç»˜åˆ¶çŸ©å½¢</span></span><br><span class="line">        bg_img = cv2_open(bg)</span><br><span class="line">        cv2.rectangle(bg_img, (x, y), (_x, _y), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">2</span>)</span><br><span class="line">        <span class="comment"># ä¿å­˜ç¼ºå£è¯†åˆ«ç»“æœåˆ°èƒŒæ™¯å›¾</span></span><br><span class="line">        <span class="keyword">if</span> save_path:</span><br><span class="line">            save_path = Path(save_path).resolve()</span><br><span class="line">            save_path = save_path.parent / <span class="string">f"<span class="subst">&#123;save_path.stem&#125;</span>.<span class="subst">&#123;distance&#125;</span><span class="subst">&#123;save_path.suffix&#125;</span>"</span></span><br><span class="line">            save_path = save_path.__str__()</span><br><span class="line">            cv2.imwrite(save_path, bg_img)</span><br><span class="line">        <span class="comment"># æ˜¾ç¤ºç¼ºå£è¯†åˆ«ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> im_show:</span><br><span class="line">            imshow(bg_img)</span><br><span class="line">    <span class="keyword">return</span> distance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d = get_distance(</span><br><span class="line">        bg=<span class="string">'assets/bg.jpg'</span>,</span><br><span class="line">        tp=<span class="string">'assets/tp.png'</span>,</span><br><span class="line">        im_show=<span class="keyword">True</span>,</span><br><span class="line">        save_path=<span class="string">'assets/bg.jpg'</span></span><br><span class="line">    )</span><br><span class="line">    print(d)</span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼ä»£ç ï¼š<strong><a href="https://github.com/lixi5338619/lxBook" target="_blank" rel="noopener">lxBook</a></strong></p>
<p>ç›¸å…³æ–‡ç« ï¼š</p>
<ol>
<li><a href="https://blog.csdn.net/qq_42857999/article/details/121586389" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸€ï¼‰ï¼šASTè¿˜åŸæ··æ·†JS</a></li>
<li><a href="https://blog.csdn.net/qq_42857999/article/details/121628908" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆäºŒï¼‰ï¼šç¼ºå£å›¾ç‰‡è¿˜åŸ</a></li>
<li><a href="https://blog.csdn.net/qq_42857999/article/details/121635961" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸‰ï¼‰ï¼šæ»‘å—ç¼ºå£è¯†åˆ«</a></li>
<li><a href="https://blog.csdn.net/qq_42857999/article/details/121659205" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆå››ï¼‰ï¼šæ»‘å—è½¨è¿¹æ„é€ </a></li>
<li><a href="https://blog.csdn.net/qq_42857999/article/details/121674134" target="_blank" rel="noopener">æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆäº”ï¼‰ï¼šè¯·æ±‚åˆ†æåŠåŠ å¯†å‚æ•°ç ´è§£</a></li>
</ol>
<h1 id="æœºå™¨å­¦ä¹ "><a class="markdownIt-Anchor" href="#æœºå™¨å­¦ä¹ "></a> æœºå™¨å­¦ä¹ </h1>
<h2 id="cardrecorder"><a class="markdownIt-Anchor" href="#cardrecorder"></a> <strong><a href="https://github.com/ZDZX-T/cardRecorder" target="_blank" rel="noopener">cardRecorder</a></strong></h2>
<blockquote>
<p>é€šè¿‡pyautoGUIå®ç°çš„æ–—åœ°ä¸»è®°ç‰Œå™¨ï¼Œæä¾›äº†tkinterçš„ç•Œé¢</p>
</blockquote>
<ul>
<li>
<p>ä½¿ç”¨pyAutoGuiæ‰¾åˆ°ç±»ä¼¼çš„å›¾ç‰‡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment"># è¿›è¡Œæˆªå›¾</span></span><br><span class="line">   img = pyautogui.screenshot(region=myPos)</span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰æ’ç±»å‹    </span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> myCardsNum.keys():</span><br><span class="line">       <span class="comment"># è¿›è¡Œå®šä½, æ‰¾åˆ°pics\\m1.pngåœ¨å½“å‰å›¾ç‰‡imgé‡Œçš„ä½ç½®</span></span><br><span class="line">       result = pyautogui.locateAll(needleImage=<span class="string">'pics\\m'</span> + i + <span class="string">'.png'</span>, haystackImage=img, confidence=myConfidence)</span><br><span class="line">       </span><br><span class="line">       myCardsNum[i] = cardsFilter(list(result), myFilter)</span><br></pre></td></tr></table></figure>
<p>pyautoGUIå›¾ç‰‡è¯†åˆ«åŠŸèƒ½ä»‹ç»ï¼š</p>
<blockquote>
<p>PyAutoGUIå¯ä»¥æˆªå–å±å¹•æˆªå›¾ï¼ˆæˆªå›¾ï¼‰ï¼Œå°†å…¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å±å¹•ä¸­æŸ¥æ‰¾å›¾åƒ(å®šä½)ã€‚</p>
</blockquote>
<ul>
<li>æˆªå›¾</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆªå…¨å±</span></span><br><span class="line">pg.screenshot()  <span class="comment"># åªä¼šä¿å­˜åˆ°å†…å­˜ï¼Œä¸ä¼šç¼“å­˜åˆ°æœ¬åœ°</span></span><br><span class="line">pg.screenshot(<span class="string">'data/screenshot.jpg'</span>)  <span class="comment"># æŒ‡å®šè·¯å¾„ï¼Œåˆ™ä¼šä¿å­˜åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="comment"># æŒ‰ç…§æŒ‡å®šåŒºåŸŸæˆªå±, region(xåæ ‡,yåæ ‡,å®½åº¦,é«˜åº¦)ï¼Œåæ ‡ä¸ºæŒ‡å®šæˆªå›¾çš„å·¦ä¸Šè§’åæ ‡</span></span><br><span class="line">pg.screenshot(imageFilename=<span class="string">'data/screenshot.jpeg'</span>, region=(<span class="number">300</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">500</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>å›¾ç‰‡å®šä½</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨å±å¹•ä¸­åŒ¹é…å›¾ç‰‡ï¼Œå¹¶è¿”å›ä½ç½®ç›¸å…³æ•°æ®ï¼ŒåŒ¹é…ä¸åˆ°åˆ™è¿”å› None</span></span><br><span class="line">locate_1 = pg.locateOnScreen(image=<span class="string">'data/test.png'</span>)</span><br><span class="line">print(locate_1)  <span class="comment"># Box(left=177, top=614, width=43, height=37)</span></span><br><span class="line">print(locate_1.left)  <span class="comment"># 177  å¯ä»¥é€šè¿‡ .left ç­‰å±æ€§è·å–ç›¸åº”çš„å€¼</span></span><br><span class="line">print(locate_1[<span class="number">0</span>])  <span class="comment"># 177  ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–ç›¸åº”çš„å€¼</span></span><br><span class="line"><span class="comment"># â€œæ¨¡ç³Šâ€åŒ¹é…  --  å¯ä»¥ä½¿ç”¨å‚æ•° confidence æ¥æŒ‡å®šæ¨¡ç³Šç¨‹åº¦ï¼Œé»˜è®¤æ˜¯ 1ï¼ŒèŒƒå›´æ˜¯ 0 - 1ï¼ˆå½“ç„¶ï¼Œå¤ªä½å°±æ²¡æ„ä¹‰äº†ï¼‰, ä½¿ç”¨è¯¥å‚æ•°è¦æ±‚å·²ç»å®‰è£…å¥½ openCV</span></span><br><span class="line"><span class="comment"># è¿™é‡Œçš„è·¯å¾„å…³é”®å­—æ˜¯ imageï¼Œå’Œä¸Šé¢çš„ imageFilename ä¸åŒï¼Œæ‰€ä»¥å»ºè®®ä¸è¦å†™å…³é”®å­—ï¼Œç›´æ¥å†™è·¯å¾„å°±å¥½ï¼Œé˜²æ­¢å†™é”™</span></span><br><span class="line">locate_2 = pg.locateOnScreen(image=<span class="string">'data/test.png'</span>, confidence=<span class="number">0.9</span>)</span><br><span class="line"><span class="comment"># è¿”å›åŒ¹é…åˆ°çš„å›¾ç‰‡çš„ä¸­å¿ƒä½ç½®åæ ‡</span></span><br><span class="line">center_point_1 = pg.center(locate_1)</span><br><span class="line">print(center_point_1)  <span class="comment"># Point(x=198, y=632)</span></span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šå±å¹•æˆªå›¾åŠŸèƒ½éœ€è¦Pillowæ¨¡å—ã€ç½®ä¿¡åº¦éœ€è¦cv</p>
<p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/math98/p/14399644.html" target="_blank" rel="noopener">PyAutoGui å›¾ç‰‡è¯†åˆ«+å®šä½+æˆªå›¾å‡½æ•°æ–‡æ¡£</a>ã€<a href="https://zhuanlan.zhihu.com/p/417147884" target="_blank" rel="noopener">pyautogui çš„æˆªå›¾åŠå›¾ç‰‡åŒ¹é…</a>ã€<a href="https://www.cnblogs.com/gexbooks/p/10790063.html" target="_blank" rel="noopener">pyautogui æ–‡æ¡£ï¼ˆäº”ï¼‰ï¼šæˆªå›¾åŠå®šä½åŠŸèƒ½</a></p>
</li>
<li>
<p>tkinterä½¿ç”¨:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å˜é‡ä½¿ç”¨</span></span><br><span class="line">num_8 = tkinter.StringVar()  <span class="comment"># 8</span></span><br><span class="line">num_8.set(strCards[<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">root = tkinter.Tk()</span><br><span class="line"><span class="comment"># æ˜¾ç¤º</span></span><br><span class="line">x_start = <span class="number">20</span></span><br><span class="line">y_start = <span class="number">5</span></span><br><span class="line">x_add = <span class="number">30</span></span><br><span class="line">x_dif = <span class="number">2</span></span><br><span class="line">y_dif = <span class="number">25</span></span><br><span class="line"><span class="comment"># æ ‡ç­¾</span></span><br><span class="line">tkinter.Label(root, text=<span class="string">'å¤§'</span>, font=(<span class="string">''</span>, <span class="number">14</span>), width=<span class="number">1</span>).place(x=x_start, y=y_start)</span><br><span class="line"><span class="comment"># è¾“å…¥æ¡†</span></span><br><span class="line">tkinter.Entry(root, textvariable=num_dw, font=(<span class="string">''</span>, <span class="number">14</span>), width=<span class="number">1</span>).place(x=x_start + x_dif, y=y_start + y_dif)</span><br><span class="line"><span class="comment"># è¿›è¡Œå¾ªç¯ç­‰å¾…äº‹ä»¶å‘ç”Ÿ</span></span><br><span class="line">root.main_loop()</span><br></pre></td></tr></table></figure>
<p>å¸ƒå±€</p>
<ul>
<li>pack()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…ä¹‹å‰ï¼Œè§„åˆ’æ­¤æ§ä»¶åœ¨åŒºå—å†…çš„ä½ç½®ã€‚</li>
<li>grid()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…ä¹‹å‰ï¼Œè§„åˆ’æ­¤æ§ä»¶ä¸ºä¸€ä¸ªç½‘æ ¼ç±»å‹çš„æ¶æ„ã€‚</li>
<li>place()ï¼šå°†æ§ä»¶æ”¾ç½®åœ¨çˆ¶æ§ä»¶å†…çš„ç‰¹å®š(æŒ‡å®š)ä½ç½®ã€‚</li>
</ul>
</li>
</ul>
<h2 id="wiki_zh_word2vec"><a class="markdownIt-Anchor" href="#wiki_zh_word2vec"></a> <strong><a href="https://github.com/AimeeLee77/wiki_zh_word2vec" target="_blank" rel="noopener">wiki_zh_word2vec</a></strong></h2>
<blockquote>
<p>åˆ©ç”¨Pythonæ„å»ºWikiä¸­æ–‡è¯­æ–™è¯å‘é‡æ¨¡å‹è¯•éªŒâ€”â€”æ‰¾åˆ°ç»™å®šè¯ç›¸ä¼¼çš„è¯è¯­</p>
<p>ä»£ç æ¶‰åŠï¼šå¼€å‘ç¯å¢ƒå‡†å¤‡ã€æ•°æ®çš„è·å–ã€æ•°æ®çš„é¢„å¤„ç†ã€æ¨¡å‹æ„å»ºå’Œæ¨¡å‹æµ‹è¯•å››å¤§å†…å®¹ï¼Œå¯¹åº”çš„æ˜¯å®ç°æ¨¡å‹æ„å»ºçš„äº”ä¸ªæ­¥éª¤ã€‚</p>
</blockquote>
<ol>
<li>
<p>å¼€å‘ç¯å¢ƒå‡†å¤‡: Python + gensim (NLPç¥å™¨åº“) +jieba + <a href="https://bintray.com/package/files/byvoid/opencc/OpenCC" target="_blank" rel="noopener">OpenCC</a>(ä¸­æ–‡ç¹ä½“æ›¿æ¢æˆç®€ä½“)</p>
</li>
<li>
<p>æ•°æ®è·å–: åˆ°wikiå®˜ç½‘ä¸‹è½½<a href="https://dumps.wikimedia.org/zhwiki/latest/zhwiki-latest-pages-articles.xml.bz2" target="_blank" rel="noopener">ä¸­æ–‡è¯­æ–™</a>ã€å°†XMLçš„Wikiæ•°æ®è½¬æ¢ä¸ºtextæ ¼å¼ï¼Œä½¿ç”¨åˆ°äº†gensim.corporaä¸­çš„WikiCorpuså‡½æ•°</p>
</li>
<li>
<p>Wikiæ•°æ®é¢„å¤„ç†ï¼šâ‘ ä½¿ç”¨OpenCCè¿›è¡Œç¹ç®€è½¬æ¢ï¼›â‘¡jiebaåˆ†è¯</p>
</li>
<li>
<p>Word2Vecæ¨¡å‹è®­ç»ƒï¼šåˆ†å¥½è¯çš„æ–‡æ¡£å³å¯è¿›è¡Œword2vecè¯å‘é‡æ¨¡å‹çš„è®­ç»ƒäº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®­ç»ƒskip-gramæ¨¡å‹</span></span><br><span class="line">model = Word2Vec(LineSentence(inp), size=<span class="number">400</span>, window=<span class="number">5</span>, min_count=<span class="number">5</span>,</span><br><span class="line">                 workers=multiprocessing.cpu_count())</span><br><span class="line">   </span><br><span class="line"><span class="comment"># ä¿å­˜æ¨¡å‹</span></span><br><span class="line">model.save(outp1)</span><br><span class="line">model.wv.save_word2vec_format(outp2, binary=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<p>ä»£ç è¿è¡Œå®Œæˆåå¾—åˆ°å¦‚ä¸‹å››ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­wiki.zh.text.modelæ˜¯å»ºå¥½çš„æ¨¡å‹ï¼Œwiki.zh.text.vectoræ˜¯è¯å‘é‡ã€‚</p>
</li>
<li>
<p>æ¨¡å‹æµ‹è¯•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">model = gensim.models.Word2Vec.load(fdir + <span class="string">'wiki.zh.text.model'</span>)</span><br><span class="line">word = model.most_similar(<span class="string">u"è¶³çƒ"</span>)</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> word:</span><br><span class="line">    <span class="keyword">print</span> (t[<span class="number">0</span>],t[<span class="number">1</span>])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è¶³çƒè¿åŠ¨ 0.531202495098</span></span><br><span class="line"><span class="string">å›½é™…è¶³çƒ 0.510423064232</span></span><br><span class="line"><span class="string">è¶³çƒæ¯”èµ› 0.499910503626</span></span><br><span class="line"><span class="string">å›½å®¶è¶³çƒé˜Ÿ 0.488919615746</span></span><br><span class="line"><span class="string">æ’çƒ 0.488108128309</span></span><br><span class="line"><span class="string">ç”·ä½“å­ç¯®çƒ0.482638418674</span></span><br><span class="line"><span class="string">ä½“è‚² 0.47221454978</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>é™„ï¼šä»€ä¹ˆæ˜¯è¯å‘é‡? â€”â€”è¯å‘é‡æŠ€æœ¯æ˜¯å°†è¯è½¬åŒ–æˆä¸ºç¨ å¯†å‘é‡ï¼Œå¹¶ä¸”å¯¹äºç›¸ä¼¼çš„è¯ï¼Œå…¶å¯¹åº”çš„è¯å‘é‡ä¹Ÿç›¸è¿‘ã€‚</p>
<p>åœ¨<a href="https://so.csdn.net/so/search?q=%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener">è‡ªç„¶è¯­è¨€å¤„ç†</a>ä»»åŠ¡ä¸­ï¼Œé¦–å…ˆéœ€è¦è€ƒè™‘è¯å¦‚ä½•åœ¨è®¡ç®—æœºä¸­è¡¨ç¤ºã€‚é€šå¸¸ï¼Œæœ‰ä¸¤ç§è¡¨ç¤ºæ–¹å¼ï¼š</p>
<ul>
<li>one-hot representation(ç¦»æ•£è¡¨ç¤º)
<ul>
<li>ä¼ ç»Ÿçš„åŸºäºè§„åˆ™æˆ–åŸºäºç»Ÿè®¡çš„è‡ªç„¶è¯­ä¹‰å¤„ç†æ–¹æ³•å°†å•è¯çœ‹ä½œä¸€ä¸ªåŸå­ç¬¦å·</li>
<li>æŠŠæ¯ä¸ªè¯è¡¨ç¤ºä¸ºä¸€ä¸ªé•¿å‘é‡ã€‚è¿™ä¸ªå‘é‡çš„ç»´åº¦æ˜¯è¯è¡¨å¤§å°ï¼Œå‘é‡ä¸­åªæœ‰ä¸€ä¸ªç»´åº¦çš„å€¼ä¸º1ï¼Œå…¶ä½™ç»´åº¦ä¸º0ï¼Œè¿™ä¸ªç»´åº¦å°±ä»£è¡¨äº†å½“å‰çš„è¯ã€‚</li>
<li>one-hot representationç›¸å½“äºç»™æ¯ä¸ªè¯åˆ†é…ä¸€ä¸ªidï¼Œè¿™å°±å¯¼è‡´è¿™ç§è¡¨ç¤ºæ–¹å¼ä¸èƒ½å±•ç¤ºè¯ä¸è¯ä¹‹é—´çš„å…³ç³»ã€‚å¦å¤–ï¼Œone-hot representationå°†ä¼šå¯¼è‡´ç‰¹å¾ç©ºé—´éå¸¸å¤§ï¼Œä½†ä¹Ÿå¸¦æ¥ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œå¾ˆå¤šåº”ç”¨ä»»åŠ¡çº¿æ€§å¯åˆ†ã€‚</li>
</ul>
</li>
<li>distribution representation(åˆ†å¸ƒå¼è¡¨ç¤º)
<ul>
<li>word embeddingæŒ‡çš„æ˜¯å°†è¯è½¬åŒ–æˆä¸€ç§åˆ†å¸ƒå¼è¡¨ç¤ºï¼Œåˆç§°è¯å‘é‡ã€‚åˆ†å¸ƒå¼è¡¨ç¤ºå°†è¯è¡¨ç¤ºæˆä¸€ä¸ªå®šé•¿çš„è¿ç»­çš„ç¨ å¯†å‘é‡ã€‚</li>
<li>åˆ†å¸ƒå¼è¡¨ç¤ºä¼˜ç‚¹:
<ol>
<li>è¯ä¹‹é—´å­˜åœ¨ç›¸ä¼¼å…³ç³»ï¼šæ˜¯è¯ä¹‹é—´å­˜åœ¨â€œè·ç¦»â€æ¦‚å¿µï¼Œè¿™å¯¹å¾ˆå¤šè‡ªç„¶è¯­è¨€å¤„ç†çš„ä»»åŠ¡éå¸¸æœ‰å¸®åŠ©ã€‚</li>
<li>åŒ…å«æ›´å¤šä¿¡æ¯ï¼šè¯å‘é‡èƒ½å¤ŸåŒ…å«æ›´å¤šä¿¡æ¯ï¼Œå¹¶ä¸”æ¯ä¸€ç»´éƒ½æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚åœ¨é‡‡ç”¨one-hotç‰¹å¾æ—¶ï¼Œå¯ä»¥å¯¹ç‰¹å¾å‘é‡è¿›è¡Œåˆ å‡ï¼Œè¯å‘é‡åˆ™ä¸èƒ½ã€‚</li>
</ol>
</li>
</ul>
</li>
</ul>
<h1 id="ç³»ç»Ÿè®¾è®¡"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿè®¾è®¡"></a> ç³»ç»Ÿè®¾è®¡</h1>
<h2 id="python-è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·"><a class="markdownIt-Anchor" href="#python-è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·"></a> <a href="https://pythondict.com/python-work/screen-translate-tools/" target="_blank" rel="noopener">Python è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·</a></h2>
<p>ç¨‹åºçš„åŠŸèƒ½ä¸»è¦ç”±3ä¸ªæ¨¡å—ç»„æˆ</p>
<ol>
<li>
<p>screenshotï¼šæˆªå›¾</p>
<blockquote>
<p>ä½¿ç”¨Pillowåº“</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…PILä¾èµ–: pip install pillow</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step1: ä»å‰ªåˆ‡æ¿è¯»å–å›¾ç‰‡</span></span><br><span class="line">img = ImageGrab.grabclipboard()</span><br><span class="line"><span class="comment"># ä¿å­˜åˆ°æœ¬åœ° or å†…å­˜ä¸­</span></span><br><span class="line">image_result = <span class="string">'./temp.png'</span></span><br><span class="line">img.save(image_result)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>recognitionï¼šå°†æˆªå›¾ä¸­çš„é—®é¢˜è¯†åˆ«æˆæ–‡å­—</p>
<blockquote>
<p>ä½¿ç”¨easyocræˆ–è€…pytesseract</p>
</blockquote>
<p>easyocrï¼š</p>
<ul>
<li>ç¼–ç¨‹ä½¿ç”¨</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå®‰è£…æ‰€éœ€è¦çš„æ¨¡å‹æ–‡ä»¶, ä¹Ÿå¯ä»¥è‡ªå·±ä¸‹è½½åæ”¾åˆ°å¯¹åº”è·¯å¾„ä¸‹</span></span><br><span class="line"><span class="comment"># Windowsï¼šC:\Users\ç”¨æˆ·å.EasyOCR\model</span></span><br><span class="line"><span class="comment"># Linuxï¼š~/ .EasyOCR / model</span></span><br><span class="line">reader = easyocr.Reader([<span class="string">'ch_sim'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨GPUï¼Œçœ‹æ˜¯å¦ä¼šæœ‰æç¤º CUDA not available</span></span><br><span class="line"><span class="comment"># reader = easyocr.Reader(['ch_sim'])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒåŒæ—¶å¤šä¸ªè¯­è¨€, è™½ç„¶å¯ä»¥ä¸€æ¬¡æ€§è¯†åˆ«è®¸å¤šç§è¯­è¨€ï¼Œ</span></span><br><span class="line"><span class="comment"># ä½†å¹¶éæ‰€æœ‰è¯­è¨€éƒ½å¯ä»¥ä¸€èµ·ç”¨ï¼Œé€šå¸¸æ˜¯å…¬å…±è¯­è¨€å’Œä¸€ä¸ªç‰¹æ®Šè¯­ç§å¯ä»¥ä¸€èµ·è¯†åˆ«ï¼Œç›¸äº’å…¼å®¹ï¼Œæ¯”å¦‚è‹±è¯­å’Œæ—¥è¯­ã€‚</span></span><br><span class="line"><span class="comment"># reader = easyocr.Reader(['ch_sim','en'])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯†åˆ«</span></span><br><span class="line">resp = requests.get(<span class="string">'https://images.zsxq.com/Fsl4plilMdpd_C8gXVJT1mKJDui9?e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:Pg0990rjMMQUAlf2bJlNL9lmLSU='</span>)</span><br><span class="line">result = reader.readtext(resp.content)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<ul>
<li>å‘½ä»¤è¡Œè¿è¡Œï¼š <code>easyocr -l ch_sim en -f test.png --detail=1 --gpu=True</code></li>
</ul>
<p>å›¾ç‰‡åŠ è½½å‡½æ•°<code>readtext</code>æ¥æ”¶ä¸‰ç§å‚æ•°</p>
<ul>
<li>æ–‡ä»¶è·¯å¾„</li>
<li>å›¾ç‰‡çš„<code>np_array</code></li>
<li>å­—èŠ‚æµå¯¹è±¡</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å‰ªåˆ‡æ¿ä¸­è·å¾—å›¾ç‰‡</span></span><br><span class="line">r = easyocr.Reader([<span class="string">"ch_sim"</span>])</span><br><span class="line"></span><br><span class="line">img = ImageGrab.grabclipboard()</span><br><span class="line">print(img, type(img))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°ä¸º: file path or numpy-array or a byte stream object</span></span><br><span class="line"><span class="comment"># 1: file path</span></span><br><span class="line">img_path = <span class="string">"ttt.png"</span></span><br><span class="line">img.save(img_path)</span><br><span class="line">reg_result = r.readtext(img_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2: numpy-array</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np_img = np.array(img)</span><br><span class="line">reg_result = r.readtext(np_img)</span><br><span class="line">print(reg_result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3: a byte stream object</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">resp = requests.get(<span class="string">'https://images.zsxq.com/Fsl4plilMdpd_C8gXVJT1mKJDui9?e=1656604799&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zD:Pg0990rjMMQUAlf2bJlNL9lmLSU='</span>)</span><br><span class="line">reg_result = r.readtext(resp.content)</span><br><span class="line">print(reg_result)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Translationï¼šå°†æ–‡å­—ç¿»è¯‘</p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨ç½‘ä¸Šçš„æœ‰é“ç¿»è¯‘APIã€æˆ–è€…ç›´æ¥ä½¿ç”¨Googleæä¾›çš„ç¿»è¯‘åº“<code>googletrans</code></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Googleç¿»è¯‘</span></span><br><span class="line">translator = Translator(service_urls=[<span class="string">'translate.google.cn'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¿»è¯‘æˆä¸­æ–‡</span></span><br><span class="line">content_chinese = translator.translate(content_eng, src=<span class="string">'en'</span>, dest=<span class="string">'zh-cn'</span>).text</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>GUIï¼šå°†ç¿»è¯‘åçš„ç»“æœå±•ç¤º</p>
<blockquote>
<p>ä½¿ç”¨ Python è‡ªå¸¦çš„ GUI tkinkerï¼Œå°†è¯†åˆ«åçš„ä¸­æ–‡æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line">root = Tk()</span><br><span class="line">root.withdraw()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç¿»è¯‘åçš„ç»“æœï¼Œä»¥å¯¹è¯æ¡†çš„å½¢å¼</span></span><br><span class="line">tkinter.messagebox.showinfo(<span class="string">'ç¿»è¯‘ç»“æœ'</span>, content_chinese)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å®Œæ•´ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab, Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = easyocr.Reader(["ch_sim"])</span></span><br><span class="line">r = easyocr.Reader([<span class="string">"en"</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">screenShot</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""1. ä»å‰ªåˆ‡æ¿ä¸­è·å¾—å›¾ç‰‡"""</span></span><br><span class="line">    img = ImageGrab.grabclipboard()</span><br><span class="line">    print(img, type(img))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identify</span><span class="params">(img: Image)</span>:</span></span><br><span class="line">    <span class="string">"""2. è¯†åˆ«æ–‡å­—"""</span></span><br><span class="line">    <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">    np_img = np.array(img)</span><br><span class="line">    reg_result = r.readtext(np_img)</span><br><span class="line">    rs = sorted(reg_result, key=<span class="keyword">lambda</span> x: x[<span class="number">2</span>], reverse=<span class="keyword">True</span>)[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translate</span><span class="params">(rs: str)</span>:</span></span><br><span class="line">    <span class="string">"""3. ç¿»è¯‘ï¼šgoogletrans åº“"""</span></span><br><span class="line">    <span class="keyword">from</span> googletrans <span class="keyword">import</span> Translator</span><br><span class="line">    <span class="comment"># Googleç¿»è¯‘</span></span><br><span class="line">    translator = Translator(service_urls=[<span class="string">'translate.google.cn'</span>])</span><br><span class="line">    <span class="comment"># ç¿»è¯‘æˆä¸­æ–‡</span></span><br><span class="line">    translated_str = translator.translate(rs, src=<span class="string">'en'</span>, dest=<span class="string">'zh-cn'</span>).text</span><br><span class="line">    <span class="keyword">return</span> translated_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showText</span><span class="params">(s: str)</span>:</span></span><br><span class="line">    <span class="string">"""4. tkå±•ç¤º"""</span></span><br><span class="line">    <span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line">    <span class="keyword">from</span> tkinter.messagebox <span class="keyword">import</span> showinfo  <span class="comment"># å¼¹çª—åº“</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰¾åˆ°ä¸»åº”ç”¨</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    <span class="comment"># éšè—ä¸»ç•Œé¢</span></span><br><span class="line">    root.withdraw()</span><br><span class="line">    print(s)</span><br><span class="line">    showinfo(<span class="string">"ç¿»è¯‘ç»“æœ"</span>, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    img = screenShot()</span><br><span class="line">    <span class="comment"># è¯†åˆ«å‡ºæ¥çš„æ–‡å­—</span></span><br><span class="line">    rs = identify(img)</span><br><span class="line">    translated_str = translate(rs)</span><br><span class="line">    showText(translated_str)</span><br></pre></td></tr></table></figure>
<h2 id="system-design-primer"><a class="markdownIt-Anchor" href="#system-design-primer"></a> <strong><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">system-design-primer</a></strong></h2>
<h2 id="go-package-plantuml"><a class="markdownIt-Anchor" href="#go-package-plantuml"></a> <strong><a href="https://github.com/qquunn/go-package-plantuml" target="_blank" rel="noopener"> go-package-plantuml</a></strong></h2>
<ul>
<li>goä¸­çš„argueparserï¼š<code>&quot;import github.com/jessevdk/go-flags&quot;</code>ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰flagã€pflagæ¥å¤„ç†è¾“å…¥å‚æ•°</li>
</ul>
<h2 id="id-maker"><a class="markdownIt-Anchor" href="#id-maker"></a> <a href="https://github.com/yongxinz/id-maker" target="_blank" rel="noopener">id-maker</a></h2>
<h2 id="health_checker"><a class="markdownIt-Anchor" href="#health_checker"></a> <a href="https://github.com/Freedomisgood/When_Coding_in_ZJU/blob/main/Health_Checkin/health_checkin_helper_cst.py" target="_blank" rel="noopener">health_checker</a></h2>
<blockquote>
<p>æµ™å¤§çš„ç™»é™†åŠ å¯†</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pythonè½¬ä¹‰å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_rsa_encrypt</span><span class="params">(self, password_str, e_str, M_str)</span>:</span></span><br><span class="line">    <span class="comment"># å°†strè½¬åŒ–ä¸ºasciiçš„å­—èŠ‚</span></span><br><span class="line">    password_bytes = bytes(password_str, <span class="string">'ascii'</span>)</span><br><span class="line">    <span class="comment"># å¤§ç«¯å¡«å……</span></span><br><span class="line">    password_int = int.from_bytes(password_bytes, <span class="string">'big'</span>)</span><br><span class="line">    <span class="comment"># å°†å…¶æŒ‰ç…§16è¿›åˆ¶çš„å½¢å¼è½¬æˆ10è¿›åˆ¶</span></span><br><span class="line">    e_int = int(e_str, <span class="number">16</span>)</span><br><span class="line">    M_int = int(M_str, <span class="number">16</span>)</span><br><span class="line">    <span class="comment"># password_int^e%M</span></span><br><span class="line">    result_int = pow(password_int, e_int, M_int)</span><br><span class="line">    <span class="comment"># 10è¿›åˆ¶è½¬æˆ16è¿›åˆ¶str, å¹¶ rjust() è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å³å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">    <span class="comment"># "hello".rjust(8, "0") ==&gt; 000hello</span></span><br><span class="line">    <span class="keyword">return</span> hex(result_int)[<span class="number">2</span>:].rjust(<span class="number">128</span>, <span class="string">'0'</span>)</span><br></pre></td></tr></table></figure>
<p>JsåŠ å¯†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">RSAUtils.encryptedString = <span class="function"><span class="keyword">function</span>(<span class="params">key, s</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = [];</span><br><span class="line">    <span class="comment">// sä¸ºåå‘çš„password, å¦‚321321aaa</span></span><br><span class="line">	<span class="keyword">var</span> sl = s.length;</span><br><span class="line">	<span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (i &lt; sl) &#123;</span><br><span class="line">		a[i] = s.charCodeAt(i);</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// è¡¥è¶³0</span></span><br><span class="line">	<span class="keyword">while</span> (a.length % key.chunkSize != <span class="number">0</span>) &#123;</span><br><span class="line">		a[i++] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// a ==&gt; 321312aaa000000 çš„ asciiå­—ç¬¦æ•°ç»„</span></span><br><span class="line">	<span class="keyword">var</span> al = a.length;</span><br><span class="line">	<span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">var</span> j, k, block;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; al; i += key.chunkSize) &#123;</span><br><span class="line">		block = <span class="keyword">new</span> BigInt();</span><br><span class="line">		j = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (k = i; k &lt; i + key.chunkSize; ++j) &#123;</span><br><span class="line">			block.digits[j] = a[k++];</span><br><span class="line">			block.digits[j] += a[k++] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">var</span> crypt = key.barrett.powMod(block, key.e);</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">var</span> text = key.radix == <span class="number">16</span> ? RSAUtils.biToHex(crypt) : RSAUtils.biToString(crypt, key.radix);</span><br><span class="line">		result += text + <span class="string">" "</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result.substring(<span class="number">0</span>, result.length - <span class="number">1</span>); <span class="comment">// Remove last space.</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>new BigInt();</code>å¾—åˆ°çš„æ˜¯digits.len=130çš„intæ•°ç»„</li>
</ul>
<h2 id="cookiecutter-golang"><a class="markdownIt-Anchor" href="#cookiecutter-golang"></a> <strong><a href="https://github.com/lacion/cookiecutter-golang" target="_blank" rel="noopener">cookiecutter-golang</a></strong></h2>
<blockquote>
<p>å¿«é€Ÿç”ŸæˆGoé¡¹ç›®çš„cookiecutteræ¨¡æ¿</p>
</blockquote>
<ul>
<li><a href="https://github.com/lacion/cookiecutter-golang/blob/master/%7B%7Bcookiecutter.app_name%7D%7D/main.go" target="_blank" rel="noopener">cobarä½¿ç”¨</a>ä¸<a href="https://github.com/lacion/cookiecutter-golang/blob/master/%7B%7Bcookiecutter.app_name%7D%7D/cmd/root.go" target="_blank" rel="noopener">cobarå‘½ä»¤å®šä¹‰</a>ï¼Œç›¸å½“äºPythonä¸­çš„Clickæ¨¡å—</li>
</ul>
<h2 id="dddd_trainer"><a class="markdownIt-Anchor" href="#dddd_trainer"></a> <strong><a href="https://github.com/sml2h3/dddd_trainer" target="_blank" rel="noopener"> dddd_trainer</a></strong></h2>
<ul>
<li>
<p>Cliå‘½ä»¤ä½¿ç”¨fireåº“ï¼šfireæ˜¯pythonä¸­ç”¨äºç”Ÿæˆå‘½ä»¤è¡Œç•Œé¢(Command Line Interfaces, CLIs)çš„å·¥å…·ï¼Œä¸éœ€è¦åšä»»ä½•é¢å¤–çš„å·¥ä½œï¼Œåªéœ€è¦ä»ä¸»æ¨¡å—ä¸­è°ƒç”¨fire.Fire()ï¼Œå®ƒä¼šè‡ªåŠ¨å°†ä½ çš„ä»£ç è½¬åŒ–ä¸ºCLIï¼Œ<u>Fire()çš„å‚æ•°å¯ä»¥è¯´ä»»ä½•çš„pythonå¯¹è±¡</u></p>
<p>ç‰¹ç‚¹ï¼šæ‰€æœ‰çš„<strong>å­å‘½ä»¤</strong>éƒ½èƒ½ä»¥å‡½æ•°ã€ç±»ç­‰å½¢å¼ä¹¦å†™ï¼Œæµç¨‹å’Œå‚æ•°è·å–éƒ½æ¯”è¾ƒæ¸…æ™°ï¼›ä¼ å‚å¯ä»¥è‡ªåŠ¨è¢«è§£ææˆPythonç±»å‹ï¼šå­—ç¬¦ä¸²ã€å…ƒç»„ã€åˆ—è¡¨ã€å­—å…¸</p>
<p>â˜…ä½¿ç”¨æŒ‡å—ï¼š <a href="https://blog.csdn.net/qq_17550379/article/details/79943740" target="_blank" rel="noopener">https://blog.csdn.net/qq_17550379/article/details/79943740</a></p>
</li>
<li>
<p><a href="https://www.jianshu.com/p/476478c17b8e" target="_blank" rel="noopener">ONNXRuntime</a>ï¼š é€šå¸¸æˆ‘ä»¬åœ¨è®­ç»ƒæ¨¡å‹æ—¶å¯ä»¥ä½¿ç”¨å¾ˆå¤šä¸åŒçš„æ¡†æ¶ï¼Œæ¯”å¦‚æœ‰çš„åŒå­¦å–œæ¬¢ç”¨ <code>Pytorch</code>ï¼Œæœ‰çš„åŒå­¦å–œæ¬¢ä½¿ç”¨ <code>TensorFLow</code>ï¼Œä¹Ÿæœ‰çš„å–œæ¬¢ <code>MXNet</code>ï¼Œä»¥åŠæ·±åº¦å­¦ä¹ æœ€å¼€å§‹æµè¡Œçš„ <code>Caffe</code>ç­‰ç­‰ï¼Œè¿™æ ·ä¸åŒçš„è®­ç»ƒæ¡†æ¶å°±å¯¼è‡´äº†äº§ç”Ÿä¸åŒçš„æ¨¡å‹ç»“æœåŒ…ï¼Œåœ¨æ¨¡å‹è¿›è¡Œéƒ¨ç½²æ¨ç†æ—¶å°±éœ€è¦ä¸åŒçš„ä¾èµ–åº“ï¼Œè€Œä¸”åŒä¸€ä¸ªæ¡†æ¶æ¯”å¦‚<code>tensorflow</code> ä¸åŒçš„ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚è¾ƒå¤§ï¼Œ ä¸ºäº†è§£å†³è¿™ä¸ªæ··ä¹±é—®é¢˜ï¼Œ<a href="https://links.jianshu.com/go?to=https%3A%2F%2Flfaidata.foundation%2F" target="_blank" rel="noopener">LF AI</a> è¿™ä¸ªç»„ç»‡è”åˆ Facebook, MicroSoftç­‰å…¬å¸åˆ¶å®šäº†æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ ‡å‡†ï¼Œè¿™ä¸ªæ ‡å‡†å«åš<strong>ONNX, Open Neural Network Exchage</strong>ï¼Œ<em>æ‰€æœ‰å…¶ä»–æ¡†æ¶äº§ç”Ÿçš„æ¨¡å‹åŒ… (<code>.pth</code>, <code>.pb</code>) éƒ½å¯ä»¥è½¬æ¢æˆè¿™ä¸ªæ ‡å‡†æ ¼å¼ï¼Œè½¬æ¢æˆè¿™ä¸ªæ ‡å‡†æ ¼å¼åï¼Œå°±å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„ ONNX Runtimeç­‰å·¥å…·è¿›è¡Œç»Ÿä¸€éƒ¨ç½²ã€‚</em></p>
</li>
<li>
<p><a href="https://pythondict.com/life-intelligent/tools/loguru/" target="_blank" rel="noopener">Loguru â€” æœ€å¼ºå¤§çš„ Python æ—¥å¿—è®°å½•å™¨</a>ï¼š å¼ºå¤§çš„å…¨å±€æ—¥å¿—å¯¹è±¡ï¼Œå…·æœ‰å¼€ç®±å³ç”¨çš„ç‰¹æ€§ã€ç¾è§‚çš„è¾“å‡ºï¼Œæ”¯æŒ<code>f-string</code>ã€æ”¯æŒåœ¨ä¸»è¿›ç¨‹å’Œçº¿ç¨‹ä¸­æ•è·å¼‚å¸¸</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">logger.add(<span class="string">"file.log"</span>, rotation=<span class="string">"12:00"</span> , format=<span class="string">"&#123;time:YYYY-MM-DD at HH:mm:ss&#125; | &#123;level&#125; | &#123;message&#125;"</span>, level=<span class="string">"INFO"</span>)</span><br><span class="line">logger.info(<span class="string">"That's it, beautiful and simple logging!"</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="njupt-api"><a class="markdownIt-Anchor" href="#njupt-api"></a> <strong><a href="https://github.com/gaoliang/NJUPT-API" target="_blank" rel="noopener">NJUPT-API</a></strong></h2>
<blockquote>
<p>å—äº¬é‚®ç”µå¤§å­¦ç½‘ç«™æ¥å£, Pythonæ¨¡å—</p>
</blockquote>
<ul>
<li>
<p><code>@login_required</code> è£…é¥°å™¨: ç”±äºæœ‰äº›æ“ä½œå¿…é¡»ç™»å½•åæ‰ä¼šæœ‰æ­£ç¡®ç»“æœï¼Œæ‰€ä»¥ç›¸å½“äºåœ¨æ‰§è¡Œå‰åšäº†ä¸€å±‚æ ¡éªŒï¼ˆè‡³äºæŠ›å‡ºå¼‚å¸¸orè½¬å‘ç™»å½•å°±çœ‹è£…é¥°å™¨ä¸­æ€ä¹ˆå†™äº†ï¼‰â€”&gt; ç”±äºæ˜¯å°è£…æˆäº†packageåº“ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€å±‚éœ€è¦è¿›è¡Œé™åˆ¶ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_required</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.verified:</span><br><span class="line">            self.login_by_sso()</span><br><span class="line">        <span class="keyword">return</span> func(self, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>setuptoolsä½¿ç”¨</p>
<ul>
<li><a href="http://setup.py" target="_blank" rel="noopener">setup.py</a></li>
<li><a href="http://MANIFEST.in" target="_blank" rel="noopener">MANIFEST.in</a></li>
</ul>
</li>
<li>
<p>æ¨¡å—æš´éœ²ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># njupt/__init__.py</span></span><br><span class="line"><span class="keyword">from</span> njupt.card <span class="keyword">import</span> Card  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.zhengfang <span class="keyword">import</span> Zhengfang  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.library <span class="keyword">import</span> Library  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.runningman <span class="keyword">import</span> RunningMan  <span class="comment"># noqa</span></span><br><span class="line"><span class="keyword">from</span> njupt.sso <span class="keyword">import</span> SSO  <span class="comment"># noqa</span></span><br><span class="line"><span class="comment"># è¡¨ç¤ºnjuptæ¨¡å—æä¾›ä»¥ä¸‹5ä¸ªæ¥å£</span></span><br><span class="line">__all__ = [<span class="string">'SSO'</span>, <span class="string">'Card'</span>, <span class="string">'Zhengfang'</span>, <span class="string">'Library'</span>, <span class="string">'RunningMan'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>éªŒè¯ç è¯†åˆ«</p>
<blockquote>
<p>å­—ç¬¦å‹éªŒè¯ç ï¼šæŠŠå›¾ç‰‡å»å™ªã€åˆ†å‰²ã€å½’ç±»ã€‚æ”¶é›†äº†è¶³å¤Ÿå¤šçš„æ ·æœ¬ï¼Œç„¶åå¯¹æ–°çš„å›¾ç‰‡ä¹Ÿåˆ†å‰²ã€‚å°†åˆ†éš”åçš„æ¯ä¸ªå­—ç¬¦ä¸æ ·æœ¬é›†åŒ¹é…ï¼Œé€‰æ¦‚ç‡æœ€å¤§çš„å­—ç¬¦ï¼Œå°†ç»„åˆ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CardCaptcha</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ä¸€å¡é€šç³»ç»Ÿçš„éªŒè¯ç å·¥å…·ç±»</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, im)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param im: PIL.imageå¯¹è±¡</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.im = im.convert(<span class="string">'L'</span>)</span><br><span class="line">        self.image_pre_process()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">image_pre_process</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># äºŒå€¼åŒ–, å»é™¤æ‚è‰²ç‚¹</span></span><br><span class="line">        threshold = <span class="number">200</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(self.im.width):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(self.im.height):</span><br><span class="line">                pix = self.im.getpixel((x, y))</span><br><span class="line">                <span class="keyword">if</span> pix &gt; threshold:</span><br><span class="line">                    self.im.putpixel((x, y), BLACK)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.im.putpixel((x, y), WHITE)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_split_image</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># åˆ‡å‰²éªŒè¯ç ï¼Œè¿”å›åŒ…å«äº”ä¸ªå­—ç¬¦å›¾åƒçš„åˆ—è¡¨</span></span><br><span class="line">        y_min, y_max = <span class="number">0</span>, <span class="number">82</span></span><br><span class="line">        <span class="comment"># å­—ç¬¦ä½ç½®å¤§è‡´å›ºå®š([7,49], [49, 91], ...)</span></span><br><span class="line">        split_lines = [<span class="number">7</span>, <span class="number">49</span>, <span class="number">91</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">217</span>]</span><br><span class="line">        ims = [self.im.crop([u, y_min, v, y_max]) <span class="keyword">for</span> u, v <span class="keyword">in</span> zip(split_lines[:<span class="number">-1</span>], split_lines[<span class="number">1</span>:])]</span><br><span class="line">        <span class="keyword">return</span> ims</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">crack</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="comment"># è£…è½½è®­ç»ƒæ•°æ®é›†</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(current_dir, <span class="string">'image_data.json'</span>), <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            image_data = json.load(f)</span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> self.handle_split_image():</span><br><span class="line">            <span class="comment"># build_vectorå°†å›¾ç‰‡è½¬æˆä¸€ç»´å‘é‡: for pixel in image.getdata():</span></span><br><span class="line">            letter_vector = build_vector(letter)</span><br><span class="line">            guess = []</span><br><span class="line">            <span class="comment"># åœ¨æ¨¡å‹æ•°æ®ä¸­, æ‰¾ä¸€ä¸ªæ±‰æ˜è·ç¦»æœ€å°(æœ€åƒçš„ç»“æœ)</span></span><br><span class="line">            <span class="keyword">for</span> image <span class="keyword">in</span> image_data:</span><br><span class="line">                <span class="comment"># xä¸ºkey, å½“å‰åŒ¹é…çš„å­—ç¬¦; yä¸ºå‘é‡</span></span><br><span class="line">                <span class="keyword">for</span> x, y <span class="keyword">in</span> image.items():</span><br><span class="line">                    <span class="keyword">if</span> len(y) != <span class="number">0</span>:</span><br><span class="line">                        <span class="comment"># è®¡ç®—ä¸¤ä¸ªä¸€ç»´å‘é‡çš„æ±‰æ˜è·ï¼ˆå‘é‡åªåŒ…å«0ï¼Œ1æ—¶ï¼‰:(åªè¦å…ƒç´ å€¼ä¸ç­‰, è·ç¦»å°±+1)</span></span><br><span class="line">                        guess.append((distance_hanmming(y, letter_vector), x))</span><br><span class="line">            guess.sort()</span><br><span class="line">            <span class="comment"># æ‰¾å‡ºè·ç¦»æœ€å°çš„, å³æœ€åŒ¹é…çš„å­—ç¬¦</span></span><br><span class="line">            result.append(guess[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.crack()</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šPILä¸­image.convert()å‡½æ•°ä½¿ç”¨</p>
<ol>
<li>æ¨¡å¼â€œ1â€ï¼šä¸ºäºŒå€¼å›¾åƒï¼Œéé»‘å³ç™½ã€‚ä½†æ˜¯å®ƒæ¯ä¸ªåƒç´ ç”¨8ä¸ªbitè¡¨ç¤ºï¼Œ0è¡¨ç¤ºé»‘ï¼Œ255è¡¨ç¤ºç™½ã€‚</li>
<li>æ¨¡å¼â€œLâ€ï¼š ä¸ºç°è‰²å›¾åƒï¼Œå®ƒçš„æ¯ä¸ªåƒç´ ç”¨8ä¸ªbitè¡¨ç¤ºï¼Œ0è¡¨ç¤ºé»‘ï¼Œ255è¡¨ç¤ºç™½ï¼Œå…¶ä»–æ•°å­—è¡¨ç¤ºä¸åŒçš„ç°åº¦ã€‚åœ¨PILä¸­ï¼Œä»æ¨¡å¼â€œRGBâ€è½¬æ¢ä¸ºâ€œLâ€æ¨¡å¼æ˜¯æŒ‰ç…§ä¸‹é¢çš„å…¬å¼è½¬æ¢çš„ï¼š<code>L = R * 299/1000 + G * 587/1000+ B * 114/1000</code></li>
<li>æ¨¡å¼â€œPâ€ä¸º8ä½å½©è‰²å›¾åƒã€æ¨¡å¼â€œRGBAâ€(alphaé€æ˜åº¦)ä¸º32ä½å½©è‰²å›¾åƒã€æ¨¡å¼â€œCMYKâ€ä¸º32ä½å½©è‰²å›¾åƒ</li>
</ol>
</li>
<li>
<p>è‡ªåˆ¶æ‰“ç å·¥å…·</p>
<ol>
<li><code>captcha_getter.py</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®å›¾ç‰‡è‡ªå·±è¾“å…¥è¯†åˆ«ç»“æœ, å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥, å›¾ç‰‡åä¸ºæ­£ç¡®çš„æ‰“ç ç»“æœ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaGUI</span>:</span></span><br><span class="line">    BASE_URL = <span class="string">"http://yktapp.njupt.edu.cn:8070"</span></span><br><span class="line">    CAPTCHA_URL = BASE_URL + <span class="string">"/Login/GetValidateCode"</span></span><br><span class="line">    LOGIN_URL = BASE_URL + <span class="string">"/Login/LoginBySnoQuery"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.s = requests.session()</span><br><span class="line">        self.r = self.s.get(self.CAPTCHA_URL)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line">        self.root = tkinter.Tk()</span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel = tkinter.Label(self.root, image=self.tkimg)</span><br><span class="line">        self.imgLabel.pack()</span><br><span class="line">        self.message = tkinter.Entry(self.root)</span><br><span class="line">        self.message.pack()</span><br><span class="line">        self.root.bind(<span class="string">'&lt;Return&gt;'</span>, self.judge_and_save)</span><br><span class="line">        self.root.mainloop()</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">judge_and_save</span><span class="params">(self, event)</span>:</span></span><br><span class="line">        <span class="comment"># è¾“å‡ºè¾“å…¥æ¡†çš„å†…å®¹</span></span><br><span class="line">        captcha_value = self.message.get()</span><br><span class="line">        print(captcha_value)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"sno"</span>: self.account,</span><br><span class="line">            <span class="string">"pwd"</span>: base64.b64encode(self.pwd.encode(<span class="string">"utf8"</span>)),</span><br><span class="line">            <span class="string">"ValiCode"</span>: captcha_value,</span><br><span class="line">            <span class="string">"remember"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"uclass"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"zqcode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"json"</span>: <span class="keyword">True</span>,</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="comment"># åªæœ‰è¾“å…¥æ­£ç¡®çš„æ‰ä¿å­˜</span></span><br><span class="line">        r = self.s.post(self.LOGIN_URL, data=data)</span><br><span class="line">        <span class="keyword">if</span> r.json()[<span class="string">"IsSucceed"</span>]:</span><br><span class="line">            print(<span class="string">"æˆåŠŸï¼"</span>)</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">"captchas/&#123;&#125;.gif"</span>.format(captcha_value), <span class="string">'wb+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(self.r.content)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(r.json())</span><br><span class="line">            print(<span class="string">"éªŒè¯ç è¾“é”™äº†"</span>)</span><br><span class="line">		<span class="comment"># åˆ·æ–°, è¿›è¡Œæ‰“ç ä¸‹ä¸€å¼ </span></span><br><span class="line">        self.r = self.s.get(self.CAPTCHA_URL)</span><br><span class="line">        self.im = Image.open(BytesIO(self.r.content))</span><br><span class="line">        <span class="comment"># åˆ·æ–°å›¾ç‰‡æ¡†</span></span><br><span class="line">        self.tkimg = ImageTk.PhotoImage(self.im)</span><br><span class="line">        self.imgLabel.config(image=self.tkimg)</span><br><span class="line">        <span class="comment"># â–². å°†è¾“å…¥æ¡†æ¸…ç©º</span></span><br><span class="line">        self.message.delete(<span class="number">0</span>, <span class="string">'end'</span>)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><code>captcha_gen.py</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spilt2chars</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ†å‰²å·²æœ‰çš„æ•°æ®ä¸ºå­—ç¬¦å¹¶ä¿å­˜</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        shutil.rmtree(<span class="string">'captcha_chars'</span>)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    os.mkdir(<span class="string">"captcha_chars"</span>)</span><br><span class="line">    values = <span class="string">"1234567890"</span></span><br><span class="line">    <span class="comment"># æ¯ä¸ªå­—ç¬¦åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> values:</span><br><span class="line">        os.mkdir(<span class="string">'captcha_chars/&#123;&#125;'</span>.format(value))</span><br><span class="line"></span><br><span class="line">    file_names = os.listdir(<span class="string">'captchas'</span>)</span><br><span class="line">    <span class="comment"># éå†æ‰€æœ‰å­—ç¬¦æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names: </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(<span class="string">'captchas/&#123;&#125;'</span>.format(file_name)) <span class="keyword">and</span> file_name != <span class="string">'.DS_Store'</span>:</span><br><span class="line">            <span class="comment"># è·å¾—æ‰“ç imgçš„å›¾ç‰‡åç§°(æ­£ç¡®ç»“æœ)</span></span><br><span class="line">            values = file_name[:<span class="number">4</span>]</span><br><span class="line">            im = Image.open(<span class="string">'captchas/&#123;&#125;'</span>.format(file_name))</span><br><span class="line">            captcha = CardCaptcha(im)</span><br><span class="line">            <span class="comment"># handle_split_imageä¸ºåˆ‡å‰²åçš„å››ä¸ªå­—ç¬¦å›¾ç‰‡, valuesä¸º3fgcçš„å€¼</span></span><br><span class="line">            <span class="keyword">for</span> im_part, value <span class="keyword">in</span> zip(captcha.handle_split_image(), values):</span><br><span class="line">                <span class="comment"># è¿›è¡Œmd5éšæœºå–åä¿å­˜</span></span><br><span class="line">                m = hashlib.md5()</span><br><span class="line">                m.update(<span class="string">"&#123;&#125;&#123;&#125;"</span>.format(time.time(), value).encode(<span class="string">'utf8'</span>))</span><br><span class="line">                <span class="comment"># captcha_chars/3/asdz.png</span></span><br><span class="line">                im_part.save(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;.png"</span>.format(value, m.hexdigest()))</span><br><span class="line">                </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_models</span><span class="params">()</span>:</span></span><br><span class="line">    iconset = list(<span class="string">'0123456789'</span>)</span><br><span class="line">    <span class="comment"># å°†å›¾åƒæ•°æ®è½¬ä¸ºå‘é‡æ•°æ®å¹¶ä¿å­˜</span></span><br><span class="line">    image_data = []</span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> iconset:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># éå†å­—ç¬¦3ä¸‹é¢æ‰€æœ‰çš„å›¾ç‰‡</span></span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> os.listdir(<span class="string">'captcha_chars/&#123;&#125;/'</span>.format(letter)):</span><br><span class="line">                <span class="keyword">if</span> img != <span class="string">"Thumbs.db"</span> <span class="keyword">and</span> img != <span class="string">".DS_Store"</span>:</span><br><span class="line">                    <span class="comment"># å¾—åˆ°å…¶å›¾ç‰‡å‘é‡</span></span><br><span class="line">                    temp = build_vector(Image.open(<span class="string">"captcha_chars/&#123;&#125;/&#123;&#125;"</span>.format(letter, img)))</span><br><span class="line">                    <span class="comment"># models_listä¸­æ·»åŠ [&#123;1: [0,1,1...]&#125;]</span></span><br><span class="line">                    image_data.append(&#123;letter: temp&#125;)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            print(letter)</span><br><span class="line">	image_data = [ &#123;<span class="number">1</span>: [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,...]&#125;, &#123;<span class="number">1</span>: [<span class="number">1</span>,<span class="number">0</span>,...]&#125;, ..., &#123;<span class="number">2</span>: [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,...]&#125;]</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'image_data.json'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(image_data, f)</span><br></pre></td></tr></table></figure>
<p>é™„ï¼šæ‰¾åˆ°æœ€åˆé€‚çš„æ—‹è½¬è§’åº¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotate_img</span><span class="params">(image)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ ¹æ®å›¾åƒåœ¨xè½´æ–¹å‘æŠ•å½±å¤§å°ç¡®å®šå­—ç¬¦çš„æ‘†æ”¾æ–¹å‘</span></span><br><span class="line"><span class="string">    -45~+45å¾ªç¯, å½“xè½´ä¸ŠæŠ•å½±å¾—åˆ°çš„ç™½è‰²åƒç´ æ•°é‡æœ€å°ï¼Œæ­¤æ—¶å°±æ˜¯æ­£ç¡®çš„è§’åº¦</span></span><br><span class="line"><span class="string">    :param image: PIL.Image object</span></span><br><span class="line"><span class="string">    :return: rotated Image object</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    min_count = <span class="number">1000</span></span><br><span class="line">    final_angle = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> angle <span class="keyword">in</span> range(<span class="number">-45</span>, <span class="number">45</span>):</span><br><span class="line">        x_count = <span class="number">0</span></span><br><span class="line">        ti = image.rotate(angle, expand=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(ti.width):</span><br><span class="line">            <span class="comment"># å½“å‰yåˆ—åªè¦æœ‰ä¸€ä¸ªåƒç´ ä¸ºwhite, é‚£ä¹ˆå°±+1ç»“æŸ, è¿›è¡Œä¸‹ä¸€åˆ—åˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(ti.height):</span><br><span class="line">                <span class="keyword">if</span> ti.getpixel((x, y)) == WHITE:</span><br><span class="line">                    x_count += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> x_count &lt; min_count:</span><br><span class="line">            min_count = x_count</span><br><span class="line">            final_angle = angle</span><br><span class="line">    image = image.rotate(final_angle, expand=<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">return</span> image</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="rss-monitor"><a class="markdownIt-Anchor" href="#rss-monitor"></a> <strong><a href="https://github.com/Freedomisgood/Rss-Monitor" target="_blank" rel="noopener">Rss-Monitor</a></strong></h2>
<blockquote>
<p>ä¸€ä¸ªé€šç”¨çš„RSSè®¢é˜…é€šçŸ¥å™¨ï¼Œå’Œ**<a href="https://github.com/DIYgod/RSSHub" target="_blank" rel="noopener">RSSHub</a>**ä¸€èµ·é£Ÿç”¨æ•ˆæœæ›´å¥½å“¦ã€‚<br>
RSS(Really Simple Syndication,ç®€æ˜“ä¿¡æ¯èšåˆ)æ˜¯ä¸€ç§æè¿°å’ŒåŒæ­¥ç½‘ç«™å†…å®¹çš„æ ¼å¼ä½ å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§å®šåˆ¶ä¸ªæ€§åŒ–æ¨é€ä¿¡æ¯çš„æœåŠ¡ã€‚å®ƒèƒ½å¤Ÿè§£å†³ä½ æ¼«æ— ç›®çš„çš„æµè§ˆç½‘é¡µçš„é—®é¢˜ã€‚</p>
</blockquote>
<ul>
<li>
<p>åŠ¨æ€å¯¼å…¥æ¨¡å—</p>
</li>
<li>
<p>è·å¾—Rssé“¾æ¥ä¿¡æ¯â€”â€”<a href="https://pypi.python.org/pypi/feedparser/" target="_blank" rel="noopener">feedparser</a>åº“</p>
<blockquote>
<p>feedparseræ˜¯ä¸€ä¸ªPythonçš„Feedè§£æåº“ï¼Œå¯ä»¥å¤„ç†RSS ï¼ŒCDFï¼ŒAtom ã€‚ä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»ä»»ä½• RSS æˆ– Atom è®¢é˜…æºå¾—åˆ°æ ‡é¢˜ã€é“¾æ¥å’Œæ–‡ç« çš„æ¡ç›®äº†ã€‚</p>
</blockquote>
<p>æ ‡å‡†çš„itemæ ¼å¼:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;![CDATA[å¦é—¨å…¬äº¤è½¦æ”¾ç«æ¡ˆæ­»è€…åå•å…¬å¸ƒ&lt;br/&gt;è­¦æ–¹å…¬å¸ƒå«ŒçŠ¯çŠ¯ç½ªè¯æ®]]&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span>&gt;</span>http://www.infzm.com/content/91404<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>&lt;![CDATA[6æœˆ11æ—¥ä¸‹åˆï¼Œå¦é—¨BRTå…¬äº¤è½¦æ”¾ç«æ¡ˆ47åæ­»äº¡è€…åå•å…¬å¸ƒã€‚å¦é—¨æ”¿åºœæ–°é—»åŠ6æœˆ10æ—¥å‘å¸ƒæ¶ˆæ¯ç§°ï¼Œæœ‰è¯æ®è¡¨æ˜ï¼Œé™ˆæ°´æ€»æºå¸¦æ±½æ²¹ä¸Šäº†é—½DY7396å…¬äº¤è½¦ã€‚ä¸”æœ‰å¤šåå¹¸å­˜è€…æŒ‡è®¤å…¶åœ¨è½¦ä¸Šçºµç«ï¼Œè‡´ä½¿æ•´éƒ¨è½¦å¼•èµ·çŒ›çƒˆç‡ƒçƒ§ã€‚ç»ç¬”è¿¹é‰´å®šï¼Œé™ˆæ°´æ€»6æœˆ7æ—¥è‡´å¦»ã€å¥³çš„ä¸¤å°ç»ç¬”ä¹¦ç³»é™ˆæ°´æ€»æœ¬äººæ‰€å†™ã€‚]]&gt;<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">category</span>&gt;</span>å—æ–¹å‘¨æœ«-çƒ­ç‚¹æ–°é—»<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">author</span>&gt;</span>infzm<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>2013-06-11 11:24:32<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>feedparseræ¨¡å—api</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> feedparser</span><br><span class="line">d=feedparser.parse(<span class="string">'http://feed.cnblogs.com/blog/sitehome/rss'</span>)</span><br><span class="line"><span class="comment"># d.feedä¸ºæ•°æ®å­—å…¸, ä¸entriesç›¸æ¯”ä¸€ä¸ªæ˜¯dictä¸€ä¸ªæ˜¯list, å…¶æ¬¡entriesä¸­æ˜¯æ›´åŠ å‡ç»ƒç‚¹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">#   è¾“å‡ºå­—å…¸ä¸­çš„é”®å€¼æœ‰å“ªäº›ï¼Œä¸€å…±æœ‰10ä¸­å¦‚ä¸‹ï¼š</span></span><br><span class="line">[<span class="string">'feed'</span>, <span class="string">'status'</span>, <span class="string">'version'</span>, <span class="string">'encoding'</span>, <span class="string">'bozo'</span>, <span class="string">'headers'</span>, <span class="string">'href'</span>, <span class="string">'namespaces'</span>, <span class="string">'entries'</span>, <span class="string">'bozo_exception'</span>]</span><br><span class="line">&#123;<span class="string">'feed'</span>: &#123;&#125;, <span class="string">'encoding'</span>: <span class="string">u'utf-8'</span>, <span class="string">'bozo'</span>: <span class="number">1</span>, <span class="string">'version'</span>: <span class="string">u''</span>, <span class="string">'namespaces'</span>: &#123;&#125;, <span class="string">'entries'</span>: [], <span class="string">'bozo_exception'</span>: SAXParseException(<span class="string">'no element found'</span>,)&#125;</span><br><span class="line"><span class="comment"># d.channelä¸‹çš„å±æ€§ä¸ºchannelä¸­ä¸­çš„å­—æ®µï¼Œæ¯”å¦‚titleã€linkã€descriptionã€generatorã€webMasterã€lastBuildDate</span></span><br><span class="line">&gt;&gt;&gt;d[<span class="string">'feed'</span>][<span class="string">'title'</span>]</span><br><span class="line"><span class="string">'åšå®¢å›­_é¦–é¡µ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.title    <span class="comment">#é€šè¿‡å±æ€§çš„æ–¹å¼è®¿é—®</span></span><br><span class="line"><span class="string">'åšå®¢å›­_é¦–é¡µ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.subtitle</span><br><span class="line"><span class="string">'ä»£ç æ”¹å˜ä¸–ç•Œ'</span></span><br><span class="line">&gt;&gt;&gt;d.feed.link</span><br><span class="line"><span class="string">'uuid:1b90fd0c-6080-4ea5-86b1-b87c64b95d69;id=4466'</span></span><br><span class="line">d.entries <span class="comment">#è¯¥å±æ€§ç±»å‹ä¸ºåˆ—è¡¨ï¼Œè¡¨ç¤ºä¸€ç»„æ–‡ç« çš„æ¡ç›®</span></span><br><span class="line">&gt;&gt;&gt;type(d.entries)    <span class="comment">#ç±»å‹ä¸ºåˆ—è¡¨, ä¸ºitemæ ‡ç­¾ä¸­çš„å†…å®¹</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">len</span><span class="params">(d.entries)</span>   #ä¸€å…±20ç¯‡æ–‡ç« </span></span><br><span class="line"><span class="class">20</span></span><br></pre></td></tr></table></figure>
<p>æ¯ä¸ªRSSå’ŒAtomè®¢é˜…æºéƒ½åŒ…å«ä¸€ä¸ªæ ‡é¢˜ï¼ˆd.feed.titleï¼‰å’Œä¸€ç»„æ–‡ç« æ¡ç›®(d.entries)</p>
<p><strong>é€šå¸¸</strong>æ¯ä¸ªæ–‡ç« æ¡ç›®éƒ½æœ‰ä¸€æ®µæ‘˜è¦ï¼ˆd.entries[i].summaryï¼‰,æˆ–è€…æ˜¯åŒ…å«äº†æ¡ç›®ä¸­å®é™…æ–‡æœ¬çš„æè¿°æ€§æ ‡ç­¾ï¼ˆd.entries[i].descriptionï¼‰</p>
</li>
<li>
<p>è‡ªå®šä¹‰æ·»åŠ Rssé“¾æ¥-&gt;<a href="https://docs.rsshub.app/joinus/quick-start.html%E3%80%81" target="_blank" rel="noopener">https://docs.rsshub.app/joinus/quick-start.htmlã€</a><a href="https://github.com/DIYgod/RSSHub/pull/1768/files#" target="_blank" rel="noopener"><br>
æ·»åŠ æµ™æ±Ÿå·¥å•†å¤§å­¦æ•™åŠ¡å¤„å’Œå­¦æ ¡é¦–é¡µé€šçŸ¥</a></p>
<blockquote>
<p>é™¤äº†æŒ‰ç…§Rsshubæ¥è‡ªå®šä¹‰Rssè®¢é˜…æºä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <a href="https://github.com/huginn/huginn" target="_blank" rel="noopener">Huginn</a>ã€Feed43ç­‰å·¥å…·ï¼Œå¦‚<a href="https://www.jianshu.com/p/1024956c8396" target="_blank" rel="noopener">ç”¨Feed43ä¸ºæ•™åŠ¡å¤„ç½‘ç«™åˆ¶ä½œRSS</a></p>
</blockquote>
<ol>
<li>
<p>æš´éœ²è·¯ç”±é“¾æ¥ï¼šåœ¨ <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/router.js" target="_blank" rel="noopener">/lib/router.js (opens new window)</a>é‡Œæ·»åŠ è·¯ç”±</p>
</li>
<li>
<p>ç¼–å†™æ•°æ®æºè„šæœ¬ï¼šåœ¨ <a href="https://github.com/DIYgod/RSSHub/tree/master/lib/routes" target="_blank" rel="noopener">/lib/routes/ (opens new window)</a>ä¸­çš„è·¯ç”±å¯¹åº”è·¯å¾„ä¸‹åˆ›å»ºæ–°çš„ js è„šæœ¬ï¼š</p>
<ol>
<li>ä½¿ç”¨ got è¯·æ±‚ HTML æ•°æ®ï¼š</li>
<li>ä½¿ç”¨ cheerio è§£æè¿”å›çš„ HTML:</li>
<li>ä½¿ç”¨ map éå†æ•°ç»„ï¼Œè§£æå‡ºæ¯ä¸€ä¸ª item çš„ç»“æœ â€”â€”å¯¹æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ï¼Œç”Ÿæˆç¬¦åˆ RSS è§„èŒƒçš„å¯¹è±¡ï¼ŒæŠŠè·å–çš„æ ‡é¢˜ã€é“¾æ¥ã€æè¿°ã€å‘å¸ƒæ—¶é—´ç­‰æ•°æ®èµ‹å€¼ç»™ ctx.state.data, <a href="https://docs.rsshub.app/joinus/quick-start.html#%E7%94%9F%E6%88%90-rss-%E6%BA%90" target="_blank" rel="noopener">ç”Ÿæˆ RSS æº</a>ï¼š</li>
</ol>
<blockquote>
<p>ç”Ÿæˆ RSS æºåŸç†ï¼šè·å–åˆ°çš„æ•°æ®èµ‹ç»™ ctx.state.data, ç„¶åæ•°æ®ä¼šç»è¿‡ <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/middleware/template.js" target="_blank" rel="noopener">template.js (opens new window)</a>ä¸­é—´ä»¶å¤„ç†ï¼Œæœ€åä¼ åˆ° <a href="https://github.com/DIYgod/RSSHub/blob/master/lib/views/rss.art" target="_blank" rel="noopener">/lib/views/rss.art (opens new window)</a>æ¥ç”Ÿæˆæœ€åçš„ RSS ç»“æœï¼Œæ¯ä¸ªå­—æ®µçš„å«ä¹‰å¦‚ä¸‹ï¼š<a href="https://docs.rsshub.app/joinus/quick-start.html#ti-jiao-xin-de-rsshub-gui-ze-bian-xie-jiao-ben" target="_blank" rel="noopener">https://docs.rsshub.app/joinus/quick-start.html#ti-jiao-xin-de-rsshub-gui-ze-bian-xie-jiao-ben</a></p>
</blockquote>
</li>
</ol>
<p>3.æ·»åŠ è„šæœ¬æ–‡æ¡£: <code>&lt;Route author=&quot;HenryQW&quot; example=&quot;/github/issue/DIYgod/RSSHub&quot; path=&quot;/github/issue/:user/:repo&quot; :paramsDesc=&quot;['ç”¨æˆ·å', 'ä»“åº“å']&quot; /&gt;</code></p>
</li>
</ul>
<h2 id="ddt-sharp-shooter"><a class="markdownIt-Anchor" href="#ddt-sharp-shooter"></a> <strong><a href="https://github.com/boring-plans/ddt-sharp-shooter" target="_blank" rel="noopener"> ddt-sharp-shooter</a></strong></h2>
<blockquote>
<p>ä½¿ç”¨åˆ°çš„åº“: <code>screeninfoã€pillowã€ddddocrã€pynput</code></p>
<ul>
<li>pynput: æ§åˆ¶å’Œç›‘è§†è¾“å…¥è®¾å¤‡ï¼›ç±»ä¼¼çš„æœ‰PyHook3ï¼ˆç›‘è§†é”®é¼ ï¼‰ã€pywin32 ï¼ˆæ¨¡æ‹Ÿé”®é¼ ï¼‰</li>
<li>ddddocrï¼šè¯†åˆ«éªŒè¯ç ï¼Œè¿™è¾¹ç”¨æ¥è¯†åˆ«æ•°å­—</li>
</ul>
</blockquote>
<ol>
<li>
<p>è¿›ç¨‹é—´é€šä¿¡ã€‚ Tkinterç•Œé¢å¼€å¯mainloopè¿›ç¨‹ï¼Œå…¶ä¸­åˆå¼€è¾Ÿå‡ºä¸€ä¸ªå­çº¿ç¨‹æ¥ä¾¦å¬å…¶ä»–è¿›ç¨‹å‘é€çš„æ•°æ®æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡<code>tk.Text</code>æ§ä»¶æ¥å±•ç¤º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="comment"># å£°æ˜å…¨å±€å¯¹è±¡åŠç±»å‹</span></span><br><span class="line">_tk: tkinter.Tk</span><br><span class="line">_text: tkinter.Text</span><br><span class="line">_terminate = <span class="keyword">False</span></span><br><span class="line">_queue: multiprocessing.Queue</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_text</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""å­çº¿ç¨‹ä¾¦å¬è¿›ç¨‹æ¶ˆæ¯"""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> _terminate:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _queue.empty():</span><br><span class="line">            text = _queue.get(<span class="keyword">False</span>)</span><br><span class="line">            append_text(text)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_text</span><span class="params">(text)</span>:</span></span><br><span class="line">    _text.config(state=<span class="string">'normal'</span>)</span><br><span class="line">    _text.insert(<span class="string">'end'</span>, <span class="string">f'\n<span class="subst">&#123;text&#125;</span>'</span>)</span><br><span class="line">    _text.see(<span class="string">'end'</span>)</span><br><span class="line">    _text.config(state=<span class="string">'disabled'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(gui_queue)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> _tk, _text, _queue, _screen_size</span><br><span class="line">    _queue = gui_queue</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    threading.Thread(target=update_text).start()</span><br><span class="line">    </span><br><span class="line">    _tk.mainloop()</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>py2app setup</code>ï¼Œåœ¨macosä¸‹åˆ›å»ºpythonåº”ç”¨ï¼Œ <code>python setup.py py2app</code></p>
</li>
<li>
<p>å¯¹çº¯æ•°å­—è¯†åˆ«ç»“æœè¿›è¡Œæ¸…æ´—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recognize_digits</span><span class="params">(image: bytes)</span>:</span></span><br><span class="line">    ocr = ddddocr.DdddOcr(show_ad=<span class="keyword">False</span>)</span><br><span class="line">    result = ocr.classification(image)</span><br><span class="line">    <span class="keyword">return</span> wash_digits(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wash_digits</span><span class="params">(digits: str)</span>:</span></span><br><span class="line">    <span class="string">"""ç”±äºä¸ä¼šå‡ºç°éæ•°å­—, æ‰€ä»¥å¯¹æ˜“è¯†åˆ«é”™è¯¯çš„å­—ç¬¦è¿›è¡Œæ›¿æ¢"""</span></span><br><span class="line">    washed = digits \</span><br><span class="line">        .replace(<span class="string">'g'</span>, <span class="string">'9'</span>).replace(<span class="string">'q'</span>, <span class="string">'9'</span>) \</span><br><span class="line">        .replace(<span class="string">'l'</span>, <span class="string">'1'</span>).replace(<span class="string">'i'</span>, <span class="string">'1'</span>) \</span><br><span class="line">        .replace(<span class="string">'z'</span>, <span class="string">'2'</span>) \</span><br><span class="line">        .replace(<span class="string">'o'</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r'\D'</span>, <span class="string">'0'</span>, washed)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="æ–‡ç« è®°å½•"><a class="markdownIt-Anchor" href="#æ–‡ç« è®°å½•"></a> æ–‡ç« è®°å½•</h1>
<h2 id="githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®"><a class="markdownIt-Anchor" href="#githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®"></a> Githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®</h2>
<ul>
<li><strong><a href="https://github.com/danistefanovic/build-your-own-x" target="_blank" rel="noopener">build-your-own-x</a></strong>â€”â€”è‡ªå·±é€ è½®å­</li>
<li><strong><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">system-design-primer</a></strong>â€”â€”ç³»ç»Ÿæ¶æ„è®¾è®¡</li>
<li><strong><a href="https://github.com/doocs/advanced-java" target="_blank" rel="noopener">advanced-java</a></strong>â€”â€”äº’è”ç½‘ Java å·¥ç¨‹å¸ˆè¿›é˜¶çŸ¥è¯†å®Œå…¨æ‰«ç›²</li>
<li><a href="https://juejin.cn/post/6844903624062009352" target="_blank" rel="noopener">https://juejin.cn/post/6844903624062009352</a></li>
<li></li>
</ul>
<h2 id="goå¥½ç”¨çš„ä¸‰æ–¹åº“"><a class="markdownIt-Anchor" href="#goå¥½ç”¨çš„ä¸‰æ–¹åº“"></a> Goå¥½ç”¨çš„ä¸‰æ–¹åº“</h2>
<ul>
<li>
<p>ä¸°å¯ŒåŸç”Ÿæ•°æ®ç»“æ„mapã€sliceçš„å·¥å…·åº“ï¼š<a href="https://github.com/samber/lo" target="_blank" rel="noopener">https://github.com/samber/lo</a></p>
</li>
<li>
<p>è¾“å…¥å‚æ•°è§£æåº“: <a href="https://github.com/jessevdk/go-flags" target="_blank" rel="noopener">go-flags</a></p>
</li>
<li>
<p>æ“ä½œexcelçš„åº“ï¼š<a href="https://github.com/qax-os/excelize" target="_blank" rel="noopener">excelize</a></p>
</li>
</ul>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://nymrli.top">Mrli</a></p><p> <span>Link:  </span><a href="https://nymrli.top/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/">https://nymrli.top/2022/03/29/å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2022/04/04/PlantUMLä½œå›¾/" title="PlantUMLä½œå›¾"><span>< PreviousPost</span><br><span class="prevTitle">PlantUMLä½œå›¾</span></a><a class="nextSlogan" href="/2022/03/19/2022å¹´3æœˆ19æ—¥-20æ—¥çˆ¬è™«é¡¹ç›®è®°å½•/" title="2022å¹´3æœˆ19~20æ—¥-çˆ¬è™«é¡¹ç›®è®°å½•"><span>NextPost ></span><br><span class="nextTitle">2022å¹´3æœˆ19~20æ—¥-çˆ¬è™«é¡¹ç›®è®°å½•</span></a><div class="clear"></div></div><div id="comment"><div id="container"></div><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>var gitment = new Gitment({
  id: 'å¼€æºé¡¹ç›®ä»£ç é˜…è¯»è®°å½•',
  owner: 'Freedomisgood',
  repo: 'Freedomisgood.github.io',
  oauth: {
    client_id: 'bc5a81fe36017dcd8b63',
    client_secret: '949cec3a1b91742c6249c47259791e4b80a6fa69',
  },
})
gitment.render('container')</script></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><p class="beian"><span>å¤‡æ¡ˆå·:è‹ICPå¤‡18015439å·</span></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 60vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#çˆ¬è™«ç³»åˆ—"><span class="toc-number">1.</span> <span class="toc-text"> çˆ¬è™«ç³»åˆ—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æŠ¢è´­-ç§’æ€"><span class="toc-number">1.1.</span> <span class="toc-text"> æŠ¢è´­ã€ç§’æ€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#taobao_seckill"><span class="toc-number">1.1.1.</span> <span class="toc-text">  taobao_seckill</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#taobao_api"><span class="toc-number">1.1.2.</span> <span class="toc-text"> taobao_api</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jd_seckill"><span class="toc-number">1.1.3.</span> <span class="toc-text"> jd_seckill</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jd-assistant"><span class="toc-number">1.1.4.</span> <span class="toc-text"> jd-assistantâ˜…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jd-seckill-maotai"><span class="toc-number">1.1.5.</span> <span class="toc-text">  jd-seckill-maotai</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸»è¦åŠŸèƒ½"><span class="toc-number">1.2.</span> <span class="toc-text"> ä¸»è¦åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jd_mask"><span class="toc-number">1.2.1.</span> <span class="toc-text"> jd_mask</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#automatic_ticket_purchase"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Automatic_ticket_purchase</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nikerobot"><span class="toc-number">1.2.3.</span> <span class="toc-text">  NikeRobot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hpv4g"><span class="toc-number">1.2.4.</span> <span class="toc-text"> hpv4gâ˜…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æŠ¢è´­å‹ä»£ç æ€»ç»“"><span class="toc-number">1.2.5.</span> <span class="toc-text"> æŠ¢è´­å‹ä»£ç æ€»ç»“ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#weibospider"><span class="toc-number">1.3.</span> <span class="toc-text"> weiboSpider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxy_pool"><span class="toc-number">1.4.</span> <span class="toc-text"> proxy_poolâ˜…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#schedulerçš„é€»è¾‘"><span class="toc-number">1.4.1.</span> <span class="toc-text"> schedulerçš„é€»è¾‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™"><span class="toc-number">1.4.2.</span> <span class="toc-text"> é¡¹ç›®ç›®å½•ç»“æ„é»˜å†™ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ä¸‰æ»‘å—ç¼ºå£è¯†åˆ«"><span class="toc-number">1.5.</span> <span class="toc-text"> æéªŒæ»‘å—éªŒè¯ç ç ´è§£ä¸ç ”ç©¶ï¼ˆä¸‰ï¼‰ï¼šæ»‘å—ç¼ºå£è¯†åˆ«</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æœºå™¨å­¦ä¹ "><span class="toc-number">2.</span> <span class="toc-text"> æœºå™¨å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cardrecorder"><span class="toc-number">2.1.</span> <span class="toc-text"> cardRecorder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wiki_zh_word2vec"><span class="toc-number">2.2.</span> <span class="toc-text"> wiki_zh_word2vec</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç³»ç»Ÿè®¾è®¡"><span class="toc-number">3.</span> <span class="toc-text"> ç³»ç»Ÿè®¾è®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#python-è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·"><span class="toc-number">3.1.</span> <span class="toc-text"> Python è‡ªåˆ¶å±å¹•ç¿»è¯‘å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-design-primer"><span class="toc-number">3.2.</span> <span class="toc-text"> system-design-primer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#go-package-plantuml"><span class="toc-number">3.3.</span> <span class="toc-text">  go-package-plantuml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#id-maker"><span class="toc-number">3.4.</span> <span class="toc-text"> id-maker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#health_checker"><span class="toc-number">3.5.</span> <span class="toc-text"> health_checker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookiecutter-golang"><span class="toc-number">3.6.</span> <span class="toc-text"> cookiecutter-golang</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dddd_trainer"><span class="toc-number">3.7.</span> <span class="toc-text">  dddd_trainer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#njupt-api"><span class="toc-number">3.8.</span> <span class="toc-text"> NJUPT-API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rss-monitor"><span class="toc-number">3.9.</span> <span class="toc-text"> Rss-Monitor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddt-sharp-shooter"><span class="toc-number">3.10.</span> <span class="toc-text">  ddt-sharp-shooter</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ–‡ç« è®°å½•"><span class="toc-number">4.</span> <span class="toc-text"> æ–‡ç« è®°å½•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®"><span class="toc-number">4.1.</span> <span class="toc-text"> Githubä¼˜ç§€çš„æ–‡ç« é¡¹ç›®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#goå¥½ç”¨çš„ä¸‰æ–¹åº“"><span class="toc-number">4.2.</span> <span class="toc-text"> Goå¥½ç”¨çš„ä¸‰æ–¹åº“</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>